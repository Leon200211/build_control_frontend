{"version":3,"file":"spreadsheet.js","sources":["../sources/locale.js","../sources/locales/en.js","../sources/views/align.js","../sources/views/border.js","../sources/views/color.js","../node_modules/@xbs/muon/dist/muon.js","../sources/mathematics/methods.js","../sources/views/date.js","../sources/views/dialog.js","../sources/views/form.js","../sources/views/formlate.js","../sources/views/icons.js","../sources/views/list_suggest.js","../sources/operations/undo_group.js","../sources/operations/save.js","../sources/helpers/column_names.js","../sources/toolbar/defaults.js","../sources/operations/styles.js","../sources/helpers/array.js","../sources/operations/formats.js","../sources/mathematics/parser.js","../sources/operations/types.js","../sources/views/suggest_formula.js","../sources/views/button.js","../sources/views/live_editor.js","../sources/views/separator.js","../sources/views/sheets.js","../sources/views/toggle.js","../sources/views/toolbar_title.js","../sources/views/multicheckbox.js","../sources/views/formlist.js","../sources/views/ui.js","../sources/views/series.js","../sources/views/bar.js","../sources/views/zoom.js","../sources/editors/date.js","../sources/editors/richselect.js","../sources/toolbar/actions.js","../sources/toolbar/buttons.js","../sources/toolbar/all_elements.js","../sources/toolbar.js","../sources/toolbar/helpers.js","../sources/operations/column_operations.js","../sources/operations/lock_cell.js","../sources/operations/spans.js","../sources/helpers/conditional.js","../sources/operations/conditional_formats.js","../sources/operations/data.js","../sources/sheets.js","../sources/operations/show_cells.js","../sources/table.js","../sources/hotkeys.js","../sources/editor.js","../sources/dialogs/common.js","../sources/mathematics/writer.js","../sources/dialogs/imagecell.js","../sources/dialogs/imagetop.js","../sources/operations/undo.js","../sources/operations/views.js","../sources/chart.js","../sources/dialogs/sparkline.js","../sources/dialogs/ranges.js","../sources/dialogs/dropdown.js","../sources/mathematics/ranges.js","../sources/operations/filter.js","../sources/dialogs/filter.js","../sources/dialogs/format.js","../sources/dialogs/conditional.js","../sources/dialogs/export.js","../sources/dialogs/link.js","../sources/operations/print.js","../sources/dialogs/print.js","../sources/dialogs/comments.js","../sources/dialogs/sizing.js","../sources/dialogs/index.js","../sources/operations/add_row_col.js","../sources/operations/dropdown.js","../sources/operations/clipboard.js","../sources/operations/hide_row_col.js","../sources/operations/resize.js","../sources/operations/selection.js","../sources/helpers/expand_selection.js","../sources/operations/sorting.js","../sources/mathematics/sheets.js","../sources/operations/hide_gridlines.js","../sources/operations/hide_headers.js","../sources/operations/comments.js","../sources/operations/show_formulas.js","../sources/operations/states.js","../sources/operations/import.js","../sources/operations/export.js","../sources/operations/load.js","../sources/operations/clear_styles.js","../sources/operations/zoom.js","../sources/api/row_col_operations.js","../sources/api/lock_cell.js","../sources/api/freeze.js","../sources/api/hide_gridlines.js","../sources/api/hide_headers.js","../sources/api/hide_rows.js","../sources/api/math.js","../sources/api/operations.js","../sources/api/core.js","../sources/api/save.js","../sources/api/dropdown.js","../sources/api/filter.js","../sources/api/confirm.js","../sources/api/undo.js","../sources/api/number_formats.js","../sources/api/show_formulas.js","../sources/api/print.js","../sources/api/zoom.js","../sources/menu.js","../sources/spreadsheet.js","../sources/context.js","../sources/operations/index.js","../sources/api/index.js"],"sourcesContent":["import en from \"./locales/en\";\nwebix.i18n.spreadsheet = en;","export default {\n\tlabels:{\n\t\t// formats\n\t\t\"common\": \"Common\",\n\t\t\"currency\": \"Currency\",\n\t\t\"number\": \"Number\",\n\t\t\"percent\": \"Percent\",\n\t\t\"date\": \"Date\",\n\t\t\"string\": \"Text\",\n\t\t\"custom-format\": \"Custom\",\n\t\t\"decimal-places\":\"Decimal places\",\n\t\t\"separator\":\"Group separator\",\n\t\t\"negative\":\"Negative number\",\n\t\t\"currency-symbol\":\"Сurrency\",\n\t\t\"date-format\":\"Date format\",\n\t\t\"format-docs\":\"How to create a format\",\n\t\t// titles\n\t\t\"undo-redo\": \"Undo/Redo\",\n\t\t\"font\": \"Font\",\n\t\t\"text\": \"Text\",\n\t\t\"cell\": \"Cell\",\n\t\t\"align\": \"Align\",\n\t\t\"format\": \"Number\",\n\t\t\"column\": \"Column\",\n\t\t\"borders\": \"Borders\",\n\t\t\"px\": \"px\",\n\t\t\"apply\": \"Apply\",\n\t\t// popups and dialogs\n\t\t\"cancel\": \"Cancel\",\n\t\t\"save\": \"Save\",\n\t\t// multisheets\n\t\t\"sheet\": \"Sheet\",\n\t\t// conditions\n\t\t\"conditional-format\": \"Conditional Format\",\n\t\t\"conditional-common\": \"Common\",\n\t\t\"conditional-text\": \"Text\",\n\t\t\"condition\": \"Condition\",\n\t\t\"conditional-style\": \"Style\",\n\t\t\"conditional-operator\": \"Operator\",\n\t\t\"conditional-between\":\"between\",\n\t\t\"conditional-not-equal\":\"not equal\",\n\t\t// ranges\n\t\t\"range\": \"Range\",\n\t\t\"range-title\": \"Named ranges\",\n\t\t\"range-name\": \"Name\",\n\t\t\"range-cells\": \"Range\",\n\t\t\"range-scope\": \"Scope\",\n\t\t\"range-global\": \"Book\",\n\t\t// images\n\t\t\"image-or\": \"or\",\n\t\t\"image-title\": \"Add image\",\n\t\t\"image-upload\": \"Select file for upload\",\n\t\t\"image-url\": \"URL (e.g. http://*)\",\n\t\t// sparklines\n\t\t\"sparkline-title\": \"Add sparkline\",\n\t\t\"sparkline-type\": \"Type\",\n\t\t\"sparkline-range\": \"Range\",\n\t\t\"sparkline-color\": \"Color\",\n\t\t\"sparkline-positive\": \"Positive\",\n\t\t\"sparkline-negative\": \"Negative\",\n\t\t// custom format\n\t\t\"format-title\": \"Set format\",\n\t\t\"format-pattern\": \"Format pattern\",\n\t\t//dropdown\n\t\t\"dropdown-empty\": \"Empty cells\",\n\t\t\"dropdown-empty-option\": \"Empty option\",\n\t\t\"dropdown-title\": \"Add dropdown\",\n\t\t\"dropdown-range\": \"Range\",\n\t\t// confirm\n\t\t\"ok\": \"OK\",\n\t\t// import/export\n\t\t\"import-title\": \"Import\",\n\t\t\"import-not-support\": \"Sorry, your browser does not support import\",\n\t\t\"export-title\": \"Export\",\n\t\t\"export-name\": \"Name of xslx file\",\n\t\t\"export-all-sheets\":\"Export all sheets\",\n\t\t// add link\n\t\t\"link-title\": \"Add Link\",\n\t\t\"link-name\": \"Text\",\n\t\t\"link-url\": \"URL\",\n\t\t//images\n\t\t\"image\": \"Image\",\n\t\t\"add-image-cell\":\"Add to cell\",\n\t\t\"add-image-top\":\"Add above cells\",\n\t\t//charts\n\t\t\"graph\": \"Graph\",\n\t\t\"add-sparkline\":\"Add to cell\",\n\t\t\"add-chart\":\"Add above cells\",\n\t\t//conditional format labels\n\t\t\"display\" : \"Display\",\n\t\t\"value\" : \"Value\",\n\t\t// confirm messages\n\t\t\"range-remove-confirm\": \"Are you sure you want to remove the range permanently?\",\n\t\t\"sheet-remove-confirm\": \"Are you sure you want to remove the sheet permanently?\",\n\t\t\"merge-cell-confirm\":\"Only the left top value will remain after merging. Continue?\",\n\t\t\"error-range\": \"The range is incorrect!\",\n\t\t\"error-link\": \"The link is incorrect!\",\n\t\t//print\n\t\t\"print\":\"Print\",\n\t\t\"print-title\":\"Before you print..\",\n\t\t\"print-settings\":\"General settings\",\n\t\t\"print-paper\":\"Paper size\",\n\t\t\"print-layout\":\"Layout\",\n\t\t\"sheets\":\"Sheets:\",\n\t\t\"selection\":\"Selected cells\",\n\t\t\"borderless\":\"Hide gridlines\",\n\t\t\"sheet-names\":\"Show sheet names\",\n\t\t\"skip-rows\":\"Skip empty rows\",\n\t\t\"margin\":\"Hide margins\",\n\t\t\"page-letter\":\"Letter\",\n\t\t\"page-a4\":\"A4 (210x297mm)\",\n\t\t\"page-a3\":\"A3 (297x420mm)\",\n\t\t\"page-width\":\"Page width\",\n\t\t\"page-actual\":\"Actual Size\",\n\t\t\"page-portrait\":\"Portrait\",\n\t\t\"page-landscape\":\"Landscape\",\n\t\t\"external-ui\":\"External UI\",\n\t\t\"print-borders\": \"Show print borders\",\n\t\t//comment\n\t\t\"comment\":\"Comment\",\n\t\t//resize\n\t\t\"width\":\"Width\",\n\t\t\"height\":\"Height\",\n\t\t\"fit-content\": \"Fit to content\",\n\t\t\"default-size\":\"Reset to default\",\n\t\t//views\n\t\t\"edit-view\":\"Edit\",\n\t\t\"remove-view\":\"Remove\",\n\t\t\"chart-edit\":\"Edit chart\",\n\n\t\t\"chart-common\":\"Common\",\n\t\t\"chart-series\":\"Series\",\n\t\t\"chart-extras\":\"Extras\",\n\n\t\t\"export-view\":\"Download\",\n\t\t\"export-view-pdf\":\"PDF document\",\n\t\t\"export-view-png\":\"PNG image\",\n\t\t\"export-view-excel\":\"Excel file\",\n\n\t\t\"line-chart\":\"Line\",\n\t\t\"area-chart\":\"Area\",\n\t\t\"bar-chart\":\"Bar\",\n\t\t\"donut-chart\":\"Donut\",\n\t\t\"pie-chart\":\"Pie\",\n\t\t\"radar-chart\":\"Radar\",\n\t\t\"spline-chart\":\"Spline\",\n\t\t\"splinearea-chart\":\"Spline Area\",\n\t\t\"scatter-chart\":\"Scatter\",\n\n\t\t\"chart-scale\":\"Scale\",\n\t\t\"chart-x-axis\":\"X axis\",\n\t\t\"chart-y-axis\":\"Y axis\",\n\t\t\"chart-lines\":\"Lines\",\n\t\t\"chart-scale-color\":\"Scale color\",\n\t\t\"chart-xAxis-title\":\"Title\",\n\t\t\"chart-yAxis-title\":\"Title\",\n\t\t\"chart-col-xAxis\":\"Use left column as xAxis\",\n\t\t\"chart-col-yAxis\":\"Use left column as yAxis\",\n\t\t\"chart-row-xAxis\":\"Use top row as xAxis\",\n\t\t\"chart-row-yAxis\":\"Use top row as yAxis\",\n\t\t\"chart-xAxis-range\":\"Range\",\n\t\t\"chart-yAxis-origin\":\"Origin\",\n\t\t\"chart-yAxis-start\":\"Start\",\n\t\t\"chart-yAxis-end\":\"End\",\n\t\t\"chart-yAxis-step\":\"Step\",\n\t\t\"chart-yAxis-note\":\"* Set all the following parameters to see the effect\",\n\n\t\t\"chart-legend\":\"Legend\",\n\t\t\"chart-row-legend\":\"Use top row as legend\",\n\t\t\"chart-col-legend\":\"Use left column as legend\",\n\t\t\"chart-legend-range\":\"Legend range\",\n\t\t\"chart-legend-align\":\"Align\",\n\t\t\"chart-legend-left\":\"Left\",\n\t\t\"chart-legend-right\":\"Right\",\n\t\t\"chart-legend-center\":\"Center\",\n\t\t\"chart-legend-valign\":\"Vertical align\",\n\t\t\"chart-legend-top\":\"Top\",\n\t\t\"chart-legend-middle\":\"Middle\",\n\t\t\"chart-legend-bottom\":\"Bottom\",\n\n\t\t\"chart-item\":\"Data\",\n\t\t\"stacked-chart\":\"Stacked\",\n\t\t\"horizontal-chart\":\"Horizontal\",\n\t\t\"chart-range\":\"Range\",\n\t\t\"chart-series-color\":\"Color\",\n\t\t\"add-line\":\"Add line\",\n\t\t\"chart-type\":\"Type\",\n\t\t\"chart-tooltip\":\"Tooltips\",\n\t\t\"chart-label\":\"Labels\",\n\n\t\t\"chart-data-from\":\"Data series from\",\n\t\t\"chart-columns\":\"columns\",\n\t\t\"chart-rows\":\"rows\",\n\n\t\t\"chart-markers\":\"Markers\",\n\t\t\"chart-markers-square\":\"Square\",\n\t\t\"chart-markers-triangle\":\"Triangle\",\n\t\t\"chart-markers-diamond\":\"Diamond\",\n\t\t\"chart-markers-round\":\"Round\",\n\n\t\t\"chart-pie-3d\":\"3D\",\n\n\t\t\"chart-radar-circle\":\"Circled lines\"\n\t},\n\ttooltips: {\n\t\t\"color\": \"Font color\",\n\t\t\"background\": \"Background color\",\n\t\t\"font-family\": \"Font family\",\n\t\t\"font-size\": \"Font size\",\n\t\t\"text-align\": \"Horizontal align\",\n\t\t\"vertical-align\": \"Vertical align\",\n\t\t\"borders\": \"Borders\",\n\t\t\"borders-no\": \"Clear borders\",\n\t\t\"borders-left\": \"Left border\",\n\t\t\"borders-top\": \"Top border\",\n\t\t\"borders-right\": \"Right border\",\n\t\t\"borders-bottom\": \"Bottom border\",\n\t\t\"borders-all\": \"All borders\",\n\t\t\"borders-outer\": \"Outer borders\",\n\t\t\"borders-top-bottom\": \"Top and bottom borders\",\n\t\t\"borders-color\": \"Border color\",\n\t\t\"align-left\": \"Left align\",\n\t\t\"align-center\": \"Center align\",\n\t\t\"align-right\": \"Right align\",\n\t\t\"align-top\": \"Top align\",\n\t\t\"align-middle\": \"Middle align\",\n\t\t\"align-bottom\": \"Bottom align\",\n\t\t\"span\": \"Merge\",\n\t\t\"wrap\": \"Text wrap\",\n\t\t\"undo\": \"Undo\",\n\t\t\"redo\": \"Redo\",\n\t\t\"format\": \"Number format\",\n\t\t\"increase-decimals\":\"Increase decimal places\",\n\t\t\"decrease-decimals\":\"Decrease decimal places\",\n\t\t\"font-weight\": \"Bold\",\n\t\t\"font-style\": \"Italic\",\n\t\t\"underline\": \"Underline\",\n\t\t\"strike\": \"Strike\",\n\t\t\"hide-gridlines\": \"Hide/show gridlines\",\n\t\t\"hide-headers\": \"Hide/show headers\",\n\t\t\"show-formulas\": \"Hide/show formulas\",\n\t\t\"print-borders\": \"Hide/show print borders\",\n\t\t\"create-filter\": \"Create/remove filters\",\n\t\t\"freeze-columns\" : \"Freeze/unfreeze columns\",\n\t\t\"add-range\": \"Set name for the selected range\",\n\t\t\"conditional\": \"Conditional formatting\",\n\t\t\"add-sheet\": \"Add Sheet\",\n\t\t\"lock-cell\": \"Lock/unlock cell\",\n\t\t\"clear\": \"Clear\",\n\t\t\"add-link\": \"Add link\",\n\t\t\"row\": \"Rows\",\n\t\t\"column\": \"Columns\",\n\t\t\"sheet\": \"Sheet\",\n\t\t\"add-image\": \"Image\",\n\t\t\"add-sparkline\": \"Graph\",\n\t\t\"add-comment\": \"Comment\",\n\t\t\"increase-indent\" : \"Increase indent\",\n\t\t\"decrease-indent\": \"Decrease indent\",\n\t\t\"scale\": \"Scale\",\n\t\t\"show-sheet\": \"Show sheet\"\n\t},\n\tmenus:{\n\t\t\"remove-sheet\": \"Remove sheet\",\n\t\t\"rename-sheet\": \"Rename sheet\",\n\t\t\"hide-sheet\": \"Hide sheet\",\n\t\t\"file\": \"File\",\n\t\t\"new\": \"New\",\n\t\t\"new-sheet\": \"New sheet\",\n\t\t\"excel-import\": \"Import from Excel\",\n\t\t\"excel-export\": \"Export to Excel\",\n\t\t\"sheet\": \"Sheets\",\n\t\t\"copy-sheet\": \"Copy to new sheet\",\n\t\t\"edit\": \"Edit\",\n\t\t\"undo\": \"Undo\",\n\t\t\"redo\": \"Redo\",\n\t\t\"columns\": \"Columns\",\n\t\t\"insert-column\": \"Insert column\",\n\t\t\"delete-column\": \"Delete column\",\n\t\t\"show-column\": \"Show column\",\n\t\t\"hide-column\": \"Hide column\",\n\t\t\"resize-column\": \"Resize column\",\n\t\t\"rows\": \"Rows\",\n\t\t\"insert-row\": \"Insert row\",\n\t\t\"delete-row\": \"Delete row\",\n\t\t\"show-row\": \"Show row\",\n\t\t\"hide-row\": \"Hide row\",\n\t\t\"resize-row\": \"Resize row\",\n\t\t\"insert\": \"Insert\",\n\t\t\"conditional-format\": \"Conditional format\",\n\t\t\"common\": \"common\",\n\t\t\"text\": \"text\",\n\t\t\"clear\": \"Clear\",\n\t\t\"clear-value\":\"Values\",\n\t\t\"clear-style\":\"Styles\",\n\t\t\"clear-conditional-formats\":\"Conditional formats\",\n\t\t\"clear-dropdown-editors\":\"Dropdowns and filters\",\n\t\t\"clear-comments\":\"Comments\",\n\t\t\"clear-all\":\"All\",\n\t\t\"image\": \"Image\",\n\t\t\"add-image-cell\":\"Add to cell\",\n\t\t\"add-image-top\":\"Add above cells\",\n\t\t\"graph\": \"Graph\",\n\t\t\"add-sparkline\":\"Add to cell\",\n\t\t\"add-chart\":\"Add above cells\",\n\t\t\"data\": \"Data\",\n\t\t\"add-link\": \"Add link\",\n\t\t\"add-range\": \"Named ranges\",\n\t\t\"sort\": \"Sort\",\n\t\t\"sort-asc\": \"Sort A to Z\",\n\t\t\"sort-desc\": \"Sort Z to A\",\n\t\t\"view\": \"View\",\n\t\t\"freeze-columns\": \"Freeze/unfreeze columns\",\n\t\t\"freeze-rows\": \"Freeze/unfreeze rows\",\n\t\t\"hide-gridlines\": \"Hide/show gridlines\",\n\t\t\"hide-headers\": \"Hide/show headers\",\n\t\t\"show-formulas\": \"Hide/show formulas\",\n\t\t\"create-filter\": \"Create/remove filters\",\n\t\t\"add-dropdown\": \"Add dropdown\",\n\t\t\"lock-cell\": \"Lock/unlock cell\",\n\t\t\"print\": \"Print\",\n\t\t\"print-borders\": \"Hide/show print borders\",\n\t\t\"add-comment\":\"Comment\",\n\t\t\"cut\": \"Cut\",\n\t\t\"copy\": \"Copy\",\n\t\t\"paste\": \"Paste\",\n\t\t\"special-paste\": \"Special paste\",\n\t\t\"paste-values\": \"Values\",\n\t\t\"paste-formulas\": \"Formulas\",\n\t\t\"paste-styles\": \"Styles\",\n\t\t\"paste-conditions\": \"Conditional formats\"\n\t},\n\ttable:{\n\t\t\"math-error\":\"#ERROR!\",\n\t\t\"math-ref-error\":\"#REF!\",\n\t\t\"format-error\":\"INCORRECT FORMAT\"\n\t},\n\tliveEditor:{\n\t\t\"edit\":\"Edit:\"\n\t},\n\tformats:{\n\t\t\"dateFormat\": \"mm/dd/yyyy\",\n\t\t\"timeFormat\": \"hh:mm AM/PM\",\n\t\t\"longDateFormat\": \"dd mmmm yyyy\",\n\t\t\"fullDateFormat\": \"mm/dd/yyyy hh:mm AM/PM\",\n\t\t\"parseDateTime\": \"%m/%d/%Y %G:%i:%s\",\n\t\t\"parseDate\": \"%m/%d/%Y\",\n\t\t\"currencies\": [\n\t\t\t\"{obj} €\",\n\t\t\t\"¥{obj}\",\n\t\t\t\"R$ {obj}\",\n\t\t\t\"{obj} rub.\"\n\t\t]\n\t}\n};\n","webix.protoUI({\n\tname: \"ssheet-align\",\n\t$cssName:\"richselect\",\n\t$init: function(config){\n\t\tconfig.options =  {\n\t\t\tview:\"datasuggest\",\n\t\t\tbody:{\n\t\t\t\tview: \"ssheet-icons\",\n\t\t\t\ttooltip: {\n\t\t\t\t\ttemplate:\"#tooltip#\"\n\t\t\t\t},\n\t\t\t\txCount:3, yCount:1\n\t\t\t},\n\t\t\tdata: config.data\n\t\t};\n\t}\n},webix.ui.richselect);","webix.protoUI({\n\tname: \"ssheet-borders-suggest\",\n\tdefaults:{\n\t\twidth: 300\n\t},\n\t$init: function(config){\n\t\tconst skin = webix.skin.$name;\n\t\tconfig.body = {\n\t\t\tmargin: 6,\n\t\t\tcols:[\n\t\t\t\t{ view: \"ssheet-icons\", scroll: false, select: true,\n\t\t\t\t\txCount: 4,\n\t\t\t\t\tyCount: 2,\n\t\t\t\t\ttooltip: {\n\t\t\t\t\t\ttemplate: function(obj){\n\t\t\t\t\t\t\treturn webix.i18n.spreadsheet.tooltips[\"borders-\"+obj.id];\n\t\t\t\t\t\t}\n\t\t\t\t\t},\n\t\t\t\t\ton:{\n\t\t\t\t\t\tonAfterSelect: function(){\n\t\t\t\t\t\t\tvar suggest = this.getParentView().getParentView();\n\t\t\t\t\t\t\tsuggest.updateMasterValue(true);\n\t\t\t\t\t\t}\n\t\t\t\t\t},\n\t\t\t\t\ttemplate: function(obj){\n\t\t\t\t\t\tvar css = \"webix_ssheet_button_icon webix_ssheet_icon ssi-borders-\"+obj.value;\n\t\t\t\t\t\treturn \"<span class='\"+css+\"'></span>\";\n\t\t\t\t\t},\n\t\t\t\t\tdata: config.data\n\t\t\t\t},\n\t\t\t\t{ view: \"ssheet-separator\"},\n\t\t\t\t{\n\t\t\t\t\trows:[\n\t\t\t\t\t\t{ view: \"ssheet-color\", css: config.css, name: config.name, width: 68,\n\t\t\t\t\t\t\tvalue: (skin == \"contrast\" || skin == \"dark\") ? \"#ffffff\" : \"#000000\",\n\t\t\t\t\t\t\ttooltip: webix.i18n.spreadsheet.tooltips[\"borders-color\"],\n\t\t\t\t\t\t\ttitle: \"<span class='webix_icon wxi-pencil'></span>\",\n\t\t\t\t\t\t\ton:{\n\t\t\t\t\t\t\t\tonChange: function(){\n\t\t\t\t\t\t\t\t\tvar suggest = this.getParentView().getParentView().getParentView();\n\t\t\t\t\t\t\t\t\tsuggest.updateMasterValue(false);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t},\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tview: \"richselect\", css:\"webix_ssheet_border_type\", value:\"thin\", suggest:{\n\t\t\t\t\t\t\t\tfitMaster:false,\n\t\t\t\t\t\t\t\twidth:130,\n\t\t\t\t\t\t\t\tcss: \"webix_ssheet_suggest\",\n\t\t\t\t\t\t\t\tbody: {\n\t\t\t\t\t\t\t\t\ttemplate:\"<div class='webix_ssheet_border webix_ssheet_border_#id#'></div>\",\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\tdata:[\n\t\t\t\t\t\t\t\t\t{ id:\"thin\" },\n\t\t\t\t\t\t\t\t\t{ id:\"medium\" },\n\t\t\t\t\t\t\t\t\t{ id:\"thick\" },\n\t\t\t\t\t\t\t\t\t{ id:\"dashed\" }, \n\t\t\t\t\t\t\t\t\t{ id:\"dotted\" },\n\t\t\t\t\t\t\t\t\t{ id:\"double\" }\n\t\t\t\t\t\t\t\t]\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t},\n\t\t\t\t\t\t{ }\n\t\t\t\t\t]\n\t\t\t\t}\n\n\t\t\t]\n\t\t};\n\t},\n\tupdateMasterValue: function(hide){\n\t\tconst value = this.getValue();\n\t\tconst master = webix.$$(this.config.master);\n\t\tmaster.setValue(value, \"user\");\n\t\tif(hide)\n\t\t\tthis.hide();\n\t},\n\tsetValue: function(value){\n\t\tif(value[0])\n\t\t\tthis.getList().select(value[0]);\n\t\tif(value[1])\n\t\t\tthis.getColorView().setValue(value[1]);\n\t\tif(value[2])\n\t\t\tthis.getTypeView().setValue(value[2]);\n\t},\n\tgetValue: function(){\n\t\treturn [this.getList().getSelectedId(), this.getColorView().getValue()||\"\", this.getTypeView().getValue()||\"\"];\n\t},\n\tgetList: function(){\n\t\treturn this.getBody().getChildViews()[0];\n\t},\n\tgetColorView: function(){\n\t\treturn this.getBody().getChildViews()[2].getChildViews()[0];\n\t},\n\tgetTypeView: function(){\n\t\treturn this.getBody().getChildViews()[2].getChildViews()[1];\n\t},\n\tgetItemText:function(){\n\t\treturn \"<span class='webix_ssheet_button_icon webix_ssheet_icon ssi-borders-all'>\";\n\t}\n},webix.ui.suggest);\n\nwebix.protoUI({\n\tname: \"ssheet-borders\",\n\t$cssName: \"richselect\",\n\t$init: function(config){\n\t\tconfig.options = {\n\t\t\tview: \"ssheet-borders-suggest\",\n\t\t\tfitMaster: false,\n\t\t\tdata: config.data\n\t\t};\n\n\t\tthis.$ready.push(webix.bind(function(){\n\t\t\tthis.getPopup().config.master = this.config.id;\n\t\t},this));\n\n\t},\n\tsetValue: function(value, config){\n\t\tif(webix.isArray(value)){\n\t\t\tif(!this.config.value || value[0] !=  this.config.value[0] || value[1] !=  this.config.value[1]){\n\t\t\t\tthis.getPopup().setValue(value);\n\t\t\t}\n\t\t\tconst old = this.config.value;\n\t\t\tthis.config.value = value;\n\t\t\tif (value[0])\n\t\t\t\tthis.callEvent(\"onChange\", [this.getValue(), old, config]);\n\t\t}\n\t\treturn value;\n\t},\n\tgetValue: function(){\n\t\treturn  this.getPopup().getValue().join(\",\");\n\t},\n\tgetList: function(){\n\t\treturn this.getPopup().getBody().getChildViews()[0];\n\t},\n\tgetColorView: function(){\n\t\treturn this.getPopup().getBody().getChildViews()[1].getChildViews()[0];\n\t}\n},webix.ui.richselect);","// toolbar: color selector\nwebix.protoUI({\n\t$cssName: \"colorboard\",\n\tname: \"ssheet-colorboard\",\n\tdefaults:{\n\t\theight: 196,\n\t\twidth: 244,\n\t\tcss: \"webix_ssheet_colorboard\",\n\t\tpalette: [\n\t\t\t[\"#000000\", \"#434343\", \"#666666\", \"#999999\", \"#b7b7b7\", \"#cccccc\", \"#d9d9d9\", \"#efefef\", \"#f3f3f3\", \"#ffffff\"],\n\t\t\t[\"#980000\", \"#ff0000\", \"#ff9900\", \"#ffff00\", \"#00ff00\", \"#00ffff\", \"#4a86e8\", \"#0000ff\", \"#9900ff\", \"#ff00ff\"],\n\t\t\t[\"#e6b8af\", \"#f4cccc\", \"#fce5cd\", \"#fff2cc\", \"#d9ead3\", \"#d0e0e3\", \"#c9daf8\", \"#cfe2f3\", \"#d9d2e9\", \"#ead1dc\"],\n\t\t\t[\"#dd7e6b\", \"#ea9999\", \"#f9cb9c\", \"#ffe599\", \"#b6d7a8\", \"#a2c4c9\", \"#a4c2f4\", \"#9fc5e8\", \"#b4a7d6\", \"#d5a6bd\"],\n\t\t\t[\"#cc4125\", \"#e06666\", \"#f6b26b\", \"#ffd966\", \"#93c47d\", \"#76a5af\", \"#6d9eeb\", \"#6fa8dc\", \"#8e7cc3\", \"#c27ba0\"],\n\t\t\t[\"#a61c00\", \"#cc0000\", \"#e69138\", \"#f1c232\", \"#6aa84f\", \"#45818e\", \"#3c78d8\", \"#3d85c6\", \"#674ea7\", \"#a64d79\"],\n\t\t\t[\"#85200c\", \"#990000\", \"#b45f06\", \"#bf9000\", \"#38761d\", \"#134f5c\", \"#1155cc\", \"#0b5394\", \"#351c75\", \"#741b47\"],\n\t\t\t[\"#5b0f00\", \"#660000\", \"#783f04\", \"#7f6000\", \"#274e13\", \"#0c343d\", \"#1c4587\", \"#073763\", \"#20124d\", \"#4c1130\"]\n\t\t]\n\t},\n\t$init:function(){\n\t\tthis.attachEvent(\"onSelect\", function(value){\n\t\t\tthis.getParentView().setMasterValue({ value }, false, \"user\");\n\t\t});\n\t}\n}, webix.ui.colorboard);\n\nwebix.protoUI({\n\t$cssName: \"richselect\",\n\tname: \"ssheet-color\",\n\tdefaults:{\n\t\tcss: \"webix_ssheet_color\",\n\t\ticon: \"wxi-menu-down\",\n\t\tsuggest:{\n\t\t\tborderless: true,\n\t\t\tbody:{\n\t\t\t\tview: \"ssheet-colorboard\"\n\t\t\t}\n\t\t}\n\t},\n\t$init: function(){\n\t\tthis.$view.className += \" webix_ssheet_color\";\n\t},\n\t$renderInput: function(config, divStart, id){\n\t\tconst color  = this.renderColor.call(this);\n\t\tdivStart = divStart.replace(/([^>]>)(.*)(<\\/div)/, function(match, p1, p2, p3){\n\t\t\treturn p1+config.title +color+p3;\n\t\t});\n\n\t\treturn webix.ui.colorpicker.prototype.$renderInput.call(this,config, divStart, id);\n\t},\n\t$setValue: function(value){\n\t\tvalue = value || \"\";\n\t\tthis.getColorNode().style.backgroundColor = value;\n\t},\n\trenderColor: function(){\n\t\treturn \"<div class='webix_ssheet_cp_color' style='background-color:\"+this.config.value+\";'> </div>\";\n\t},\n\tgetColorNode: function(){\n\t\treturn this.$view.firstChild.firstChild.childNodes[1];\n\t},\n\t$renderIcon:function(){\n\t\treturn webix.ui.text.prototype.$renderIcon.apply(this,arguments);\n\t}\n},webix.ui.colorpicker);","\"use strict\";Object.defineProperty(exports,\"__esModule\",{value:!0});var t,r={1:\"#ERROR\",2:\"#ERROR\",3:\"#REF!\"},e=function(){return e=Object.assign||function(t){for(var r,e=1,n=arguments.length;e<n;e++)for(var o in r=arguments[e])Object.prototype.hasOwnProperty.call(r,o)&&(t[o]=r[o]);return t},e.apply(this,arguments)};function n(t,r,e){return e+64*r+64*t*4096}function o(t){return[t<2147483648?t>>18:t/262144&16777215,t>>6&4095,63&t]}function i(t){return t<2147483648?t>>18:t/262144&16777215}function a(t){return t>>6&4095}function u(t){return 63&t}function f(t,r,e){for(var n=o(t),i=n[0],a=n[1],u=o(r),f=u[0]-i,s=u[1]-a,h=0;h<=f;h++)for(var c=0;c<=s;c++)e(t+64*c+4096*h*64)}function s(t,r){for(var e,n,i,a,f,s,c,p,v=t.code,g=t.source,l=\"\",d=v.length,b=0;b<d;b+=3){switch(v[b]){case 5:var M=void 0;9===v[b+6]&&(M=r.pageName(u(v[b+7]))),l+=(-1!==(p=M||t.source.substr(v[b+1],v[b+2])).indexOf(\" \")?\"'\"+p+\"'\":p)+\"!\";break;case 7:l+=h(a=(e=o(v[b+4]))[0],s=e[1],v[b+5]);break;case 4:l+=g.substr(v[b+1],v[b+2]).toUpperCase();break;case 8:a=(n=o(v[b+4]))[0],s=n[1],f=(i=o(v[b+7]))[0],c=i[1],l+=h(a,s,v[b+5]),l+=\":\",l+=h(f,c,v[b+8]);break;case 9:break;case 2:l+=\"{{\"+g.substr(v[b+1],v[b+2])+\"}}\";break;case 3:l+=\"#REF!\";break;case 1:l+='\"'+g.substr(v[b+1],v[b+2])+'\"';break;default:l+=g.substr(v[b+1],v[b+2])}}return l}function h(t,r,e){var n=\"\";2&e&&(n+=\"$\");var o=\"\";for(r+=1;r>0;){var i=r%26;0===i&&(i=26),o=String.fromCharCode(64+i)+o,r=(r-i)/26}return n+=o,1&e&&(n+=\"$\"),n+=t+1}function c(t){return t<=122}function p(t){return t<=122?t>=65||35===t||36===t||46===t:t>191}function v(t){return t>=97}function g(t){var r=t.charCodeAt(0);return r>=48&&r<=57}function l(t,r){var e;do{r++,e=t.charCodeAt(r)}while(e>=48&&e<=57);return r}function d(t){return\" \"===t||\"\\t\"===t||\"\\n\"===t||\"\\r\"===t}function b(t,r){var e;do{e=t[++r]}while(d(e));return r}function M(t,r){if(\"<\"===t[r]){var e=t[r+1];\">\"!==e&&\"=\"!==e||r++}else\">\"===t[r]&&\"=\"===t[r+1]&&r++;return r+1}function y(r,e,n){for(var o=r.length,i=!0,a=e,u=!1,f=!1,s=!1,h=0;a<o;a++){var l=r[a];if(\"'\"!==l){if(!u){s=!0;var d=l.charCodeAt(0);if(p(d)){c(d)?v(d)&&(f=!0):i=!1,1==h&&h++;continue}if(g(l)){0==h&&h++;continue}break}}else{if(s)break;if(u){a++;break}u=!0}}var b=r[a],M=e,y=a-e;return u&&((y-=1+(\"'\"===r[a-1]?1:0))<0&&(y=0),M++,n=5),0===n&&(\":\"===b&&i?1!==h?n=3:(n=8,f&&(t=!0)):\"!\"===b?n=\"#\"===r[M]?3:5:\"(\"===b?(function(t,r,e){var n=t.substr(r,e);return n.toUpperCase()!==n}(r,M,y)&&(t=!0),n=4):\"}\"===b&&\"}\"===r[a-1]?n=2:1===h&&i?(n=7,f&&(t=!0)):n=6),[M,y,a,n]}function m(t,r,e){for(var o=0,i=0,a=1,u=1,f=0,s=!1,h=r.length-1;h>=0;h--){var c=r[h].charCodeAt(0);36!==c?c<58?(i+=(c-48)*a,a*=10):(s||(a=1,o=i,i=0,s=!0,u+=1),i+=(c-(c>96?96:64))*a,a*=26):f+=u}i>4095?t.push(3,0,0):t.push(9,n(o-1,i-1,e),f)}function _(r,e){var n,o,a=[];t=!1;for(var u,f,h=-1,c=0;c<r.length;c++){var p=r[c];if('\"'!=p){if(!(h>-1))if(\"{\"!=p||\"{\"!=r[c+1])if(\"'\"==p||((f=p.charCodeAt(0))<=122?f>=65||35===f||36===f:f>191)){var v=y(r,c,0),_=(L=v[0],P=v[1],v[2]),w=v[3],E=a.length;if(7!==w&&8!==w||5!==a[a.length-3])u=e.z,a.push(w,L,P);else{var I=\"'\"===r[L-2]?1:0,C=a[E-2],T=a[E-1];void 0===(u=e.page(r.substr(C,T)))&&(a.push(3,0,0),u=0),a.push(w,L-T-2*I-1,P+T+2*I+1)}if(c=_-1,6===w)e.name(a,r,e);else if(8===w){var D=a.length;if(m(a,r.substr(L,P),u),L=(n=y(r,c+2,0))[0],P=n[1],_=n[2],5===(w=n[3])&&(L=(o=y(r,_+1,0))[0],P=o[1],_=o[2],w=o[3]),7!==w){a[D-3]=7;continue}m(a,r.substr(L,P),u);var N=a[D+1],A=a[D+4];(N>A||i(N)>i(A))&&(a[D+1]=A,a[D+4]=N),a[D-1]+=P+1,c=_-1}else 7===w?m(a,r.substr(L,P),u):3!==w&&5!==w||c++}else if(d(p)){var S=b(r,c);a.push(12,c,S-c),c=S-1}else if(g(p)){var O=l(r,c);a.push(11,c,O-c),c=O-1}else{var x=M(r,c);a.push(10,c,x-c),c=x-1}else{var R=y(r,c+2,2),L=R[0],P=R[1],F=R[2];a.push(2,L,P),c=F+2-1}}else h>-1?(a.push(1,h+1,c-h-1),h=-1):h=c}var U={code:a,source:r,exec:null,broken:0,triggers:null};return t&&(U.source=s(U,e)),U}function w(t){return\"              \".substr(0,10-t.length)}var E=[\">\",\"<\",\"=\",\"+\"];function I(t,r){var e=function(t,r){for(var e=t.code,n=t.source,o=\"\",i=0,a=[],u=e.length,f=0;f<u;f+=3){switch(e[f]){case 4:o+='ctx.m[\"'+n.substr(e[f+1],e[f+2]).toUpperCase()+'\"]';break;case 1:o+='\"'+n.substr(e[f+1],e[f+2])+'\"';break;case 2:o+='ctx.p(\"'+n.substr(e[f+1],e[f+2])+'\")';break;case 6:case 7:var s=void 0,h=void 0;if(10===e[f-3]?s=f-3:12===e[f-3]&&10===e[f-6]&&(s=f-6),10===e[f+6]?h=f+6:12===e[f+6]&&10===e[f+9]&&(h=f+9),s||h){var c=s?n[e[s+1]]:null,p=h?n[e[h+1]]:null;if(\"&\"==c||\"&\"==p){o+=\"(ctx.v(\"+e[f+4]+') === null ? \"\" : ctx.v('+e[f+4]+\"))\";break}if(-1!=E.indexOf(c)||-1!=E.indexOf(p)){o+=\"(ctx.v(\"+e[f+4]+\") === null ? 0 : ctx.v(\"+e[f+4]+\"))\";break}}o+=\"ctx.v(\"+e[f+4]+\")\";break;case 8:o+=\"ctx.r(\"+e[f+4]+\", \"+e[f+7]+\")\";break;case 10:if(1===e[f+2])\"&\"===(v=n[e[f+1]])?o+='+\"\"+':r&&\"+\"==v?o+=\"*1+1*\":\"=\"===v?o+=\"==\":\";\"===v?o+=\",\":\"{\"===v?o+=\"[\":\"}\"===v?o+=\"]\":\"%\"===v?e[f+3]&&10!==e[f+3]?o+=r?\"/0+\":v:o+=(\"/\"==a[i]?\"*\":\"/\")+\"100\":(\"(\"==v?(i++,a.push(\"+\")):\")\"==v&&(i--,a.pop()),o+=v),\"+\"!=v&&\"-\"!=v&&\"*\"!=v&&\"/\"!=v&&\"&\"!=v||(a[i]=v);else if(2===e[f+2]){var v;o+=\"<>\"===(v=n.substr(e[f+1],e[f+2]))?\"!=\":v}else o+=n.substr(e[f+1],e[f+2]);break;case 11:o+=n.substr(e[f+1],e[f+2]);break;case 3:return\"\"}}return o}(t,r);if(!e)return t.broken=3,void(t.exec=null);try{t.exec=new Function(\"ctx\",\"return \"+e)}catch(r){t.broken=1,t.exec=null}}var C=\"#DIV/0!\",T=\"#VALUE!\",D=\"#NUM!\",N=\"#N/A\";function A(t){var r=new Date(t.getFullYear(),0,0),e=t.valueOf()-r.valueOf()+60*(r.getTimezoneOffset()-t.getTimezoneOffset())*1e3;return Math.floor(e/864e5)}function S(t){var r=new Date(Math.round(86400*(t-25569)*1e3));return new Date(r.getTime()+6e4*r.getTimezoneOffset())}function O(t){return 25569+(t.getTime()-6e4*t.getTimezoneOffset())/864e5}function x(t){return!(!t&&0!==t||(t*=1,isNaN(t)))&&t}function R(t){if(1===t.length){var r=t[0];return\"object\"==typeof r?r:[r]}for(var e=[],n=0;n<t.length;n++)e=e.concat(t[n]);return e}function L(t){return!t&&0!==t}function P(t){return\"string\"==typeof t?\"TRUE\"===t:!!t}function F(t){var r=\"string\"==typeof t?new Date(t):S(t);if(r.getTime())return r;throw t+\" is invalid date\"}function U(t){var r=x(t);if(\"number\"!=typeof r)throw t+\" is not a number\";return r}function k(t,r,e,n,o){var i=x(t);i<0&&8==o&&(r=null);var a,u=r?x(r):null;if(\"number\"!=typeof i||\"boolean\"==typeof u)throw T;if(i<e&&(i=e),i>n&&(i=n),u<-1)throw D;u&&(u=Math.floor(+u));var f=t<0&&16===o?\"FF\":\"\";if(a=n<2147483648?(i>>>0&n-e).toString(o):(i>>>0).toString(o),u&&a.length>u)throw D;return(f+a).padStart(u,\"0\").toUpperCase()}function V(t,r){var e=+yt(t),n=+mt(t),o=+yt(r),i=+mt(r);return ht(e*o-n*i,e*i+n*o)}function X(t,r){var e=+yt(t),n=+mt(t);return ht(e+ +yt(r),n+ +mt(r))}function H(t){return t>0?Math.floor(t):Math.ceil(t)}function Y(t){return t<0?Math.floor(t):Math.ceil(t)}function B(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];for(var e=0,n=R(t),o=0;o<n.length;o++){var i=x(n[o]);\"number\"==typeof i&&(e+=i)}return e}function j(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];for(var e=0,n=0,o=R(t),i=0;i<o.length;i++){var a=x(o[i]);\"number\"==typeof a&&(e+=a,n++)}return n?e/n:0}function z(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];for(var e=R(t),n=0,o=0,i=0;i<e.length;i++){var a=e[i],u=x(e[i]);\"number\"==typeof u?(n+=u,o++):(!0===a&&n++,(a||!1===a)&&o++)}return o?n/o:0}function G(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];for(var e=0,n=R(t),o=0;o<n.length;o++){var i=x(n[o]);\"number\"==typeof i&&e++}return e}function q(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];for(var e=0,n=R(t),o=0;o<n.length;o++)n[o]&&1*n[o]!=0&&e++;return e}function $(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];for(var e=-1/0,n=R(t),o=0;o<n.length;o++){var i=x(n[o]);\"number\"==typeof i&&i>e&&(e=i)}return e===-1/0?0:e}function W(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];for(var e=1/0,n=R(t),o=0;o<n.length;o++){var i=x(n[o]);\"number\"==typeof i&&i<e&&(e=i)}return e===1/0?0:e}function K(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];for(var e=!1,n=1,o=R(t),i=0;i<o.length;i++){var a=x(o[i]);\"number\"==typeof a&&(e=!0,n*=a)}return e?n:null}function Q(t,r,e){for(var n=R(t),o=r?0:-1,i=e?z.apply(void 0,t):j.apply(void 0,t),a=0,u=0;u<n.length;u++){var f=n[u],s=x(n[u]);if(\"number\"!=typeof s){if(!e||\"boolean\"!=typeof f&&!f)continue;s=!0===f?1:0}o++,a+=Math.pow(s-i,2)}return o?a/o:0}function J(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];return Q(t,!1,!1)}function Z(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];return Q(t,!1,!0)}function tt(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];return Q(t,!0,!1)}function rt(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];return Q(t,!0,!0)}function et(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];return Math.sqrt(J.apply(void 0,t))}function nt(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];return Math.sqrt(tt.apply(void 0,t))}function ot(t,r){var e=x(t),n=x(r);if(\"number\"==typeof e&&\"number\"==typeof n)return Math.pow(e,n)}var it={M:1e3,CM:900,D:500,CD:400,C:100,XC:90,L:50,XL:40,X:10,IX:9,V:5,IV:4,I:1};var at=[];function ut(t){var r=x(t);if(\"number\"==typeof r&&r>-1){var e=Math.floor(r);return 0===e||1===e?1:(at[e]>0||(at[e]=ut(e-1)*e),at[e])}}function ft(t,r){var e=x(t),n=x(r);if(\"number\"==typeof e&&\"number\"==typeof n)return ut(e)/(ut(n)*ut(e-n))}var st=[\"\",\"C\",\"CC\",\"CCC\",\"CD\",\"D\",\"DC\",\"DCC\",\"DCCC\",\"CM\",\"\",\"X\",\"XX\",\"XXX\",\"XL\",\"L\",\"LX\",\"LXX\",\"LXXX\",\"XC\",\"\",\"I\",\"II\",\"III\",\"IV\",\"V\",\"VI\",\"VII\",\"VIII\",\"IX\"];function ht(t,r,e){void 0===e&&(e=\"i\");var n=x(t),o=x(r);if(\"number\"!=typeof n&&\"number\"!=typeof o)throw D;var i=\"\",a=\"\";return t&&(i=t.toString()),r&&1!==r?a=r+e:1===r&&(a=e),r>0?(i?i+\"+\":\"\")+a:i+a}function ct(t,r){return void 0===r&&(r=null),k(t,r,-512,511,2)}function pt(t,r){return void 0===r&&(r=null),k(t,r,-274877906944,274877906943,16)}function vt(t,r){return void 0===r&&(r=null),k(t,r,-536870912,536870911,8)}var gt=[-1.3026537197817094,.6419697923564902,.019476473204185836,-.00956151478680863,-.000946595344482036,.000366839497852761,42523324806907e-18,-20278578112534e-18,-1624290004647e-18,130365583558e-17];function lt(t){for(var r,e=t<0,n=0,o=0,i=2/(2+(t=Math.abs(t))),a=4*i-2,u=gt.length-1;u>0;u--)r=a*n-o+gt[u],o=n,n=r;var f=i*Math.exp(-t*t+.5*(gt[0]+a*n)-o);return e?f-1:1-f}function dt(t,r){var e=x(t),n=x(r);if(\"number\"==typeof e)return\"number\"==typeof n?lt(n)-lt(e):lt(e);throw T}var bt=[.9999999999998099,676.5203681218851,-1259.1392167224028,771.3234287776531,-176.6150291621406,12.507343278686905,-.13857109526572012,9984369578019572e-21,1.5056327351493116e-7];var Mt=Math.pow(2,39);function yt(t){if(\"string\"!=typeof t)throw T;if([\"i\",\"+i\",\"1i\",\"+1i\",\"-i\",\"-1i\",\"j\",\"+j\",\"1j\",\"+1j\",\"-j\",\"-1j\"].indexOf(t)>=0)return 0;var r=t.indexOf(\"+\"),e=t.indexOf(\"-\");0===r&&(r=t.indexOf(\"+\",1)),0===e&&(e=t.indexOf(\"-\",1));var n=t.substring(t.length-1,t.length),o=\"i\"===n||\"j\"===n;if(r>=0||e>=0){if(!o)throw D;if(r>=0){if(isNaN(+t.substring(0,r))||isNaN(+t.substring(r+1,t.length-1)))throw D;return Number(t.substring(0,r))}if(isNaN(+t.substring(0,e))||isNaN(+t.substring(e+1,t.length-1)))throw D;return Number(t.substring(0,e))}if(o){if(isNaN(+t.substring(0,t.length-1)))throw D;return 0}if(isNaN(+t))throw D;return+t}function mt(t){if(\"string\"!=typeof t)throw T;if([\"i\",\"j\"].indexOf(t)>=0)return 1;var r=(t=t.replace(\"+i\",\"+1i\").replace(\"-i\",\"-1i\").replace(\"+j\",\"+1j\").replace(\"-j\",\"-1j\")).indexOf(\"+\"),e=t.indexOf(\"-\");0===r&&(r=t.indexOf(\"+\",1)),0===e&&(e=t.indexOf(\"-\",1));var n=t.substring(t.length-1,t.length),o=\"i\"===n||\"j\"===n;if(r>=0||e>=0){if(!o)throw D;if(r>=0){if(isNaN(+t.substring(0,r))||isNaN(+t.substring(r+1,t.length-1)))throw D;return Number(t.substring(r+1,t.length-1))}if(isNaN(+t.substring(0,e))||isNaN(+t.substring(e+1,t.length-1)))throw D;return-Number(t.substring(e+1,t.length-1))}if(o){var i=+t.substring(0,t.length-1);if(isNaN(i))throw D;return i}if(isNaN(+t))throw D;return 0}function _t(t){var r=+yt(t),e=+mt(t);return ht(Math.cos(r)*Math.cosh(e),-Math.sin(r)*Math.sinh(e))}function wt(t){var r=+yt(t),e=+mt(t);return ht(Math.cos(e)*(Math.exp(r)+Math.exp(-r))/2,Math.sin(e)*(Math.exp(r)-Math.exp(-r))/2)}function Et(t,r){var e=+yt(t),n=+mt(t),o=+yt(r),i=+mt(r),a=Math.pow(o,2)+Math.pow(i,2);return ht((e*o+n*i)/a,(n*o-e*i)/a)}function It(t){var r=+yt(t),e=+mt(t);return ht(Math.sin(r)*Math.cosh(e),Math.cos(r)*Math.sinh(e))}function Ct(t){var r=+yt(t),e=+mt(t);return ht(Math.cos(e)*(Math.exp(r)-Math.exp(-r))/2,Math.sin(e)*(Math.exp(r)+Math.exp(-r))/2)}var Tt=Math.pow(2,29);function Dt(t,r,e){var n=x(r);if(\"number\"!=typeof n||r<0||r>1||e&&(0===r||1===r))throw T;var o=R(t).sort((function(t,r){return t-r}));e&&(o=function(){for(var t=0,r=0,e=arguments.length;r<e;r++)t+=arguments[r].length;var n=Array(t),o=0;for(r=0;r<e;r++)for(var i=arguments[r],a=0,u=i.length;a<u;a++,o++)n[o]=i[a];return n}([0],o));var i=(o.length+(e?0:-1))*n,a=Math.floor(i);if(void 0===o[a+1])return o[a];var u=o[a+1]-o[a];return o[a]+u*(i-a)}function Nt(t,r,e){var n=x(r);if(\"number\"!=typeof n)throw T;switch(n){case 0:if(e)throw T;return W.apply(void 0,t);case 1:return Dt(t,.25,e);case 2:return Dt(t,.5,e);case 3:return Dt(t,.75,e);case 4:if(e)throw T;return $.apply(void 0,t);default:throw D}}function At(t,r,e,n){var o=U(t),i=U(r),a=U(e);if(1==r)return 1/a;var u=Math.exp(-Math.pow(o/a,i));return n?1-u:i/Math.pow(a,i)*Math.pow(o,i-1)*u}function St(t,r,e,n){void 0===n&&(n=!1);var o=U(t),i=U(r),a=U(e),u=function(t,r,e){return ft(r,t)*Math.pow(e,t)*Math.pow(1-e,r-t)};if(!n)return u(o,i,a);for(var f=0,s=0;s<o+1;s++)f+=u(s,i,a);return f}function Ot(t,r,e){var n=t.filter((function(t){return\"number\"==typeof t})),o=r.filter((function(t){return\"number\"==typeof t}));if(n.length!==o.length)throw N;var i=n.length;if(0===i)throw C;for(var a=n.reduce((function(t,r){return t+r}),0)/i,u=o.reduce((function(t,r){return t+r}),0)/i,f=0,s=0;s<i;s++)f+=(n[s]-a)*(o[s]-u);return f/(e?i-1:i)}function xt(t,r){return Ot(t,r,!1)}var Rt={ABS:function(t){var r=x(t);if(\"number\"==typeof r)return Math.abs(r)},ACOS:function(t){var r=x(t);if(\"number\"==typeof r)return Math.acos(r)},ACOSH:function(t){var r=x(t);if(\"number\"==typeof r)return Math.acosh(r)},ACOT:function(t){var r=x(t);if(\"number\"==typeof r)return Math.atan(1/r)},ACOTH:function(t){var r=x(t);if(\"number\"==typeof r)return.5*Math.log((r+1)/(r-1))},ADD:function(t,r){var e=x(t),n=x(r);if(\"number\"==typeof e&&\"number\"==typeof n)return e+n},ARABIC:function(t){if(!x(t)&&/^M*(?:D?C{0,3}|C[MD])(?:L?X{0,3}|X[CL])(?:V?I{0,3}|I[XV])$/.test(\"\"+t)){var r=0;return(\"\"+t).replace(/[MDLV]|C[MD]?|X[CL]?|I[XV]?/g,(function(t){return r+=it[t],t})),+r}},ASIN:function(t){var r=x(t);if(\"number\"==typeof r)return Math.asin(r)},ASINH:function(t){var r=x(t);if(\"number\"==typeof r)return Math.asinh(r)},ATAN:function(t){var r=x(t);if(\"number\"==typeof r)return Math.atan(r)},ATAN2:function(t,r){var e=x(t),n=x(r);if(\"number\"==typeof e&&\"number\"==typeof n)return Math.atan2(n,e)},ATANH:function(t){var r=x(t);if(\"number\"==typeof r)return Math.log((1+r)/(1-r))/2},AVEDEV:function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];var e=R(t).filter((function(t){return\"number\"==typeof t})),n=e.length;if(0===n)throw C;var o=e.reduce((function(t,r){return t+r}),0)/n,i=e.reduce((function(t,r){return t+Math.abs(r-o)}),0);return i/n},AVERAGE:j,AVERAGEA:z,BASE:function(t,r,e){void 0===e&&(e=0);var n=x(t),o=x(r),i=x(e);if(\"number\"==typeof n&&\"number\"==typeof o&&\"number\"==typeof i){var a=n.toString(o);return new Array(Math.max(i+1-a.length,0)).join(\"0\")+a.toUpperCase()}},BINOMDIST:St,\"BINOM.INV\":function(t,r,e){for(var n=U(t),o=U(r),i=U(e),a=0;a<=n;a++){if(St(a,n,o,!0)>=i)return a}},\"BINOM.DIST.RANGE\":function(t,r,e,n){var o=U(t),i=U(r),a=U(e),u=x(n);\"number\"!=typeof u&&(u=a);for(var f=0,s=a;s<=u;s++){f+=ft(o,s)*Math.pow(i,s)*Math.pow(1-i,o-s)}return f},\"BINOM.DIST\":St,BITAND:function(t,r){var e=x(t),n=x(r);if(\"number\"==typeof e&&\"number\"==typeof n)return e&n;throw T},BITLSHIFT:function(t,r){var e=x(t),n=x(r);if(\"number\"==typeof e&&\"number\"==typeof n)return n>0?e<<n:e>>-n;throw T},BITOR:function(t,r){var e=x(t),n=x(r);if(\"number\"==typeof e&&\"number\"==typeof n)return e|n;throw T},BITRSHIFT:function(t,r){var e=x(t),n=x(r);if(\"number\"==typeof e&&\"number\"==typeof n)return n>0?e>>n:e<<-n;throw T},BITXOR:function(t,r){var e=x(t),n=x(r);if(\"number\"==typeof e&&\"number\"==typeof n)return e^n;throw T},CEILING:function(t,r,e){void 0===r&&(r=1),void 0===e&&(e=0);var n=x(t),o=x(r),i=x(e);if(\"number\"==typeof n&&\"number\"==typeof o&&\"number\"==typeof i)return 0===o?0:(o=Math.abs(o),n>=0?Math.ceil(n/o)*o:0===e?-1*Math.floor(Math.abs(n)/o)*o:-1*Math.ceil(Math.abs(n)/o)*o)},COMBIN:ft,COMBINA:function(t,r){var e=x(t),n=x(r);if(\"number\"==typeof e&&\"number\"==typeof n)return 0===e&&0===n?1:ft(e+n-1,e-1)},COMPLEX:ht,CORREL:function(t,r){if(t.length!==r.length)throw N;for(var e=t.filter((function(t){return\"number\"==typeof t})),n=r.filter((function(t){return\"number\"==typeof t})),o=e.length,i=e.reduce((function(t,r){return t+r}),0)/o,a=n.reduce((function(t,r){return t+r}),0)/o,u=0,f=0,s=0,h=0;h<o;h++)u+=(e[h]-i)*(n[h]-a),f+=Math.pow(e[h]-i,2),s+=Math.pow(n[h]-a,2);var c=Math.sqrt(f*s);if(!c)throw C;return u/c},COS:function(t){var r=x(t);if(\"number\"==typeof r)return Math.cos(r)},COSH:function(t){var r=x(t);if(\"number\"==typeof r)return Math.cosh(r)},COT:function(t){var r=x(t);if(\"number\"==typeof r)return 1/Math.tan(r)},COTH:function(t){var r=x(t);if(\"number\"==typeof r){var e=Math.exp(2*r);return(e+1)/(e-1)}},COUNT:G,COUNTA:q,COUNTBLANK:function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];for(var e=0,n=R(t),o=0;o<n.length;o++)0===n[o]||n[o]||e++;return e},COVAR:xt,\"COVARIANCE.P\":xt,\"COVARIANCE.S\":function(t,r){return Ot(t,r,!0)},CSC:function(t){var r=x(t);if(\"number\"==typeof r)return 1/Math.sin(r)},CSCH:function(t){var r=x(t);if(\"number\"==typeof r)return 2/(Math.exp(r)-Math.exp(-r))},DEC2BIN:ct,DEC2HEX:pt,DEC2OCT:vt,DECIMAL:function(t,r){var e=x(t),n=x(r);if(!(\"\"+e).match(\"/[2-9]/\")&&\"number\"==typeof e&&\"number\"==typeof n&&n>1&&n<37)return parseInt(\"\"+e,n)},DEGREES:function(t){var r=x(t);if(\"number\"==typeof r)return 180*r/Math.PI},DELTA:function(t,r){var e=x(t),n=x(r);if(\"number\"==typeof e||\"number\"==typeof e)return+(e===n);throw T},DEVSQ:function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];var e=R(t),n=[];e.forEach((function(t){\"number\"==typeof t&&n.push(t)}));var o=n.reduce((function(t,r){return t+r}),0)/n.length;return n.reduce((function(t,r){return t+Math.pow(r-o,2)}),0)},DIVIDE:function(t,r){var e=x(t),n=x(r);if(\"number\"==typeof e&&\"number\"==typeof n&&0!==n)return e/n},EQ:function(t,r){return typeof t==typeof r&&t==r},ERF:dt,ERFC:function(t,r){var e=x(t);if(\"number\"==typeof e)return 1-dt(e,r);throw T},EVEN:function(t){var r=x(t);if(\"number\"==typeof r){var e=Y(r);return e%2?e+Math.sign(r):e}},EXP:function(t){var r=x(t);if(\"number\"==typeof r)return Math.exp(r);throw T},FACT:ut,FACTDOUBLE:function t(r){var e=x(r);if(\"number\"==typeof e){var n=Math.floor(e);return n<=0?1:n*t(n-2)}},FISHER:function(t){var r=x(t);if(\"number\"==typeof r&&r>-1&&r<1)return.5*Math.log((1+r)/(1-r));throw T},FISHERINV:function(t){var r=x(t);if(\"number\"==typeof r){var e=Math.exp(2*r);return(e-1)/(e+1)}throw T},FLOOR:function(t,r){var e=x(t),n=x(r);if(\"number\"==typeof e&&\"number\"==typeof n){var o=Math.abs(n);return e>=0?Math.floor(e/o)*o:-1*Math.ceil(Math.abs(e)/o)*o}},GAMMA:function t(r){var e=x(r);if(\"number\"!=typeof e)throw T;if(!(Number.isInteger(e)&&e<=0)){if(e<.5)return Math.PI/(Math.sin(Math.PI*e)*t(1-e));e-=1;for(var n=bt[0],o=1;o<9;o++)n+=bt[o]/(e+o);var i=e+7+.5;return Math.sqrt(2*Math.PI)*Math.pow(i,e+.5)*Math.exp(-i)*n}throw D},GCD:function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];var e=R(t),n=e.length;if(!n)return 1;for(var o=e[0],i=1;\"number\"!=typeof o;){if(o=e[i],i>e.length)throw\"The arguments should contain at least one numeric value\";i++}for(var a=o<0?-o:o;i<n;i++){var u=x(e[i]);if(\"number\"==typeof u){for(var f=u<0?-u:u;a&&f;)a>f?a%=f:f%=a;a+=f}}return a},GEOMEAN:function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];var e=R(t);if(e.some((function(t){return!Number.isFinite(t)||t<=0})))throw D;return Math.pow(e.reduce((function(t,r){return r*t}),1),1/e.length)},GESTEP:function(t,r){void 0===r&&(r=0);var e=x(t),n=x(r);if(\"number\"==typeof e&&\"number\"==typeof n)return+(t>=r);throw T},GT:function(t,r){var e=x(t),n=x(r);if(\"number\"==typeof e&&\"number\"==typeof n)return e>n},GTE:function(t,r){var e=x(t),n=x(r);if(\"number\"==typeof e&&\"number\"==typeof n)return e>=n},HARMEAN:function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];var e=R(t);if(e.some((function(t){return!Number.isFinite(t)||t<=0})))throw D;var n=e.reduce((function(t,r){return t+1/r}),0);return 1/(1/e.length*n)},HEX2BIN:function(t,r){return ct(parseInt(t.toString(),16),r)},HEX2DEC:function(t,r){var e=parseInt(t.toString(),16);if(!Number.isFinite(e))throw T;var n=e>Mt;n&&(e=-(e-2*Mt));var o=r?x(r):null,i=e.toString();return(n?\"-\":\"\")+(o?i.padStart(o,\"0\"):i)},HEX2OCT:function(t,r){void 0===r&&(r=null);var e=parseInt(t.toString(),16);return e>Mt&&(e^=Mt),vt(e,r)},IMABS:function(t){var r=yt(t),e=mt(t);if(!Number.isFinite(+r)||!Number.isFinite(+e))throw T;return Math.sqrt(Math.pow(+r,2)+Math.pow(+e,2))},IMAGINARY:mt,IMCONJUGATE:function(t){return ht(+yt(t),-+mt(t))},IMCOS:_t,IMCOSH:wt,IMCOT:function(t){return Et(_t(t),It(t))},IMCSC:function(t){return Et(\"1\",It(t))},IMCSCH:function(t){return Et(\"1\",Ct(t))},IMDIV:Et,IMEXP:function(t){var r=+yt(t),e=+mt(t),n=Math.exp(r);return ht(n*Math.cos(e),n*Math.sin(r))},IMLN:function(t){var r=+yt(t),e=+mt(t);return ht(Math.log(Math.sqrt(r*r+e*e)),Math.atan(e/r))},IMPOWER:function(t,r){var e=x(r);if(\"number\"!=typeof e)throw T;var n=+yt(t),o=+mt(t),i=Math.sqrt(n*n+o*o),a=Math.pow(i,e),u=Math.atan(o/n);return ht(a*Math.cos(e*u),a*Math.sin(e*u))},IMPRODUCT:function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];if(0===t.length)throw T;for(var e=t[0],n=0,o=t.slice(1);n<o.length;n++){var i=o[n];e=V(e.toString(),i.toString())}return e.toString()},IMREAL:yt,IMSEC:function(t){return Et(\"1\",_t(t))},IMSECH:function(t){return Et(\"1\",wt(t))},IMSIN:It,IMSINH:Ct,IMSQRT:function(t){var r=+yt(t),e=+mt(t),n=Math.sqrt(Math.sqrt(r*r+e*e)),o=Math.atan(e/r)/2;return ht(n*Math.cos(o),n*Math.sin(o))},IMSUB:function(t,r){var e=+yt(t),n=+mt(t);return ht(e-+yt(r),n-+mt(r))},IMSUM:function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];if(0===t.length)throw T;for(var e=t[0],n=0,o=t.slice(1);n<o.length;n++){var i=o[n];e=X(e.toString(),i.toString())}return e.toString()},IMTAN:function(t){return Et(It(t),_t(t))},INT:function(t){var r=x(t);if(\"number\"==typeof r)return Math.floor(r)},LARGE:function(t,r){var e=x(r),n=t.sort((function(t,r){return t-r}));if(\"number\"==typeof e&&!t.some((function(t){return\"number\"!=typeof x(t)})))return n[n.length-e];throw T},LN:function(t){var r=x(t);if(\"number\"==typeof r)return Math.log(r)},LOG:function(t,r){void 0===r&&(r=10);var e=x(t),n=x(r);if(\"number\"==typeof e&&\"number\"==typeof n)return Math.log(e)/Math.log(n)},LOG10:function(t){var r=x(t);if(\"number\"==typeof r)return Math.log(r)/Math.log(10)},LT:function(t,r){var e=x(t),n=x(r);if(\"number\"==typeof e&&\"number\"==typeof n)return e<n},LTE:function(t,r){var e=x(t),n=x(r);if(\"number\"==typeof e&&\"number\"==typeof n)return e<=n},MAX:$,MEDIAN:function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];var e=R(t);e.sort((function(t,r){return t-r}));var n=Math.floor(e.length/2);return e.length%2?e[n]:(e[n-1]+e[n])/2},MIN:W,MINUS:function(t,r){var e=x(t),n=x(r);if(\"number\"==typeof e&&\"number\"==typeof n)return e-n},MOD:function(t,r){var e=x(t),n=x(r);if(\"number\"==typeof e&&\"number\"==typeof n&&0!==n){var o=Math.abs(e%n);return r>0?o:-o}},MROUND:function(t,r){var e=x(t),n=x(r);if(\"number\"==typeof e&&\"number\"==typeof n&&e*n>-1)return Math.round(e/n)*n},MULTINOMIAL:function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];for(var e=R(t),n=0,o=1,i=0;i<e.length;i++){var a=x(e[i]);\"number\"==typeof a&&(n+=a,o*=ut(e[i]))}return ut(n)/o},MULTIPLY:function(t,r){var e=x(t),n=x(r);if(\"number\"==typeof e&&\"number\"==typeof n)return e*n},NE:function(t,r){return typeof t!=typeof r||t!=r},OCT2BIN:function(t,r){void 0===r&&(r=null);var e=parseInt(t.toString(),8);return e&Tt&&(e=-(2*Tt-e)),ct(e,r)},OCT2DEC:function(t,r){void 0===r&&(r=null);var e=r?x(r):null,n=parseInt(t.toString(),8);if(n&Tt&&(n=-(2*Tt-n)),!Number.isFinite(n)||\"boolean\"==typeof e)throw T;return n.toString().padStart(e||0,\"0\")},OCT2HEX:function(t,r){void 0===r&&(r=null);var e=parseInt(t.toString(),8);return e&Tt&&(e=-(2*Tt-e)),pt(e,r)},ODD:function(t){var r=x(t);if(\"number\"==typeof r){var e=Y(r);return e%2?e:e+Math.sign(r)}},PERCENTILE:Dt,\"PERCENTILE.INC\":Dt,\"PERCENTILE.EXC\":function(t,r){return Dt(t,r,!0)},PERMUT:function(t,r){var e=x(t),n=x(r);if(\"number\"==typeof e&&\"number\"==typeof n)return ut(e)/ut(e-n);throw T},PI:function(){return Math.PI},POW:function(t,r){var e=x(t),n=x(r);if(\"number\"==typeof e&&\"number\"==typeof n)return ot(t,r)},POWER:ot,PRODUCT:K,QUARTILE:Nt,\"QUARTILE.INC\":Nt,\"QUARTILE.EXC\":function(t,r){return Nt(t,r,!0)},QUOTIENT:function(t,r){var e=x(t),n=x(r);if(\"number\"==typeof e&&\"number\"==typeof n)return H(e/n)},RADIANS:function(t){var r=x(t);if(\"number\"==typeof r)return r*Math.PI/180},RAND:function(){return Math.random()},RANDBETWEEN:function(t,r){var e=x(t),n=x(r);if(\"number\"==typeof e&&\"number\"==typeof n)return e+Math.ceil((n-e+1)*Math.random())-1},ROMAN:function(t){var r=x(t);if(\"number\"==typeof r){for(var e=String(r).split(\"\"),n=\"\",o=3;o--;)n=(st[+e.pop()+10*o]||\"\")+n;return new Array(+e.join(\"\")+1).join(\"M\")+n}},ROUND:function(t,r){var e=x(t),n=x(r)||0;if(\"number\"==typeof e&&\"number\"==typeof n)return parseFloat(e.toFixed(n))},ROUNDDOWN:function(t,r){var e=x(t),n=x(r)||0;if(\"number\"==typeof e&&\"number\"==typeof n)return Math.floor(e*Math.pow(10,n))/Math.pow(10,n)},ROUNDUP:function(t,r){var e=x(t),n=x(r)||0;if(\"number\"==typeof e&&\"number\"==typeof n)return Math.ceil(e*Math.pow(10,n))/Math.pow(10,n)},SEC:function(t){var r=x(t);if(\"number\"==typeof r)return 1/Math.cos(r)},SECH:function(t){var r=x(t);if(\"number\"==typeof r)return 2/(Math.exp(r)+Math.exp(-r))},SIGN:function(t){var r=x(t);if(\"number\"==typeof r)return 0===r?0:r/Math.abs(r);throw T},SIN:function(t){var r=x(t);if(\"number\"==typeof r)return Math.sin(r)},SINH:function(t){var r=x(t);if(\"number\"==typeof r)return Math.sinh(r)},SMALL:function(t,r){var e=x(r),n=t.sort((function(t,r){return t-r}));if(\"number\"==typeof e&&!t.some((function(t){return\"number\"!=typeof x(t)})))return n[e-1];throw T},SQRT:function(t){var r=x(t);if(\"number\"==typeof r&&r>=0)return Math.sqrt(r)},SQRTPI:function(t){var r=x(t);if(\"number\"==typeof r&&r>-1)return Math.sqrt(r*Math.PI)},STDEV:et,\"STDEV.S\":et,\"STDEV.P\":nt,STDEVA:function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];return Math.sqrt(Z.apply(void 0,t))},STDEVP:nt,STDEVPA:function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];return Math.sqrt(rt.apply(void 0,t))},STEYX:function(t,r){if(t.length!==r.length)throw N;var e=t.filter((function(t){return\"number\"==typeof t})),n=r.filter((function(t){return\"number\"==typeof t})),o=e.length;if(2===o)throw C;for(var i=e.reduce((function(t,r){return t+r}),0)/o,a=n.reduce((function(t,r){return t+r}),0)/o,u=0,f=0,s=0,h=0;h<o;h++)u+=(e[h]-i)*(n[h]-a),f+=Math.pow(e[h]-i,2),s+=Math.pow(n[h]-a,2);if(2===s)throw C;return Math.sqrt((f-Math.pow(u,2)/s)/(o-2))},SUBTOTAL:function(t){for(var r=[],e=1;e<arguments.length;e++)r[e-1]=arguments[e];var n=x(t),o=R(r);if(\"number\"==typeof n)switch(n){case 1:case 101:return j.apply(void 0,o);case 102:case 2:return G.apply(void 0,o);case 103:case 3:return q.apply(void 0,o);case 104:case 4:return $.apply(void 0,o);case 105:case 5:return W.apply(void 0,o);case 106:case 6:return K.apply(void 0,o);case 107:case 7:case 110:case 10:return;case 108:case 8:return nt.apply(void 0,o);case 109:case 9:return B.apply(void 0,o);case 111:case 11:return tt.apply(void 0,o)}},SUM:B,SUMPRODUCT:function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];var e=t[0].length;for(var n in t)if(t[n].length!==e)return;var o=0;for(n=0;n<t[0].length;n++){var i=!1,a=1;for(var u in t){var f=x(t[u][n]);\"number\"==typeof f&&(a*=f,i=!0)}i&&(o+=a)}return o},SUMSQ:function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];for(var e=0,n=R(t),o=0;o<n.length;o++){var i=x(n[o]);\"number\"==typeof i&&(e+=Math.pow(i,2))}return e},SUMX2MY2:function(t,r){if(!t.find((function(t){return\"number\"!=typeof x(t)}))&&!r.find((function(t){return\"number\"!=typeof x(t)}))){for(var e=0,n=0;n<t.length;n++)e+=t[n]*t[n]-r[n]*r[n];return e}},SUMX2PY2:function(t,r){if(!t.find((function(t){return\"number\"!=typeof x(t)}))&&!r.find((function(t){return\"number\"!=typeof x(t)}))){for(var e=0,n=0;n<t.length;n++)e+=t[n]*t[n]+r[n]*r[n];return e}},SUMXMY2:function(t,r){if(!t.find((function(t){return\"number\"!=typeof x(t)}))&&!r.find((function(t){return\"number\"!=typeof x(t)}))){for(var e=0,n=0;n<t.length;n++)e+=Math.pow(t[n]-r[n],2);return e}},TAN:function(t){var r=x(t);if(\"number\"==typeof r)return Math.tan(r)},TANH:function(t){var r=x(t);if(\"number\"==typeof r)return Math.tanh(r)},TRUNC:function(t){var r=x(t);if(\"number\"==typeof r)return H(r)},VAR:J,\"VAR.S\":J,\"VAR.P\":tt,VARA:Z,VARP:tt,VARPA:rt,WEIBULL:At,\"WEIBULL.DIST\":At};var Lt=/[\\0-\\x1F]/g;var Pt=Object.freeze({__proto__:null,CONCATENATE:function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];return R(t).join(\"\")},LEFT:function(t,r){return L(t)?\"\":t.toString().substring(0,r)},MID:function(t,r,e){return L(t)?\"\":t.toString().substring(r,r+e)},RIGHT:function(t,r){return L(t)?\"\":t.toString().substring(t.length-r)},LOWER:function(t){return L(t)?\"\":t.toString().toLowerCase()},UPPER:function(t){return L(t)?\"\":t.toString().toUpperCase()},PROPER:function(t){if(L(t))return\"\";var r=t.toString().toLowerCase().split(\" \");for(var e in t=\"\",r)t+=(t?\" \":\"\")+r[e].substring(0,1).toUpperCase()+r[e].substring(1);return t},TRIM:function(t){return L(t)?\"\":t.toString().trim()},LEN:function(t){return L(t)?0:t.toString().length},CHAR:function(t){var r=x(t);if(\"number\"==typeof r)return String.fromCharCode(r)},CLEAN:function(t){return void 0===t&&(t=\"\"),(\"\"+t).replace(Lt,\"\")},CODE:function(t){return void 0===t&&(t=\"\"),(\"\"+t).charCodeAt(0)},EXACT:function(t,r){return t===r},FIND:function(t,r,e){void 0===e&&(e=0);var n=x(e);if(\"number\"==typeof n&&r)return(\"\"+r).indexOf(\"\"+t,n-1)+1;throw\"index cannot be string\"},FIXED:function(t,r,e){void 0===r&&(r=2),void 0===e&&(e=!1);var n=x(t),o=x(r);if(\"number\"==typeof n&&\"number\"==typeof o){var i=n.toFixed(o);if(P(e))return\"\"+i;var a=(\"\"+i).split(\".\"),u=a[0],f=a[1];return u.replace(/\\B(?=(\\d{3})+(?!\\d))/g,\",\")+\".\"+f}},NUMBERVALUE:function(t,r,e){if(void 0===r&&(r=\".\"),void 0===e&&(e=\",\"),\"string\"==typeof t&&\"string\"==typeof r&&\"string\"==typeof e)return Number(t.replace(r,\".\").replace(e,\"\"))},REGEXEXTRACT:function(t,r){if(\"string\"==typeof t&&\"string\"==typeof r){var e=t.match(new RegExp(r));return e?e[e.length>1?e.length-1:0]:null}},REGEXMATCH:function(t,r){if(\"string\"==typeof t&&\"string\"==typeof r)return!!t.match(new RegExp(r))},REGEXREPLACE:function(t,r,e){if(\"string\"==typeof t&&\"string\"==typeof r)return t.replace(new RegExp(r),\"\"+e)},REPT:function(t,r){var e=x(r);if(\"number\"==typeof e)return new Array(e+1).join(\"\"+t)},SEARCH:function(t,r,e){void 0===e&&(e=0);var n=x(e);if(\"number\"==typeof n){var o=(\"\"+r).toLowerCase().indexOf((\"\"+t).toLowerCase(),n-1)+1;if(0!==o)return o;throw\"not found\"}},SUBSTITUTE:function(t,r,e,n){if(!t||!r||!e&&\"\"!==e)return\"\"+t;if(void 0===n)return(\"\"+t).replace(new RegExp(\"\"+r,\"g\"),\"\"+e);for(var o=0,i=0;(\"\"+t).indexOf(\"\"+r,o)>0;)if(o=(\"\"+t).indexOf(\"\"+r,o+1),++i===n)return(\"\"+t).substring(0,o)+e+(\"\"+t).substring(o+(\"\"+r).length)},T:function(t){return\"string\"==typeof t&&\"TRUE\"!==t&&\"FALSE\"!==t?\"\"+t:\"\"},JOIN:function(t){for(var r=[],e=1;e<arguments.length;e++)r[e-1]=arguments[e];var n=[];return r.forEach((function(r){\"object\"==typeof r?n.push(r.join(\"\"+t)):n.push(r)})),n.join(\"\"+t)},REPLACE:function(t,r,e,n){var o=x(r),i=x(e);if(\"number\"==typeof o&&\"number\"==typeof i){var a=t.toString(),u=n.toString();return a.replace(a.substr(o-1,i),u)}},ARRAYTOTEXT:function(t,r){return r?\"{\"+t.map((function(t){return\"string\"==typeof t?'\"'+t+'\"':t})).join(\"; \")+\"}\":t.join(\"; \")}});function Ft(t){return void 0===t?null:t}function Ut(t,r,e,n){void 0===e&&(e=0);var o=-1;if(0===e)o=r.indexOf(t);else{var i=\"string\"==typeof t?\"\":-1/0*e;1===e?r.forEach((function(r,e){r<=t&&r>i&&(i=r,o=e)})):-1===e&&r.forEach((function(r,e){r>=t&&r<i&&(i=r,o=e)}))}return o+1}var kt={LOOKUP:function(t,r,e){var n=Ut(t,r,1);if(0===n)throw\"#N/A\";return(e||r)[n-1]},HLOOKUP:function(t,r,e,n){var o=!0;void 0!==n&&(o=P(n));var i=r.$width?r.$width:r.length,a=Ut(t,r.slice(0,i),o?1:0);if(0===a)throw\"#N/A\";return Ft(r[i*((e||1)-1)+a-1])},VLOOKUP:function(t,r,e,n){var o=!0;void 0!==n&&(o=P(n));var i,a=r.$width?r.$width:1,u=r.length/a;if(1===u)i=r;else{i=[];for(var f=0;f<u;f++)i.push(r[a*f])}var s=e,h=Ut(t,i,o?1:0);if(0===h)throw\"#N/A\";return Ft(r[a*(h-1)+(s||1)-1])},XLOOKUP:function(t,r,e,n,o,i){var a=Ut(t,r,o);if(0===a){if(void 0!==n)return n;throw\"#N/A\"}return(e||r)[a-1]},INDEX:function(t,r,e){var n=r,o=e;return Ft(t[(t.$width?t.$width:1)*(n-1)+(o||1)-1])},MATCH:function(t,r,e){var n=e;void 0===e&&(n=1);var o=Ut(t,r,n);if(0===o)throw\"#N/A\";return o},XMATCH:function(t,r,e,n){var o=Ut(t,r,e);if(0===o)throw\"#N/A\";return o}},Vt=[[],[1,2,3,4,5,6,7],[7,1,2,3,4,5,6],[6,0,1,2,3,4,5],[],[],[],[],[],[],[],[7,1,2,3,4,5,6],[6,7,1,2,3,4,5],[5,6,7,1,2,3,4],[4,5,6,7,1,2,3],[3,4,5,6,7,1,2],[2,3,4,5,6,7,1],[1,2,3,4,5,6,7]],Xt=[void 0,0,1,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,1,2,3,4,5,6,0],Ht=[[],[6,0],[0,1],[1,2],[2,3],[3,4],[4,5],[5,6],void 0,void 0,void 0,[0,0],[1,1],[2,2],[3,3],[4,4],[5,5],[6,6]];function Yt(t,r){var e=F(t),n=F(r);if(e&&n)return Math.round((e.getTime()-n.getTime())/864e5)}function Bt(t){var r=F(t);if(r){r.setHours(0,0,0),r.setDate(r.getDate()+4-(r.getDay()||7));var e=new Date(r.getFullYear(),0,1);return Math.ceil(((r.getTime()-e.getTime())/864e5+1)/7)}}function jt(t,r,e,n){var o=F(t),i=F(r);if(o&&i){for(var a=void 0===e?Ht[1]:Ht[e],u=n||[],f=0;f<u.length;f++){if((l=S(u[f]))instanceof Error)throw\"The \"+u[f]+\" is not a  number\";u[f]=l}var s=(i.getTime()-o.getTime())/864e5+1,h=Math.round(s),c=o;for(f=0;f<s;f++){var p=(new Date).getTimezoneOffset()>0?c.getUTCDay():c.getDay(),v=!1;p!==a[0]&&p!==a[1]||(v=!0);for(var g=0;g<u.length;g++){var l;if((l=u[g]).getDate()===c.getDate()&&l.getMonth()===c.getMonth()&&l.getFullYear()===c.getFullYear()){v=!0;break}}v&&h--,c.setDate(c.getDate()+1)}return h}}function zt(t,r,e,n){var o=F(t),i=x(r);if(o&&\"number\"==typeof i){for(var a=void 0===e?Ht[1]:Ht[e],u=n||[],f=0;f<u.length;f++){if((p=S(u[f]))instanceof Error)throw\"The \"+u[f]+\" is not a  number\";u[f]=p}for(var s=0;s<i;){o.setDate(o.getDate()+1);var h=o.getDay();if(h!==a[0]&&h!==a[1]){for(var c=0;c<u.length;c++){var p;if((p=u[c]).getDate()===o.getDate()&&p.getMonth()===o.getMonth()&&p.getFullYear()===o.getFullYear()){s--;break}}s++}}return O(o)}}function Gt(t){return 1===new Date(t,1,29).getMonth()}function qt(t,r,e){void 0===e&&(e=0);var n=F(t),o=F(r);if(n&&o){var i=n.getDate(),a=n.getMonth()+1,u=n.getFullYear(),f=o.getDate(),s=o.getMonth()+1,h=o.getFullYear(),c=365,p=h-u+1,v=(new Date(h+1,0,1).getTime()-new Date(u,0,1).getTime())/1e3/60/60/24/p;switch(e){case 0:return 31===i&&31===f?(i=30,f=30):31===i?i=30:30===i&&31===f&&(f=30),(f+30*s+360*h-(i+30*a+360*u))/360;case 1:return u===h||u+1===h&&(a>s||a===s&&i>=f)?((u===h&&Gt(u)||function(t,r){var e=t.getFullYear(),n=new Date(e,2,1);if(Gt(e)&&t<n&&r>=n)return!0;var o=r.getFullYear(),i=new Date(o,2,1);return Gt(o)&&r>=i&&t<i}(n,o)||1===s&&29===f)&&(c=366),Yt(o.toDateString(),n.toDateString())/c):Yt(o.toDateString(),n.toDateString())/v;case 2:return Yt(o.toDateString(),n.toDateString())/360;case 3:return Yt(o.toDateString(),n.toDateString())/365;case 4:return(f+30*s+360*h-(i+30*a+360*u))/360}}}var $t={DATE:function(t,r,e){return O(new Date(t,r-1,e))},TIME:function(t,r,e){var n=O(new Date(1900,0,1,t,r,e,0));return n-Math.trunc(n)},DAY:function(t){return S(t).getDate()},MONTH:function(t){return S(t).getMonth()+1},YEAR:function(t){return S(t).getFullYear()},HOUR:function(t){return S(t).getHours()},MINUTE:function(t){return S(t).getMinutes()},SECOND:function(t){return S(t).getSeconds()},NOW:function(){return O(new Date)},DATEDIF:function(t,r,e){var n=e.toLowerCase();if(\"d\"===n)return r-t;var o=S(t),i=S(r);switch(n){case\"y\":return i.getFullYear()-o.getFullYear();case\"m\":return(u=12*(i.getFullYear()-o.getFullYear()))+i.getMonth()-o.getMonth();case\"d\":return Math.floor(r-t);case\"md\":if((f=i.getDate()-o.getDate())<0){var a=new Date(o.getFullYear(),o.getMonth()+1,0).getDate();return i.getDate()+a-o.getDate()}return f;case\"ym\":var u;return(u=i.getMonth()-o.getMonth())<0?12+u:u;case\"yd\":var f;return(f=A(i)-A(o))<0?365+f:f}},DATEVALUE:function(t){if(\"string\"==typeof t)return O(new Date(new Date(t).toDateString()))},DAYS:Yt,DAYS360:function(t,r,e){void 0===e&&(e=0);var n=F(t),o=F(r);if(n&&o){var i=n.getMonth(),a=o.getMonth(),u=void 0,f=void 0;if(P(e))u=31===n.getDate()?30:n.getDate(),f=31===o.getDate()?30:o.getDate();else{var s=new Date(n.getFullYear(),i+1,0).getDate(),h=new Date(o.getFullYear(),a+1,0).getDate();u=n.getDate()===s?30:n.getDate(),o.getDate()===h?u<30?(a++,f=1):f=30:f=o.getDate()}return 360*(o.getFullYear()-n.getFullYear())+30*(a-i)+(f-u)}},EDATE:function(t,r){var e=F(t),n=x(r);if(e&&\"number\"==typeof n)return e.setMonth(e.getMonth()+n),O(e)},EOMONTH:function(t,r){var e=F(t),n=x(r);if(e&&\"number\"==typeof n)return O(new Date(e.getFullYear(),e.getMonth()+n+1,0))},ISOWEEKNUM:Bt,NETWORKDAYS:function(t,r,e){return jt(t,r,1,e)},\"NETWORKDAYS.INTL\":jt,TIMEVALUE:function(t){if(\"string\"==typeof t){var r=t.split(\" \"),e=r[1],n=r[0].split(\":\"),o=new Date;return o.setHours(+n[0]),e&&\"PM\"===e.toUpperCase()&&o.setHours(o.getHours()+12),o.setMinutes(+n[1]),n[2]&&o.setSeconds(+n[2]),(3600*o.getHours()+60*o.getMinutes()+o.getSeconds())/86400}},WEEKNUM:function(t,r){void 0===r&&(r=1);var e=F(t);if(21===r)return Bt(r);var n=Xt[r],o=new Date(e.getFullYear(),0,1),i=o.getDay()<n?1:0,a=o.getTime()-24*Math.abs(o.getDay()-n)*60*60*1e3;return Math.floor((e.getTime()-a)/864e5/7+1)+i},WEEKDAY:function(t,r){void 0===r&&(r=1);var e=F(t).getDay();return Vt[r][e]},WORKDAY:function(t,r,e){return zt(t,r,1,e)},\"WORKDAY.INTL\":zt,YEARFRAC:qt};var Wt=Object.freeze({__proto__:null,IF:function(t,r,e){return t?r:e},AND:function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];for(var e=0;e<t.length;e++)if(!P(t[e]))return!1;return!0},NOT:function(t){return!P(t)},OR:function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];for(var e=0;e<t.length;e++)if(t[e])return!0;return!1},CHOOSE:function(t){for(var r=[],e=1;e<arguments.length;e++)r[e-1]=arguments[e];var n=x(t);if(r.length>1&&\"number\"==typeof n){if(r.length<n)throw\"the index number is greater than the length of the array of values\";if(n<=0)throw\"index cannot be less than or equal to 0\";return r[--n]}},FALSE:function(){return!1},TRUE:function(){return!0}});var Kt=Object.freeze({__proto__:null,ISBLANK:function(t){return L(t)},ISBINARY:function(t){return/^[01]{1,10}$/.test(\"\"+t)},ISEVEN:function(t){var r=x(t);return\"number\"==typeof r&&r%2==0},ISODD:function(t){var r=x(t);return\"number\"==typeof r&&r%2!=0},ISNONTEXT:function(t){return\"string\"!=typeof t},ISNUMBER:function(t){return\"number\"==typeof x(t)},ISTEXT:function(t){return\"string\"==typeof t},N:function(t){var r=x(t);if(\"number\"==typeof r)return r;var e=new Date(t);return e.getTime()?O(e):\"TRUE\"===t||!0===t?1:0}});function Qt(t,r,e,n,o){void 0===n&&(n=0),void 0===o&&(o=0);var i,a=U(t),u=U(r),f=U(e),s=U(n);if(0===a)i=(f+s)/u;else{var h=Math.pow(1+a,u);i=a*(f*h+s)/(h-1),1===o&&(i/=1+a)}return-i}function Jt(t,r,e,n,o){void 0===n&&(n=0),void 0===o&&(o=0);var i,a=U(t),u=U(r),f=U(e),s=U(n);if(0!==a){var h=Math.pow(1+a,u);return i=s*h+f*(h-1)/a,1===o&&(i=s*h+f*(1+a)*(h-1)/a),-i}i=s+f*u}function Zt(t,r,e,n,o,i){void 0===o&&(o=0),void 0===i&&(i=0);var a=U(t),u=U(e),f=U(r),s=U(n),h=Qt(a,u,s,U(o),i);return(1===f?1===i?0:-s:1===i?Jt(a,f-2,h,s,1)-h:Jt(a,f-1,h,s,0))*a}var tr=Object.freeze({__proto__:null,ACCRINT:function(t,r,e,n,o,i,a){void 0===o&&(o=0),void 0===a&&(a=0);var u=F(t),f=F(e),s=U(n),h=U(o),c=U(i),p=U(a);if(1!==c)throw\"This function is only supported with frequency 1\";if(-1===[0,1,2,3,4].indexOf(p))throw\"Basis is \"+a+\". It's should be 0, 1, 2, 3 or 4\";if(f<=u)throw\"Settlement canot be before or equal to issue\";return h*s*qt(t,e,p)},PMT:Qt,FV:Jt,DB:function(t,r,e,n,o){void 0===o&&(o=12);var i=U(t),a=U(r),u=U(e),f=U(n),s=U(o);if(i<0||a<0||u<0||f<0)throw\"Parameters cannot be negative\";if(-1===[1,2,3,4,5,6,7,8,9,10,11,12].indexOf(s))throw\"Month is \"+o+\". It's should be beetwen 1 and 12\";if(f>u)throw\"Period cannot be greater than life\";if(a>=i)return 0;for(var h=+(1-Math.pow(a/i,1/u)).toFixed(3),c=i*h*s/12,p=c,v=0,g=n===u?u-1:n,l=2;l<=g;l++)p+=v=(i-p)*h;return 1===n?c:n===u?(i-p)*h:v},DDB:function(t,r,e,n,o){void 0===o&&(o=2);var i=U(t),a=U(r),u=U(e),f=U(n),s=U(o);if(i<0||a<0||u<0||f<0||s<0)throw\"Parameters cannot be negative\";if(f>u)throw\"Period cannot be greater than life\";if(a>=i)return 0;for(var h=0,c=0,p=1;p<=n;p++)h+=c=Math.min(s/u*(i-h),i-a-h);return c},DOLLAR:function(t,r){void 0===r&&(r=2);var e=x(t),n=x(r);if(\"number\"==typeof e&&\"number\"==typeof n){if(n>=0)return\"$\"+e.toFixed(n);var o=Math.pow(10,-n);return\"$\"+Math.trunc(e/o)*o}},DOLLARDE:function(t,r){var e=U(t),n=U(r);if(n<0)throw\"Fraction cannot be negative\";if(n>=0&&n<1)throw\"Fraction cannot be zero\";n=parseInt(\"\"+n,10);var o=parseInt(\"\"+t,10);o+=e%1*Math.pow(10,Math.ceil(Math.log(n)/Math.LN10))/n;var i=Math.pow(10,Math.ceil(Math.log(n)/Math.LN2)+1);return o=Math.round(o*i)/i},DOLLARFR:function(t,r){var e=U(t),n=U(r);if(n<0)throw\"Fraction cannot be negative\";if(n>=0&&n<1)throw\"Fraction cannot be zero\";n=parseInt(\"\"+n,10);var o=parseInt(\"\"+t,10);return o+=e%1*Math.pow(10,-Math.ceil(Math.log(n)/Math.LN10))*n},EFFECT:function(t,r){var e=U(t),n=U(r);if(e<=0)throw\"Rate cannot be less than or equal to zero\";if(n<1)throw\"Periods cannot be less than 1\";return n=parseInt(\"\"+n,10),Math.pow(1+e/n,n)-1},FVSCHEDULE:function(t,r){for(var e=U(t),n=r.map((function(t){return U(t)})),o=n.length,i=e,a=0;a<o;a++)i*=1+n[a];return i},IRR:function(t,r){void 0===r&&(r=0);for(var e=R(t).map((function(t){return U(t)})),n=U(r),o=function(t,r,e){for(var n=e+1,o=t[0],i=1;i<t.length;i++)o+=t[i]/Math.pow(n,(r[i]-r[0])/365);return o},i=function(t,r,e){for(var n=e+1,o=0,i=1;i<t.length;i++){var a=(r[i]-r[0])/365;o-=a*t[i]/Math.pow(n,a+1)}return o},a=[],u=!1,f=!1,s=0;s<e.length;s++)a[s]=0===s?0:a[s-1]+365,e[s]>0&&(u=!0),e[s]<0&&(f=!0);if(!u||!f)throw\"Values should contain at least one positive value and one negative value\";var h,c,p,v=n=void 0===r?.1:n,g=!0;do{h=v-(p=o(e,a,v))/i(e,a,v),c=Math.abs(h-v),v=h,g=c>1e-10&&Math.abs(p)>1e-10}while(g);return v},IPMT:Zt,ISPMT:function(t,r,e,n){var o=U(t),i=U(r),a=U(e);return U(n)*o*(i/a-1)},NPV:function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];for(var e=R(t).map((function(t){return U(t)})),n=U(e[0]),o=0,i=1;i<e.length;i++)o+=e[i]/Math.pow(1+n,i);return o},NOMINAL:function(t,r){var e=U(t),n=U(r);if(e<=0)throw\"Rate cannot be less then or equal to zero\";if(n<1)throw\"Periods cannot be less then 1\";return n=parseInt(\"\"+n,10),(Math.pow(e+1,1/n)-1)*n},NPER:function(t,r,e,n,o){void 0===n&&(n=0),void 0===o&&(o=0);var i=U(t),a=U(r),u=U(e),f=U(n),s=U(o),h=a*(1+i*s)-f*i,c=u*i+a*(1+i*s);return Math.log(h/c)/Math.log(1+i)},PDURATION:function(t,r,e){var n=U(t),o=U(r),i=U(e);if(n<=0)throw\"Rate cannot be less then or equal to zero\";return(Math.log(i)-Math.log(o))/Math.log(1+n)},PPMT:function(t,r,e,n,o,i){void 0===o&&(o=0),void 0===i&&(i=0);var a=U(t),u=U(r),f=U(e),s=U(n),h=U(o),c=U(i);return Qt(a,f,s,h,c)-Zt(a,u,f,s,h,c)},PV:function(t,r,e,n,o){void 0===n&&(n=0),void 0===o&&(o=0);var i=U(t),a=U(r),u=U(e),f=U(n),s=U(o);return 0===i?-u*a-f:((1-Math.pow(1+i,a))/i*u*(1+i*s)-f)/Math.pow(1+i,a)},SYD:function(t,r,e,n){var o=U(t),i=U(r),a=U(e);return(o-i)*(a-U(n)+1)*2/(a*(a+1))},TBILLPRICE:function(t,r,e){var n=F(t),o=F(r),i=U(e);if(\"number\"==typeof i&&o>n)return 100*(1-i*Math.round((o.getTime()-n.getTime())/864e5)/360)},TBILLYIELD:function(t,r,e){var n=F(t),o=F(r),i=U(e);if(\"number\"==typeof i&&o>n)return(100-i)/i*360/Math.round((o.getTime()-n.getTime())/864e5)}}),rr={number:Rt,string:Pt,date:$t,other:Wt,information:Kt,financial:tr,lookup:kt},er=e(e(e(e(e(e(e({},Rt),Pt),$t),Wt),Kt),tr),kt);var nr=Math.pow(10,8);function or(t,r,e){e.add?t.has(r)||e.add(r):t.add(r)}function ir(t){if(t.keys)return Array.from(t.keys());var r=[];return t.forEach((function(t,e){return r.push(e)})),r}function ar(t){if(t.values)return t.values();var r=[];t.forEach((function(t,e){return r.push(e)}));var e=0;return{add:function(t){r.push(t)},next:function(){var t=r[e];return{done:++e>r.length,value:t}}}}var ur=function(){function t(t){var r=this;(t=t||{get:null,set:null,strict:!1})&&(this._getter=t.get,this._setter=t.set,this._strict=t.strict),this._parser=_,this._printer=I,this._parseContext={name:function(){},pageName:function(){return\"\"},pageObj:function(){return null},page:function(){return 0},z:0},this.$count=0,this._data=new Map,this._triggers=new Map,this._holders={},this._context={v:function(t){if(-1===t)throw new Error;var e=r._getter(t);return void 0===e?null:e},r:function(t,e){var n=o(t),i=n[0],a=n[1],u=o(e),f=u[0]-i,s=u[1]-a+1,h=[];h.$width=s;for(var c=0;c<=f;c++)for(var p=0;p<s;p++)h[c*s+p]=r._getter(t+64*p+4096*c*64);return h},m:er,e:function(t){throw t},p:function(t){return r.getPlaceholder(t)}}}return t.prototype.setValue=function(t,r,e,n){\"\"===r&&(r=null),this._removeTriggers(t,null),this._setter(t,r,e)&&(n||this.trigger(t))},t.prototype.clean=function(t){this._removeTriggers(t,null)},t.prototype.getValue=function(t){return this._getter(t)},t.prototype.setPlaceholder=function(t,r){var e=this;\"*\"===t?Object.entries(r).forEach((function(t){return e.setPlaceholder(t[0],t[1])})):(null===r?delete this._holders[t]:this._holders[t]=r,this.each((function(r,n){(function(t,r,e){for(var n=0;n<t.length;n+=3)if(2===t[n]&&r.substr(t[n+1],t[n+2])==e)return!0;return!1})(n.code,n.source,t)&&e.setMath(r,n.source,e._parseContext)})))},t.prototype.getPlaceholder=function(t){if(\"*\"===t)return this._holders;var r=this._holders[t];return void 0===r?null:r},t.prototype.setMath=function(t,r,e,n){var o=this._generate(r,e),i=this._setMathAt(t,o);n||this._execAndTrigger(i)},t.prototype.refresh=function(t){this._execAndTrigger(t)},t.prototype.getMath=function(t){return this._data.get(t)},t.prototype.trigger=function(t,r){var e=this._triggers.get(t);if(e){var n=!r;r||(r=new Set);for(var o=0;o<e.length;o++)r.add(e[o]);n&&this.triggerSet(r)}return null},t.prototype.triggerSet=function(t){for(var r=this,e=new Map;t.size;){var n=ar(t),o=!1;t:for(var i=n.next();!i.done;i=n.next()){var a=this._data.get(i.value),u=e.get(i.value);if(!u||(1==u&&(u=this._check_for_loops(i.value,a.triggers,e)),2!=u)){var f=a.triggers;if(f)for(var s=0;s<f.length;s++)if(t.has(f[s]))continue t;this._execAndTrigger(i.value,t),u||e.set(i.value,1),t.delete(i.value),o=!0}}if(!o)return void t.forEach((function(e){return r._errorAndTrigger(e,t)}))}},t.prototype.getStats=function(){return{math:this._data.size,trigger:this._triggers.size}},t.prototype._check_for_loops=function(t,r,e){var n=new Set;r.forEach((function(t){return n.add(t)}));for(var o=ar(n),i=o.next();!i.done;i=o.next()){if(i.value==t)return e.set(t,2),2;var a=e.get(i.value);if(a&&a>1)return e.set(t,a),a;var u=this._data.get(i.value);u&&u.triggers&&u.triggers.forEach((function(t){return or(n,t,o)}))}return e.set(t,3),3},t.prototype._setMathAt=function(t,r){if(this._removeTriggers(t,r)){if(r.triggers)if(-1===r.triggers.indexOf(t)&&3!==r.broken)for(var n=0;n<r.triggers.length;n++){var o=r.triggers[n],i=this._triggers.get(o);void 0===i&&(i=[],this._triggers.set(o,i)),i.push(t)}else r=e(e({},r),{broken:3});return this._data.set(t,r),t}},t.prototype._removeTriggers=function(t,r){var e=this._data.get(t);if(!e)return!0;if(e===r)return!1;var n=e.triggers;if(n&&3!==e.broken)for(var o=0;o<n.length;o++){var i=n[o],a=this._triggers.get(i);if(a){var u=a.filter((function(r){return r!==t}));u.length?this._triggers.set(i,u):this._triggers.delete(i)}}return this._data.delete(t),!0},t.prototype.parse=function(t,r){return this._parser(t,r||this._parseContext)},t.prototype.exec=function(t,r){var e=this._generate(t,r);return this._exec(e)},t.prototype.each=function(t){var r=this;ir(this._data).forEach((function(e){return t(e,r._data.get(e))}))},t.prototype.setLogger=function(t){this._err_handler=t},t.prototype._setErr=function(t,e){return t.broken=2,e&&this._err_handler&&this._err_handler(e),r[t.broken]},t.prototype._exec=function(t){if(t.broken>0&&2!==t.broken)return r[t.broken];try{var e=t.exec(this._context);return t.broken=0,\"number\"==typeof e?isFinite(e)?Math.round(e*nr)/nr:this._setErr(t):e}catch(r){return this._setErr(t,r)}},t.prototype.toString=function(t,r){return s(t,r||this._parseContext)},t.prototype.regenerate=function(t,r,n){var o=this;n=e({},n||this._parseContext),ir(this._data).forEach((function(e){var i=!1,a=o._data.get(e),f=u(e);if(r&&f===t)o._removeTriggers(e,null);else{for(var h=0;h<a.code.length;h+=3)if(9===a.code[h]&&u(a.code[h+1])===t){i=!0;break}i&&(n.z=f,r?o.setMath(e,a.source,n):(a.source=s(a,n),a.code=o._parser(a.source,n).code))}}))},t.prototype.recalculate=function(t,r){var n=this;r=e({},r||this._parseContext);var o=new Set;this.each((function(e){if(t){var i=n._data.get(e);if(i.broken&&2!==i.broken)return r.z=u(e),void n.setMath(e,i.source,r)}o.add(e)})),this.triggerSet(o)},t.prototype._generate=function(t,r,e){var n=e||this._parser(t,r||this._parseContext);return this._printer(n,this._strict),n.triggers=function(t){for(var r=[],e=t.code,n=e.length,o=0;o<n;o+=3){switch(e[o]){case 7:case 6:var i=e[o+4];r.push(i);break;case 8:f(e[o+4],e[o+7],(function(t){return r.push(t)}))}}if(r.length>10){var a=new Set;r=r.filter((function(t){return!a.has(t)&&(a.add(t),!0)}))}return r.length?r:null}(n),n},t.prototype._execAndTrigger=function(t,r){this.$count+=1;var e=this._data.get(t);if(e){var n=this._exec(e);this._setter(t,n,2)&&this.trigger(t,r)}},t.prototype._errorAndTrigger=function(t,r){var e=this._data.get(t),n=this._setErr(e);this._setter(t,n,2)&&this.trigger(t,r)},t.prototype.debug=function(t){console.log(function(t){for(var r=t.code,e=t.source,n=\"\",o=r.length,i=0;i<o;i+=3){var a=r[i],u=void 0;switch(a){case 4:u=\"method\";break;case 1:u=\"text\";break;case 5:u=\"page\";break;case 2:u=\"holder\";break;case 6:u=\"name\";break;case 7:u=\"arg\";break;case 8:u=\"range\";break;case 9:u=\"data\";break;case 10:u=\"op\";break;case 11:u=\"number\";break;case 3:u=\"error\";break;case 12:u=\"extra\"}n+=9===a?\"              \"+r[i+1]+\" x \"+r[i+2]+\")\\n\":\"[\"+u+\"]\"+w(u)+e.substr(r[i+1],r[i+2])+\"\\n\"}return n}(this.parse(t)))},t.prototype.transpose=function(t,r,i,a){var u=this;a=a||this._parseContext;var f=o(t),s=f[0],h=f[1],c=f[2],p=new Map,v=new Map,g=new Set;ir(this._data).forEach((function(t){var f=o(t),l=f[0],d=f[1],b=f[2],M=u._data.get(t),y=b===a.z?a:e(e({},a),{z:b}),m=u._transpose(M,s,h,r,i,a,y),_=t;if(b===c&&(d>=h||l>=s)&&(_=n(l>=s?l+r:l,d>=h?d+i:d,b)),M!==m||t!==_){if(v.set(t,m),b===c&&(i<0&&d>=h&&d<h-i||r<0&&l>=s&&l<s-r))return;p.set(_,m),M.broken!==m.broken&&g.add(_)}})),ir(p).forEach((function(t){return u._setMathAt(t,p.get(t))})),Array.from(v.keys()).forEach((function(t){p.has(t)||u._removeTriggers(t,null)})),r>0&&this._triggerRow(s,r,g),i>0&&this._triggerColumn(h,i,g),r<0&&this._triggerColumn(s-1,2,g),i<0&&this._triggerColumn(h-1,2,g),this.triggerSet(g)},t.prototype._triggerColumn=function(t,r,e){var n=this,o=r?t+r:t;ir(this._triggers).forEach((function(r){var i=a(r);i>=t&&i<o&&n.trigger(r,e)}))},t.prototype._triggerRow=function(t,r,e){var n=this,o=r?t+r:t;ir(this._triggers).forEach((function(r){var a=i(r);a>=t&&a<o&&n.trigger(r,e)}))},t.prototype.transposeMath=function(t,r,e,n){return\"string\"==typeof t&&(t=this.parse(t,n)),n=n||this._parseContext,this._transpose(t,-1,-1,r,e,n,n).source},t.prototype._transpose=function(t,r,e,i,a,u,f){for(var h=!0,c=t.code,p=!(r<0||e<0),v=0;v<c.length;v+=3)if(7===c[v]){var g=o(c[v+4]),l=g[0],d=g[1],b=g[2];if(u.z!==b)continue;var M=c[v+5];if(!p&&3==M)continue;(p||0==(1&M))&&0!==i&&l>=r&&(h&&(c=[].concat(c),h=!1),((l+=i)<r||l<0)&&(c[v]=3)),(p||0==(2&M))&&0!==a&&d>=e&&(h&&(c=[].concat(c),h=!1),((d+=a)<e||d<0)&&(c[v]=3)),h||(c[v+4]=n(l,d,b)),v+=3}else if(8===c[v]){var y=c[v+5],m=c[v+8];if(!p&&3===y&&3===m)continue;var _=o(c[v+4]),w=_[0],E=_[1],I=(b=_[2],o(c[v+7])),C=I[0],T=I[1];if(u.z!==b)continue;0!==i&&((p||0==(1&y))&&(i>0?w>=r:w>r)&&(h&&(c=[].concat(c),h=!1),(w+=i)<0&&(c[v]=3)),(p||0==(1&m))&&C>=r&&(h&&(c=[].concat(c),h=!1),(C+=i)<w&&(c[v]=3))),0!==a&&((p||0==(2&y))&&(a>0?E>=e:E>e)&&(h&&(c=[].concat(c),h=!1),(E+=a)<0&&(c[v]=3)),(p||0==(2&m))&&T>=e&&(h&&(c=[].concat(c),h=!1),(T+=a)<E&&(c[v]=3))),h||(c[v+4]=n(w,E,b),c[v+7]=n(C,T,b)),v+=6}if(h)return t;var D={code:c,broken:t.broken,source:t.source,triggers:null,exec:null};return D=this._parser(s(D,f),f),this._generate(D.source,f,D)},t}();var fr=function(){function t(t,r,n){this._data=[],this._id=t,this._store=r,this._meta={},this._parseContext=e(e({},n),{z:t})}return t.prototype.getMeta=function(){return this._meta},t.prototype.setMeta=function(t){this._meta=e(e({},this._meta),t)},t.prototype.getID=function(){return this._id},t.prototype.cellID=function(t,r){return n(t,r,this._id)},t.prototype.getSize=function(){var t=this._data.length,r=0;return this._data.forEach((function(t){t&&t.length>r&&(r=t.length)})),[t,r]},t.prototype.getContext=function(){return this._parseContext},t.prototype.addRow=function(t,r){this._data.splice.apply(this._data,sr(t,r)),this._store.transpose(n(t,0,this._id),r,0,this._parseContext)},t.prototype.removeRow=function(t,r){this._data.splice(t,r),this._store.transpose(n(t,0,this._id),-r,0,this._parseContext)},t.prototype.addColumn=function(t,r){var e=sr(t,r);this._data.forEach((function(t){t&&t.splice.apply(t,e)})),this._store.transpose(n(0,t,this._id),0,r,this._parseContext)},t.prototype.removeColumn=function(t,r){this._data.forEach((function(e){e&&e.splice(t,r)})),this._store.transpose(n(0,t,this._id),0,-r,this._parseContext)},t.prototype.setCell=function(t,r,n){var o=this._data[t];o||(o=this._data[t]=[]);var i=o[r];o[r]=i?e(e(e({},i),n),{value:i.value}):n,void 0!==n.value&&this.setValue(t,r,n.value)},t.prototype.setValue=function(t,r,e,o){\"string\"==typeof e&&e.length>1&&\"=\"===e[0]?this._store.setMath(n(t,r,this._id),e.substr(1),this._parseContext):this._store.setValue(n(t,r,this._id),e,o)},t.prototype.getCell=function(t,r,e){var n=this._data[t],o=n?n[r]:null;return o||!e||(n||(n=this._data[t]=[]),(o=n[r])||(o=n[r]={value:\"\"})),o},t.prototype.getValue=function(t,r,e){if(e){var o=this._store.getMath(n(t,r,this._id));if(o)return\"=\"+o.source}var i=this.getCell(t,r,!1);return i?i.value:null},t.prototype.getRange=function(t,r,e,n){for(var o=[],i=t;i<=e;i++)for(var a=r;a<=n;a++)o.push(this.getValue(i,a,!1));return o},t.prototype.getCellRange=function(t,r,e,n){for(var o=[],i=t;i<=e;i++)for(var a=r;a<=n;a++)o.push(this.getCell(i,a));return o},t.prototype.eachCell=function(t){this._data.forEach((function(r,e){r&&r.forEach((function(r,n){r&&t(e,n,r)}))}))},t.prototype.serialize=function(t){var r=this,o=[];return this.eachCell((function(i,a,u){if(u=e({},u),t){var f=r._store.getMath(n(i,a,r.getID()));f&&(u.value=\"=\"+f.source)}o.push([i,a,u])})),o},t.prototype.parse=function(t,r){var o=this;this._store.each((function(t){u(t)===o._id&&o._store.clean(t)})),this._data=[];var i=new Set;t.forEach((function(t){var a=t[0],u=t[1],f=t[2],s=o._data[a];s||(s=o._data[a]=[]);var h=(f=s[u]=e({},f)).value;if(h)if(\"string\"==typeof h&&h.length>1&&\"=\"===h[0]){var c=n(a,u,o._id),p=h.substr(1);o._store.setMath(c,p,o.getContext(),!0),i.add(c)}else if(r){f.value=null;c=n(a,u,o._id);o._store.setValue(c,h,null,!0),o._store.trigger(c,i)}})),this._store.triggerSet(i)},t}();function sr(t,r){for(var e=[t,0],n=0;n<r;n++)e.push(null);return e}var hr=function(){function t(t,r,e){this._ranges=new Map,this._counter=1,this._rangeOrder=[],this._store=t,this._page=r,this._pageGetter=e}return t.prototype.get=function(t){return this._store.getMath(this._ranges.get(t))},t.prototype.toId=function(t){return this._ranges.get(t)},t.prototype.add=function(t,r){var e=this._ranges.get(t)||this._next_id();this._store.setMath(e,r,this._page.getContext()),this._ranges.set(t,e),this._refresh(t)},t.prototype.remove=function(t){this._ranges.delete(t),this._counter=1,this._refresh(t)},t.prototype.serialize=function(){var t=this;return Array.from(this._ranges.keys()).map((function(r){return[r,t.get(r).source]}))},t.prototype.parse=function(t){var r=this;t.forEach((function(t){return r.add(t[0],t[1])}))},t.prototype._refresh=function(t){var r=this,e=t.indexOf(\"!\"),n=\"\";-1!==e&&(n=t.substr(0,e),t=t.substr(e+1)),this._store.each((function(e,o){if(function(t,r,e,n){for(var o=0;o<t.length;o+=3)if(6===t[o]){if(\"\"!==e){if(5===t[o-3]&&r.substr(t[o-2],t[o-1])!==e)continue;return!0}if(r.substr(t[o+1],t[o+2])===n)return!0}return!1}(o.code,o.source,n,t)){var i=u(e);r._store.setMath(e,o.source,r._pageGetter(i).getContext())}}))},t.prototype._next_id=function(){for(;this._rangeOrder[this._counter];)this._counter++;return this._rangeOrder[this._counter]=!0,n(this._counter,0,this._page.getID())},t.prototype.renamePage=function(t,r){var e=this;t+=\"!\",r&&(r+=\"!\"),this._ranges.forEach((function(n,o,i){0===o.indexOf(t)&&(r?i.set(o.replace(t,r),n):e._store.clean(n),i.delete(o))}))},t}();var cr=function(){function t(t){var r=this;this._cfg=t||{strict:!1},this._pages=[],this._pageNames=[],this._pageName2ID=new Map,this._pCounter=0,this._parseContext={page:function(t){return r._pageName2ID.get(t)},pageName:function(t){return r._pageNames[t]},pageObj:function(t){return r._pages[t]},name:function(t,e,n){var o,i=t.length,a=e.substr(t[i-2],t[i-1]);if(5===t[i-6]){var u=e.substr(t[i-5],t[i-4]);o=r._ranges.toId(u+\"!\"+a)||r._ranges.toId(a)}else o=r._ranges.toId(n.pageName(n.z)+\"!\"+a)||r._ranges.toId(a);t.push(9,o||-1,0)},z:0},this._store=new ur(e(e({},this._cfg),{get:function(t){var e=o(t),n=e[0],i=e[1],a=e[2];return r._pages[a].getValue(n,i)},set:function(t,e,n){var i=o(t),a=i[0],u=i[1],f=i[2],s=r._pages[f].getCell(a,u,!0),h=2===n;if(null!=n&&2!=n||(n=s.$format||0),s.$format=n,\"string\"==typeof e&&1!=n&&e){var c=parseFloat(e);h&&(c=c.toString()),c==e&&(e=parseFloat(e))}return s.value!==e&&(s.value=e,!0)}}));var n=this._pages[63]=new fr(63,this._store,this._parseContext);this._ranges=new hr(this._store,n,this.getPage.bind(this))}return t.prototype.addPage=function(t){for(;this._pages[this._pCounter];)this._pCounter++;var r=this._pCounter,e=new fr(r,this._store,this._parseContext);return this._pageName2ID.set(t,r),this._pages[r]=e,this._pageNames[r]=t,e},t.prototype.renamePage=function(t,r){if(t!==r){var e=this._pageName2ID.get(t);this._pageName2ID.delete(t),this._pageName2ID.set(r,e),this._pageNames[e]=r,this._ranges.renamePage(t,r);var n=this._pages[e].getContext();this._store.regenerate(e,!1,n)}},t.prototype.removePage=function(t){var r=this._pageName2ID.get(t),e=this._pages[r].getContext();this._pageName2ID.delete(t),this._pages[r]=this._pageNames[r]=null,this._pCounter=0,this._ranges.renamePage(t,null),this._store.regenerate(r,!0,e)},t.prototype.getPage=function(t){return\"string\"==typeof t&&(t=this._pageName2ID.get(t)),this._pages[t]},t.prototype.getRanges=function(){return this._ranges},t.prototype.getStore=function(){return this._store},t}();exports.D_COMMON=0,exports.D_STRING=1,exports.DataPage=fr,exports.DataStore=cr,exports.Store=ur,exports.T_ARG=7,exports.T_DATA=9,exports.T_ERROR=3,exports.T_METHOD=4,exports.T_NAME=6,exports.T_NUMBER=11,exports.T_OPERATOR=10,exports.T_PAGE=5,exports.T_PLACEHOLDER=2,exports.T_RANGE=8,exports.T_SPACE=12,exports.T_TEXT=1,exports.addMethod=function(t,r){er[t]=r},exports.column=a,exports.fromId=o,exports.methodGroups=rr,exports.methods=er,exports.page=u,exports.row=i,exports.str2id=function(t){var r=[];return m(r,t,0),r[1]},exports.str2pos=function(t){var r=[];return m(r,t,0),o(r[1]).slice(0,2)},exports.str2range=function(t){var r=[];t.split(\":\").map((function(t){return m(r,t,0)}));var e=o(r[1]),n=e[0],i=e[1],a=o(r[4]);return[n,i,a[0],a[1]]},exports.toId=n;\n//# sourceMappingURL=muon.js.map\n","import {addMethod} from \"@xbs/muon\";\n\nexport function init(view){\n\tconst math = {\n\t\tIMAGE: url => `<img class=\"webix_ssheet_cimage\" src=\"${webix.template.escape(url)}\">`,\n\t\tHYPERLINK: (url, text) => {\n\t\t\tconst escape = webix.template.escape;\n\t\t\tlet attrs;\n\n\t\t\tif(url[0] == \"#\")\n\t\t\t\tattrs = `href=\"javascript:void(0);\" class=\"webix_ssheet_ref\" data-ref=\"${escape(url.substr(1))}\"`;\n\t\t\telse\n\t\t\t\tattrs = `target=\"blank\" href=\"${escape(url)}\"`;\n\n\t\t\treturn `<a ${attrs}>${escape(text || url)}</a>`;\n\t\t},\n\t\tSPARKLINE: (arr, type, color1, color2) => {\n\t\t\tconst config = { type, color: color1, negativeColor:color2, paddingX:2, paddingY:2 };\n\n\t\t\tif(type == \"donut\")\n\t\t\t\twebix.extend(config, {type:\"pie\", donut:1}, true);\n\t\t\telse if(type == \"barH\")\n\t\t\t\twebix.extend(config, {type:\"bar\", horizontal:1}, true);\n\n\t\t\tfor(let i = 0 ; i < arr.length; i++)\n\t\t\t\tarr[i] = arr[i]||0;\n\n\t\t\tconst tableConfig = view.$$(\"cells\").config;\n\n\t\t\t//[FIXME] we do not know from which cell the method was called, so this is not the real width and height\n\t\t\tconst isCircle = config.type == \"pie\" || type == \"radar\";\n\t\t\tconst width = isCircle ? 100 : tableConfig.columnWidth;\n\t\t\tconst height = isCircle ? 100 : tableConfig.rowHeight;\n\t\t\treturn webix.Sparklines.getTemplate(config)(arr, { width, height });\n\t\t}\n\t};\n\n\tconst keys = Object.keys(math);\n\tkeys.forEach((key, i) => addMath(view, key, math[key], i == keys.length - 1));\n}\n\nexport function addMath(view, name, handler, sort){\n\tname = name.toUpperCase();\n\taddMethod(name, handler);\n\tif(view.$$(\"liveEditor\")){\n\t\tconst sid = view.$$(\"liveEditor\").config.suggest;\n\t\tconst list = webix.$$(sid).getList();\n\t\tif(!list.exists(name)){\n\t\t\tlist.add({id:name, value:name});\n\t\t\tif(sort)\n\t\t\t\tlist.sort(\"value\", \"asc\", \"string\");\n\t\t}\n\t}\n}\n\nexport function getJsDateFromExcel(excelDate) {\n\tconst date = new Date(Math.round((excelDate - 25569) * 86400 * 1000));\n\treturn new Date(date.getTime() + date.getTimezoneOffset() * 60000);\n}\n\nexport function getExcelDateFromJs(jsDate) {\n\tconst returnDateTime = 25569 + ((jsDate.getTime() - (jsDate.getTimezoneOffset() * 60000)) / (86400 * 1000));\n\treturn returnDateTime.toString();\n}","import {getJsDateFromExcel, getExcelDateFromJs} from \"../mathematics/methods\";\n\nfunction getJsDate(value){\n\tif ((value || value === 0) && !(value instanceof Date) && !isNaN(value)){\n\t\tvalue = getJsDateFromExcel(value);\n\t}\n\treturn value;\n}\n\nfunction getExcelDate(value){\n\tif (value && value instanceof Date){\n\t\tvalue = getExcelDateFromJs(value);\n\t}\n\treturn value;\n}\n\nwebix.protoUI({\n\t$cssName: \"datepicker\",\n\tname: \"ssheet-datepicker\",\n\tgetValue:function(){\n\t\tconst value = webix.ui.datepicker.prototype.getValue.apply(this);\n\t\treturn getExcelDate(value) || \"\";\n\t},\n\t$prepareValue:function(value){\n\t\tvalue = getJsDate(value);\n\t\treturn webix.ui.datepicker.prototype.$prepareValue.apply(this, [value]);\n\t}\n}, webix.ui.datepicker);\n\nwebix.protoUI({\n\t$cssName: \"daterangepicker\",\n\tname: \"ssheet-daterangepicker\",\n\tgetValue:function(){\n\t\tlet value = webix.ui.datepicker.prototype.getValue.apply(this);\n\t\tif (value){\n\t\t\tvalue = webix.copy(value);\n\t\t\tvalue.start = getExcelDate(value.start);\n\t\t\tvalue.end = getExcelDate(value.end);\n\t\t}\n\t\treturn value || \"\";\n\t},\n\t$prepareValue:function(value){\n\t\tif (!value){\n\t\t\tvalue = { start:null, end:null };\n\t\t}\n\t\telse if (!value.start && !value.end)\n\t\t\tvalue = { start:value };\n\n\t\tvalue.start = getJsDate(value.start);\n\t\tvalue.end = getJsDate(value.end);\n\n\t\treturn webix.ui.daterangepicker.prototype.$prepareValue.apply(this, [value]);\n\t}\n}, webix.ui.daterangepicker);","webix.protoUI({\n\t$cssName: \"window\",\n\tname: \"ssheet-dialog\",\n\t$init: function(config){\n\t\tthis.$view.className += \" webix_ssheet_dialog\";\n\t\tthis.config.buttons = config.buttons;\n\t\tthis.config.close = true;\n\t},\n\tgetBodyConfig: function(content){\n\t\tcontent.borderless = true;\n\t\tvar elements = this.getFormElements(content);\n\t\tvar config = {\n\t\t\tview: \"form\",\n\t\t\tcss: \"webix_ssheet_form\",\n\t\t\tpadding: webix.skin.$active.layoutPadding.form,\n\t\t\telements: elements\n\t\t};\n\t\treturn config;\n\t},\n\tgetFormElements: function(content){\n\t\tvar elements;\n\t\tif(webix.isArray(content))\n\t\t\telements= content;\n\t\telse{\n\t\t\telements = [];\n\t\t\telements.push(content);\n\t\t}\n\t\tif(this.config.buttons){\n\t\t\telements.push({height:1});\n\t\t\telements.push( {\n\t\t\t\tmargin: 10,\n\t\t\t\tcols:[\n\t\t\t\t\t{},\n\t\t\t\t\t{view: \"button\", css: \"ssheet_cancel_button\", label: webix.i18n.spreadsheet.labels.cancel, autowidth:true, click: function(){\n\t\t\t\t\t\tvar parentView = this.getTopParentView();\n\t\t\t\t\t\tparentView.callEvent(\"onCancelClick\",[]);\n\t\t\t\t\t}},\n\t\t\t\t\t{view: \"button\", label: webix.i18n.spreadsheet.labels.save, hotkey: \"enter\", autowidth:true, click: function(){\n\t\t\t\t\t\tvar parentView = this.getTopParentView();\n\t\t\t\t\t\tparentView.callEvent(\"onSaveClick\",[]);\n\t\t\t\t\t}}\n\t\t\t\t]\n\t\t\t});\n\t\t}\n\t\treturn elements;\n\t},\n\tbody_setter: function(value){\n\t\tif(typeof value == \"object\"){\n\t\t\tif(webix.isUndefined(value.padding))\n\t\t\t\tvalue.padding = webix.skin.$active.layoutPadding.form;\n\t\t\tif(value.view == \"form\" && value.elements){\n\t\t\t\tvalue.elements = this.getFormElements(value.elements);\n\t\t\t\tif(!value.css)\n\t\t\t\t\tvalue.css = \"webix_ssheet_form\";\n\t\t\t}\n\t\t\telse\n\t\t\t\tvalue = this.getBodyConfig(value);\n\t\t}\n\n\t\treturn webix.ui.window.prototype.body_setter.call(this,value);\n\t},\n\tdefaults:{\n\t\tmove:true,\n\t\thead: \"Dialog\",\n\t\tbuttons: true,\n\t\tclose:true,\n\t\t//we need to retain focus in table area, so disabling the autofocusing feature\n\t\tautofocus:false,\n\t\twidth: 350\n\t}\n}, webix.ui.window, webix.IdSpace);\n\n\n\nwebix.protoUI({\n\t$cssName: \"datatable\",\n\tname: \"ssheet-dialog-table\",\n\t$init: function(config){\n\t\tif(!config.headerRowHeight)\n\t\t\tconfig.headerRowHeight = 34;\n\t\tthis.$view.className += \" webix_ssheet_dialog_table\";\n\t}\n},webix.ui.datatable);","webix.protoUI({\n\tname: \"ssheet-suggest-labels\",\n\tdefaults:{\n\t\tfitMaster:false,\n\t\tpadding:0,\n\t\tborderless: true\n\t},\n\t$init: function(){\n\t\tthis.$view.className += \" webix_ssheet_suggest\";\n\t},\n\tgetItemText: function(id){\n\t\treturn this.getList().getItem(id).value;\n\t}\n}, webix.ui.suggest);\n\nwebix.protoUI({\n\tname: \"ssheet-form-suggest\",\n\tdefaults:{\n\t\tpadding:0,\n\t\tborderless: true\n\t},\n\t$init: function(){\n\t\tthis.$view.className += \" webix_ssheet_suggest\";\n\t}\n}, webix.ui.suggest);\n\nwebix.protoUI({\n\t$cssName: \"colorpicker\",\n\tname: \"ssheet-colorpicker\",\n\t$init: function(){\n\t\tthis.$view.className += \" webix_ssheet_colorpicker\";\n\t},\n\tdefaults:{\n\t\tsuggest:{\n\t\t\tborderless: true,\n\t\t\tbody:{\n\t\t\t\tview: \"ssheet-colorboard\",\n\t\t\t}\n\t\t}\n\t}\n}, webix.ui.colorpicker);","webix.protoUI({\n\tname:\"formlate\",\n\tsetValue:function(a){ return this.setHTML(a); },\n\tgetValue:function(){ return \"\"; }\n}, webix.ui.template);","webix.protoUI({\n\tname:\"ssheet-icons\",\n\t$cssName: \"dataview\",\n\t$init: function(){\n\t\tthis.$view.className += \" webix_ssheet_dataview\";\n\t},\n\tdefaults:{\n\t\tborderless: true,\n\t\ttemplate: \"<span class='webix_ssheet_button_icon #css#' ></span>\",\n\t\ttype:{\n\t\t\twidth: 36,\n\t\t\theight: 36\n\t\t}\n\t}\n},webix.ui.dataview);","webix.protoUI({\n\tname: \"ssheet-suggest\",\n\tdefaults:{\n\t\tpadding:0,\n\t\tcss: \"webix_ssheet_suggest\"\n\t}\n},webix.ui.contextmenu);","const group = {\n\tvalue: null,\n\tset: function(method, master){\n\t\tif(!this.value){\n\t\t\tthis.start();\n\t\t\tmethod.call(master);\n\t\t\tthis.end();\n\t\t}\n\t\telse\n\t\t\tmethod.call(master);\n\t},\n\tstart(){\n\t\tthis.value = webix.uid();\n\t},\n\tend(){\n\t\tthis.value = null;\n\t}\n};\n\nexport default group;","export function init(view){\n\tconst events = [\n\t\t{name:\"onSheetAdd\", type:\"insert\"},\n\t\t{name:\"onSheetRemove\", type:\"remove\"},\n\t\t{name:\"onSheetRename\", type:\"rename\"},\n\t\t{name:\"onSheetStateChange\", type:\"state\"},\n\t\t{name:\"onCellChange\"},\n\t\t{name:\"onStyleChange\"},\n\t\t{name:\"onAction\"},\n\t\t{name:\"onRowOperation\"},\n\t\t{name:\"onColumnOperation\"},\n\t\t{name:\"onAfterConditionSet\"},\n\t\t{name:\"onAfterRangeSet\"},\n\t\t{name:\"onAfterSpan\"},\n\t\t{name:\"onAfterSplit\"},\n\t\t{name:\"onAfterFilter\", view: \"cells\"},\n\t\t{name:\"onRowResize\", view: \"cells\"},\n\t\t{name:\"onColumnResize\", view: \"cells\"}\n\t];\n\n\tlet thread;\n\tfor (let i = 0; i < events.length; i++){\n\t\tconst handler = events[i];\n\t\t(handler.view ? view.$$(handler.view) : view).attachEvent(handler.name, function(name, newName, _, page){\n\t\t\tif (view._loading_data) return;\n\n\t\t\tlet params;\n\t\t\tif(handler.type)\n\t\t\t\tparams = handler.type == \"rename\" ? [handler.type, newName, name] : [handler.type, name];\n\t\t\telse{\n\t\t\t\tlet activeSheet = view.getActiveSheet();\n\t\t\t\tif(handler.name == \"onCellChange\" && page != activeSheet)\n\t\t\t\t\tactiveSheet = page;\n\t\t\t\tparams = [\"update\", activeSheet];\n\t\t\t}\n\n\t\t\tclearTimeout(thread);\n\t\t\tthread = webix.delay(() => view.callEvent(\"onChange\", params));\n\t\t});\n\t}\n\n\tview.attachEvent(\"onChange\", function(){\n\t\tsave(view, \"all\");\n\t});\n}\n\nexport function save(view, name, data){\n\tvar save = view.config.save;\n\tvar url;\n\tif (!save) return;\n\n\tif(name == \"all\"){\n\t\tif(!save.all)\n\t\t\treturn;\n\t\tdata = { data: view.serialize({ sheets: true }) };\n\t\turl = save.all;\n\t}\n\telse{\n\t\turl = typeof save === \"string\" ? save + \"/\" + name : save[name];\n\t}\n\n\turl = webix.proxy.$parse(url);\n\n\tif(url){\n\t\tif (typeof url === \"function\")\n\t\t\treturn url(name, data);\n\n\t\tif (url.$proxy && url.save)\n\t\t\treturn url.save(view, data, null, null);\n\n\t\tvar ajax = webix.ajax();\n\t\tif (name === \"all\")\n\t\t\tajax.headers({ \"Content-type\" : \"application/json\" });\n\t\tajax.post(url, data);\n\t}\n}","export const decode = {};\nexport const encode = {};\n\nconst alpha = \"ABCDEFGHIJKLMNOPQRSTUVWXYZ\";\n\nfunction indexToHeader(index){\n\tconst chars = alpha.length;\n\tconst quotient = Math.floor(--index / chars);\n\tif (quotient > 0)\n\t\treturn indexToHeader(quotient) + alpha[index % chars];\n\n\treturn alpha[index % chars];\n}\n\nexport function updateMaxColumn(maxColumn){\n\tconst lastColumn = Object.keys(encode).length;\n\n\tfor(let i = lastColumn + 1; i <= maxColumn; i++){\n\t\tlet str = indexToHeader(i);\n\n\t\tdecode[str] = i;\n\t\tencode[i] = str;\n\t}\n}\n\nexport function adress(text){\n\tlet size;\n\tfor(let i = 0; i < text.length; i++)\n\t\tif(text.charCodeAt(i) < 59){\n\t\t\tsize = i;\n\t\t\tbreak;\n\t\t}\n\n\tconst col = text.substr(0, size);\n\tconst row = text.substr(size);\n\n\treturn [row*1, decode[col]];\n}\n\nexport function range(text, view, page){\n\tconst nind = text.indexOf(\"!\");\n\tlet sheet = page || \"\";\n\n\t//parse sheet names\n\tif (nind !== -1){\n\t\tsheet = text.substr(0, nind);\n\t\tif (sheet[0] === \"'\")\n\t\t\tsheet = sheet.substr(1, sheet.length-2);\n\t\ttext = text.substr(nind+1);\n\t}\n\n\tlet parts = text.split(\":\");\n\tif (parts.length != 2){\n\t\tif(view){\n\t\t\tlet code = view.ranges.getCode(text, sheet);\n\t\t\tif(!code){\n\t\t\t\t// global named range\n\t\t\t\tcode = view.ranges.getCode(text, true);\n\t\t\t\tif(!code)\n\t\t\t\t\treturn null;\n\t\t\t}\n\n\t\t\tconst rangeParts = code.split(\"!\");\n\t\t\tif(rangeParts[0] != page || view.getActiveSheet())\n\t\t\t\tsheet = rangeParts[0].replace(/'/g,\"\");\n\t\t\tcode = rangeParts[1];\n\t\t\tparts = code.split(\":\");\n\t\t}\n\t\telse\n\t\t\treturn null;\n\t} \n\n\tconst d1 = adress(parts[0]);\n\tconst d2 = adress(parts[1]);\n\n\tif(d1[0] && d1[1] && d2[0] && d2[1])\n\t\treturn [d1[0], d1[1], d2[0], d2[1], sheet];\n}\n\n\nexport function escapeSheet(sheet){\n\treturn sheet.indexOf(\" \") == -1 ? sheet : `'${sheet}'`;\n}\n\nexport function toRange(x,y,x2,y2,sheet){\n\treturn (sheet?(escapeSheet(sheet)+\"!\"):\"\")+encode[y]+x+\":\"+encode[y2]+x2;\n}\nexport function toSheetRange(x,y,sheet){\n\treturn (sheet?(escapeSheet(sheet)+\"!\"):\"\")+x+\":\"+y;\n}\n\nexport function rangeObj(text, view){\n\tif (typeof text === \"object\") return text;\n\tconst a = range(text, view);\n\treturn { start:{ row:a[0], column:a[1]}, end:{ row:a[2], column:a[3] }, sheet: a[4] };\n}\n\nexport function eachRange(text, view, callback, data){\n\tconst range = rangeObj(text);\n\tfor (let row = range.start.row; row <= range.end.row; row++) {\n\t\tfor (let column = range.start.column; column <=  range.end.column; column++) {\n\t\t\tcallback(view, {row: row, column: column}, data);\n\t\t}\n\t}\n}\n\nexport function isRange(text){\n\tif(typeof text == \"string\"){\n\t\tconst cells = text.split(\":\");\n\t\tif(cells.length == 2){\n\t\t\tfor(let i = 0; i < cells.length; i++){\n\t\t\t\tconst parts = cells[i].split(\"!\");\n\t\t\t\tif(!isCell(parts.pop()))\n\t\t\t\t\treturn;\n\t\t\t}\n\t\t\treturn true;\n\t\t}\n\t}\n}\n\nconst cellTest = /^[A-Z]+[0-9]+$/;\nexport function isCell(text){\n\treturn cellTest.test(text);\n}\n\nexport function changeRange(text,name,inc,start){\n\tlet updated = false;\n\n\tif(isRange(text)){\n\t\tlet [r1,c1,r2,c2,sheet] = range(text);\n\n\t\t//ranges like B2:A1\n\t\tif(r1 > r2)\n\t\t\t[r1, r2] = [r2, r1];\n\t\tif(c1 > c2)\n\t\t\t[c1, c2] = [c2, c1];\n\n\t\tif (name === \"row\" && start.row <= r2){\n\t\t\tif((inc < 0 && start.row < r1) || (inc > 0 && start.row <= r1))\n\t\t\t\tr1 += inc;\n\t\t\tr2 += inc;\n\n\t\t\tif(r2<r1)\n\t\t\t\treturn \"\";\n\n\t\t\tupdated = true;\n\t\t}\n\t\telse if (name === \"column\" && start.column <= c2){\n\t\t\tif((inc < 0 && start.column < c1) || (inc > 0 && start.column <= c1))\n\t\t\t\tc1 += inc;\n\t\t\tc2 += inc;\n\n\t\t\tif(c2<c1)\n\t\t\t\treturn \"\";\n\n\t\t\tupdated = true;\n\t\t}\n\t\tif(updated)\n\t\t\ttext = toRange(r1,c1,r2,c2,sheet);\n\t}\n\n\treturn text;\n}","export const toolbarSizes = {\n\twidth:38,\n\tmargin: 7,\n\tpaddingY: 1,\n\tsectorPadding: 5,\n\tsectorMargin: 0\n};\n\n// default styles for toolbar elements\nexport const defaultStyles = {\n\t\"color\"         : \"#666666\",\n\t\"background\"    : \"#ffffff\",\n\t\"font-family\"   : \"'PT Sans', Tahoma\",\n\t\"font-size\" : \"15\",\n\t\"text-align\": \"left\",\n\t\"vertical-align\": \"middle\",\n\t\"white-space\": \"nowrap\",\n};\n\nconst fonts = {\n\tmaterial: \"'Roboto', sans-serif\",\n\tmini: \"'Roboto', sans-serif\",\n\tflat: \"'PT Sans', Tahoma\",\n\tcompact: \"'PT Sans', Tahoma\",\n\tcontrast: \"'PT Sans', Tahoma\",\n\twillow: \"'Open Sans', sans-serif\",\n\tdark: \"'Open Sans', sans-serif\",\n};\n\nexport function setSkinDefaults(){\n\tconst skin = webix.skin.$name;\n\ttoolbarSizes.width = webix.skin.$active.inputHeight + 2;\n\ttoolbarSizes.titleHeight = (skin == \"mini\" || skin == \"compact\") ? 18 : 20;\n\n\tdefaultStyles[\"font-family\"] = fonts[skin];\n\n\tif (skin == \"contrast\"){\n\t\tdefaultStyles.background = \"#393939\";\n\t\tdefaultStyles.color = \"#ffffff\";\n\t} else if (skin == \"material\" || skin == \"mini\"){\n\t\tdefaultStyles.color = \"#475466\";\n\t} else if (skin == \"willow\"){\n\t\tdefaultStyles.color = \"#2C2F3C\";\n\t} else if (skin == \"dark\"){\n\t\tdefaultStyles.background = \"#2A2B2D\";\n\t\tdefaultStyles.color = \"#ffffff\";\n\t}\n}","import group from \"./undo_group\";\nimport {save} from \"./save\";\nimport {eachRange} from \"../helpers/column_names\";\nimport {defaultStyles} from \"../toolbar/defaults\";\n\n//do not change order, it will break server side compatibility\n//add new options to the end of this list\nexport const style_names = [\n\t\"color\",\"background\",\"text-align\",\n\t\"font-family\",\"font-size\",\n\t\"font-style\",\"underline\",\"font-weight\",\n\t\"vertical-align\", \"wrap\", \"borders\", \"format\",\n\t\"border-right\", \"border-bottom\",\"border-left\", \"border-top\",\n\t\"strike\", \"indent\"\n];\n\nconst _style_map = {\n\tformat: ()=> \"\",\n\t\"text-align\": {\n\t\tleft: () => \"justify-content:flex-start;\",\n\t\tcenter: () => \"justify-content:center;text-align:center;\",\n\t\tright: () => \"justify-content:flex-end;text-align:right;\"\n\t},\n\t\"vertical-align\": {\n\t\ttop: () => \"align-items:flex-start;\",\n\t\tmiddle: () => \"align-items:center;\",\n\t\tbottom: () => \"align-items:flex-end;\"\n\t},\n\twrap: {\n\t\twrap: ()=> {\n\t\t\treturn \"white-space: normal !important;\";\n\t\t}\n\t},\n\t\"border-left\": (obj, zoom) => {\n\t\treturn getBorderCss(\"border-left\", obj, zoom);\n\t},\n\t\"border-top\": (obj, zoom) => {\n\t\treturn getBorderCss(\"border-top\", obj, zoom);\n\t},\n\t\"border-right\": (obj, zoom) => {\n\t\treturn getBorderCss(\"border-right\", obj, zoom);\n\t},\n\t\"border-bottom\": (obj, zoom) => {\n\t\treturn getBorderCss(\"border-bottom\", obj, zoom);\n\t},\n\t\"font-weight\": obj => {\n\t\t//Roboto bold - font-weight:500 (looks better, than 700). Roboto is default font for material skins.\n\t\tif(obj[\"font-weight\"] == \"bold\"){\n\t\t\tconst family = obj[\"font-family\"] || defaultStyles[\"font-family\"];\n\t\t\treturn \"font-weight:\" + (family == \"'Roboto', sans-serif\" ? 500 : 700) + \";\";\n\t\t}\n\t\treturn \"\";\n\t},\n\tunderline: obj => {\n\t\tconst underline = obj.underline == \"underline\" ? \"underline\" : \"\";\n\t\tif(underline){\n\t\t\tconst strike = obj.strike == \"strike\" ? \"line-through\" : \"\";\n\t\t\treturn `text-decoration: ${underline} ${strike};`;\n\t\t}\n\t\treturn \"\";\n\t},\n\tstrike: obj => {\n\t\tif(obj.underline != \"underline\" && obj.strike == \"strike\")\n\t\t\treturn \"text-decoration: line-through;\";\n\t\treturn \"\";\n\t},\n\tindent: (obj, zoom) => {\n\t\tconst count = obj.indent * 1;\n\t\tif(count > 0){\n\t\t\tconst pos = obj[\"text-align\"] == \"right\" ? \"right\" : \"left\";\n\t\t\treturn { innerCss: `margin-${pos}:${(count * 8 + 12)*zoom}px;` }; // 12 - default cell margin\n\t\t}\n\t},\n\t\"font-size\": (obj, zoom) => {\n\t\tlet fontSize = obj[\"font-size\"];\n\n\t\tif(zoom != 1)\n\t\t\tfontSize = obj[\"font-size\"].replace(\"px\",\"\") * zoom + \"px\";\n\n\t\treturn \"font-size:\"+fontSize+\";\";\n\t},\n};\n\nfunction getBorderCss(pos, obj, zoom){\n\tlet border = obj[pos];\n\tif(border){\n\t\tlet [color, type] = border.split(\",\");\n\n\t\ttype = type || \"thin\";\n\t\tlet size = 1;\n\t\tif(type == \"medium\")\n\t\t\tsize = 2;\n\t\telse if(type == \"thick\" || type == \"double\")\n\t\t\tsize = 3;\n\n\t\tsize = size * zoom + \"px\";\n\n\n\t\tif([\"thin\", \"medium\", \"thick\"].indexOf(type) != -1)\n\t\t\ttype = \"solid\";\n\n\t\treturn `${pos}: ${size} ${type} ${color} !important;`;\n\t}\n\treturn \"\";\n}\n\nconst border_checks = {\n\t\"border-left\":\t\tfunction(cell, area, mode){ return cell.column == area.start.column || mode ==\"no\"; },\n\t\"border-right\":\t\tfunction(cell, area, mode){ return cell.column == area.end.column || mode == \"all\" || mode ==\"no\"; },\n\t\"border-top\":\t\tfunction(cell, area , mode){ return cell.row == area.start.row || mode ==\"no\"; },\n\t\"border-bottom\":\tfunction(cell, area, mode){ return cell.row == area.end.row || mode == \"all\"|| mode ==\"no\"; }\n};\n\nconst _style_handlers = {\n\t\"borders\": function(view, style, value, cell){\n\t\tconst area = view.$$(\"cells\").getSelectArea();\n\t\tvalue = value.split(\",\");\n\t\tconst type = value[0];\n\t\tlet color = value[1];\n\t\tlet lineStyle = value[2];\n\n\t\tvar modes = [\"border-left\", \"border-right\", \"border-bottom\", \"border-top\"];\n\n\t\tif(type == \"top-bottom\"){\n\t\t\tmodes = [\"border-top\",\"border-bottom\"];\n\t\t}\n\t\telse if (type != \"no\" && type != \"all\" && type != \"outer\")\n\t\t\tmodes = [\"border-\"+type];\n\n\t\tfor (var i = 0; i < modes.length; i++){\n\t\t\tvar mode = modes[i];\n\t\t\tlet result = view.callEvent(\"onAction\", [\"check-borders\", {row:cell.row, column:cell.column, area, type, mode}]);\n\t\t\tif (result === true || border_checks[mode](cell, area, type)){\n\t\t\t\tconst border = type == \"no\" ? \"\" : `${color},${lineStyle}`;\n\t\t\t\tstyle = _updateStyle(view, style, mode, border, cell);\n\t\t\t}\n\t\t}\n\t\treturn style;\n\t}\n};\n\nvar sizeEl;\nexport function init(view){\n\tview.attachEvent(\"onStyleSet\", (name, value) => _applyStyles(view, name, value));\n\tview.attachEvent(\"onDataParse\", (data) => _parse(view, data));\n\tview.attachEvent(\"onDataSerialize\", (data) => _serialize(view, data));\n\tview.attachEvent(\"onReset\", () => reset(view));\n\tview.attachEvent(\"onUndo\", (type, row, column, style) => {\n\t\tif(type == \"style\")\n\t\t\t_undoStyle(view, row, column, style);\n\t});\n\n\treset(view);\n\n\tif (!sizeEl)\n\t\tsizeEl = webix.html.create(\"DIV\", { style:\"visibility:hidden; position:absolute; top:0px; left:0px; height:auto;\"}, \"\");\n}\n\nfunction reset(view){\n\tview._styles = {};\n\tview._styles_cache = {};\n\tview._styles_max = 1;\n\n\tlet prefix = \".wss_\"+view.$index;\n\twebix.html.removeStyle(prefix);\n}\n\nexport function zoomStyles(view){\n\tconst data = {};\n\t_serialize(view, data);\n\treset(view);\n\t_parse(view, data, true);\n}\n\nexport function getStyle(view, cell){\n\tconst obj = view._mPage.getCell(cell.row-1, cell.column-1);\n\tconst span = view.$$(\"cells\").getSpan(cell.row, cell.column);\n\n\tif(span && span[0] == cell.row && span[1] == cell.column){\n\t\tconst spanStyles = span[5].split(\" \");\n\t\tfor (let i = 0; i < spanStyles.length; i++){\n\t\t\tconst spanStyle = view._styles[spanStyles[i]];\n\t\t\tif(spanStyle)\n\t\t\t\treturn spanStyle;\n\t\t}\n\t}\n\n\tif (obj && obj.style)\n\t\treturn view._styles[obj.style];\n\n\treturn null;\n}\n\nexport function getFormat(view, row, column){\n\tvar obj = view._mPage.getCell(row-1, column-1);\n\treturn (obj && obj.format) || \"\";\n}\n\n// undo\nfunction _undoStyle(view, row, column, style){\n\tvar cell = {row: row, column: column};\n\tsetStyle(view, cell, style);\n}\n\nfunction _serialize(view, obj){\n\tvar styles = [];\n\n\tfor (var key in view._styles_cache)\n\t\tstyles.push([view._styles_cache[key].id, key]);\n\n\tobj.styles = styles;\n}\n\nexport function addStyle(view, props, origin){\n\tvar style = {\n\t\tprops: styleFromText( style_names.map(()=>\"\").join(\";\") )\n\t};\n\n\tif (origin)\n\t\tfor (var key in origin.props)\n\t\t\tstyle.props[key] = origin.props[key];\n\n\tfor (let  key in props)\n\t\tstyle.props[key] = props[key];\n\n\n\tstyle.text = styleToText(style);\n\tvar cache = view._styles_cache[style.text];\n\tif (cache)\n\t\treturn cache;\n\n\t_addStyle(view, style);\n\n\treturn style;\n}\n\nfunction _parse(view, obj, zoom){\n\tif (obj.styles)\n\t\tfor (let i=0; i < obj.styles.length; i++){\n\t\t\tvar styleObj = obj.styles[i];\n\t\t\tvar style = {\n\t\t\t\tid: styleObj[0],\n\t\t\t\ttext:styleObj[1],\n\t\t\t\tprops: styleFromText(styleObj[1])\n\t\t\t};\n\n\t\t\t_addStyle(view, style, true);\n\t\t}\n\n\tif(!zoom)\n\t\tfor (let i = 0; i < obj.data.length; i++){\n\t\t\tvar [row, column, , css] = obj.data[i];\n\n\t\t\tif (css)\n\t\t\t\tupdate_style_data(view, row, column, view._styles[css]);\n\t\t}\n}\n\nfunction _applyStyles(view, name, value){\n\tgroup.set(function(){\n\t\tview.eachSelectedCell(function(cell){\n\t\t\tconst span = view.$$(\"cells\").getSpan(cell.row, cell.column);\n\t\t\tif(!span || (span && span[0] == cell.row && span[1] == cell.column))\n\t\t\t\t_applyCellStyles(view, cell, name, value);\n\t\t});\n\t});\n\tview.refresh();\n}\n\nfunction _applyCellStyles(view, cell, name, value){\n\tconst ostyle = getStyle(view, cell);\n\n\tif(name == \"indent\"){\n\t\tconst oldVal = ((ostyle && ostyle.props[name]) || 0) * 1;\n\n\t\tif(!oldVal && value == -1)\n\t\t\treturn;\n\n\t\tvalue += oldVal;\n\t}\n\n\tconst nstyle = _updateStyle(view, ostyle, name, value, cell);\n\n\tif (nstyle && nstyle != ostyle)\n\t\t_setStyle(view, cell, nstyle, ostyle, true);\n}\n\nfunction _updateStyle(view, style, name, value, cell){\n\n\tif(_style_handlers[name]){\n\t\treturn _style_handlers[name](view, style, value, cell);\n\t}\n\n\tif (style && style.props[name] == value) return style;\n\n\tvar nstyle = { text:\"\", id:0, props: (style?webix.copy(style.props):{}) };\n\tnstyle.props[name] = value;\n\tnstyle.text = styleToText(nstyle);\n\n\tvar cache = view._styles_cache[nstyle.text];\n\tif (cache)\n\t\treturn cache;\n\n\t_addStyle(view,nstyle);\n\n\treturn nstyle;\n}\n\nfunction update_style_data(view, row, column, style){\n\tconst obj = view._mPage.getCell(row-1, column-1, true);\n\tobj.style = style && style.id;\n\tobj.format = style && style.props.format;\n}\n\nexport function setStyle(view, cell, style){\n\tconst old = getStyle(view, cell);\n\treturn _setStyle(view, cell, style, old);\n}\n\nexport function setRangeStyle(view, range, style) {\n\teachRange(range, view, _setStyle, style);\n}\n\nexport function getTextSize(view, text, css, baseWidth){\n\tsizeEl.innerHTML = text;\n\tsizeEl.style.width = baseWidth ? baseWidth+\"px\" : \"auto\";\n\n\tsizeEl.className = \"webix_table_cell webix_cell \"+css;\n\tview._table.$view.appendChild(sizeEl);\n\n\tconst width = Math.max(0, sizeEl.offsetWidth+1);\n\tconst height = Math.max(0, sizeEl.offsetHeight+1);\n\n\tview._table.$view.removeChild(sizeEl);\n\tsizeEl.innerHTML = \"\";\n\n\treturn { width, height };\n}\n\nfunction _setStyle(view, cell, style, old, toolbar){\n\tif(view.callEvent(\"onBeforeStyleChange\", [cell.row, cell.column, style, old])){\n\t\tgroup.set(()=>{\n\t\t\tconst format = style && style.props.format || null;\n\t\t\tconst oldFormat = old && old.props.format || null;\n\t\t\tconst formatChanged = format != oldFormat;\n\t\t\tif(!formatChanged || formatChanged && view.callEvent(\"onBeforeFormatChange\", [cell.row, cell.column, format, oldFormat])){\n\t\t\t\tupdate_style_data(view, cell.row, cell.column, style);\n\t\t\t\tview.callEvent(\"onStyleChange\", [cell.row, cell.column, style, old]);\n\n\t\t\t\tif(formatChanged)\n\t\t\t\t\tview.callEvent(\"onFormatChange\", [cell.row, cell.column, format, oldFormat]);\n\n\t\t\t\tview.saveCell(cell.row,cell.column);\n\n\t\t\t\tconst sel = view.getSelectedId();\n\t\t\t\tif(!toolbar && sel && sel.row == cell.row && sel.column == cell.column)\n\t\t\t\t\tview.callEvent(\"onCommand\", [{id:\"toolbar-update\"}]);\n\t\t\t}\n\t\t});\n\t}\n}\n\nfunction _buildCssString(view, style) {\n\tlet css = \"\";\n\tlet innerCss = \"\";\n\n\tfor (var key in style){\n\t\tif (style[key]){\n\t\t\tif( _style_map[key]){\n\t\t\t\tif(_style_map[key][style[key]])\n\t\t\t\t\tcss += _style_map[key][style[key]](style);\n\t\t\t\telse if(typeof  _style_map[key] == \"function\"){\n\t\t\t\t\tconst outCss = _style_map[key](style, view._zoom);\n\n\t\t\t\t\tif(typeof outCss == \"object\"){\n\t\t\t\t\t\tcss += outCss.css || \"\";\n\t\t\t\t\t\tinnerCss += outCss.innerCss || \"\";\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t\tcss += outCss;\n\t\t\t\t}\n\t\t\t}\n\t\t\telse\n\t\t\t\tcss+= key+\":\"+style[key]+\";\";\n\t\t}\n\t}\n\n\treturn {css, innerCss};\n}\n\nfunction _addStyle(view, style, silent){\n\tview._styles_cache[style.text] = style;\n\n\twhile (!style.id || view._styles[style.id])\n\t\tstyle.id = \"wss\"+(view._styles_max++);\n\tview._styles[style.id] = style;\n\n\tconst {css, innerCss} = _buildCssString(view, style.props);\n\tconst prefix = \".wss_\"+view.$index;\n\twebix.html.addStyle(prefix+\" .\"+style.id+\"{\"+css+\"}\", prefix);\n\twebix.html.addStyle(prefix+\" .\"+style.id+\" div:first-child{\"+innerCss+\"}\", prefix);\n\n\tif (!silent)\n\t\tsave(view, \"styles\", { name:style.id, text: style.text } );\n}\n\nexport function styleToText(style){\n\tvar id = [];\n\tfor (var i=0; i<style_names.length; i++)\n\t\tid.push(style.props[style_names[i]]);\n\treturn id.join(\";\");\n}\n\nexport function styleFromText(text){\n\tvar parts = text.split(\";\");\n\tvar props = {};\n\tfor (var i=0; i<style_names.length; i++)\n\t\tprops[style_names[i]] = parts[i];\n\treturn props;\n}\n\n\n\nexport function clearRangeStyle(view, range){\n\tgroup.set(function(){\n\t\teachRange(range, view, function(view, cell){\n\t\t\tlet style = getStyle(view,cell);\n\t\t\tif (style)\n\t\t\t\tsetStyle(view, cell, null);\n\t\t});\n\t});\n}\n\nexport function compactStyles(view){\n\tconst serialized = view.serialize();\n\tserialized.styles = removeUnusedStyles(serialized);\n\n\treset(view);\n\t_parse(view, serialized);\n}\n\nexport function removeUnusedStyles(serialized){\n\tconst data = serialized.data;\n\tconst styles = serialized.styles;\n\n\tconst used = {};\n\tfor (let i=0; i<data.length; i++){\n\t\tconst name = data[i][3];\n\t\tif (name)\n\t\t\tused[name] = 1;\n\t}\n\n\tconst newStyles = [];\n\tfor(let i = 0; i<styles.length; i++){\n\t\tconst name = styles[i][0];\n\t\tif (used[name])\n\t\t\tnewStyles.push(styles[i]);\n\t}\n\n\treturn newStyles;\n}","export function find(arr, func){\n\tvar result = findIndex(arr, func);\n\treturn arr[result];\n}\n\nexport function findIndex(arr, func){\n\tvar result = -1;\n\tfor(var i =0; result<0 && i < arr.length; i++){\n\t\tif(func(arr[i]))\n\t\t\tresult = i;\n\t}\n\treturn result;\n}\n\nexport function getDimension(data, spans, rows, cols){\n\tfor(let i=0; i<data.length; i++){\n\t\t// data[i] - [ row, column, value, style]\n\t\tlet line = data[i];\n\t\tif (line[0]>rows) rows=line[0];\n\t\tif (line[1]>cols) cols=line[1];\n\t}\n\n\tif(spans)\n\t\tfor(let i = 0; i < spans.length; i++){\n\t\t\t// spans[i] - [ row, column, colCount, rowCount ]\n\t\t\tconst spanEndRow = spans[i][0] + spans[i][3] - 1;\n\t\t\tconst spanEndCol = spans[i][1] + spans[i][2] - 1;\n\n\t\t\tif(spanEndRow > rows) rows = spanEndRow;\n\t\t\tif(spanEndCol > cols) cols = spanEndCol;\n\t\t}\n\n\treturn [rows*1, cols*1];\n}","import {addStyle, styleFromText} from \"./styles\";\nimport {getJsDateFromExcel} from \"../mathematics/methods\";\nimport group from \"./undo_group\";\nimport * as arr from \"../helpers/array\";\n\nexport function init(view){\n\tview.attachEvent(\"onDataParse\", (data) => load(view, data));\n\tview.attachEvent(\"onDataSerialize\", (data, config) => serialize(view, data, config));\n}\n\nexport let formatHelpers = {};\nexport let currencies = [];\nconst defaultFormats = {common:1};\n\n\nexport let formatsCount;\nexport let formatCache;\n\nlet formats;\nlet formatSources;\n\nfunction getCurrencySymbol(format){\n\treturn webix.template(format)(\"\");\n}\n\nexport function setDefaultFormats(){\n\tconst formatsLocale = webix.i18n.spreadsheet.formats;\n\n\tcurrencies = [ webix.i18n.price ];\n\tcurrencies = currencies.concat(webix.copy(formatsLocale.currencies));\n\n\tcurrencies = currencies.map(format => {\n\t\tconst id = getCurrencySymbol(format);\n\t\treturn {\n\t\t\tformat,\n\t\t\tid,\n\t\t\tvalue: id.trim()\n\t\t};\n\t});\n\n\tformats = {};\n\tformatsCount = 0;\n\tformatSources = {};\n\tformatCache = {};\n\tformatHelpers = {\n\t\tprice : {\n\t\t\tgetFormat : function(value, extra){\n\t\t\t\textra.css = \"webix_ssheet_format_price\";\n\t\t\t\tconst minusSign = value < 0 ? \"-\" : \"\";\n\t\t\t\tif(minusSign) value = Math.abs(value);\n\t\t\t\treturn minusSign+webix.i18n.priceFormat(value);\n\t\t\t},\n\t\t\tvalues:webix.extend({\n\t\t\t\tzeros: webix.i18n.priceSettings.decimalSize, \n\t\t\t\tsymbol: webix.i18n.priceFormat(\"\"),\n\t\t\t\tseparator: 1, negative:1, type: \"price\"\n\t\t\t}, getDelimiters(\"price\"))\n\t\t},\n\t\t\"int\" : {\n\t\t\tgetFormat : function(value, extra){\n\t\t\t\textra.css = \"webix_ssheet_format_int\";\n\t\t\t\treturn webix.i18n.numberFormat(value);\n\t\t\t},\n\t\t\tvalues:webix.extend({\n\t\t\t\tzeros: webix.i18n.decimalSize,\n\t\t\t\tseparator: 1, negative:1, type: \"int\",\n\t\t\t}, getDelimiters(\"int\"))\n\t\t},\n\t\tpercent : {\n\t\t\tgetFormat : function(value, extra){\n\t\t\t\textra.css = \"webix_ssheet_format_percent\";\n\t\t\t\treturn Math.round(value*100)+\"%\";\n\t\t\t},\n\t\t\tvalues:webix.extend({\n\t\t\t\tzeros: 0, separator: 0, negative:1, type: \"percent\",\n\t\t\t}, getDelimiters(\"percent\"))\n\t\t},\n\t\tdate : {\n\t\t\tgetFormat : function(value, extra){\n\t\t\t\textra.css = \"webix_ssheet_format_date\";\n\t\t\t\treturn format2code(formatsLocale.dateFormat, getDelimiters(\"date\"))(value);\n\t\t\t},\n\t\t\tvalues: { type:\"date\", date:formatsLocale.dateFormat }\n\t\t},\n\t\tstring : {\n\t\t\tgetFormat : function(value, extra){\n\t\t\t\textra.css = \"webix_ssheet_format_text\";\n\t\t\t\treturn value;\n\t\t\t},\n\t\t\tvalues: { type:\"string\" }\n\t\t}\n\t};\n\n\tfor(let i in formatHelpers){\n\t\tdefaultFormats[i] = 1;\n\t\tformatSources[i] = serializeFormat(formToValues(i, formatHelpers[i].values));\n\t\tformatCache[formatSources[i]] = i;\n\t}\n}\n\nexport function getDelimiters(type){\n\tif(type == \"price\")\n\t\treturn { groupSign:webix.i18n.priceSettings.groupDelimiter, decimalSign:webix.i18n.priceSettings.decimalDelimiter };\n\telse \n\t\treturn { groupSign:webix.i18n.groupDelimiter, decimalSign:webix.i18n.decimalDelimiter };\n}\n\nfunction serialize(view, data){\n\tconst formats = [];\n\n\tfor(let i in formatSources){\n\t\tif(!defaultFormats[i]) //exclude default formats\n\t\t\tformats.push([i,formatSources[i]]);\n\t}\n\tdata.formats = formats;\n}\n\nfunction load(view,data){\n\tvar i,\n\t\tformats = data.formats;\n\n\tif(formats)\n\t\tfor(i = 0; i < formats.length; i++)\n\t\t\tcreateFormatName(formats[i][1],formats[i][0]);\n}\n\nexport function getFormat(name){\n\treturn formatHelpers[name] ? formatHelpers[name].getFormat : formatHelpers[name];\n}\n\nexport function getFormatSource(name, toexcel){\n\tif(toexcel){\n\t\tlet parsed = parseFormat({values: formatHelpers[name].values, format: formatSources[name]});\n\t\treturn serializeFormat(parsed, true);\n\t}\n\telse\n\t\treturn formatSources[name];\n}\n\nfunction createFormatName(str, values){\n\tif (formatCache[str]) return formatCache[str];\n\n\tlet name = typeof(values) == \"object\" ? \"fmt\"+(formatsCount) : values;\n\tformatsCount++;\n\n\tformats[name] = str;\n\n\tif(typeof(values) == \"string\")\n\t\tvalues = formatToForm(str);\n\n\twebix.extend(\n\t\tvalues,\n\t\tgetDelimiters(\"custom\")\n\t);\n\n\tformatHelpers[name] = {\n\t\tgetFormat:format2code(str, {decimalSign: values.decimalSign, groupSign: values.groupSign}),\n\t\tvalues: values\n\t};\n\n\tformatSources[name] = str;\n\tformatCache[str] = name;\n\n\treturn name;\n}\n\nexport function addFormat(view, row, column, format, type){\n\tif(!type)\n\t\ttype = {format:format, type: \"custom\"};\n\tconst old = view.getStyle(row, column);\n\tconst nev = addStyle(view, { format:createFormatName(format, type) }, old);\n\tview.setStyle(row, column, nev);\n}\n\nexport function removeFormat(view, row, column){\n\tconst old = view.getStyle(row, column);\n\tconst nev = addStyle(view, { format:\"\" }, old);\n\tview.setStyle(row, column, nev);\n}\n\nfunction splitFormat(str){\n\tvar conditional = str.match(/.*\\[[><=].*/g);\n\tvar parts = str.split(\";\");\n\tif (!conditional){\n\t\tif (parts.length > 1){\n\t\t\tparts[0] = (parts.length > 2 ? \"[>0]\" : \"[>=0]\")+parts[0];\n\t\t\tparts[1] = \"[<0]\"+parts[1];\n\t\t\tif (parts[2])\n\t\t\t\tparts[2] = \"[=0]\"+parts[2];\n\t\t}\n\t}\n\treturn parts;\n}\n\nexport function format2code(str, delimiters){\n\tconst errorMessage = webix.i18n.spreadsheet.table[\"format-error\"];\n\tlet parts = splitFormat(str);\n\tlet code = [\"var spaces = \\\"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\\\";\"];\n\tfor (var i=0; i<parts.length; i++){\n\t\tvar separated = separateFmt(parts[i]);\n\t\tcode.push(genCode(separated.condition, separated.color.toLowerCase(), separated.symbol, separated.fmt, i, parts.length > 0, delimiters));\n\t}\n\n\tlet method;\n\ttry {\n\t\tmethod = new Function(\"val\",\"extra\", `try{ ${code.join(\"\\n\")} return val; } catch(err) { return \"${errorMessage}\"; }`);\n\t}\n\tcatch(err){\n\t\tmethod = function(){return errorMessage;};\n\t}\n\treturn method;\n}\n\nfunction genCode(check, color, symbol, line, ind, isAbs, delimiters){\n\tvar str = \"\";\n\tif (check){\n\t\tif (!ind) str+=\"if\"; else str+=\"else if\";\n\t\tif (check[0] === \"=\") check = \"=\"+check;\n\t\tstr+=\"(val\"+check+\"){\";\n\t\tif (isAbs) str+=\"val = Math.abs(val);\";\n\t}\n\tif (color)\n\t\tstr+=\"extra.css = \\\"webix_ssheet_format_\"+color+\"\\\";\";\n\n\tstr += genFormatCode(line, delimiters, symbol);\n\n\treturn str+(check?\"}\":\"\");\n}\n\nconst dateTypes = {\n\t\"yy\": \"%y\",\n\t\"yyyy\": \"%Y\",\n\t\"m\": \"%n\",\n\t\"mm\": \"%m\",\n\t\"mmm\": \"%M\",\n\t\"mmmm\": \"%F\",\n\t\"mmmmm\":\"%F\", //not supported by webix\n\t\"d\": \"%j\",\n\t\"dd\": \"%d\",\n\t\"ddd\": \"%D\",\n\t\"dddd\": \"%l\"\n};\n\nconst timeTypes = {\n\t\"h\": \"%G\",\n\t\"hh\": \"%H\",\n\t\"m\": \"%i\", //not supported by webix\n\t\"mm\": \"%i\",\n\t\"s\": \"%s\", //not supported by webix\n\t\"ss\": \"%s\",\n\t\"AM/PM\": \"%A\"\n};\n\nconst dateOrder = Object.keys(dateTypes).sort((a, b) => b.length - a.length);\nconst timeOrder = Object.keys(timeTypes).sort((a, b) => b.length - a.length);\n\nfunction excelDateToWebix(text, lastDateType){\n\tconst typesOrder = [\n\t\t{name:\"date\", order:dateOrder, types:dateTypes}, \n\t\t{name:\"time\", order:timeOrder, types:timeTypes}\n\t];\n\n\t// \"m\"/\"mm\" format can be either date (%n/%m) or time (%i), so check last date type\n\tconst basedOnLast = /^m{1,2}(?!m)/.test(text);\n\tif(basedOnLast && lastDateType != \"date\")\n\t\ttypesOrder.reverse();\n\n\tfor(let i = 0; i < typesOrder.length; i++){\n\t\tconst type = typesOrder[i];\n\t\tfor(let j = 0; j < type.order.length; j++)\n\t\t\tif(text.indexOf(type.order[j]) == 0)\n\t\t\t\treturn {\n\t\t\t\t\tformat: type.types[type.order[j]],\n\t\t\t\t\tlength: type.order[j].length,\n\t\t\t\t\ttype: type.name\n\t\t\t\t};\n\t}\n}\n\nfunction genFormatCode(line, delimiters, symbol){\n\tif (!line)\n\t\treturn \"return val;\";\n\n\tlet str = \"return \\\"\\\"\";\n\n\tlet isQuote;\n\tlet fmt = \"\";\n\tlet multiply = 1;\n\tlet comma, numberPlaceholder, textPlaceholder;\n\tlet date = [];\n\tlet lastDateType = \"date\";\n\n\tlet symbolPos;\n\tif(symbol){\n\t\tconst currency = arr.find(currencies, val => val.id == symbol);\n\t\tsymbolPos = \"left\";\n\n\t\tif(currency)\n\t\t\tsymbolPos = arr.findIndex(currency.format.split(\"{obj}\"), val => val) ? \"right\" : \"left\";\n\t}\n\n\tfor (var i=0; i<line.length; i++){\n\t\tvar betweenPlaceholders = placeholder(line[i-1])&&placeholder(line[i+1]);\n\t\tif (line[i] == \"\\\"\"){\n\t\t\tif(webix.isUndefined(isQuote))\n\t\t\t\tisQuote = i;\n\t\t\telse {\n\t\t\t\tstr += `+\"${line.substr(isQuote+1, i-isQuote-1)}\"`;\n\t\t\t\tisQuote = undefined;\n\t\t\t}\n\t\t\tcontinue;\n\t\t}\n\t\tif (!webix.isUndefined(isQuote))\n\t\t\tcontinue;\n\t\tif(line[i] == \"%\")\n\t\t\tmultiply = multiply*100;\n\n\t\tif(/[a-zA-Z]/.test(line[i])){\n\t\t\tconst datePart = excelDateToWebix(line.substr(i), lastDateType);\n\t\t\tif(datePart){\n\t\t\t\tif(numberPlaceholder || textPlaceholder)\n\t\t\t\t\treturn \"throw \\\"unexpected number placeholder\\\";\";\n\t\t\t\tdate.push(datePart.format);\n\t\t\t\tstr += \"/*date*/\"; //update this value after date format is ready\n\t\t\t\tlastDateType = datePart.type;\n\t\t\t\ti += datePart.length-1;\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\telse\n\t\t\t\tstr += `+\"${line[i]}\"`;\n\t\t}\n\t\telse if (line[i] === delimiters.decimalSign && betweenPlaceholders){\n\t\t\tfmt+= delimiters.decimalSign;\n\t\t}\n\t\telse if(line[i]==\"@\"){\n\t\t\tif(numberPlaceholder || date.length)\n\t\t\t\treturn \"throw \\\"unexpected number placeholder\\\";\";\n\t\t\tif(!textPlaceholder){\n\t\t\t\tstr+=\"+fmt\";\n\t\t\t\ttextPlaceholder = true;\n\t\t\t}\n\t\t\tfmt+=line[i];\t\t\n\t\t}\n\t\telse if (placeholder(line[i])){\n\t\t\tif(textPlaceholder || date.length)\n\t\t\t\treturn \"throw \\\"unexpected text placeholder\\\";\";\n\t\t\tif (!numberPlaceholder) {\n\t\t\t\tif(symbolPos == \"left\")\n\t\t\t\t\tstr += `+\"${symbol}\"`;\n\t\t\t\tstr+=\"+fmt\";\n\t\t\t\tif(symbolPos == \"right\")\n\t\t\t\t\tstr += `+\"${symbol}\"`;\n\t\t\t\tnumberPlaceholder=true;\n\t\t\t}\n\t\t\tfmt+=line[i];\n\t\t}\n\t\telse if (line[i] === delimiters.groupSign && betweenPlaceholders)\n\t\t\tcomma = true;\n\t\telse\n\t\t\tstr += `+\"${line[i]}\"`;\n\t}\n\n\tif(date.length){\n\t\t// 12-hour or 24-hour clock depends on AM/PM in format\n\t\tif(date.indexOf(\"%A\") != -1)\n\t\t\tdate = date.map(datePart => {\n\t\t\t\tswitch(datePart){\n\t\t\t\t\tcase \"%G\": return \"%g\";\n\t\t\t\t\tcase \"%H\": return \"%h\";\n\t\t\t\t\tdefault: return datePart;\n\t\t\t\t}\n\t\t\t});\n\n\t\tfor(let i = 0; i < date.length; i++)\n\t\t\tstr = str.replace(\"/*date*/\", `+dateParts[${i}]`);\n\t}\n\n\treturn `\n\t\t${date.length ? `val = (${getJsDateFromExcel})(val); var dateParts = webix.Date.dateToStr(\"${date.join(\";\")}\")(val).split(\";\");` : \"\"}\n\t\t${fmt ? `${numberFormat(fmt, comma, delimiters, multiply)};` : \"\"}\n\t\t${str};`;\n}\n\nfunction numberFormat(fmt, comma, delimiters, multiply){\n\tvar str = `if(/^@+$/.test(\"${fmt}\") || isNaN(val)){ var fmt = val; }else {`;\n\tvar decimal = delimiters.decimalSign;\n\tvar [left, right] = getParts(fmt, decimal);\n\tright = (right || \"\").split(\"\").reverse().join(\"\");\n\n\t//calculate indexes in mask\n\tvar lzeros = left.indexOf(\"0\"); if (lzeros>=0) lzeros = left.length - lzeros;\n\tvar lfills = left.indexOf(\"?\"); if (lfills>=0) lfills = left.length - lfills;\n\tvar rzeros = right.indexOf(\"0\"); if (rzeros>=0) rzeros = right.length - rzeros;\n\tvar rfills = right.indexOf(\"?\"); if (rfills>=0) rfills = right.length - rfills;\n\tvar rmax = right.length;\n\n\tstr += `\n\tval = val*${multiply};\n\tvar parts = val.toFixed(${rmax}).split(\".\");\n\tvar left = parts[0];\n\tvar lsize = left.length; \n\tvar right = parts[1] || \"\";\n\tif (left.length < ${lzeros}) left = \"0000000000\".substr(0, ${lzeros} - left.length)+left;\n\tif (left.length < ${lfills}) left = spaces.substr(0, 6*(${lfills} - left.length))+left;\n\tif (${comma}) {\n\t\tvar buf = [];\n\t\tvar start = 3;\n\t\twhile (lsize > start) { buf.push(left.substr(left.length-start,3)); start+=3; }\n\t\tvar last = left.substr(0,left.length-start+3);\n\t\tif (last !== \"-\")\n\t\t\tbuf.push(last);\n\t\telse\n\t\t\tbuf.push(\"-\"+buf.pop());\n\n\t\tleft = buf.reverse().join(\"${delimiters.groupSign}\");\n\t}\n\tif (right){\n\t\tvar zpoint = right.length-1;\n\t\twhile (zpoint >= ${rzeros}){\n\t\t\tif (right[zpoint] !== \"0\"){\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tzpoint--;\n\t\t}\n\n\t\tif (zpoint <= right.length)\n\t\t\tright = right.substr(0, zpoint+1);\n\n\t\tif (right.length < ${rfills}){\n\t\t\tright += spaces.substr(0, 6*(${rfills} - right.length));\n\t\t}\n\t}\n\tvar fmt = left+(right?\"${decimal}\":\"\")+right;\n\t`;\n\n\treturn str+\"}\\n\";\n}\n\nfunction updateDecimals(fmt, inc, val){\n\tlet parsed = parseFormat(fmt);\n\tfor(let i = 0; i < parsed.length; i++){\n\t\tif(parsed[i].decimals){\n\t\t\tif(inc>0)\n\t\t\t\tparsed[i].right.placeholders += Array(inc+1).join(\"0\");\n\t\t\telse\n\t\t\t\tparsed[i].right.placeholders = parsed[i].right.placeholders.slice(0, inc);\n\t\t}\n\t\telse{\n\t\t\tconst withoutText = !parsed[i].left.text && !parsed[i].right.text;\n\t\t\tconst withoutPlaceholders = !parsed[i].left.placeholders && !parsed[i].right.placeholders;\n\t\t\t//check if cell value have decimals (not cell format)\n\t\t\tif(inc < 0 && withoutText && withoutPlaceholders && webix.rules.isNumber(val) && val.indexOf(\".\") > -1){\n\t\t\t\tparsed[i].left.placeholders = \"0\";\n\t\t\t\tparsed[i].right.placeholders = Array(val.split(\".\")[1].length).join(Array(inc+1).join(\"0\"));\n\t\t\t}\n\t\t\t//ignore text\n\t\t\telse if(inc > 0 && (parsed[i].left.placeholders || withoutText)){\n\t\t\t\tparsed[i].left.placeholders = parsed[i].left.placeholders || \"0\";\n\t\t\t\tparsed[i].right.placeholders = Array(inc+1).join(\"0\");\n\t\t\t\tparsed[i].decimals = true;\n\t\t\t}\n\t\t}\n\t\tparsed[i].decimals = parsed[i].right.placeholders.length > 0;\n\t}\n\n\treturn serializeFormat(parsed);\n}\n\nexport function changeAreaDecimals(view, inc, row, column){\n\tlet cells = getCells(view, row, column);\n\tif(cells.length == 0)\n\t\treturn;\n\n\tconst obj = view._mPage.getCell(cells[0].row-1, cells[0].column-1);\n\tconst oldFormat = obj && obj.format;\n\tconst value = (obj && obj.value) ? obj.value.toString() : \"\";\n\t\n\tif(webix.rules.isNumber(value) || oldFormat){\n\t\tgroup.set(function(){\n\t\t\tfor(let i = 0; i < cells.length; i++)\n\t\t\t\tchangeCellDecimals(view, inc, cells[i]);\n\t\t});\n\t\tview.refresh();\n\n\t\tlet format = getFormatName(view, cells[0].row, cells[0].column) || \"common\";\n\t\tformat = isCustom(format) ? \"custom\" : format;\n\t\tview.callEvent(\"onCommand\", [{id:\"toolbar-update\", name:\"format\", value:format}]);\n\t}\n}\n\nexport function changeCellDecimals(view, inc, cell){\n\tlet format;\n\tconst obj = view._mPage.getCell(cell.row-1, cell.column-1);\n\tconst oldFormat = obj && obj.format;\n\tconst value = (obj && obj.value) ? obj.value.toString() : \"\";\n\n\tif(oldFormat){\n\t\tformat = webix.copy({values:formatHelpers[oldFormat].values, format:getFormatSource(oldFormat)});\n\t\tformat.format = updateDecimals(format, inc, value);\n\n\t\tif(format.values && format.values.hasOwnProperty(\"zeros\"))\n\t\t\tformat.values.zeros = Math.max(format.values.zeros+inc, 0);\n\t}\n\t//add format for cell without format\n\telse{\n\t\tconst zeros = webix.rules.isNumber(value) && value.split(\".\")[1] ? Math.max(value.split(\".\")[1].length+inc, 0) : Math.max(inc, 0);\n\n\t\tformat = {values:{negative:1, zeros:zeros, separator:0, type:\"int\"}};\n\t\tformat.format = serializeFormat(formToValues(format.values.type, format.values));\n\t}\n\taddFormat(view, cell.row, cell.column, format.format, format.values);\n}\n\nexport function isCustom(name){\n\treturn !defaultFormats[name];\n}\n\nexport function formToValues(type, formValues){\n\tif(type == \"string\")\n\t\treturn [{left:{text:\"@\"}}];\n\tif(formValues.date)\n\t\treturn [{left:{text:formValues.date}}];\n\n\tlet values = [{condition:\">=0\", left:{text:\"\"},right:{text:\"\"}}, {condition:\"<0\", left:{text:\"\"}, right:{text:\"\"}}];\n\twebix.extend(values, getDelimiters(type));\n\tvalues[0].right.placeholders = values[1].right.placeholders = formValues.zeros ? Array(formValues.zeros + 1).join(\"0\") : \"\";\n\tvalues[0].separator = values[1].separator = formValues.separator && type != \"percent\";\n\tvalues[0].left.placeholders = values[1].left.placeholders = values[0].separator ? \"#\"+values.groupSign +\"0\" : \"0\";\n\tvalues[0].decimals = values[1].decimals = formValues.zeros ? true : false;\n\tvalues[1].color = formValues.negative != 1 ? \"red\" : \"\";\n\tvalues[1].left.text += formValues.negative < 3 ? \"-\" : \"\";\n\tif(formValues.negative == 4)\n\t\tvalues[1].left.text += \"(\";\n\n\tif(type === \"percent\")\n\t\tvalues[0].right.text = values[1].right.text += \"%\";\n\telse if(type === \"price\"){\n\t\tconst symbolId = formValues.symbol;\n\t\tconst currency = arr.find(currencies, val => val.id == symbolId);\n\t\tconst pos = arr.findIndex(currency.format.split(\"{obj}\"), val => val) ? \"right\" : \"left\";\n\n\t\tvalues[0][pos].symbol = values[1][pos].symbol = symbolId;\n\t}\n\n\tif(formValues.negative == 4)\n\t\tvalues[1].right.text += \")\";\n\n\treturn values;\n}\n\nfunction formatToForm(format){\n\tconst formatsLocale = webix.i18n.spreadsheet.formats;\n\tconst dates = [\n\t\tformatsLocale.dateFormat,\n\t\tformatsLocale.timeFormat,\n\t\tformatsLocale.fullDateFormat,\n\t\tformatsLocale.longDateFormat\n\t];\n\tconst form = {format, type:\"custom\"};\n\n\tif(arr.find(dates, date => date == format)){\n\t\twebix.extend(form, {\n\t\t\ttype:\"date\", date:format\n\t\t}, true);\n\t}\n\telse{\n\t\tlet [first, second] = format.split(\";\");\n\t\tif(first && second){\n\t\t\tif(first.indexOf(\"[>=0]\") == 0 && second.indexOf(\"[<0]\") == 0){\n\t\t\t\tfirst = first.replace(\"[>=0]\", \"\");\n\t\t\t\tsecond = second.replace(\"[<0]\", \"\");\n\n\t\t\t\tlet red;\n\t\t\t\tif(second.indexOf(\"[red]\") == 0){\n\t\t\t\t\tsecond = second.replace(\"[red]\", \"\");\n\t\t\t\t\tred = true;\n\t\t\t\t}\n\n\t\t\t\tif(second[0] == \"-\"){\n\t\t\t\t\tsecond = second.substring(1);\n\t\t\t\t\tform.negative = red ? 2 : 1;\n\t\t\t\t}\n\t\t\t\telse if(red){\n\t\t\t\t\tif(second[0] == \"(\" && second[second.length-1] == \")\"){\n\t\t\t\t\t\tform.negative = 4;\n\t\t\t\t\t\tsecond = second.substring(1, second.length-1);\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t\tform.negative = 3;\n\t\t\t\t}\n\n\t\t\t\tif(form.negative && first == second){\n\t\t\t\t\tlet type = \"int\";\n\t\t\t\t\tlet priceBrackets = first.indexOf(\"[$\") != -1;\n\n\t\t\t\t\tif(first[first.length-1] == \"%\"){\n\t\t\t\t\t\tfirst = first.substring(0, first.length-1);\n\t\t\t\t\t\ttype = \"percent\";\n\t\t\t\t\t}\n\t\t\t\t\telse{\n\t\t\t\t\t\tfor(let i = 0; i < currencies.length; i++){\n\t\t\t\t\t\t\tconst currency = currencies[i].id;\n\t\t\t\t\t\t\tlet isPrice;\n\n\t\t\t\t\t\t\tif(priceBrackets){\n\t\t\t\t\t\t\t\tif(first.indexOf(`[$${currency}]`) != -1){\n\t\t\t\t\t\t\t\t\tfirst = first.replace(`[$${currency}]`, \"\");\n\t\t\t\t\t\t\t\t\tisPrice = true;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\telse if(first.indexOf(currency) != -1){\n\t\t\t\t\t\t\t\tfirst = first.replace(currency, \"\");\n\t\t\t\t\t\t\t\tisPrice = true;\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tif(isPrice){\n\t\t\t\t\t\t\t\ttype = \"price\";\n\t\t\t\t\t\t\t\tform.symbol = currency;\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\tconst delimiters = getDelimiters(type);\n\n\t\t\t\t\tif(first.indexOf(\"#\"+delimiters.groupSign) == 0){\n\t\t\t\t\t\tfirst = first.replace(\"#\"+delimiters.groupSign, \"\");\n\t\t\t\t\t\tform.separator = 1;\n\t\t\t\t\t}\n\n\t\t\t\t\tconst [integer, decimal] = first.split(delimiters.decimalSign);\n\t\t\t\t\tif((!integer || integer == \"0\") && (!decimal || /^[0]+$/.test(decimal))){\n\t\t\t\t\t\tform.type = type;\n\t\t\t\t\t\tform.delimiters = delimiters;\n\t\t\t\t\t\tform.zeros = decimal ? decimal.length : 0;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\treturn form;\n}\n\nexport function serializeFormat(values, toExcel){\n\tlet fmt = \"\";\n\tfor(let i = 0; i < values.length; i++){\n\t\tif(values[i].condition)\n\t\t\tfmt += \"[\"+values[i].condition+\"]\";\n\t\tif(values[i].color)\n\t\t\tfmt += \"[\"+values[i].color+\"]\";\n\n\t\tif(values[i].left){\n\t\t\tif(values[i].left.text){\n\t\t\t\tlet leftText = values[i].left.text;\n\t\t\t\tfmt += leftText;\n\t\t\t}\n\t\t\tif(values[i].left.symbol)\n\t\t\t\tfmt += \"[$\"+values[i].left.symbol+\"]\";\n\t\t\tif(values[i].left.placeholders){\n\t\t\t\tlet leftPlaceholders = values[i].left.placeholders;\n\t\t\t\tfmt += toExcel ? leftPlaceholders.replace(values.groupSign, \",\") : leftPlaceholders;\n\t\t\t}\n\t\t}\n\n\t\tif(values[i].decimals)\n\t\t\tfmt += toExcel ? \".\" : values.decimalSign;\n\n\t\tif(values[i].right){\n\t\t\tif(values[i].right.placeholders)\n\t\t\t\tfmt += values[i].right.placeholders;\n\t\t\tif(values[i].right.symbol)\n\t\t\t\tfmt += \"[$\"+values[i].right.symbol+\"]\";\n\t\t\tif(values[i].right.text){\n\t\t\t\tlet rightText = values[i].right.text;\n\n\t\t\t\tfmt += rightText;\n\t\t\t}\n\t\t}\n\t\tif(i != values.length - 1)\n\t\t\tfmt += \";\";\n\t}\n\treturn fmt;\n}\n\nfunction parseFormat(fmt){\n\tconst fmtParts = fmt.format.split(\";\");\n\tlet values = [];\n\n\tfor(let i = 0; i < fmtParts.length; i++){\n\t\tlet separated = separateFmt(fmtParts[i]);\n\t\tvalues[i] = {color:separated.color, condition:separated.condition ,left:{}, right:{}};\n\n\t\tconst format = separated.fmt;\n\n\t\tvalues.groupSign = fmt.values.groupSign;\n\t\tvalues.decimalSign = fmt.values.decimalSign;\n\n\t\tif(format.indexOf(values.groupSign) > -1)\n\t\t\tvalues[i].separator = true;\n\n\t\tconst sepFmtParts = getParts(format, values.decimalSign);\n\n\t\tlet left = sepFmtParts[0];\n\t\tlet right = sepFmtParts[1] || \"\";\n\n\t\tif(sepFmtParts[1])\n\t\t\tvalues[i].decimals = true;\n\n\t\tleft = getFmtPartValues(left, \"left\", values.groupSign);\n\t\tright = getFmtPartValues(right, \"right\", values.groupSign);\n\n\t\tvalues[i].left = {\n\t\t\ttext: left.leftText,\n\t\t\tplaceholders: left.placeholders\n\t\t};\n\n\t\tvalues[i].right = {\n\t\t\ttext: left.rightText + right.rightText,\n\t\t\tplaceholders: right.placeholders\n\t\t};\n\n\t\tconst symbol = separated.symbol;\n\t\tif(symbol){\n\t\t\tconst currency = arr.find(currencies, val => val.id == symbol);\n\t\t\tlet pos = \"left\";\n\n\t\t\tif(currency)\n\t\t\t\tpos = arr.findIndex(currency.format.split(\"{obj}\"), val => val) ? \"right\" : \"left\";\n\n\t\t\tvalues[i][pos].symbol = symbol;\n\t\t}\n\t}\n\treturn values;\n}\n\nfunction getFmtPartValues(fmtPart, type, groupSign){\n\tlet firstPlaceholder;\n\tif(type == \"left\"){\n\t\tfirstPlaceholder = fmtPart.match(/[#?0]/);\n\t\tfirstPlaceholder = firstPlaceholder ? firstPlaceholder.index : Infinity;\n\t}\n\n\tlet leftText = \"\";\n\tlet rightText = \"\";\n\tlet placeholders = \"\";\n\tfor(let k = 0; k < fmtPart.length; k++){\n\t\tif(!placeholder(fmtPart[k])){\n\t\t\tif(fmtPart[k] == groupSign && placeholder(fmtPart[k+1]) && placeholder(fmtPart[k-1])){\n\t\t\t\tplaceholders += fmtPart[k];\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\tif(type == \"left\")\n\t\t\t\tif(k < firstPlaceholder){\n\t\t\t\t\tleftText += fmtPart[k];\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\t\t\trightText += fmtPart[k];\n\t\t}\n\t\telse\n\t\t\tplaceholders += fmtPart[k];\n\t}\n\treturn {leftText: leftText, rightText: rightText, placeholders: placeholders};\n}\n\nfunction separateFmt(line){\n\tlet color = \"\";\n\tlet check = \"\";\n\tlet symbol = \"\";\n\n\tlet start = line.indexOf(\"[\");\n\tif (start != -1){\n\t\tif (line[1].match(/[><=]/)){\n\t\t\tlet end = line.indexOf(\"]\");\n\t\t\tcheck = line.substr(start+1, end-start-1);\n\t\t\tline = line.substr(end+1);\n\t\t}\n\t}\n\n\tstart = line.indexOf(\"[$\");\n\tif(start != -1){\n\t\tlet end = start + line.substr(start).indexOf(\"]\");\n\t\tsymbol = line.substr(start+2, end-start-2);\n\t\tline = line.substr(0, start)+line.substr(end+1);\n\t}\n\n\tstart = line.indexOf(\"[\");\n\tif (start != -1){\n\t\tlet end = line.indexOf(\"]\");\n\t\tcolor = line.substr(start+1, end-start-1);\n\t\tline = line.substr(end+1);\n\t}\n\treturn {condition:check, color, symbol, fmt:line};\n}\n\nfunction getCells(view, row, column){\n\tif(row && column){\n\t\tif (typeof row === \"object\" && typeof column === \"object\"){\n\t\t\tlet cells = [];\n\t\t\tfor (let r = row.row; r<=column.row; r++)\n\t\t\t\tfor (let c = row.column; c<=column.column; c++)\n\t\t\t\t\tcells.push({row: r, column: c});\n\t\t\treturn cells;\n\t\t}\n\t\telse\n\t\t\treturn [{row: row, column: column}];\n\t}\n\telse\n\t\treturn view.getSelectedId(true);\n}\n\nfunction placeholder(val){\n\treturn val === \"0\" || val === \"#\" || val === \"?\";\n}\n\nfunction getParts(str, decimal){\n\t// it is nessesary to use \"/\" before decimal to escape regex special characters\n\tconst match = str.match(\"[#?0][/\"+decimal+\"][#?0]\");\n\tif(match)\n\t\treturn [str.substring(0, match.index+1), str.substring(match.index+2)];\n\telse\n\t\treturn [str];\n}\n\n//simple check: take into account only first condition\nexport function checkFormat(format, type, checkTime){\n\tformat = format && format.fmt ? format.fmt : getFormatSource(format);\n\tif(!format) return;\n\tconst parts = splitFormat(format);\n\tconst separated = separateFmt(parts[0]).fmt;\n\n\tlet quot;\n\tif(separated)\n\t\tfor(let i = 0; i < separated.length; i++){\n\t\t\tif(separated[i] == \"\\\"\")\n\t\t\t\tquot = !quot;\n\t\t\tif(quot) continue;\n\n\t\t\tif(type == \"date\" && /[a-zA-Z]/.test(separated)){\n\t\t\t\tconst datePart = excelDateToWebix(separated.substr(i), \"date\");\n\t\t\t\tif(datePart){\n\t\t\t\t\tif(checkTime){\n\t\t\t\t\t\tif(datePart.type == \"time\")\n\t\t\t\t\t\t\treturn true;\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t\treturn true;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif(type == \"string\" && separated[i] == \"@\")\n\t\t\t\treturn true;\n\t\t}\n}\n\nexport function getFormatName(view, row, col){\n\tconst item = view._mPage.getCell(row-1, col-1);\n\treturn (item && item.format) || null;\n}\n\nexport function isDateInvalid(value){\n\treturn value < -99974430.925 || value > 100025569.125;\n}\n\nexport function getDateEditFormat(view, row, col){\n\tconst formatName = getFormatName(view, row, col);\n\tconst locale = webix.i18n.spreadsheet.formats;\n\tconst isTime = checkFormat(formatName, \"date\", true);\n\n\treturn webix.Date.dateToStr( locale[isTime ? \"parseDateTime\" : \"parseDate\"] );\n}\n\nexport function getFormatFromData(data, array){\n\tconst styleName = array[3];\n\tlet fmt;\n\tif(styleName){\n\t\tlet style = arr.find(data.styles, arr => arr[0] == styleName);\n\t\tif(style){\n\t\t\tstyle = style[1];\n\t\t\tconst fmtName = styleFromText(style).format;\n\t\t\tif(fmtName){\n\t\t\t\tif(data.formats)\n\t\t\t\t\tfmt = arr.find(data.formats, arr => arr[0] == fmtName);\n\n\t\t\t\tif(fmt)\n\t\t\t\t\tfmt = fmt[1];\n\t\t\t\telse\n\t\t\t\t\tfmt = getFormatSource(fmtName); //default formats (int, percent, etc.)\n\t\t\t}\n\t\t}\n\t}\n\treturn fmt;\n}","import {getFormatName, getFormatSource} from \"../operations/formats\";\n\nexport function isChar(char) {\n\tconst code = char.charCodeAt(0);\n\treturn code <= 122 ? code >= 65 || code === 35 || code === 36 : code > 191;\n}\n\nexport function getLastCharIndex(str, includeNumbers){\n\tlet lastChar = str.length;\n\tfor(let i = lastChar - 1; i >= 0; i--){\n\t\tif(!isChar(str[i])){\n\t\t\tif(includeNumbers && isNumber(str[i]))\n\t\t\t\tcontinue;\n\t\t\treturn lastChar;\n\t\t}\n\t\telse\n\t\t\tlastChar = i;\n\t}\n}\n\nfunction isNumber(char){\n\tvar code = char.charCodeAt(0);\n\treturn code>=48 && code<=57;\n}\n\nfunction getWord(formula, i){\n\tlet sheet = \"\";\n\tlet quotes = false;\n\n\tlet j;\n\tfor(j=i; j<formula.length; j++){\n\t\tconst key =  formula[j];\n\t\tif (key === \"'\"){\n\t\t\tquotes = !quotes;\n\t\t\tcontinue;\n\t\t}\n\n\t\tif (!quotes){\n\t\t\tif (key == \"!\"){\n\t\t\t\tif(formula[i] == \"#\") //error\n\t\t\t\t\tcontinue;\n\t\t\t\telse{\n\t\t\t\t\t//multi-sheet math\n\t\t\t\t\tsheet = formula.substr(i, j-i);\n\t\t\t\t\tif (sheet[0] === \"'\")\n\t\t\t\t\t\tsheet = sheet.substr(1, sheet.length-2);\n\t\t\t\t\ti=j+1;\n\t\t\t\t}\n\t\t\t}\n\t\t\telse if (!isChar(key) && !isNumber(key)){\n\t\t\t\treturn [formula.substr(i, j-i), j, i, sheet];\n\t\t\t}\n\t\t}\n\t}\n\n\treturn [formula.substr(i), j, i, sheet];\n}\n\nvar operand = /^[A-Z$]+[0-9]+$/;\nfunction isPosition(text){\n\treturn operand.test(text);\n}\n\nexport function position(word){\n\tvar row = 0, sum = 0, x = 1, mode = 1, flags = 0;  \n\tvar chars = false;\n\n\tfor (var j =word.length-1; j>=0; j--){\n\t\tvar key = word[j].charCodeAt(0);\n\t\tif (key === 36) {\n\t\t\tflags = flags+mode;\n\t\t\tcontinue;\n\t\t}\n\n\t\tif (key < 58){\n\t\t\t//numeric\n\t\t\tsum += (key - 48)*x;\n\t\t\tx *= 10;\n\t\t} else {\n\t\t\tif (!chars){\n\t\t\t\tx = 1; row = sum; sum = 0; chars = true; mode += 1;\n\t\t\t}\n\t\t\t//alpha\n\t\t\tsum += (key - 64)*x;\n\t\t\tx*=26;\n\t\t}\n\t}\n\n\t/*\n\t\t$X$Y => flags = 3\n\t\t$XY  => flags = 2\n\t\tX$Y  => flags = 1\n\t\tXY   => flags = 0\n\t*/\n\treturn [row, sum, flags];\n}\n\nexport function split(formula, view, crosssheet, fromSheet){\n\tconst activeSheet = view.getActiveSheet();\n\tvar lines = [];\n\tvar index = 0;\n\tvar quotes = false, ph = false;\n\tfor (var i = formula[i] === \"=\" ? 1 : 0; i < formula.length; i++){\n\t\tvar key = formula[i];\n\t\tif (key == \"\\\"\"){\n\t\t\tquotes = !quotes;\n\t\t} else if (!quotes){\n\t\t\tif (key == \"{\" && formula[i+1] == \"{\"){\n\t\t\t\tph = true;\n\t\t\t} else if (key == \"}\" && formula[i+1] == \"}\"){\n\t\t\t\tph = false;\n\t\t\t} else if (!ph){\n\t\t\t\tconst escaped = key === \"'\";\n\t\t\t\tif (escaped || isChar(key)){\n\t\t\t\t\tlet [word, end, ,sheet] = getWord(formula, i);\n\t\t\t\t\tlet next = end - 1;\n\t\t\t\t\tlet value;\n\n\t\t\t\t\tif(formula[next+1] !== \"(\"){\n\t\t\t\t\t\tif(isPosition(word)){\n\t\t\t\t\t\t\tif(!sheet || sheet == activeSheet || crosssheet){\n\t\t\t\t\t\t\t\tvalue = sheet ? [sheet, word, escaped] : word;\n\t\t\t\t\t\t\t\tpushLine(lines, formula, i, index, value);\n\t\t\t\t\t\t\t\tindex = next+1;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse{\n\t\t\t\t\t\t\tif(crosssheet){\n\t\t\t\t\t\t\t\tvalue = sheet ? [sheet, word, escaped] : word;\n\t\t\t\t\t\t\t\tpushLine(lines, formula, i, index, value);\n\t\t\t\t\t\t\t\tindex = next+1;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\telse{\n\t\t\t\t\t\t\t\t//specified sheet or active sheet (if not specified) range\n\t\t\t\t\t\t\t\tlet range = view.ranges.getCode(word, sheet || fromSheet);\n\n\t\t\t\t\t\t\t\t//global range\n\t\t\t\t\t\t\t\tif(!range)\n\t\t\t\t\t\t\t\t\trange = view.ranges.getCode(word, true);\n\n\t\t\t\t\t\t\t\tif(range){\n\t\t\t\t\t\t\t\t\tconst parts = range.split(\"!\");\n\t\t\t\t\t\t\t\t\tif(parts[0] == activeSheet){\n\t\t\t\t\t\t\t\t\t\tvalue = [sheet, word, escaped, parts[1]];\n\t\t\t\t\t\t\t\t\t\tpushLine(lines, formula, i, index, value);\n\t\t\t\t\t\t\t\t\t\tindex = next+1;\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\ti = next;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tif (index!=formula.length)\n\t\tlines.push(formula.substr(index));\n\treturn lines;\n}\n\nfunction pushLine(lines, formula, i, index, value){\n\tif (i!==0)\n\t\tlines.push(formula.substr(index, i-index));\n\tlines.push(value);\n}\n\nexport function getMathFormat(view, value){\n\tlet level = 0;\n\tlet blockLevel;\n\n\tconst parts = split(value, view);\n\n\tfor(let i = 0; i < parts.length; i++){\n\t\t// parts[i] can contain numbers, math operators, formulas, etc.\n\t\tif(i%2 === 0){\n\t\t\t// check formulas and round brackets which are not in quotes\n\t\t\tconst methods = parts[i].match(/(([a-zA-Z]*\\()|\\))(?=(?:[^\"]|\"[^\"]*\")*$)/g);\n\t\t\tif(methods)\n\t\t\t\tmethods.forEach(part => {\n\t\t\t\t\tif(part.indexOf(\"(\") > -1){\n\t\t\t\t\t\tlevel++;\n\t\t\t\t\t\t// some methods block format addition (like count,odd,etc.)\n\t\t\t\t\t\tconst safeMethods = /^(SUM|AVERAGE|MAX|MIN|INT|ROUND|ROUNDDOWN|ROUNDUP|TRUNC)?\\($/gi;\n\t\t\t\t\t\tif(!blockLevel && !safeMethods.test(part))\n\t\t\t\t\t\t\tblockLevel = level;\n\t\t\t\t\t}\n\t\t\t\t\telse if(--level < blockLevel)\n\t\t\t\t\t\tblockLevel = null;\n\t\t\t\t});\n\t\t}\n\t\t// parts[i] can be named range, cell from the active / non-active sheet\n\t\telse if(!blockLevel){\n\t\t\tif(webix.isArray(parts[i])){\n\t\t\t\tif(/^[A-Za-z]+$/.test(parts[i][1]))\n\t\t\t\t\tparts[i] = parts[i][3].split(\":\")[0];\n\t\t\t\telse if(parts[i][0] == view.getActiveSheet())\n\t\t\t\t\tparts[i] = parts[i][1];\n\t\t\t\telse\n\t\t\t\t\tcontinue; // ignore non-active sheets\n\t\t\t}\n\n\t\t\t// if range - check first cell position\n\t\t\tconst cell = position(parts[i]);\n\t\t\tconst name = getFormatName(view, cell[0], cell[1]);\n\n\t\t\t// first cell with number format\n\t\t\tif(name)\n\t\t\t\treturn {fmt: getFormatSource(name)};\n\t\t}\n\t}\n}","import {getFormatName, checkFormat, isDateInvalid, getFormatFromData, getFormatSource} from \"./formats\";\nimport {getExcelDateFromJs} from \"../mathematics/methods\";\nimport {getMathFormat} from \"../mathematics/parser\";\n\nexport function init(view){\n\tview.attachEvent(\"onCellChange\", function(row, col, value, page){\n\t\tif(page == this.getActiveSheet() && !this._setType){\n\t\t\tconst formatName = getFormatName(this, row, col);\n\t\t\tconst cell = {\n\t\t\t\trow,\n\t\t\t\tcol,\n\t\t\t\tvalue,\n\t\t\t\tfmt: formatName ? {fmt: getFormatSource(formatName)} : null\n\t\t\t};\n\t\t\tsetType(this, cell);\n\t\t}\n\t});\n\n\tview.attachEvent(\"onBeforeFormatChange\", function(row, col, formatName){\n\t\tif(!this._setType){\n\t\t\tconst cell = {\n\t\t\t\trow,\n\t\t\t\tcol,\n\t\t\t\tvalue: view.getCellValue(row, col),\n\t\t\t\tfmt: {fmt:getFormatSource(formatName)}\n\t\t\t};\n\t\t\tsetType(this, cell, true);\n\t\t}\n\t});\n\n\tview.attachEvent(\"onAction\", function(action, values){\n\t\tif(action == \"dropdown\" && values.newValue && values.newValue.editor == \"excel_date\"){\n\t\t\tconst format = getFormatName(this, values.row, values.column);\n\t\t\tif(getFormatType(format) != \"date\")\n\t\t\t\tthis.setFormat(values.row, values.column, webix.i18n.spreadsheet.formats.dateFormat);\n\t\t}\n\t});\n}\n\nexport function loadCell(view, data, item){\n\tconst fmt = getFormatFromData(data, item);\n\tconst cell = {\n\t\tvalue: item[2],\n\t\tfmt: fmt ? {fmt} : null,\n\t\ttype: item[4]\n\t};\n\tsetType(view, cell);\n\treturn cell;\n}\n\nfunction getExpectType(view, cell, parseDate, isFormula, formatType, style){\n\t//date based math\n\tlet type = \"string\";\n\tif(!webix.isUndefined(cell.value)){\n\t\tif(isFormula){\n\t\t\ttype = \"number\";\n\n\t\t\tif(/^=(now|date|time)\\(/i.test(cell.value))\n\t\t\t\ttype = \"date\";\n\t\t\telse if(/^=(sparkline|image)\\(/i.test(cell.value))\n\t\t\t\ttype = \"string\";\n\t\t}\n\t\telse if(!isNaN(cell.value))\n\t\t\ttype = \"number\";\n\t\telse if(formatType != \"string\" && parseDate){\n\t\t\t//if user types a date string, or it comes from Excel import\n\t\t\t//set date type and convert string to Excel date\n\t\t\tconst parser = webix.Date.strToDate( webix.i18n.spreadsheet.formats.parseDateTime );\n\t\t\tconst value  = parser(cell.value);\n\t\t\tif(value != \"\" && !isNaN(value)){\n\t\t\t\t//change cell style - value changes once (some value -> 35767.5)\n\t\t\t\t//change cell value - value changes twice (some value -> \"12/03/97\" -> 35767.5)\n\t\t\t\t//so ignore undo for cell value change\n\t\t\t\tif(style)\n\t\t\t\t\tdateToExcel(view, cell, value);\n\t\t\t\telse\n\t\t\t\t\tview.ignoreUndo(() => dateToExcel(view, cell, value));\n\n\t\t\t\ttype = \"date\";\n\t\t\t}\n\t\t}\n\t}\n\treturn type;\n}\n\nfunction dateToExcel(view, cell, date){\n\tdate = getExcelDateFromJs(date);\n\tcell.value = date;\n\n\tif(!(view._loading_data || view._page_value_set))\n\t\tview.setCellValue(cell.row, cell.col, date);\n}\n\nfunction checkType(type, expectType, formatType, isFormula, value){\n\ttype = type || expectType;\n\n\t//strings will always have string type regardless of format\n\tif(expectType == \"string\")\n\t\ttype = \"string\";\n\telse if(formatType)\n\t\ttype = formatType;\n\n\tif(type == \"date\" && !isFormula && isDateInvalid(value))\n\t\ttype = \"number\";\n\n\treturn type;\n}\n\nfunction getFormatType(format){\n\tlet formatType = format ? \"number\" : null;\n\tif(checkFormat(format, \"string\"))\n\t\tformatType = \"string\";\n\telse if(checkFormat(format, \"date\"))\n\t\tformatType = \"date\";\n\treturn formatType;\n}\n\nexport function getType(view, row, column, page){\n\tpage = page ? view._mData.getPage(page) : view._mPage;\n\tconst item = page.getCell(row-1, column-1);\n\treturn (item && item.type) || null;\n}\n\nfunction setType(view, cell, style){\n\tconst parseToStore = !(cell.row && cell.col);\n\n\t//prevent type change during value or format change\n\tview._setType = true;\n\n\tconst isFormula = typeof cell.value == \"string\" && cell.value[0] == \"=\";\n\tconst parseDate = (!style || cell.fmt == getFormatSource(\"date\")) && (!view._loading_data || view._page_value_set || cell.type == \"date\");\n\n\tlet mathFormat;\n\tif(!parseToStore)\n\t\tmathFormat = isFormula && !cell.fmt ? getMathFormat(view, cell.value) : null;\n\n\tconst formatType = getFormatType(cell.fmt || mathFormat);\n\tconst expectType = getExpectType(view, cell, parseDate, isFormula, formatType, style);\n\n\tcell.type = checkType(cell.type, expectType, formatType, isFormula, cell.value);\n\n\tif(!parseToStore){\n\t\tconst item = view._mPage.getCell(cell.row-1, cell.col-1, true);\n\t\titem.$format = formatType == \"string\" ? 1 : 0;\n\t\tupdateCell(view, cell, expectType, formatType, mathFormat);\n\t\titem.type = cell.type;\n\t}\n\n\tdelete view._setType;\n}\n\nfunction updateCell(view, cell, expectType, formatType, mathFormat){\n\tconst row = cell.row;\n\tconst col = cell.col;\n\tconst isString = typeof cell.value == \"string\";\n\n\tconst isFormula = isString && cell.value[0] == \"=\";\n\tconst cellEditor = view.getCellEditor(row, col);\n\n\t//update cell value if set number format (5e5 -> 500000, 005 -> 5)\n\tif(!(view._loading_data || view._page_value_set) && cell.type === \"number\" && isString && !isFormula && cell.value !== \"\")\n\t\tview.setCellValue(row, col, cell.value*1);\n\n\tif(mathFormat)\n\t\tview.setFormat(row, col, mathFormat.fmt);\n\telse if(cell.type == \"date\"){\n\t\t// add default date format\n\t\tif(formatType != \"date\"){\n\t\t\tconst isTime = isFormula && cell.value.toUpperCase().indexOf(\"=TIME(\") == 0;\n\t\t\tconst locale = webix.i18n.spreadsheet.formats;\n\t\t\tconst format = isTime ? locale.timeFormat : locale.dateFormat;\n\t\t\tview.setFormat(row, col, format);\n\t\t}\n\n\t\t//set date editor for cells with date type\n\t\tif(!isFormula && !cellEditor)\n\t\t\tview.setCellEditor(row, col, {editor: \"excel_date\"});\n\t}\n\telse if(formatType != \"string\" && cell.type == \"string\" && expectType != \"string\"){\n\t\t//force text format for numbers typed as strings\n\t\tview.setFormat(row, col, \"@\");\n\t}\n\n\t//remove date editor\n\tif((cell.type != \"date\" || isFormula) && cellEditor && cellEditor.editor == \"excel_date\")\n\t\tview.setCellEditor(row, col, null);\n}\n","import {isChar, getLastCharIndex} from \"../mathematics/parser\";\n\nwebix.protoUI({\n\tname: \"suggest-formula\",\n\tdefaults: {\n\t\tfitMaster: false,\n\t\twidth: 200,\n\t\tfilter(item, value) {\n\t\t\tconst editor = webix.$$(this.config.master);\n\t\t\tconst cursor = editor.getInputNode().selectionStart;\n\t\t\tconst val = editor.getValue();\n\n\t\t\tif(val.charAt(0) !== \"=\") return;\n\n\t\t\tconst str = val.substring(0, cursor);\n\t\t\tconst search = str.substring( getLastCharIndex(str, true) );\n\t\t\tconst nextSymbol = val.charAt(cursor);\n\n\t\t\tif(search && (cursor === val.length || !(isChar(nextSymbol) || /^[0-9]/.test(nextSymbol))))\n\t\t\t\tvalue = search;\n\n\t\t\treturn item.value.toString().toLowerCase().indexOf(value.toLowerCase()) === 0;\n\t\t}\n\t},\n\t$init() {\n\t\tthis.attachEvent(\"onBeforeShow\", (node) => {\n\t\t\tif(node.tagName){\n\t\t\t\tconst editor = webix.$$(this.config.master);\n\t\t\t\tconst text = editor.getValue();\n\n\t\t\t\t//only for formulas\n\t\t\t\tif(!text || text.charAt(0) !== \"=\") return false;\n\n\t\t\t\tconst sizes = webix.html.offset(node);\n\n\t\t\t\tconst selectionStart = editor.getInputNode().selectionStart;\n\t\t\t\tconst textWidth = webix.html.getTextSize(text.substring(0, selectionStart), \"webix_ssheet_formula\").width;\n\n\t\t\t\tconst y = sizes.y + sizes.height;\n\t\t\t\tconst x = sizes.x + textWidth;\n\n\t\t\t\twebix.ui.popup.prototype.show.apply(this, [{x, y}]);\n\t\t\t\treturn false;\n\t\t\t}\n\t\t});\n\t},\n\tsetMasterValue(data, refresh) {\n\t\tconst text = data.id ? this.getItemText(data.id) : (data.text||data.value);\n\t\twebix.$$(this.config.master).setValueHere(text);\n\n\t\tif (!refresh)\n\t\t\tthis.hide(true);\n\n\t\tthis.callEvent(\"onValueSuggest\", [data, text]);\n\t},\n\t$enterKey: function() {\n\t\tif (this.isVisible())\n\t\t\treturn webix.ui.suggest.prototype.$enterKey.apply(this, arguments);\n\t}\n}, webix.ui.suggest);","webix.protoUI({\n\tname: \"ssheet-button\",\n\t$cssName: \"button\",\n\tdefaults:{\n\t\ttype:\"htmlbutton\",\n\t\twidth: 40\n\t},\n\t$init: function(config){\n\t\tconst arrowCss = config.arrow ? \" webix_ssheet_button_menu\" : \"\";\n\t\tconst iconCss = config.label ? \"\" : \" webix_ssheet_icon_only\";\n\t\tthis.$view.className += \" webix_ssheet_button\"+arrowCss+iconCss;\n\t\tif(config.label || config.icon){\n\t\t\tlet icon = (config.icon||config.name),\n\t\t\t\ttext = config.label||\"\";\n\t\t\tif(config.arrow){\n\t\t\t\tconst right = webix.skin.$active.inputSpacing/2;\n\t\t\t\ttext += \"<span class='webix_ssheet_button_icon webix_ssheet_icon_arrow webix_icon wxi-menu-down' style='right:\"+right+\"px;'></span>\";\n\t\t\t}\n\t\t\tconfig.label = \"<span class='webix_ssheet_button_icon webix_ssheet_icon ssi-\"+icon+\"'></span> \"+text;\n\t\t\tconfig.tooltip = webix.i18n.spreadsheet.tooltips[config.name]||\"\";\n\t\t}\n\t\tif(config.options && !config.popup)\n\t\t\tconfig.popup = getPopupConfig(config.options);\n\t}\n},webix.ui.button);\n\n\nwebix.protoUI({\n\tname: \"ssheet-button-icon-top\",\n\t$cssName: \"button\",\n\tdefaults:{\n\t\ttype:\"htmlbutton\",\n\t\twidth: 70,\n\t\theight: 70\n\t},\n\t$init: function(config){\n\t\tthis.$view.className += \" ssheet_button_icon_top\";\n\t\tif(config.label) {\n\t\t\tlet icon = (config.icon || config.name||\"\"),\n\t\t\t\ttext = config.label;\n\t\t\tconfig.label = \"<span class='webix_ssheet_button_icon webix_ssheet_icon ssi-\" + icon + \"'></span><br/>\";\n\t\t\tconfig.label += \"<span class='ssheet_button_icon_top_text'>\"+text+\"</span>\";\n\t\t\tif (config.arrow)\n\t\t\t\tconfig.label += \"<br/><span class='ssheet_button_icon_top_arrow webix_icon wxi-menu-down'></span>\";\n\t\t\tconfig.tooltip = webix.i18n.spreadsheet.tooltips[config.name]||\"\";\n\t\t}\n\t\tif(config.options && !config.popup)\n\t\t\tconfig.popup = getPopupConfig(config.options);\n\t}\n},webix.ui.button);\n\n\nfunction getPopupConfig(options){\n\treturn {\n\t\tview: \"ssheet-suggest\",\n\t\tcss: \"webix_ssheet_suggest\",\n\t\tautowidth:true,\n\t\ttemplate: function(obj){\n\t\t\tvar text = \"\";\n\t\t\tif(obj.icon)\n\t\t\t\ttext += \"<span class='webix_ssheet_button_icon webix_ssheet_icon ssi-\" + obj.icon + \"'></span> \";\n\t\t\ttext += obj.value || webix.i18n.spreadsheet.menus[obj.id] || obj.id;\n\t\t\treturn text;\n\t\t},\n\t\tdata: options,\n\t\ton:{\n\t\t\tonItemClick: function(id){\n\t\t\t\tvar button = this.config.master;\n\t\t\t\tif(button){\n\t\t\t\t\tlet view = webix.$$(button).getTopParentView();\n\t\t\t\t\tvar params = [this.getItem(id)];\n\t\t\t\t\tif(webix.$$(button).config.area){\n\t\t\t\t\t\tlet area = view.$$(\"cells\").getSelectArea();\n\t\t\t\t\t\tif(area)\n\t\t\t\t\t\t\tparams = params.concat([area.start,area.end]);\n\t\t\t\t\t}\n\t\t\t\t\tview.callEvent(\"onCommand\",params);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t};\n}","import \"./suggest_formula\";\nimport {getJsDateFromExcel} from \"../mathematics/methods\";\nimport {getType} from \"../operations/types\";\nimport {getDateEditFormat} from \"../operations/formats\";\nimport {split, position, getLastCharIndex} from \"../mathematics/parser\";\n\nwebix.protoUI({\n\tname: \"live-editor\",\n\t$cssName:\"texthighlight\",\n\t$init(config){\n\t\tconfig.suggest = {\n\t\t\tview: \"suggest-formula\",\n\t\t\tdata: config.suggestData\n\t\t};\n\t\tconfig.highlight = this.highlight;\n\n\t\tthis._highlightedCells = {};\n\t\tthis.$view.className += \" webix_ssheet_formula\";\n\n\t\tthis.attachEvent(\"onKeyPress\", (code, e) => {\n\t\t\tdelete this._update_range;\n\t\t\tif(code == 13) {\n\t\t\t\t//ignore Enter key if it was pressed to select some value from suggest\n\t\t\t\tif ((new Date() - (this._last_value_set || 0)) > 300){\n\t\t\t\t\tconst cell = this.config.activeCell;\n\t\t\t\t\tthis.showActiveSheet(true);\n\t\t\t\t\tthis.updateCellValue(cell);\n\t\t\t\t\t//blur to avoid calling highlight function after selection move\n\t\t\t\t\tthis.getInputNode().blur();\n\t\t\t\t\t//we have 'enter' hot key to activate editor\n\t\t\t\t}\n\t\t\t\twebix.html.preventEvent(e);\n\t\t\t}\n\t\t\t//esc - cancel editing\n\t\t\telse if(code == 27){\n\t\t\t\tthis.showActiveSheet();\n\n\t\t\t\twebix.delay(()=>{\n\t\t\t\t\tconst master = this.getTopParentView();\n\t\t\t\t\tconst cell = master.getSelectedId();\n\t\t\t\t\tconst oldVal = this.getCellValue(cell.row, cell.column);\n\n\t\t\t\t\tif(this.getValue() == oldVal)\n\t\t\t\t\t\tmaster.$$(\"cells\").refresh(cell.row);\n\t\t\t\t\telse\n\t\t\t\t\t\tthis.setValue(oldVal);\n\n\t\t\t\t\tdelete master.$handleSelection;\n\n\t\t\t\t\twebix.UIManager.setFocus(master.$$(\"cells\"));\n\t\t\t\t});\n\t\t\t}\n\t\t});\n\n\t\tthis.attachEvent(\"onAfterRender\", function(){\n\t\t\twebix.eventRemove(this.keydownEv);\n\n\t\t\tthis.keydownEv = webix.event(this.getInputNode(), \"keydown\", e => {\n\t\t\t\tthis.endEdit(e);\n\t\t\t});\n\t\t});\n\t},\n\thighlight(value){\n\t\tlet html = \"\";\n\t\tconst master = this.getTopParentView();\n\t\tconst escapeText = webix.template.escape;\n\n\t\tfor(let area in this._highlightedCells){\n\t\t\tconst cells = this._highlightedCells[area];\n\t\t\tthis.changeCellCss(cells[0], cells[1], cells[2], true);\n\t\t}\n\t\tthis._highlightedCells = {};\n\n\t\t//value can be null\n\t\tif(value && value[0]==\"=\"){\n\t\t\tconst parts = split(value, master, null, this._activeMath);\n\t\t\tconst sheet = master.getActiveSheet();\n\n\t\t\tlet colorIndex = 1;\n\n\t\t\tfor(let i = 0; i < parts.length; i++){\n\t\t\t\tif(i%2 === 0)\n\t\t\t\t\thtml += escapeText(parts[i]);\n\t\t\t\telse{\n\t\t\t\t\tconst crossheet = webix.isArray(parts[i]);\n\t\t\t\t\tconst cellSheet = crossheet ? this.prepareSheet(parts[i][0], parts[i][2]) : \"\";\n\t\t\t\t\tconst activeMath = this._activeMath;\n\n\t\t\t\t\tconst activeSheet = !crossheet && (!activeMath || activeMath == sheet);\n\t\t\t\t\tlet cell = position(crossheet ? parts[i][1] : parts[i]);\n\t\t\t\t\tconst cellText = crossheet ? cellSheet+parts[i][1] : parts[i];\n\n\t\t\t\t\tconst rangeName = crossheet && !getLastCharIndex(parts[i][1]);\n\n\t\t\t\t\tif(rangeName || activeSheet || (crossheet && parts[i][0] == sheet)){\n\t\t\t\t\t\tlet repeatedColor;\n\t\t\t\t\t\t//range\n\t\t\t\t\t\tif((parts[i+1] == \":\" && parts[i+2]) || rangeName){\n\t\t\t\t\t\t\tlet nextCell, nextCellText;\n\n\t\t\t\t\t\t\tif(rangeName){\n\t\t\t\t\t\t\t\tconst cells = parts[i][3].split(\":\");\n\n\t\t\t\t\t\t\t\tcell = position(cells[0]);\n\t\t\t\t\t\t\t\tnextCell = position(cells[1]);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\telse{\n\t\t\t\t\t\t\t\tnextCell = position(webix.isArray(parts[i+2]) ? parts[i+2][1] : parts[i+2]);\n\t\t\t\t\t\t\t\tnextCellText = webix.isArray(parts[i+2]) ? cellSheet+parts[i+2][1] : parts[i+2];\n\t\t\t\t\t\t\t\ti+=2;\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\trepeatedColor = this.setColor(cell[0], cell[1], nextCell[0], nextCell[1], colorIndex);\n\t\t\t\t\t\t\thtml += `<span class=\"webix_ssheet_highlight_color_${repeatedColor||colorIndex}\">${rangeName ? cellText : cellText+\":\"+nextCellText}</span>`;\n\t\t\t\t\t\t}\n\t\t\t\t\t\t//OtherSheet!A1:A3 - do not highlight A3\n\t\t\t\t\t\telse if(parts[i-1] && parts[i-1][ parts[i-1].length-1 ] == \":\"){\n\t\t\t\t\t\t\thtml += cellText;\n\t\t\t\t\t\t\tcontinue;\n\t\t\t\t\t\t}\n\t\t\t\t\t\t//cell\n\t\t\t\t\t\telse{\n\t\t\t\t\t\t\trepeatedColor = this.setColor(cell[0], cell[1], cell[0], cell[1], colorIndex);\n\t\t\t\t\t\t\thtml += `<span class=\"webix_ssheet_highlight_color_${repeatedColor||colorIndex}\">${cellText}</span>`;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tconst colors = 7;\n\t\t\t\t\t\tif(!repeatedColor)\n\t\t\t\t\t\t\tcolorIndex += colorIndex == colors ? -1*(colors-1) : 1;\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t\thtml += cellText;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\telse\n\t\t\thtml = escapeText(value);\n\n\t\tmaster.$$(\"cells\").refresh();\n\n\t\tif(document.activeElement == this.getInputNode())\n\t\t\tthis.paintValue();\n\t\treturn html;\n\t},\n\tshowActiveSheet(enter){\n\t\tconst master = this.getTopParentView();\n\t\tconst grid = master._table;\n\n\t\tif(this._activeMath){\n\t\t\tif(this._activeMath != master.getActiveSheet()){\n\t\t\t\tconst cell = this.config.activeCell;\n\n\t\t\t\tthis.define({activeCell:null});\n\n\t\t\t\tmaster.showSheet(this._activeMath);\n\n\t\t\t\twebix.delay(()=>{\n\t\t\t\t\tgrid.select(cell.row + (enter ? 1 : 0), cell.column);\n\t\t\t\t});\n\t\t\t}\n\t\t\tdelete this._activeMath;\n\t\t}\n\t\telse if(enter){\n\t\t\twebix.delay(()=>{\n\t\t\t\tgrid.moveSelection(\"down\");\n\t\t\t});\n\t\t}\n\t},\n\tchangeCellCss(row, col, index, remove){\n\t\tconst css = `webix_ssheet_highlight_background_${index}`;\n\t\tfor (let r = row.start; r <= row.end; r++)\n\t\t\tfor (let c = col.start; c <=  col.end; c++)\n\t\t\t\tthis.getTopParentView().$$(\"cells\")[remove?\"removeCellCss\":\"addCellCss\"](r, c, css, true);\n\t},\n\tendEdit(e){\n\t\tconst code = e.which || e.keyCode;\n\n\t\t//if it is a formula - force user to finish it by click outside or 'enter'\n\t\tif(code == 9){\n\t\t\twebix.html.preventEvent(e);\n\n\t\t\tthis.getInputNode().blur();\n\t\t\tthis.updateCellValue();\n\t\t\tthis.getTopParentView()._table.moveSelection(e.shiftKey ? \"left\" : \"right\");\n\t\t}\n\t},\n\tpaintValue(){\n\t\tconst master = this.getTopParentView();\n\t\tif(!this._activeMath || this._activeMath == master.getActiveSheet()){\n\t\t\tconst cell = this.config.activeCell;\n\t\t\tconst node = master._table.getItemNode(cell);\n\t\t\tif(cell && node) \n\t\t\t\tnode.innerHTML = `<div>${webix.template.escape(this.getValue())}</div>`;\n\t\t}\n\t},\n\tupdateCellValue(cell) {\n\t\tconst newv = this.getValue();\n\t\tconst master = this.getTopParentView();\n\t\tcell = cell || this.config.activeCell;\n\n\t\tif (!cell)\n\t\t\tthis.setValue(\"\");\n\t\telse{\n\t\t\tconst val = master.getCellValue(cell.row, cell.column);\n\n\t\t\tif(newv !== val){\n\t\t\t\tthis.config.value = newv;\n\t\t\t\tmaster.setCellValue(cell.row, cell.column, newv);\n\t\t\t\tmaster.refresh();\n\t\t\t}\n\t\t}\n\n\t\tdelete master.$handleSelection;\n\t},\n\t$setValueHere(value){\n\t\tthis.setValueHere(value);\n\t},\n\tsetValueHere(value) {\n\t\tthis._last_value_set = new Date();\n\n\t\tconst formula = this.getValue();\n\t\tif(formula && formula.charAt(0)===\"=\"){\n\t\t\tconst cursor = this.getInputNode().selectionStart;\n\t\t\tlet str1 = formula.substring(0, cursor);\n\t\t\tconst str2 = formula.substring(cursor);\n\n\t\t\tif(str1[str1.length-1] == \"(\")\n\t\t\t\tstr1 = str1.substring(0, str1.length-1);\n\n\t\t\tstr1 = str1.substring(0, getLastCharIndex(str1, true));\n\n\t\t\t//suggest called via up/down key\n\t\t\tstr1 += value + (str2[0] == \"(\" ? \"\" : \"(\");\n\n\t\t\tthis.setValue(str1 + str2);\n\t\t\tthis.getInputNode().setSelectionRange(str1.length, str1.length);\n\t\t}\n\t},\n\texpectOperator(){\n\t\tconst text = this.getValue();\n\n\t\tif(text[0] == \"=\"){\n\t\t\tlet cursor = this.getInputNode().selectionStart;\n\t\t\twhile(text[cursor-1] == \" \")\n\t\t\t\tcursor--;\n\t\t\treturn text[cursor-1] && text[cursor-1].match(/[+&\\-/*=(:,]/);\n\t\t}\n\t},\n\tsetRange(range, replace){\n\t\tconst cursor = this.getInputNode().selectionStart;\n\t\tconst formula = this.getValue();\n\n\t\tlet str1, str2;\n\n\t\t//check if range was added by click\n\t\tif(replace)\n\t\t\treplace = this._update_range && cursor == this._update_range.pos + this._update_range.len;\n\n\t\tconst lastPos = replace ? this._update_range.pos : cursor;\n\n\t\tstr1 = formula.substring(0, lastPos) + range;\n\t\tstr2 = formula.substring(cursor);\n\n\t\tthis._update_range = {pos: lastPos, len: range.length};\n\n\t\tthis.setValue(str1 + str2);\n\t},\n\tprepareSheet(sheet, escaped){\n\t\tif(!sheet)\n\t\t\treturn \"\";\n\t\tconst condition = webix.isUndefined(escaped) ? sheet.indexOf(\" \") != -1 : escaped;\n\t\treturn (condition ? `'${sheet}'` : sheet) + \"!\";\n\t},\n\tprepareArea(first, second){\n\t\treturn {\n\t\t\tstart: Math.min(first, second),\n\t\t\tend: Math.max(first, second)\n\t\t};\n\t},\n\tsetColor(row1, col1, row2, col2, color){\n\t\tconst row = this.prepareArea(row1, row2);\n\t\tconst col = this.prepareArea(col1, col2);\n\t\tconst index = [row.start, row.end, col.start, col.end].join(\",\");\n\t\tconst coloredArea = this._highlightedCells[index];\n\n\t\tif(!coloredArea){\n\t\t\tthis._highlightedCells[index] = [row, col, color];\n\t\t\tthis.changeCellCss(row, col, color);\n\t\t}\n\t\telse\n\t\t\treturn coloredArea[2];\n\t},\n\tgetCellValue(row, column){\n\t\tconst master = this.getTopParentView();\n\t\tlet value = master.getCellValue(row, column);\n\t\tif(getType(master, row, column) == \"date\" && value[0] != \"=\"){\n\t\t\tconst format = getDateEditFormat(master, row, column);\n\t\t\tvalue = format(getJsDateFromExcel(value));\n\t\t}\n\t\treturn value;\n\t}\n}, webix.ui.texthighlight);","webix.protoUI({\n\tname: \"ssheet-separator\",\n\tdefaults:{\n\t\tcss: \"webix_ssheet_toolbar_spacer\",\n\t\ttemplate: \" \",\n\t\twidth: 1,\n\t\tborderless: true\n\t}\n},webix.ui.view);","webix.protoUI({\n\tname: \"sheets\",\n\tdefaults:{\n\t\tlayout: \"x\",\n\t\tborderless: true,\n\t\tcss:\"ssheet_list_sheets\",\n\t\tselect: true,\n\t\tdrag: \"order\",\n\t\tdragscroll:\"x\",\n\t\tscroll:false\n\t}\n},webix.EditAbility,webix.ui.list);","// toolbar: toogle button\nwebix.protoUI({\n\t$cssName: \"toggle\",\n\tname:\"ssheet-toggle\",\n\ttoggle:function(){\n\t\tconst old = this.getValue();\n\n\t\tif(!old || old == this.config.offValue)\n\t\t\tthis.config.value = this.config.onValue || true;\n\t\telse\n\t\t\tthis.config.value = this.config.offValue || false;\n\n\t\tconst val = this.getValue();\n\t\tthis.$setValue(val);\n\t\tthis.callEvent(\"onChange\", [val, old, \"user\"]);\n\t},\n\t$setValue:function(value){\n\t\tif(value == this.config.offValue)\n\t\t\tvalue = false;\n\t\telse if(value == this.config.onValue)\n\t\t\tvalue = true;\n\t\twebix.ui.toggle.prototype.$setValue.call(this,value);\n\t},\n\tgetValue:function(){\n\t\tvar config = this.config;\n\t\tvar value = config.value;\n\t\treturn  !value || value==config.offValue?(config.offValue||false):(config.onValue||true);\n\t},\n\tdefaults:{\n\t\ttemplate:function(obj, common){\n\t\t\tvar css = (obj.value === true || obj.value == obj.onValue) ? \" webix_pressed\" : \"\";\n\t\t\tvar inp = common.$renderInput(obj, common);\n\t\t\treturn \"<div class='webix_el_box\"+css+\"' style='width:\"+obj.awidth+\"px; height:\"+obj.aheight+\"px'>\"+inp+\"</div>\";\n\t\t}\n\t}\n}, webix.ui.toggle);\n\n\n// toolbar: silent toggle button\nwebix.protoUI({\n\tname:\"ssheet-toggle-silent\",\n\t$cssName:\"toggle\",\n\t$allowsClear:false,\n\tsetValue:function(){\n\t\tthis.blockEvent();\n\t\twebix.ui.toggle.prototype.setValue.apply(this, arguments);\n\t\tthis.unblockEvent();\n\t}\n}, webix.ui.toggle);","webix.protoUI({\n\tname: \"ssheet-bar-title\",\n\tdefaults:{\n\t\tborderless: true\n\t},\n\t$init: function(){\n\t\tthis.$view.className += \" webix_ssheet_subbar_title\";\n\t}\n},webix.ui.template);","import * as arr from \"../helpers/array\";\n\nwebix.protoUI({\n\tname:\"multicheckbox\",\n\tdefaults:{\n\t\tpadding:0,\n\t\ttype:\"clean\",\n\t\tborderless:true,\n\t\telementsConfig:{\n\t\t\tlabelWidth:0\n\t\t}\n\t},\n\t$init:function(config){\n\t\tconfig.rows = [{height:0.000001}];\n\t\tthis.$ready.push(function(){\n\t\t\tthis._initOnChange();\n\t\t});\n\t},\n\t_initOnChange(){\n\t\tthis.attachEvent(\"onChange\", function(newv){\n\t\t\tconst name = this.$eventSource.config.name;\n\n\t\t\tthis.blockEvent();\n\t\t\tif(name == \"$all\"){\n\t\t\t\tfor(let i in this.elements)\n\t\t\t\t\tthis.elements[i].setValue(newv);\n\t\t\t\tif(!newv)\n\t\t\t\t\tthis._getCheckboxes()[0].setValue(1);\n\t\t\t}\n\t\t\telse{\n\t\t\t\tconst value = this.getValue(true);\n\n\t\t\t\tif(webix.isArray(value) && (!value.length || !arr.find(value, config => !config.$hiddenSheet))){\n\t\t\t\t\tconst checkboxes = this._getCheckboxes();\n\t\t\t\t\tarr.find(checkboxes, c => !c.config.$hiddenSheet).setValue(1);\n\t\t\t\t}\n\n\t\t\t\tthis.elements.$all.setValue(this.getValue(true) === true ? 1 : 0);\n\t\t\t}\n\t\t\tthis.unblockEvent();\n\t\t});\n\t},\n\tsetValue:function(value){\n\t\tthis.elements = {};\n\t\tthis._count = value.length;\n\n\t\tif(value.length > 1){\n\t\t\tlet elements = [];\n\t\t\tlet base = [];\n\t\t\tconst maxHeight = 400;\n\n\t\t\tvalue.forEach(sheet => {\n\t\t\t\tconst icon = `<span class=\"webix_icon wxi-eye${sheet.hidden ? \"-slash\" : \"\"}\"></span>`;\n\t\t\t\tbase.push({ view: \"checkbox\", labelRight: icon + sheet.name, name: sheet.name, value: sheet.active, $hiddenSheet: sheet.hidden });\n\t\t\t});\n\n\t\t\tconst baseHeight = base.length * webix.skin.$active.inputHeight;\n\t\t\tconst scroll = baseHeight > maxHeight;\n\n\t\t\telements.push({\n\t\t\t\tview:\"scrollview\", body:{rows:base},\n\t\t\t\tscroll: scroll,\n\t\t\t\theight: scroll ? maxHeight : baseHeight\n\t\t\t});\n\n\t\t\telements.push({ template:\"<div class='ss_sep_line'></div>\", height:10 });\n\t\t\telements.push({ view:\"checkbox\", labelRight:webix.i18n.spreadsheet.labels[\"export-all-sheets\"], name:\"$all\", value:0 });\n\n\t\t\twebix.ui(elements, this);\n\t\t}\n\t\telse if(this.getChildViews().length > 1){\n\t\t\twebix.ui([{height:0.000001}], this);\n\t\t}\n\t},\n\tgetValue:function(config){\n\t\tconst checkboxes = this._getCheckboxes();\n\t\tlet output = [];\n\n\t\t//save order\n\t\tfor(let i = 0; i < checkboxes.length; i++)\n\t\t\tif(checkboxes[i].getValue()){\n\t\t\t\tconst cfg = checkboxes[i].config;\n\t\t\t\toutput.push(config ? cfg : cfg.name);\n\t\t\t}\n\n\t\tif(output.length == this._count)\n\t\t\treturn true;\n\n\t\treturn output;\n\t},\n\t_getCheckboxes(){\n\t\tconst scrollview = this.queryView(\"scrollview\");\n\t\treturn scrollview ? scrollview.getBody().getChildViews() : [];\n\t}\n}, webix.ui.form);","webix.protoUI({\n\tname:\"formlist\",\n\tdefaults:{\n\t\tpaddingY: 5,\n\t\theight: 120,\n\t},\n\t$init:function(config){\n\n\t\tconfig.cols = [\n\t\t\t{\n\t\t\t\tcss:\"webix_inp_label\",\n\t\t\t\ttemplate:config.label,\n\t\t\t\twidth:config.labelWidth,\n\t\t\t\tborderless:true\n\t\t\t},\n\t\t\t{\n\t\t\t\tview:\"list\",\n\t\t\t\tdata:config.data,\n\t\t\t\tcss:config.css,\n\t\t\t\ttemplate:config.template,\n\t\t\t\tselect: true,\n\t\t\t\tscroll:false,\n\t\t\t\tborderless:true,\n\t\t\t\ton:{\n\t\t\t\t\tonSelectChange:()=>{\n\t\t\t\t\t\tthis.getParentView().callEvent(\"onChange\", []);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t];\n\t},\n\tsetValue:function(value){this.getChildViews()[1].select(value);},\n\tgetValue:function(){return this.getChildViews()[1].getSelectedId();},\n\trefresh: function(){this.getChildViews()[1].refresh();},\n\tfocus:function(){}\n}, webix.ui.layout);","webix.protoUI({\n\tname: \"ssheet-ui\",\n\tdefaults:{\n\t\tmove:true,\n\t\tcss:\"webix_shadow_none webix_ssheet_ui\",\n\t\thead:false,\n\t\tresize:true,\n\t\ttoFront:true,\n\t\tminWidth:50,\n\t\tminHeight:200,\n\t\tescHide:false,\n\t\tautofit:false\n\t},\n\t$init:function(){\n\t\t// prevent block selection\n\t\tthis.$view.setAttribute(\"webixignore\", \"1\");\n\n\t\tthis.$ready.push(function(){\n\t\t\twebix.UIManager.addHotKey(\"delete\", webix.bind(this._removeView, this));\n\t\t\twebix.UIManager.addHotKey(\"backspace\", webix.bind(this._removeView, this));\n\t\t\tthis.getMenu();\n\t\t});\n\t\tthis.attachEvent(\"onDestruct\", function(){\n\t\t\twebix.eventRemove(this._clickEv);\n\t\t\tthis._menu.destructor();\n\t\t});\n\t},\n\tmove_setter:function(value){\n\t\tif (value){\n\t\t\twebix.DragControl.addDrag(this.$view, this);\n\t\t}\n\t\treturn value;\n\t},\n\t$dragPos:function(pos, e){\n\t\tthis.callEvent(\"onViewMove\", [pos, e]);\n\t\treturn pos;\n\t},\n\t$dragCreate:function(object, e){\n\t\tconst trg = e.target;\n\t\tif (!trg.getAttribute || trg.getAttribute(\"webix_disable_drag\") || trg.getAttribute(\"webixignore\"))\n\t\t\treturn;\n\n\t\tthis.getMenu().hide();\n\t\tconst elOffset = webix.html.offset(object);\n\t\tconst elPos = webix.html.pos(e);\n\t\tconst pOffset = webix.html.offset(object.parentNode);\n\t\tconst state = webix.$$(this.config.master).getScrollState();\n\n\t\twebix.DragControl.top = elOffset.y - elPos.y - pOffset.y;\n\t\twebix.DragControl.left = elOffset.x - elPos.x - pOffset.x + state.x;\n\n\t\treturn webix.toNode(this.$view);\n\t},\n\t$dragDestroy:function(node, drag){\n\t\tconst x = this.config.left = parseInt(drag.style.left,10);\n\t\tconst y = this.config.top = parseInt(drag.style.top,10);\n\n\t\twebix.DragControl.top = webix.DragControl.left = 0;\n\n\t\tthis.callEvent(\"onViewMoveEnd\", [x, y]);\n\t\treturn;\n\t},\n\tgetMenu:function(){\n\t\tconst labels = webix.i18n.spreadsheet.labels;\n\t\tif(!this._menu){\n\t\t\tlet data = [\n\t\t\t\t{ value:labels[\"export-view\"], submenu:[\n\t\t\t\t\t{ id:\"pdf\", value:labels[\"export-view-pdf\"] },\n\t\t\t\t\t{ id:\"png\", value:labels[\"export-view-png\"] },\n\t\t\t\t\t{ id:\"excel\", value:labels[\"export-view-excel\"] }\n\t\t\t\t] }\n\t\t\t];\n\n\t\t\tif(!webix.$$(this.config.master).getTopParentView().config.readonly)\n\t\t\t\tdata = [\n\t\t\t\t\t{ id:\"edit\", value:labels[\"edit-view\"] },\n\t\t\t\t\t...data,\n\t\t\t\t\t{ id:\"del\", value:labels[\"remove-view\"] }\n\t\t\t\t];\n\n\t\t\tthis._menu = webix.ui({\n\t\t\t\tview:\"contextmenu\",\n\t\t\t\tsubmenuConfig:{\n\t\t\t\t\texternalUI: this.config.id\n\t\t\t\t},\n\t\t\t\tdata:data,\n\t\t\t\ton:{\n\t\t\t\t\tonMenuItemClick: id => this._menuActions(id),\n\t\t\t\t\tonBeforeShow: () => this._toggleExcel()\n\t\t\t\t}\n\t\t\t});\n\t\t\tconst dots = webix.html.create(\"span\", {\"class\":\"webix_ssheet_view_menu webix_icon wxi-dots\"});\n\t\t\tthis._clickEv = webix.event(dots, \"click\", ()=> {\n\t\t\t\tif(this._menu.isVisible())\n\t\t\t\t\tthis._menu.hide();\n\t\t\t\telse\n\t\t\t\t\tthis._menu.show(dots);\n\t\t\t});\n\t\t\tthis.$view.firstChild.appendChild(dots);\n\t\t}\n\t\treturn this._menu;\n\t},\n\t_menuActions:function(id){\n\t\tswitch(id){\n\t\t\tcase \"del\":\n\t\t\t\tthis.callEvent(\"onViewRemove\", []);\n\t\t\t\tbreak;\n\t\t\tcase \"edit\":\n\t\t\t\tthis.callEvent(\"onViewEdit\", []);\n\t\t\t\tbreak;\n\t\t\tcase \"pdf\":\n\t\t\t\twebix.toPDF(this.getBody(), {display:\"image\"});\n\t\t\t\tbreak;\n\t\t\tcase \"png\":\n\t\t\t\twebix.toPNG(this.getBody());\n\t\t\t\tbreak;\n\t\t\tcase \"excel\":\n\t\t\t\twebix.toExcel(this.getBody(), {header: false});\n\t\t\t\tbreak;\n\t\t}\n\t},\n\t_toggleExcel:function(){\n\t\tconst view = this.getBody();\n\t\tif(view.data && view.data.pull)\n\t\t\tthis._menu.showMenuItem(\"excel\");\n\t\telse\n\t\t\tthis._menu.hideMenuItem(\"excel\");\n\t},\n\t_removeView:function(view){\n\t\tif(view && view.getTopParentView() == this)\n\t\t\tthis.callEvent(\"onViewRemove\", []);\n\t}\n}, webix.ui.window);","webix.protoUI({\n\tname: \"ssheet-series\",\n\t$init: function(config){\n\t\tthis.hidden = {};\n\t\tconfig.rows = [\n\t\t\t{\n\t\t\t\tview: \"scrollview\",\n\t\t\t\tborderless: true,\n\t\t\t\tbody: {\n\t\t\t\t\tview: \"accordion\",\n\t\t\t\t\tcss: \"webix_ssheet_accordion\",\n\t\t\t\t\tmargin: webix.skin.$active.layoutMargin.form,\n\t\t\t\t\tmulti: true,\n\t\t\t\t\ttype: \"clean\",\n\t\t\t\t\trows: [\n\t\t\t\t\t\tthis.getSectionConfig()\n\t\t\t\t\t]\n\t\t\t\t},\n\t\t\t\ton:{\n\t\t\t\t\tonAfterScroll:function(){\n\t\t\t\t\t\t//close possibly open selector popups\n\t\t\t\t\t\twebix.callEvent(\"onClick\", []);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t},\n\t\t\t{ view:\"button\", label:webix.i18n.spreadsheet.labels[\"add-line\"], click:()=>{\n\t\t\t\tthis.addSection();\n\t\t\t}}\n\t\t];\n\t},\n\tgetSectionConfig: function(i){\n\t\tconst view = this;\n\t\tconst labels = webix.i18n.spreadsheet.labels;\n\t\tconst trashIcon = \"<span class='webix_icon webix_ssheet_series_icon wxi-trash'></span>\";\n\t\tconst padding = webix.skin.$active.dataPadding-2;\n\n\t\treturn {\n\t\t\tview:\"accordionitem\",\n\t\t\theader:`${labels[\"chart-item\"]} ${i ? i+1 : 1} ${trashIcon}`,\n\t\t\tbody:{\n\t\t\t\tview:\"form\",\n\t\t\t\tpadding,\n\t\t\t\telementsConfig:{\n\t\t\t\t\tlabelWidth:180\n\t\t\t\t},\n\t\t\t\ton:{\n\t\t\t\t\tonChange: () => {\n\t\t\t\t\t\tthis.callEvent(\"onChange\", []);\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\telements:[\n\t\t\t\t\t{ view:\"text\", label:labels[\"chart-range\"], name:\"range\", range:true, on:{\n\t\t\t\t\t\tonChange: function(val, oldVal) {\n\t\t\t\t\t\t\tconst upper = val.toUpperCase();\n\t\t\t\t\t\t\tif(val != upper){\n\t\t\t\t\t\t\t\tthis.blockEvent();\n\t\t\t\t\t\t\t\tthis.setValue(upper);\n\t\t\t\t\t\t\t\tthis.unblockEvent();\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tview.callEvent(\"onRangeChange\", [upper, oldVal]);\n\t\t\t\t\t\t}\n\t\t\t\t\t}},\n\t\t\t\t\t{ view:\"ssheet-colorpicker\", label:labels[\"chart-series-color\"], name:\"color\", hidden: this.hidden.color},\n\t\t\t\t\t{ view:\"checkbox\", label:labels[\"chart-tooltip\"], name:\"tooltip\" },\n\t\t\t\t\t{ view:\"checkbox\", label:labels[\"chart-label\"], name:\"label\", hidden: this.hidden.label },\n\t\t\t\t\t{ view:\"richselect\", label:labels[\"chart-markers\"], value:\"square\", name:\"marker\", hidden: this.hidden.marker,\n\t\t\t\t\t\tsuggest:{\n\t\t\t\t\t\t\tview: \"ssheet-form-suggest\",\n\t\t\t\t\t\t\tdata: [\n\t\t\t\t\t\t\t\t{id:\"square\", value:labels[\"chart-markers-square\"]},\n\t\t\t\t\t\t\t\t{id:\"triangle\", value:labels[\"chart-markers-triangle\"]},\n\t\t\t\t\t\t\t\t{id:\"diamond\", value:labels[\"chart-markers-diamond\"]},\n\t\t\t\t\t\t\t\t{id:\"round\", value:labels[\"chart-markers-round\"]}\n\t\t\t\t\t\t\t]\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t]\n\t\t\t},\n\t\t\tonClick:{\n\t\t\t\t\"wxi-trash\": function(){\n\t\t\t\t\tconst layout = this.getParentView();\n\t\t\t\t\tlayout.removeView(this);\n\n\t\t\t\t\tconst childs = layout.getChildViews();\n\n\t\t\t\t\tfor (let i = 0; i < childs.length; i++) {\n\t\t\t\t\t\tchilds[i].define({header:`${labels[\"chart-item\"]} ${i+1} ${trashIcon}`});\n\t\t\t\t\t\tchilds[i].refresh();\n\t\t\t\t\t}\n\n\t\t\t\t\tview.callEvent(\"onChange\", []);\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\t},\n\taddSection: function(){\n\t\tconst layout = this.getLayout();\n\t\tconst lastIndex = layout.getChildViews().length;\n\t\tconst layoutId = layout.addView(this.getSectionConfig(lastIndex));\n\n\t\twebix.$$(layoutId).queryView({name: \"range\"}).focus();\n\t},\n\tsetValue: function(value){\n\t\tvalue = value || [];\n\n\t\tconst layout = this.getLayout();\n\t\tconst childs = layout.getChildViews();\n\t\tconst count = childs.length;\n\n\t\tif(count > value.length)\n\t\t\tfor(let i = count; i > value.length; i--)\n\t\t\t\tthis.getLayout().removeView(childs[i-1]);\n\t\telse if(value.length > count)\n\t\t\tfor(let i = value.length; i > count; i--)\n\t\t\t\tthis.addSection();\n\n\t\tfor(let i = 0; i < childs.length; i++){\n\t\t\tconst form = childs[i].getChildViews()[0];\n\t\t\tconst range = form.queryView({name: \"range\"});\n\n\t\t\t//block range events to ignore onRangeChange\n\t\t\trange.blockEvent();\n\t\t\tform.setValues(value[i]);\n\t\t\trange.unblockEvent();\n\t\t}\n\t},\n\tsetSubValue: function(sub, value){\n\t\tsub.blockEvent();\n\t\tsub.setValue(value);\n\t\tsub.unblockEvent();\n\t},\n\tgetLayout(){\n\t\treturn this.queryView(\"scrollview\").getBody();\n\t},\n\thideSubviews(name, show){\n\t\tthis.hidden[name] = !show;\n\n\t\tthis.queryView({ name }, \"all\").forEach(view => {\n\t\t\tif(show)\n\t\t\t\tview.show();\n\t\t\telse\n\t\t\t\tview.hide();\n\t\t});\n\t},\n\tgetValue: function(){\n\t\tconst value = [];\n\n\t\tconst layout = this.getLayout();\n\t\tlayout.getChildViews().forEach(child => {\n\t\t\tvalue.push(child.getChildViews()[0].getValues());\n\t\t});\n\t\treturn value;\n\t}\n}, webix.ui.layout);","webix.protoUI({\n\tname: \"ssheet-toolbar-scrollview\",\n\t$getSize: function(){\n\t\tconst size = webix.ui.scrollview.prototype.$getSize.apply(this, arguments);\n\t\tconst bodySize = this.getBody().$getSize(0, 0);\n\n\t\tlet scroll = 0;\n\t\tif(this.config.scroll)\n\t\t\tscroll = webix.env.scrollSize;\n\t\telse\n\t\t\tthis.$view.style[\"overflow-x\"] = \"hidden\";\n\n\t\tsize[2] = size[3] = bodySize[2] + scroll;\n\n\t\treturn size;\n\t},\n\t$setSize: function(x,y){\n\t\tconst bodySize = this.getBody().$getSize(0, 0);\n\t\tconst oldScroll = this.config.scroll;\n\t\tconst scroll = x < bodySize[0] ? \"x\" : false;\n\n\t\tif(scroll != oldScroll){\n\t\t\tthis.define({scroll});\n\t\t\treturn webix.delay(()=>{\n\t\t\t\tthis.resize();\n\t\t\t});\n\t\t}\n\n\t\twebix.ui.scrollview.prototype.$setSize.apply(this, [x, y]);\n\t}\n},webix.ui.scrollview);","webix.protoUI(\n\t{\n\t\tname: \"ssheet-zoom\",\n\t\t$cssName: \"counter webix_ssheet_zoom\",\n\t\t$init: function() {\n\t\t\tthis.attachEvent(\"onAfterRender\", () => {\n\t\t\t\tthis.$setValue(this.config.value);\n\t\t\t\tthis.getInputNode().readOnly = true;\n\t\t\t\twebix.event(this.$view.firstChild, \"keydown\", e =>\n\t\t\t\t\twebix.html.preventEvent(e)\n\t\t\t\t);\n\t\t\t});\n\t\t},\n\t\t$setValue: function(value) {\n\t\t\tthis.getInputNode().value = parseInt(value * 100, 10) + \"%\";\n\t\t},\n\t\tgetNext: function(value, step, numbers) {\n\t\t\tconst index = numbers.indexOf(value);\n\n\t\t\tif(index != -1)\n\t\t\t\treturn numbers[index + step] || value;\n\n\t\t\tlet nextValue;\n\t\t\tfor(let i = 0; i < numbers.length; i++){\n\t\t\t\tif(numbers[i] > value){\n\t\t\t\t\tif(step < 0){\n\t\t\t\t\t\tif(--i == -1)\n\t\t\t\t\t\t\treturn value;\n\t\t\t\t\t}\n\t\t\t\t\tnextValue = numbers[i];\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif(step < 0 && !nextValue)\n\t\t\t\tnextValue = numbers[numbers.length - 1];\n\n\t\t\treturn nextValue || value;\n\t\t},\n\t\tshift: function(step, config) {\n\t\t\tconst v = this.config.value;\n\t\t\tconst arr = this.config.numbers;\n\n\t\t\tconst value = this.getNext(v, step, arr);\n\t\t\tthis.setValue(value, config);\n\t\t},\n\t},\n\twebix.ui.counter\n);","import {getJsDateFromExcel, getExcelDateFromJs} from \"../mathematics/methods\";\nimport {getDateEditFormat} from \"../operations/formats\";\n\nwebix.editors.excel_date = webix.extend({\n\tcreatePopup:function(){\n\t\tconst editor = webix.editors.excel_date;\n\n\t\tif(!editor.popup){\n\t\t\tconst popup = webix.ui({\n\t\t\t\tview:\"popup\",\n\t\t\t\tbody:{ \n\t\t\t\t\tview:\"calendar\",\n\t\t\t\t\ticons:true,\n\t\t\t\t\ttimepicker:true,\n\t\t\t\t\ton:{\n\t\t\t\t\t\tonChange: function(val){\n\t\t\t\t\t\t\tval = val[0];\n\t\t\t\t\t\t\tthis.getParentView()._last_input_target.value = val ? getExcelDateFromJs(val) : \"\";\n\t\t\t\t\t\t\twebix.callEvent(\"onEditEnd\", []);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\ton:{\n\t\t\t\t\tonEnter: function(){\n\t\t\t\t\t\twebix.callEvent(\"onEditEnd\", []);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t});\n\t\t\teditor.popup = popup.config.id;\n\t\t}\n\n\t\treturn editor.popup;\n\t},\n\trender:function(){\n\t\tconst node = webix.html.create(\"div\", {\n\t\t\t\"class\":\"webix_dt_editor\"\n\t\t}, \"<input type='text'>\");\n\n\t\tthis.popup = this.createPopup();\n\n\t\twebix.event(node.firstChild, \"click\", ()=> this.getPopup().show(node));\n\n\t\treturn node;\n\t},\n\tgetPopup(){\n\t\treturn webix.$$(this.popup);\n\t},\n\tshowPopup:function(){\n\t\tconst input = this.getInputNode();\n\t\tconst popup = this.getPopup();\n\n\t\tpopup._last_input_target = input;\n\t\tpopup.show(input);\n\n\t\tinput.setAttribute(\"aria-expanded\", \"true\");\n\t},\n\tupdateCalendar(value){\n\t\tconst calendar = this.getPopup().getBody();\n\n\t\tcalendar.blockEvent();\n\t\tcalendar.setValue(value);\n\t\tcalendar.unblockEvent();\n\t},\n\tafterRender:function(){\n\t\tthis.showPopup();\n\t},\n\tsetValue:function(value){\n\t\tconst noDate = (value === \"\" || isNaN(value*1));\n\t\tvalue = noDate ? new Date() : getJsDateFromExcel(value);\n\t\tthis.updateCalendar(value);\n\n\t\tconst view = webix.$$(this.config.node).queryView(a => a.name === \"spreadsheet\", \"parent\");\n\t\tconst format = getDateEditFormat(view, this.config.row.id, this.config.id);\n\t\tthis.getInputNode().value = format(value);\n\t},\n\tgetValue:function(){\n\t\tconst value = this.getInputNode().value;\n\t\tthis.getPopup().hide();\n\t\treturn value;\n\t}\n}, webix.editors.text);","webix.editors.ss_richselect = webix.extend({\n\tgetFormat:function(value){\n\t\tconst list = this.getInputNode();\n\t\tlet item;\n\n\t\tif (value && list.exists(value))\n\t\t\titem = list.getItem(value);\n\t\treturn item && item.format;\n\t},\n\tpopupInit:function(popup){\n\t\twebix.editors.richselect.popupInit.apply(this, arguments);\n\n\t\tpopup.getList().define(\"template\", function(obj){\n\t\t\treturn obj.$value || obj.value;\n\t\t});\n\t}\n}, webix.editors.richselect);","import {changeAreaDecimals} from \"../operations/formats\";\n\nexport const actions = {\n\tspan: view => {\n\t\tconst range = view.$$(\"cells\").getSelectArea();\n\t\tif(range){\n\t\t\tif(isMerged(view,range))\n\t\t\t\tview.splitCell();\n\t\t\telse {\n\t\t\t\tconst values = [];\n\t\t\t\tfor(let r = range.start.row; r<=range.end.row; r++){\n\t\t\t\t\tfor(let c = range.start.column; c<=range.end.column; c++){\n\t\t\t\t\t\tlet value = view.getCellValue(r,c);\n\t\t\t\t\t\tif(value) values.push(value);\n\t\t\t\t\t\tif(values.length >1) break;\n\t\t\t\t\t}\n\t\t\t\t\tif(values.length >1) break;\n\t\t\t\t}\n\t\t\t\tif(values.length>1){\n\t\t\t\t\tview.confirm({\n\t\t\t\t\t\ttext:webix.i18n.spreadsheet.labels[\"merge-cell-confirm\"]\n\t\t\t\t\t}).then(()=> view.combineCells() );\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t\tview.combineCells();\n\t\t\t}\n\t\t}\n\t},\n\tundo: view => view.undo(),\n\tredo: view => view.redo(),\n\t\"hide-gridlines\": view => view.hideGridlines(\"toggle\"),\n\t\"hide-headers\": view => view.hideHeaders(\"toggle\"),\n\t\"freeze-columns\": view => view.freezeColumns(),\n\t\"freeze-rows\": view => view.freezeRows(),\n\t\"increase-decimals\": view => changeAreaDecimals(view, 1),\n\t\"decrease-decimals\": view => changeAreaDecimals(view, -1),\n\t\"increase-indent\": view => view.callEvent(\"onStyleSet\", [\"indent\", 1]),\n\t\"decrease-indent\": view => view.callEvent(\"onStyleSet\", [\"indent\", -1]),\n\t\"show-formulas\": view => view.showFormulas(\"toggle\"),\n\t\"print-borders\": view => view.showPrintBorders(\"toggle\"),\n};\n\nfunction isMerged(view,range){\n\tvar i, j,\n\t\tc0 = range.start,\n\t\tc1 = range.end;\n\n\tfor( i = c0.row*1; i <= c1.row*1; i++ ){\n\t\tfor( j = c0.column*1; j <= c1.column*1; j++ ){\n\t\t\tif(view.$$(\"cells\").getSpan(i, j))\n\t\t\t\treturn true;\n\t\t}\n\t}\n\treturn false;\n}\n","import {toolbarSizes, defaultStyles} from \"./defaults\";\nimport {formatHelpers} from \"../operations/formats\";\n\n// options for 'font-family' select\nexport const fontFamily = [\n\t{id: \"Arial\", value: \"Arial\"},\n\t{id: \"'Roboto', sans-serif\", value: \"Roboto\"},\n\t{id: \"'PT Sans', Tahoma\", value: \"PT Sans\"},\n\t{id: \"'Open Sans', sans-serif\", value:\"Open Sans\"},\n\t{id: \"Tahoma\", value: \"Tahoma\"},\n\t{id: \"Verdana\", value: \"Verdana\"},\n\t{id: \"Calibri, Tahoma\", value:\"Calibri\"}\n];\n\n// options for 'format' select\nfunction getCellFormats(){\n\tconst locale = webix.i18n.spreadsheet.labels;\n\treturn [\n\t\t{id: \"common\", value: locale.common },\n\t\t{id: \"price\", value: locale.currency, example: \"98.20\"},\n\t\t{id: \"int\", value: locale.number, example: \"2120.02\"},\n\t\t{id: \"percent\", value: locale.percent, example:\"0.5\"},\n\t\t{id: \"date\", value: locale.date, example:\"45000\"},\n\t\t{id: \"string\", value: locale.string, example:\"012345\"},\n\t\t{id: \"custom\", value: locale[\"custom-format\"]},\n\t];\n}\n\nexport function getColumnOperation(view){\n\tconst locale = webix.i18n.spreadsheet.menus;\n\tlet colOperations = [\n\t\t{ id:\"add\",    group:\"column\", value:locale[\"insert-column\"]},\n\t\t{ id:\"del\",    group:\"column\", value:locale[\"delete-column\"]},\n\t\t{ id:\"show\",   group:\"column\", value:locale[\"show-column\"], neighbors:true},\n\t\t{ id:\"hide\",   group:\"column\", value:locale[\"hide-column\"]}\n\t];\n\tif(view.config.resizeCell != false)\n\t\tcolOperations.push({ id:\"resize\", group:\"column\", value:locale[\"resize-column\"]});\n\treturn colOperations;\n}\n\nexport function getRowOperation(view){\n\tconst locale = webix.i18n.spreadsheet.menus;\n\tlet rowOperations = [\n\t\t{ id:\"add\",    group:\"row\", value:locale[\"insert-row\"]},\n\t\t{ id:\"del\",    group:\"row\", value:locale[\"delete-row\"]},\n\t\t{ id:\"show\",   group:\"row\", value:locale[\"show-row\"], neighbors:true},\n\t\t{ id:\"hide\",   group:\"row\", value:locale[\"hide-row\"]}\n\t];\n\tif(view.config.resizeCell != false)\n\t\trowOperations.push({ id:\"resize\", group:\"row\", value:locale[\"resize-row\"]});\n\treturn rowOperations;\n}\n\n// options for 'clear' select\nexport function getClearOperation(){\n\treturn [\n\t\t{id: \"clear-value\",               value: getLocaleClear(\"value\")},\n\t\t{id: \"clear-style\",               value: getLocaleClear(\"style\")},\n\t\t{id: \"clear-conditional-formats\", value: getLocaleClear(\"conditional-formats\")},\n\t\t{id: \"clear-dropdown-editors\",    value: getLocaleClear(\"dropdown-editors\")},\n\t\t{id: \"clear-comments\",            value: getLocaleClear(\"comments\")},\n\t\t{ $template: \"Separator\" },\n\t\t{id: \"clear-all\",                 value: getLocaleClear(\"all\")}\n\t];\n}\n\n// options for 'borders' select\nconst borders = [\n\t{id: \"no\", value: \"no\"},\n\t{id: \"left\", value: \"left\"},\n\t{id: \"top\", value: \"top\"},\n\t{id: \"right\", value: \"right\"},\n\t{id: \"bottom\", value: \"bottom\"},\n\t{id: \"all\", value: \"all\"},\n\t{id: \"outer\", value: \"outer\"},\n\t{id: \"top-bottom\", value: \"top-bottom\"}\n];\n\nfunction getLocaleClear(value){\n\tvar locale = webix.i18n.spreadsheet.menus;\n\treturn locale[\"clear\"] + \" \" + locale[\"clear-\"+value].toLowerCase();\n}\n\n// options for 'font-size' select\nfunction getFontSize(){\n\treturn [\n\t\t\"8\",\"9\",\"10\",\"11\",\"12\",\"14\",\"15\",\n\t\t\"16\",\"18\",\"20\",\"22\",\"24\",\"28\",\"36\"\n\t];\n}\n\nexport const styleFormats = {\n\t\"font-weight\": \"bold\",\n\t\"font-style\": \"italic\",\n\t\"underline\": \"underline\",\n\t\"strike\": \"strike\"\n};\n\nexport const ui = {\n\tbutton: function(config){\n\t\treturn {\n\t\t\tview: \"ssheet-toggle\", width: config.width||toolbarSizes.width, id: config.name, name: config.name,  label: config.label,\n\t\t\tcss: config.css||\"\", onValue: styleFormats[config.name], offValue: \"normal\",\n\t\t\ttooltip: webix.i18n.spreadsheet.tooltips[config.name]||\"\"\n\t\t};\n\t},\n\tcolorButton: function(config){\n\t\treturn {\n\t\t\tview: \"ssheet-color\",  css: config.css,  name: config.name, width: config.width||toolbarSizes.width+24,\n\t\t\ttitle: \"<span class='webix_ssheet_button_icon webix_ssheet_color_button_icon webix_ssheet_icon ssi-\"+config.name+\"' ></span>\",\n\t\t\ttooltip: webix.i18n.spreadsheet.tooltips[config.name]||\"\"\n\t\t};\n\t},\n\ttoggleButton: function(config){\n\t\treturn {\n\t\t\tview: \"ssheet-toggle-silent\", width: toolbarSizes.width, id: config.name, name: config.name,\n\t\t\tlabel: \"<span class='webix_ssheet_button_icon webix_ssheet_icon ssi-\"+(config.icon||config.name)+\"'></span>\",\n\t\t\ttooltip: webix.i18n.spreadsheet.tooltips[config.name]||\"\"\n\t\t};\n\t},\n\ticonButton: function(config){\n\t\tvar btn = webix.copy(config);\n\t\twebix.extend(btn, {view: \"button\", width: toolbarSizes.width, id: config.name,\n\t\t\tlabel: \"<span class='webix_ssheet_button_icon webix_ssheet_icon ssi-\"+config.name+\"'></span>\",\n\t\t\tcss: \"\",\n\t\t\ttooltip: webix.i18n.spreadsheet.tooltips[config.name]||webix.i18n.spreadsheet.menus[config.name]||\"\"\n\t\t});\n\t\tif(config.onValue){\n\t\t\twebix.extend(btn,{view: \"ssheet-toggle\", onValue: config.onValue, offValue: config.offValue},true);\n\t\t}\n\n\t\treturn btn;\n\t},\n\tsegmented: function(config){\n\t\treturn  {\n\t\t\tview: \"segmented\", name: config.name, css:config.css||\"\", width: config.width||toolbarSizes.width+76,  options:config.options\n\t\t};\n\t},\n\tselect: function(config){\n\t\twebix.extend(config,{\n\t\t\tview: \"richselect\",\n\t\t\tid: config.name,\n\t\t\tvalue: defaultStyles[config.name],\n\t\t\tsuggest: {\n\t\t\t\tcss: \"webix_ssheet_suggest\",\n\t\t\t\tpadding: 0,\n\t\t\t\tdata: config.options\n\t\t\t}\n\t\t});\n\n\t\tconfig.tooltip = webix.i18n.spreadsheet.tooltips[config.name]||\"\";\n\t\tif(config.popupWidth){\n\t\t\tconfig.suggest.fitMaster = false;\n\t\t\tconfig.suggest.width = config.popupWidth;\n\t\t}\n\t\tif(config.popupTemplate)\n\t\t\tconfig.suggest.body = {\n\t\t\t\ttemplate: config.popupTemplate\n\t\t\t};\n\t\tif(config.popupEvents){\n\t\t\tconfig.suggest.body = config.suggest.body || {};\n\t\t\tconfig.suggest.body.on = config.popupEvents;\n\t\t}\n\t\treturn config;\n\t},\n\tseparator: function(){\n\t\treturn {\n\t\t\tview: \"ssheet-separator\"\n\t\t};\n\t},\n\ttitle: function(config){\n\t\tvar title = config.title;\n\t\tif(title.indexOf(\"$\") === 0)\n\t\t\ttitle = \"\";\n\t\ttitle = webix.i18n.spreadsheet.labels[config.title]||title;\n\n\t\treturn {\n\t\t\ttemplate: title, view: \"ssheet-bar-title\", height: toolbarSizes.titleHeight\n\t\t};\n\t},\n\tborders: function(config){\n\t\treturn {view: \"ssheet-borders\", width:config.width||toolbarSizes.width+24, data: borders, id: config.name, name: config.name,\n\t\t\ttooltip: webix.i18n.spreadsheet.tooltips[config.name] };\n\t},\n\talign: function(config){\n\t\treturn {view: \"ssheet-align\", value: defaultStyles[config.name], width:config.width||toolbarSizes.width+24, data: config.options,\n\t\t\tname: config.name, tooltip: webix.i18n.spreadsheet.tooltips[config.name] };\n\t},\n\tcondFormat: function(config){\n\t\treturn {\n\t\t\tview: \"ssheet-cond-format\",\n\t\t\twidth: 40,\n\t\t\tid: config.name,\n\t\t\tname: config.name\n\t\t};\n\t}\n};\n\nexport const buttonsMap = {\n\t\"font-family\": function(){\n\t\treturn  ui.select({name: \"font-family\", options:fontFamily, width: 100, view:\"combo\"});\n\t},\n\t\"font-size\": function(){\n\t\treturn  ui.select({name: \"font-size\", options:getFontSize(), width: 70, view:\"text\", icon: \"wxi-menu-down\", css: \"webix_ssheet_text\",\n\t\t\ton: {\n\t\t\t\tonItemClick: function(){\n\t\t\t\t\tconst suggest = webix.$$(this.config.suggest);\n\t\t\t\t\tif(!suggest.isVisible())\n\t\t\t\t\t\tsuggest.show(this.getInputNode());\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t},\n\t\"font-weight\": function(){\n\t\treturn ui.button({name:\"font-weight\",label: \"B\", css: \"webix_ssheet_bold\"});\n\t},\n\t\"font-style\": function(){\n\t\treturn ui.button({name: \"font-style\",label: \"I\",css:\"webix_ssheet_italic\"});\n\t},\n\t\"underline\": function(){\n\t\treturn ui.button({name: \"underline\",label: \"U\",css: \"webix_ssheet_underline\"});\n\t},\n\t\"strike\": function(){\n\t\treturn ui.button({name: \"strike\",label: \"S\",css: \"webix_ssheet_strike\"});\n\t},\n\t\"color\": function(){\n\t\treturn ui.colorButton({name: \"color\",icon:\"font\",css:\"webix_ssheet_color\"});\n\t},\n\t\"background\": function(){\n\t\treturn  ui.colorButton({name: \"background\",icon:\"paint-brush\",css:\"webix_ssheet_background\", width: 70});\n\t},\n\t\"borders\": function(){\n\t\treturn ui.borders({ name: \"borders\" });\n\t},\n\t\"text-align\": function(){\n\t\tvar locale = webix.i18n.spreadsheet.tooltips;\n\t\treturn ui.align({name: \"text-align\", css: \"webix_ssheet_align\", options:[\n\t\t\t{id: \"left\", css: \"webix_ssheet_icon ssi-left\", tooltip: locale[\"align-left\"]},\n\t\t\t{id: \"center\", css: \"webix_ssheet_icon ssi-center\", tooltip: locale[\"align-center\"]},\n\t\t\t{id: \"right\", css: \"webix_ssheet_icon ssi-right\", tooltip: locale[\"align-right\"]}\n\t\t]});\n\t},\n\t\"vertical-align\": function(){\n\t\tvar locale = webix.i18n.spreadsheet.tooltips;\n\t\treturn  ui.align({name: \"vertical-align\", css: \"webix_ssheet_align\", options:[\n\t\t\t{id: \"top\", css: \"webix_ssheet_icon ssi-top\", tooltip: locale[\"align-top\"]},\n\t\t\t{id: \"middle\", css: \"webix_ssheet_icon ssi-middle\", tooltip: locale[\"align-middle\"]},\n\t\t\t{id: \"bottom\", css: \"webix_ssheet_icon ssi-bottom\", tooltip: locale[\"align-bottom\"]}\n\t\t]});\n\t},\n\t\"wrap\": function(){\n\t\treturn ui.iconButton({name: \"wrap\", onValue:\"wrap\", offValue:\"nowrap\"});\n\t},\n\t\"format\": function(){\n\t\treturn ui.select({\n\t\t\tname: \"format\", width: 106, options:getCellFormats(), popupWidth: 180,\n\t\t\tpopupTemplate: function(obj){\n\t\t\t\t//make it look like an actual cell\n\t\t\t\tvar format =  formatHelpers[obj.id] ? formatHelpers[obj.id].getFormat : \"\";\n\t\t\t\tvar cell = {css:\"\"};\n\t\t\t\tvar example = format && obj.example?format(obj.example, cell):\"\";\n\t\t\t\treturn obj.value + (format?\"<span class='webix_ssheet_right\"+(cell.css?\" \"+cell.css:\"\")+\"'>\"+example+\"</span>\":\"\");\n\t\t\t},\n\t\t\tpopupEvents:{\n\t\t\t\tonItemClick: function(id){\n\t\t\t\t\tif(id == \"custom\")\n\t\t\t\t\t\tthis.getTopParentView().callEvent(\"onCommand\", [{id:id}]);\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t},\n\t\"column\": function(view){\n\t\treturn {\n\t\t\tname: \"column\",\n\t\t\tview: \"ssheet-button\", icon: \"column\",\n\t\t\tarrow: true, area: true, width: 58,\n\t\t\toptions:getColumnOperation(view)\n\t\t};\n\t},\n\t\"row\": function(view){\n\t\treturn {\n\t\t\tname: \"row\", view: \"ssheet-button\", icon: \"row\",\n\t\t\tarrow: true, area: true, width: 58,\n\t\t\toptions:getRowOperation(view)\n\t\t};\n\t},\n\t\"clear\": function(){\n\t\treturn {\n\t\t\tname: \"clear\", view: \"ssheet-button\", icon: \"clear-styles\",\n\t\t\tarrow: true, area: true, width: 58,\n\t\t\toptions:getClearOperation()\n\t\t};\n\t},\n\t\"image\":function(){\n\t\treturn {\n\t\t\tname:\"image\", view:\"ssheet-button\", icon:\"add-image\",\n\t\t\tarrow:true, options:[\n\t\t\t\t{id:\"add-image-cell\", value: webix.i18n.spreadsheet.labels[\"add-image-cell\"]},\n\t\t\t\t{id:\"add-image-top\", value: webix.i18n.spreadsheet.labels[\"add-image-top\"]}\n\t\t\t]\n\t\t};\n\t},\n\t\"graph\":function(){\n\t\treturn {\n\t\t\tname:\"graph\", view:\"ssheet-button\", icon:\"add-sparkline\",\n\t\t\tarrow:true, options:[\n\t\t\t\t{id:\"add-sparkline\", value:webix.i18n.spreadsheet.labels[\"add-sparkline\"]},\n\t\t\t\t{id:\"add-chart\", value: webix.i18n.spreadsheet.labels[\"add-chart\"]}\n\t\t\t]\n\t\t};\n\t},\n\t\"comment\": function(){\n\t\treturn {\n\t\t\tname: \"comment\",\n\t\t\tview: \"ssheet-button\", icon: \"comments\",\n\t\t\tarrow: true, area: true, width: 55\n\t\t};\n\t},\n\t\"create-filter\": function(){\n\t\treturn ui.toggleButton({name: \"create-filter\"});\n\t},\n\t\"hide-gridlines\": function(){\n\t\treturn ui.toggleButton({name: \"hide-gridlines\"});\n\t},\n\t\"hide-headers\": function(){\n\t\treturn ui.toggleButton({name: \"hide-headers\"});\n\t},\n\t\"show-formulas\": function(){\n\t\treturn ui.toggleButton({name: \"show-formulas\"});\n\t},\n\t\"print-borders\": function(){\n\t\treturn ui.toggleButton({name: \"print-borders\", icon:\"borders-no\"});\n\t}\n};","import {toolbarSizes} from \"./defaults\";\n\nfunction getText(text){\n\tvar locale = webix.i18n.spreadsheet;\n\treturn locale.menus[text] || locale.labels[text] || locale.tooltips[text] || text;\n}\nfunction calcButtons(){\n\tvar i, name, width,\n\t\tgroups = {\n\t\t\t\"undo\":[\"undo\",\"redo\"],\n\t\t\t\"insert\":[\"add-sparkline\",\"add-image\",\"add-comment\"]\n\t\t},\n\t\tresult = {};\n\n\tfor( name in groups){\n\t\tresult[name] = 0;\n\t\tfor(i=0; i < groups[name].length; i++){\n\t\t\twidth = webix.html.getTextSize(getText(groups[name][i]), \"webix_ssheet_button_measure\").width + 7;\n\t\t\tresult[name] = Math.max(width,result[name]);\n\t\t}\n\t}\n\treturn result;\n}\nexport function getAllElements(readonly){\n\tconst sizes = calcButtons();\n\tconst titleHeight = toolbarSizes.titleHeight;\n\n\tif(readonly)\n\t\treturn [\n\t\t\t{\n\t\t\t\tpadding: 3,\n\t\t\t\tmargin: 0,\n\t\t\t\trows: [\n\t\t\t\t\t{\n\t\t\t\t\t\tmargin: 2,\n\t\t\t\t\t\tcols:[\n\t\t\t\t\t\t\t{$button: \"excel-export\"},\n\t\t\t\t\t\t\t{$button: \"print\"},\n\t\t\t\t\t\t\t{$button: \"print-borders\"}\n\t\t\t\t\t\t]\n\t\t\t\t\t},\n\t\t\t\t\t{template: getText(\"file\"), view: \"ssheet-bar-title\", height: titleHeight}\n\t\t\t\t]\n\t\t\t},\n\t\t\t{view: \"ssheet-separator\"},\n\t\t\t{}\n\t\t];\n\n\treturn [\n\t\t{\n\t\t\tpadding: 3,\n\t\t\tmargin: 0,\n\t\t\trows:[\n\t\t\t\t{\n\t\t\t\t\tmargin: 2,\n\t\t\t\t\tcols: [\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tname: \"sheet\", view: \"ssheet-button-icon-top\", label: getText(\"sheet\"), arrow: true,\n\t\t\t\t\t\t\toptions:[\n\t\t\t\t\t\t\t\t{id: \"new-sheet\"},\n\t\t\t\t\t\t\t\t{id: \"copy-sheet\"},\n\t\t\t\t\t\t\t\t{id: \"remove-sheet\"},\n\t\t\t\t\t\t\t\t{id: \"hide-sheet\"}\n\t\t\t\t\t\t\t]\n\t\t\t\t\t\t},\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\trows:[\n\t\t\t\t\t\t\t\t{$button: \"excel-import\"},\n\t\t\t\t\t\t\t\t{$button: \"excel-export\"}\n\t\t\t\t\t\t\t]\n\t\t\t\t\t\t},\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\trows:[\n\t\t\t\t\t\t\t\t{$button: \"print\"},\n\t\t\t\t\t\t\t\t{$button: \"print-borders\"}\n\t\t\t\t\t\t\t]\n\t\t\t\t\t\t}\n\t\t\t\t\t]\n\t\t\t\t},\n\t\t\t\t{template: getText(\"file\"), view: \"ssheet-bar-title\", height: titleHeight, width: 85}\n\t\t\t]\n\t\t},\n\t\t{view: \"ssheet-separator\"},\n\t\t{\n\t\t\tpadding: 3,\n\t\t\trows:[\n\t\t\t\t{$button: \"undo\", view: \"ssheet-button\", label: getText(\"undo\"), width: sizes.undo },\n\t\t\t\t{$button: \"redo\", view: \"ssheet-button\", label: getText(\"redo\"), width: sizes.undo},\n\t\t\t\t{template: getText(\"undo-redo\"), view: \"ssheet-bar-title\", height: titleHeight}\n\t\t\t]\n\t\t},\n\t\t{view: \"ssheet-separator\"},\n\t\t{\n\t\t\tpadding: 3,\n\t\t\trows:[\n\t\t\t\t{\n\t\t\t\t\tmargin: 2,\n\t\t\t\t\tcols:[\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tmargin: 2,\n\t\t\t\t\t\t\tcols:[\n\t\t\t\t\t\t\t\t{$button: \"font-family\", width: (webix.skin.$active.inputHeight+2)*4+6},\n\t\t\t\t\t\t\t\t{$button: \"font-size\"}\n\t\t\t\t\t\t\t]\n\t\t\t\t\t\t},\n\t\t\t\t\t\t{$button: \"borders\"}\n\t\t\t\t\t]\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tmargin: 2,\n\t\t\t\t\tcols:[\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tmargin: 2,\n\t\t\t\t\t\t\tcols:[\n\t\t\t\t\t\t\t\t{$button: \"font-weight\"},\n\t\t\t\t\t\t\t\t{$button: \"font-style\"},\n\t\t\t\t\t\t\t\t{$button: \"underline\"},\n\t\t\t\t\t\t\t\t{$button: \"strike\"}\n\t\t\t\t\t\t\t]\n\t\t\t\t\t\t},\n\n\t\t\t\t\t\t{$button: \"background\"},\n\t\t\t\t\t\t{$button: \"color\"}\n\t\t\t\t\t]\n\n\t\t\t\t},\n\t\t\t\t{template: getText(\"font\"), view: \"ssheet-bar-title\", height: titleHeight}\n\t\t\t]\n\t\t},\n\t\t{view: \"ssheet-separator\"},\n\t\t{\n\t\t\tpadding: 3,\n\t\t\trows:[\n\t\t\t\t{\n\t\t\t\t\tmargin: 2,\n\t\t\t\t\tcols:[\n\t\t\t\t\t\t{$button: \"text-align\"},\n\t\t\t\t\t\t{$button: \"span\"},\n\t\t\t\t\t\t{$button: \"increase-indent\"}\n\t\t\t\t\t]\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tmargin: 2,\n\t\t\t\t\tcols:[\n\t\t\t\t\t\t{$button: \"vertical-align\"},\n\t\t\t\t\t\t{$button: \"wrap\"},\n\t\t\t\t\t\t{$button: \"decrease-indent\"}\n\t\t\t\t\t]\n\t\t\t\t},\n\t\t\t\t{template: getText(\"align\"), view: \"ssheet-bar-title\", height: titleHeight}\n\t\t\t]\n\t\t},\n\t\t{view: \"ssheet-separator\"},\n\t\t{\n\t\t\tpadding: 3,\n\t\t\trows:[\n\t\t\t\t{$button: \"format\"},\n\t\t\t\t{\n\t\t\t\t\tmargin: 2,\n\t\t\t\t\tcols:[\n\t\t\t\t\t\t{$button: \"increase-decimals\"},\n\t\t\t\t\t\t{$button: \"decrease-decimals\"}\n\t\t\t\t\t]\n\t\t\t\t},\n\n\t\t\t\t{template: getText(\"number\"), view: \"ssheet-bar-title\", height: titleHeight}\n\t\t\t]\n\t\t},\n\t\t{view: \"ssheet-separator\"},\n\t\t{\n\t\t\tpadding: 3,\n\t\t\trows:[\n\t\t\t\t{cols:[\n\t\t\t\t\t{ $button: \"sort-asc\"},\n\t\t\t\t\t{ $button: \"create-filter\"},\n\t\t\t\t\t{ $button: \"conditional-format\"},\n\t\t\t\t\t{ $button: \"add-link\"},\n\t\t\t\t\t{ $button: \"clear\"}\n\t\t\t\t]},\n\t\t\t\t{cols:[\n\t\t\t\t\t{ $button: \"sort-desc\"},\n\t\t\t\t\t{ $button: \"add-range\"},\n\t\t\t\t\t{ $button: \"lock-cell\"},\n\t\t\t\t\t{ $button: \"add-dropdown\"}\n\t\t\t\t]},\n\t\t\t\t{template: getText(\"edit\"), view: \"ssheet-bar-title\", height: titleHeight}\n\t\t\t]\n\t\t},\n\t\t{view: \"ssheet-separator\"},\n\t\t{\n\t\t\tpadding: 3,\n\t\t\trows:[\n\t\t\t\t{\n\t\t\t\t\tcols:[\n\t\t\t\t\t\t{$button: \"image\", view: \"ssheet-button\", label: getText(\"image\"), width:sizes.insert},\n\t\t\t\t\t\t{$button: \"add-comment\", view: \"ssheet-button\", label: getText(\"comment\"), width:sizes.insert},\n\t\t\t\t\t]\n\t\t\t\t},\n\t\t\t\t{$button: \"graph\", view: \"ssheet-button\", label: getText(\"graph\"), width:sizes.insert},\n\t\t\t\t{template: getText(\"insert\"), view: \"ssheet-bar-title\", height: titleHeight}\n\t\t\t]\n\t\t},\n\t\t{view: \"ssheet-separator\"},\n\t\t{\n\t\t\tpadding: 3,\n\t\t\trows:[\n\t\t\t\t{\n\t\t\t\t\tcols:[\n\t\t\t\t\t\t{rows:[\n\t\t\t\t\t\t\t{$button:\"row\"},\n\t\t\t\t\t\t\t{$button:\"column\"}\n\t\t\t\t\t\t]},\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\trows:[\n\t\t\t\t\t\t\t\t{$button:\"hide-gridlines\"},\n\t\t\t\t\t\t\t\t{$button:\"hide-headers\"}\n\t\t\t\t\t\t\t]\n\t\t\t\t\t\t},\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\trows:[\n\t\t\t\t\t\t\t\t{$button:\"freeze-rows\"},\n\t\t\t\t\t\t\t\t{$button:\"freeze-columns\"}\n\t\t\t\t\t\t\t]\n\t\t\t\t\t\t},\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\trows:[\n\t\t\t\t\t\t\t\t{$button:\"show-formulas\"},\n\t\t\t\t\t\t\t\t{}\n\t\t\t\t\t\t\t]\n\t\t\t\t\t\t}\n\t\t\t\t\t]\n\t\t\t\t},\n\t\t\t\t{template: getText(\"view\"), view: \"ssheet-bar-title\", height: titleHeight}\n\t\t\t]\n\t\t},\n\t\t{view: \"ssheet-separator\"},\n\t\t{}\n\t];\n}","import {actions} from \"./toolbar/actions\";\nimport {defaultStyles} from \"./toolbar/defaults\";\nimport {toolbarButtons, getButtons} from \"./toolbar/helpers\";\nimport * as elm from \"./toolbar/all_elements\";\nimport {isCustom} from \"./operations/formats\";\nimport {getStyle, getFormat} from \"./operations/styles\";\n\nconst buttons = {\n\t\"undo-redo\": [\"undo\",\"redo\"],\n\t\"font\": [\"font-family\",\"font-size\",\"font-weight\",\"font-style\",\"underline\",\"strike\",\"color\",\"background\",\"borders\"],\n\t\"align\": [\"text-align\",\"vertical-align\",\"wrap\",\"span\",\"increase-indent\",\"decrease-indent\"],\n\t\"format\": [\"format\"]\n};\n\n\nexport function init(view){\n\tview.attachEvent(\"onComponentInit\", () => ready(view));\n\tview.attachEvent(\"onCommand\", (action) => {\n\t\tif (action.id == \"toolbar-update\"){\n\t\t\tif(action.name)\n\t\t\t\tupdateValue(view, action.name, action.value);\n\t\t\telse\n\t\t\t\tsetValues(view, view.getSelectedId(true));\n\t\t}\n\t});\n\n\tlet elements = [];\n\n\tif(view.config.toolbar){\n\t\tlet allElements =  view.config.toolbar;\n\t\tif(allElements == \"full\"){\n\t\t\tallElements = elm.getAllElements(view.config.readonly);\n\t\t\tif(webix.isUndefined(view.config.bottombar))\n\t\t\t\tview.config.bottombar = true;\n\t\t}\n\t\telements =   toolbarButtons(view, allElements);\n\t}\n\telse\n\t\telements =   getButtons(view, view.config.buttons || buttons);\n\n\tconst bar = {\n\t\tview: webix.env.$customScroll ? \"scrollview\" : \"ssheet-toolbar-scrollview\",\n\t\tscroll: \"x\",\n\t\tbody: {\n\t\t\tview:\"toolbar\",\n\t\t\tcss: \"webix_ssheet_toolbar webix_layout_toolbar\",\n\t\t\tid:\"bar\",\n\t\t\tpadding:0,\n\t\t\telements,\n\t\t\ton: {\n\t\t\t\tonChange: function (value, old, config){\n\t\t\t\t\tif(config == \"user\"){\n\t\t\t\t\t\tconst source = this.$eventSource;\n\t\t\t\t\t\tconst name = source.config.name;\n\t\t\t\t\t\tif(name == \"format\" && value == \"common\")\n\t\t\t\t\t\t\tvalue = \"\";\n\n\t\t\t\t\t\tconst size = name == \"font-size\";\n\t\t\t\t\t\tif((size || name == \"font-family\") && (!value || (size && isNaN(value))))\n\t\t\t\t\t\t\treturn source.setValue(old);\n\t\t\t\t\t\telse if(size){\n\t\t\t\t\t\t\tconst maxSize = Math.floor(400 / 0.75); // 400 pt - max excel font size; divide 0.75 - pt to px conversion\n\t\t\t\t\t\t\tconst limited = Math.max(1, Math.min(maxSize, value));\n\t\t\t\t\t\t\tif (limited != value){\n\t\t\t\t\t\t\t\tvalue = limited;\n\t\t\t\t\t\t\t\tsource.setValue(value);\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tvalue += \"px\";\n\t\t\t\t\t\t}\n\n\n\t\t\t\t\t\tif(!(name == \"format\" && value == \"custom\"))\n\t\t\t\t\t\t\tview.callEvent(\"onStyleSet\", [name, value]);\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\tonItemClick: function (id){\n\t\t\t\t\tvar viewId = view.innerId(id);\n\t\t\t\t\tif (actions[viewId])\n\t\t\t\t\t\tactions[viewId].call(this, view);\n\t\t\t\t\telse\n\t\t\t\t\t\tview.callEvent(\"onCommand\", [{ id: viewId }]);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t};\n\n\tview.callEvent(\"onViewInit\", [\"toolbar\", bar]);\n\treturn bar;\n\n}\n\nfunction ready(view){\n\tview.attachEvent(\"onAfterSelect\", (selected) => setValues(view, selected));\n}\n\nfunction setValues(view, selected) {\n\tconst barStyles = getBarStyles(view, selected);\n\tview.$$(\"bar\").setValues(barStyles);\n}\n\nfunction updateValue(view, name, value){\n\tconst element = view.$$(\"bar\").elements[name];\n\n\tif (element)\n\t\telement.setValue(value);\n}\n\nfunction getBarStyles(view, selected){\n\tconst dropdowns = [\n\t\t\"font-family\",\n\t\t\"font-size\",\n\t\t\"text-align\",\n\t\t\"vertical-align\",\n\t\t\"format\",\n\t\t\"background\",\n\t\t\"color\"\n\t];\n\n\tconst cell = selected[0];\n\tconst barStyles = getCellStyles(view, cell);\n\n\tfor(let i = 1; i < selected.length; i++){\n\t\tconst cellStyle = getCellStyles(view, selected[i]);\n\n\t\tfor(let k = dropdowns.length-1; k >= 0; k--){\n\t\t\tconst property = dropdowns[k];\n\t\t\tif(barStyles[property] != cellStyle[property]){\n\t\t\t\tdelete barStyles[property];\n\t\t\t\tdropdowns.splice(k, 1);\n\t\t\t}\n\t\t}\n\n\t\tif(!dropdowns.length)\n\t\t\tbreak;\n\t}\n\n\treturn barStyles;\n}\n\nfunction getCellStyles(view, cell){\n\tconst span = view.$$(\"cells\").getSpan(cell.row, cell.column);\n\tif(span)\n\t\t[cell.row, cell.column] = span;\n\n\tconst obj = getStyle(view, cell);\n\tconst styles = obj ? webix.copy(obj.props) : {};\n\n\tfor (let i in defaultStyles)\n\t\tif(!styles[i])\n\t\t\tstyles[i] = defaultStyles[i];\n\n\tstyles[\"font-size\"] = styles[\"font-size\"].replace(\"px\", \"\");\n\n\tconst format = getFormat(view, cell.row, cell.column) || \"common\";\n\tstyles.format = isCustom(format) ? \"custom\" : format;\n\n\treturn styles;\n}\n","import {ui, buttonsMap} from \"./buttons\";\n\nexport function toolbarButtons(view,structure){\n\tvar checkButtons = function(cells){\n\t\tfor(var i =0; i < cells.length; i++){\n\t\t\tvar name = cells[i].$button;\n\t\t\tif (name){\n\t\t\t\tvar base = buttonsMap[name] ? buttonsMap[name](view) : ui.iconButton({name:name});\n\t\t\t\twebix.extend(cells[i], base);\n\t\t\t}\n\t\t\t\n\t\t\tif(cells[i].rows)\n\t\t\t\tcheckButtons(cells[i].rows);\n\t\t\tif(cells[i].cols)\n\t\t\t\tcheckButtons(cells[i].cols);\n\t\t}\n\t};\n\tcheckButtons(structure);\n\treturn structure;\n}\n\nexport function getButtons(view,structure){\n\tvar config = [];\n\tfor(var block in structure){\n\t\tconfig.push(elementsBlock(view, block, structure[block]));\n\t\tconfig.push(ui.separator());\n\t}\n\treturn config;\n}\n\nfunction blockColumns(view, buttons){\n\tvar cols = [];\n\tfor(var i =0; i < buttons.length; i++){\n\t\tlet name = buttons[i];\n\t\tif(typeof name == \"object\"){\n\t\t\tcols.push(name);\n\t\t}\n\t\telse {\n\t\t\tvar base = buttonsMap[name] ? buttonsMap[name](view) : ui.iconButton({name:name});\n\t\t\tcols.push(base);\n\t\t}\n\t}\n\treturn cols;\n}\n\n\nfunction elementsBlock(view, name, columns){\n\tvar block = {\n\t\trows:[\n\t\t\t{\n\t\t\t\tpadding:2,\n\t\t\t\tcols:[{\n\t\t\t\t\tmargin: 2,\n\t\t\t\t\tcols: blockColumns(view, columns)\n\t\t\t\t}]\n\t\t\t},\n\t\t\tui.title({title:name})\n\t\t]\n\t};\n\treturn block;\n}","import {getTextSize} from \"./styles\";\nimport {toRange} from \"../helpers/column_names\";\n\nexport function selectRow(row, view, endRow){\n\tvar columns = view.$$(\"cells\").config.columns;\n\tvar firstColumn = columns[0].id == \"rowId\" ? 1 : 0;\n\n\tvar start = {\n\t\trow:row,\n\t\tcolumn:columns[firstColumn].id\n\t};\n\tvar last = {\n\t\trow: (endRow || row),\n\t\tcolumn: columns[columns.length-1].id\n\t};\n\n\tif(start.column && last.column)\n\t\t_selectRange(start, last, view);\n}\n\nexport function selectAll(view){\n\tvar order = view.$$(\"cells\").data.order;\n\tvar columns = view.$$(\"cells\").config.columns;\n\tvar firstColumn = columns[0].id == \"rowId\" ? 1 : 0;\n\n\tvar start = {\n\t\trow: order[0],\n\t\tcolumn: columns[firstColumn].id\n\t};\n\tvar last = {\n\t\trow: order[order.length-1],\n\t\tcolumn: columns[columns.length-1].id\n\t};\n\n\tif(start.column && last.column)\n\t\t_selectRange(start, last, view);\n}\n\nexport function selectColumn(column, view, endColumn){\n\tvar order = view.$$(\"cells\").data.order;\n\tvar startRow = order[0];\n\tvar lastRow = order[order.length-1];\n\n\tvar start = {row: startRow, column: column};\n\tvar last = {row: lastRow, column: (endColumn || column) };\n\n\t_selectRange(start, last, view);\n}\n\nexport function isColSelected(column, view){\n\tconst selectedArea = view.$$(\"cells\").getSelectArea();\n\tif (selectedArea){\n\t\tif (column >= selectedArea.start.column && column <= selectedArea.end.column)\n\t\t\treturn true;\n\t}\n\treturn false;\n}\n\nexport function isCellSelected(row, column, view){\n\treturn isRowSelected(row, view) && isColSelected(column, view);\n}\n\nexport function isRowSelected(row, view){\n\tconst selectedArea = view.$$(\"cells\").getSelectArea();\n\tif (selectedArea){\n\t\tif (row >= selectedArea.start.row && row <= selectedArea.end.row)\n\t\t\treturn true;\n\t}\n\treturn false;\n}\n\nexport function selectColumns(column, view) {\n\tconst selectedArea = view.$$(\"cells\").getSelectArea();\n\n\tif (!selectedArea)\n\t\tselectColumn(column, view);\n\telse {\n\t\tlet col1 = Math.min(selectedArea.start.column, selectedArea.end.column, column);\n\t\tlet col2 = Math.max(selectedArea.start.column, selectedArea.end.column, column);\n\t\tselectColumn(col1, view, col2);\n\t}\n}\n\nfunction _selectRange(a, b, view){\n\tview.$$(\"cells\").addSelectArea(a, b);\n}\n\n\nexport function adjustColumn(column, view) {\n\tconst grid = view.$$(\"cells\");\n\tlet width = 25;\n\tconst columnWidth = grid.getColumnConfig(column).width;\n\n\tgrid.eachRow(function(row) {\n\t\tconst span = grid.getSpan(row, column);\n\t\tif(span && span[2] > 1)\n\t\t\treturn;\n\n\t\tconst text = this.getText(row, column);\n\t\tconst style = view.getStyle(row, column);\n\t\tconst css = style ? style.id : \"\";\n\n\t\tif (text.replace(/<\\/?[^>]+(>|$)/g, \"\")) {\n\t\t\tconst size = getTextSize(view, text, css);\n\t\t\tconst zoom = view._zoom;\n\n\t\t\tif(view.getCellEditor(row, column))\n\t\t\t\tsize.width += 18 * zoom;\n\t\t\tif(view.getCellFilter(row, column))\n\t\t\t\tsize.width += 18 * zoom;\n\n\t\t\tif(style && style.props.wrap == \"wrap\" && size.width > columnWidth)\n\t\t\t\tsize.width = columnWidth;\n\t\t\tif (size.width > width)\n\t\t\t\twidth = size.width;\n\t\t}\n\t});\n\tgrid.setColumnWidth(column, width);\n}\n\nexport function adjustRow(row, view) {\n\tlet height = 25;\n\n\tview._table.eachColumn(function(column) {\n\t\tif(column != \"rowId\"){\n\t\t\tconst text = this.getText(row, column);\n\n\t\t\t// if there is text wrap in cell we need to know width to get correct height\n\t\t\tlet width = this.getColumnConfig(column).width;\n\t\t\tconst span = view._table.getSpan(row, column);\n\t\t\tif(span)\n\t\t\t\twidth = view._table.getSpanNode({row:span[0], column:span[1]}).offsetWidth;\n\n\t\t\tlet style = view.getStyle(row, column);\n\t\t\tlet css = style ? style.id : \"\";\n\n\t\t\tif (text.replace(/<\\/?[^>]+(>|$)/g, \"\")) {\n\t\t\t\tlet size = getTextSize(view, text, css, width);\n\t\t\t\tif (size.height > height) height = size.height;\n\t\t\t}\n\t\t}\n\t});\n\tview._table.setRowHeight(row, height);\n}\n\nexport function highlightColRow(start, end, view){\n\tif(!view._table.config.header) return;\n\n\tconst grid = view._table;\n\n\tconst css = \"webix_highlight\";\n\n\tlet sr = start.row, er = end.row, sc = start.column, ec = end.column;\n\n\tconst columns = grid.config.columns;\n\tconst firstColumn = columns[1].id;\n\n\tif(sc == \"rowId\"){\n\t\tif(sc == ec){\n\t\t\tstart.column = sc = firstColumn;\n\t\t\tend.column = ec = columns[ columns.length-1 ].id;\n\t\t}\n\t\telse\n\t\t\tstart.column = sc = firstColumn;\n\t}\n\telse if(ec == \"rowId\")\n\t\tend.column = ec = firstColumn;\n\n\tif(er<sr) [sr, er] = [er, sr];\n\tif(ec<sc) [sc, ec] = [ec, sc];\n\n\tgrid.eachRow(function(row){\n\t\tif(row < sr || row > er)\n\t\t\tgrid.removeCellCss(row, \"rowId\", css, true);\n\t\telse\n\t\t\tgrid.addCellCss(row, \"rowId\", css, true);\n\t});\n\twebix.delay(() => grid.refresh());\n\n\tgrid.eachColumn(function(col){\n\t\tconst node = grid.getHeaderNode(col);\n\t\tif(col == \"rowId\" || !node) return;\n\n\t\tif(col < sc || col > ec)\n\t\t\twebix.html.removeCss(node, css);\n\t\telse\n\t\t\twebix.html.addCss(node, css, true);\n\t});\n\n\tif(view.$$(\"navigation\")){\n\t\tlet range = \"\";\n\n\t\tif(sc && ec){\n\t\t\tif(!sr){\n\t\t\t\tconst order = grid.data.order;\n\t\t\t\tsr = order[0];\n\t\t\t\ter = order[order.length-1];\n\t\t\t}\n\t\t\trange = toRange(sr, sc, er, ec);\n\t\t\tconst cells = range.split(\":\");\n\t\t\tif(cells[0] == cells[1])\n\t\t\t\trange = cells[0];\n\t\t}\n\n\t\tview.$$(\"navigation\").setValue(range);\n\t}\n}","import group from \"./undo_group\";\n\nexport const lockCss = \"webix_lock\";\n\nexport function init(view){\n\tview._locks = {};\n\tview.attachEvent(\"onReset\", () => reset(view));\n\tview.attachEvent(\"onUndo\", (type, row, column, mode) => {\n\t\tif (type === \"lock\") lockCell(view, row, column, !!mode, true);\n\t});\n\n\tview.attachEvent(\"onCommand\", (cm) => {\n\t\tif (cm.id === \"lock-cell\")\n\t\t\tlock(view);\n\t});\n\n\tview.attachEvent(\"onAction\", (action, p)=> {\n\t\tif(action == \"before-grid-change\")\n\t\t\tupdatePosition(view, p.name, p.inc, p.data, p.start);\n\t});\n}\n\nfunction reset(view){\n\tview._locks = {};\n}\n\nexport function lockCell(view, row, column, mode, silent){\n\tvar table = view.$$(\"cells\");\n\tif (typeof row === \"object\" && typeof column === \"object\"){\n\t\tgroup.set(function() {\n\t\t\t_mapCellsCalls(row, column, function(row, column){\n\t\t\t\tlockCell(view, row, column, mode, true);\n\t\t\t});\n\t\t});\n\t} else {\n\t\tmode = ((mode === false) ? false : true);\n\t\tvar objrow = view._locks[row] = view._locks[row] || {};\n\t\tobjrow[column] = mode;\n\t\tif (mode)\n\t\t\ttable.addCellCss(row, column, lockCss, true);\n\t\telse\n\t\t\ttable.removeCellCss(row, column, lockCss, true);\n\n\t\tview.callEvent(\"onAction\", [\"lock\", { row, column, value: !mode, newValue: mode }]);\n\t}\n\n\tif (!silent)\n\t\ttable.refresh();\n}\n\nfunction _mapCellsCalls(start, end, handler,master){\n\tfor (let x = start.row; x<=end.row; x++)\n\t\tfor (let y = start.column; y<=end.column; y++)\n\t\t\thandler.call(master||this, x, y);\n}\n\nexport function isCellLocked(view, row, column){\n\treturn view._locks[row]?view._locks[row][column]:false;\n}\n\nexport function serialize(view,data){\n\tvar row, column,\n\t\tlocked = [];\n\tfor(row in view._locks){\n\t\tfor(column in view._locks[row])\n\t\t\tif(view._locks[row][column])\n\t\t\t\tlocked.push([row,column]);\n\t}\n\tdata.locked = locked;\n}\n\nexport function load(view,data){\n\tvar i,\n\t\tlocked = data.locked;\n\n\tif(locked)\n\t\tfor(i = 0; i < locked.length; i++)\n\t\t\tlockCell(view, locked[i][0],locked[i][1],true, true);\n}\n\nfunction lock(view){\n\tvar block = view.$$(\"cells\").getSelectArea();\n\tif (block){\n\t\tvar mode = view.isCellLocked(block.start.row, block.start.column);\n\t\tview.lockCell(block.start, block.end, !mode);\n\t}\n}\n\nfunction updatePosition(view, name, inc, data, start){\n\tlet locked = data.locked,\n\t\ti = locked.length;\n\n\tif(inc){\n\t\twhile(i--){\n\t\t\tlet [row,column] = locked[i];\n\t\t\tif(row && name == \"row\" && row>= start.row || column && name == \"column\" && column >= start.column){\n\t\t\t\tif (name == \"row\"){\n\t\t\t\t\tif (row < start.row - inc)\t//delete lock mark if row was deleted\n\t\t\t\t\t\tlocked.splice(i,1);\n\t\t\t\t\telse\t\t\t\t\t\t//update mark position if upper row was deleted\n\t\t\t\t\t\tlocked[i][0] = row*1 + inc;\n\t\t\t\t} else if (name == \"column\"){\n\t\t\t\t\tif (column < start.column - inc){\n\t\t\t\t\t\tlocked.splice(i, 1);\n\t\t\t\t\t} else \n\t\t\t\t\t\tlocked[i][1] = column*1 + inc;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n}","import {lockCss} from \"./lock_cell\";\nimport {save} from \"./save\";\nimport * as arr from \"../helpers/array\";\n\nexport function init(view){\n\tview.attachEvent(\"onStyleChange\", (row, column, style) => {\n\t\tvar span = getSpan(view, row, column);\n\t\tif (span){\n\t\t\tvar extraCss = getExtraCss(view, row, column);\n\t\t\tspan[3] = (style ? style.id : \"\") + (extraCss ? (\" \" + extraCss) : \"\");\n\t\t}\n\t});\n\n\tview.attachEvent(\"onDataParse\", (data) => {\n\t\tparse(view, data);\n\t});\n\n\tview.attachEvent(\"onDataSerialize\", (data) => {\n\t\tserialize(view, data);\n\t});\n\t\n\tview.attachEvent(\"onUndo\", (type, row, column, value, isUndo) => {\n\t\tif(type == \"span\" || type == \"split\"){\n\t\t\tif (type == \"span\") \n\t\t\t\tisUndo = !isUndo;\n\t\t\tundoSpan(view, row, column, value, isUndo);\n\t\t}\n\t});\n\n\tview.attachEvent(\"onAction\", (name, options) => {\n\t\tif(name == \"lock\")\n\t\t\tsetSpanCss(view, options.row, options.column, lockCss, options.newValue);\n\t\telse if(name == \"before-grid-change\")\n\t\t\tupdatePosition(view, options.name, options.inc, options.data, options.start);\n\t\telse if(name == \"check-borders\")\n\t\t\treturn checkSpanBorders(view, options.row, options.column, options.area, options.mode);\n\t});\n}\n\nfunction getSpan(view, row, column){\n\tvar item = view.$$(\"cells\").getSpan()[row];\n\tif (item)\n\t\treturn item[column];\n}\n\nfunction parse(view, data){\n\tif (data.spans)\n\t\tfor (var i = 0; i < data.spans.length; i++) {\n\t\t\tvar span = data.spans[i];\n\t\t\taddSpan( view,\n\t\t\t\t{ row: span[0], column: span[1] },\n\t\t\t\tspan[2]*1,\n\t\t\t\tspan[3]*1,\n\t\t\t\ttrue \n\t\t\t);\n\t\t}\n}\n\nexport function serialize(view, data){\n\tvar spans = [];\n\tvar pull = view.$$(\"cells\").getSpan();\n\tif (pull){\n\t\tfor (var rid in pull){\n\t\t\tvar row = pull[rid];\n\t\t\tfor (var cid in row){\n\t\t\t\tvar span = row[cid];\n\t\t\t\tspans.push([rid*1, cid*1, span[0], span[1]]);\n\t\t\t}\n\t\t}\n\n\t\tdata.spans = spans;\n\t}\n\treturn data;\n}\n\nexport function addSpan(view, cell, x, y, silent){\n\tif (x<2 && y<2) return;\n\n\tif(silent || view.callEvent(\"onBeforeSpan\", [cell.row, cell.column, [x, y]])){\n\t\tconst obj = view._mPage.getCell(cell.row-1, cell.column-1);\n\t\tlet css = ( obj && obj.style ) || \"\";\n\t\tvar extraCss = getExtraCss(view, cell.row, cell.column);\n\t\tif (extraCss)\n\t\t\tcss += \" \" + extraCss;\n\n\t\tsetSpanValue(view, cell, x, y);\n\t\tview.$$(\"cells\").addSpan(cell.row, cell.column, x, y, null, css);\n\t\tif (!silent){\n\t\t\tview.callEvent(\"onAfterSpan\", [cell.row, cell.column, [x, y]]);\n\t\t\tsave(view, \"spans\", {\n\t\t\t\trow:cell.row, column: cell.column,\n\t\t\t\tx:x, y:y\n\t\t\t});\n\t\t}\n\t}\n}\n\nexport function removeSpan(view, cell){\n\tvar span = view.$$(\"cells\").getSpan(cell.row, cell.column);\n\tif(span && view.callEvent(\"onBeforeSplit\", [ cell.row, cell.column, [span[2], span[3]] ])){\n\t\tview.$$(\"cells\").removeSpan(cell.row, cell.column);\n\t\tview.callEvent(\"onAfterSplit\", [ cell.row, cell.column, [span[2], span[3]] ]);\n\t\tsave(view, \"spans\", {\n\t\t\trow:cell.row, column: cell.column,\n\t\t\tx:0, y:0\n\t\t});\n\t}\n}\n\nexport function getRange(sel){\n\tvar lx, ly, rx, ry;\n\trx = ry = 0;\n\tlx = ly = Infinity;\n\n\tfor (var i=0; i<sel.length; i++){\n\t\tvar cx = sel[i].column*1;\n\t\tvar cy = sel[i].row*1;\n\n\t\tlx = Math.min(cx, lx);\n\t\trx = Math.max(cx, rx);\n\t\tly = Math.min(cy, ly);\n\t\try = Math.max(cy, ry);\n\t}\n\n\treturn {\n\t\tcell:{ row:ly, column:lx },\n\t\tx: rx-lx+1,\n\t\ty: ry-ly+1\n\t};\n}\n\nexport function setSpanCss(view, row, column, css, add){\n\tconst span = getSpan(view, row, column);\n\tif (span){\n\t\tif (add){\n\t\t\tif (span[3].indexOf(css) == -1)\n\t\t\t\tspan[3] += \" \" + css;\n\t\t} else {\n\t\t\tspan[3] = span[3].replace(\" \" + css, \"\");\n\t\t}\n\t}\n}\n\nfunction getExtraCss(view, row, column){\n\tlet extraCss = [];\n\tif(view.getCellEditor(row, column))\n\t\textraCss.push(\"ss_editor\");\n\tif(view.getCellFilter(row, column))\n\t\textraCss.push(\"ss_filter\");\n\treturn extraCss.join(\" \");\n}\n\nfunction undoSpan(view,row, column,value,isUndo){\n\tif(isUndo){\n\t\tremoveSpan(view,{row: row, column: column});\n\t}\n\telse{\n\t\taddSpan(view, {row: row, column: column}, value[0], value[1]);\n\t}\n}\n\nfunction updatePosition(view, name, inc, data, start){\n\tlet spans = data.spans;\n\tif(inc){\n\t\tfor(let i = spans.length-1;i >=0;i--){\n\t\t\tlet [row,column] = spans[i];\n\n\t\t\tif(inc < 0){//deleting\n\t\t\t\tif(name == \"row\" && row <= start.row-inc-1)\n\t\t\t\t\tinc = start.row - spans[i][0];\n\t\t\t\telse if (name == \"column\" && column <= start.column-inc-1)\n\t\t\t\t\tinc = start.column - spans[i][1];\n\t\t\t}\n\n\t\t\tif(name == \"row\" && row>= start.row || name == \"column\" && column >= start.column){\n\t\t\t\tspans[i][0] =  name == \"row\"?row*1 + inc:row;\n\t\t\t\tspans[i][1] = name == \"column\"?column*1 + inc:column;\n\t\t\t}\n\t\t}\n\t}\n}\n\nvar borderChecks = {\n\t\"border-right\":\t\tfunction(row, column, span, area){\n\t\treturn area.end.column == column+span[0]-1;\n\t},\n\t\"border-bottom\":\tfunction(row, column, span, area){\n\t\treturn area.end.row == row+span[1]-1;\n\t}\n};\n\nfunction checkSpanBorders(view, row, column, area, mode){\n\tvar span = getSpan(view, row, column);\n\treturn span&&borderChecks[mode]?borderChecks[mode](row, column, span, area):false;\n}\n\n// clear merged cells except the first one\nfunction setSpanValue(view, cell, x, y){\n\tvar i,j,value,\n\t\trow = cell.row*1,\n\t\tcolumn = cell.column*1,\n\t\tisEmpty = !view.getCellValue(row,column);\n\tfor(i = row; i < row+y; i++){\n\t\tfor(j = column; j < column+x; j++) {\n\t\t\tvalue = view.getCellValue(i,j);\n\t\t\tif(value!==\"\" && (j != column || i != row)){\n\t\t\t\tif(isEmpty){\n\t\t\t\t\tisEmpty = false;\n\t\t\t\t\tview.setCellValue(row,column,value);\n\t\t\t\t}\n\t\t\t\tview.setCellValue(i,j,\"\");\n\t\t\t}\n\t\t}\n\t}\n}\n\nexport function adjustSpan (span, action, start, end, view, data, spanData){\n\tvar length = action.group == \"row\" ? span[3] : span[2];\n\tvar checkSpan = action.group == \"row\" ? [span[0]*1, span[0]*1+span[3]-1] : [span[1]*1, span[1]*1+span[2]-1];\n\tvar selection = action.group == \"row\" ? [start.row, end.row] : [start.column, end.column];\n\n\t//if we add, the number of selected rows/cols is added to span, so we need original selection length\n\tvar inc = selection[1] - selection[0] + 1;\n\n\tselection[0] = Math.max(selection[0], checkSpan[0]);\n\tselection[1] = Math.min(selection[1], checkSpan[1]);\n\n\tvar isFirstCell = selection[0] == checkSpan[0];\n\n\tif(selection[0] <= selection[1]){ //selection is in span\n\t\tif(action.id == \"del\") //if we delete, only rows/cols included into span\n\t\t\tinc = (selection[1] - selection[0]+ 1) * -1;\n\t\t//delete smth which starts as span and less than it's length\n\t\tif(action.id == \"del\" && isFirstCell && length > -1*inc){\n\t\t\tconst item = arr.find(data, arr => arr[0] == span[0] && arr[1] == span[1]);\n\t\t\tif(item)\n\t\t\t\tspanData.push(item);\n\t\t}\n\n\t\tif(!(isFirstCell && action.id == \"add\")){\n\t\t\tspan[2] = action.group == \"column\" ? span[2]+inc : span[2];\n\t\t\tspan[3] = action.group == \"row\" ? span[3]+inc : span[3];\n\t\t}\n\t}\n\treturn span;\n}\n\nexport function pasteSpan(view, extra, row, col, cutted, translate){\n\t//existing span\n\tvar s = view._table.getSpan(row, col);\n\tif(extra && extra.span){\n\t\tvar span = extra.span;\n\t\t//if we are on start position for the future span\n\t\tif(row == span[0]*1+translate.row && col == span[1]*1+translate.column){\n\t\t\t//delete spans in future paste zone \n\t\t\tview._table.mapCells(row, col, span[3], span[2], (value, rid, cid) => {\n\t\t\t\ts = view._table.getSpan(rid,cid);\n\t\t\t\tif(s) removeSpan(view, {row:s[0], column:s[1]});\n\t\t\t}, true);\n\t\t\taddSpan(view, {row:row, column:col}, span[2], span[3]);\n\t\t\tif(cutted === 1)\n\t\t\t\tremoveSpan(view, {row:extra.row, column:extra.col});\n\t\t}\n\t}\n\telse if(s)\n\t\tremoveSpan(view, {row:s[0], column:s[1]});\n}","import {isDateInvalid} from \"../operations/formats\";\n\nfunction getText(text){\n\tvar locale = webix.i18n.spreadsheet.labels;\n\treturn locale[text] || text;\n}\nexport function getDefaultStyles(){\n\treturn [\n\t\t{name: getText(\"normal\"), css: \"webix_ssheet_condition_regular\"},\n\t\t{name: getText(\"neutral\"), css: \"webix_ssheet_condition_neutral\"},\n\t\t{name: getText(\"bad\"), css: \"webix_ssheet_condition_bad\"},\n\t\t{name: getText(\"good\"), css: \"webix_ssheet_condition_good\"}\n\t];\n}\n\nfunction isDate(value){\n\treturn value && !isNaN(value) && !isDateInvalid(value);\n}\n\nexport const conditions = {\n\tnumber:[\n\t\t{ id:\"greater\", batch:\"text\", handler:function(a,b){\n\t\t\treturn a !== \"\" && (a*1 > b*1);\n\t\t}},\n\t\t{ id:\"less\", batch:\"text\", handler:function(a,b){\n\t\t\treturn a !== \"\" && (a*1 < b*1);\n\t\t}},\n\t\t{ id:\"greaterOrEqual\", batch:\"text\", handler:function(a,b){\n\t\t\treturn a !== \"\" && (a*1 >= b*1);\n\t\t}},\n\t\t{ id:\"lessOrEqual\", batch:\"text\", handler:function(a,b){\n\t\t\treturn a !== \"\" && (a*1 <= b*1);\n\t\t}},\n\t\t{ id:\"equal\", batch:\"text\", handler:function(a,b){ return a == b; }},\n\t\t{ id:\"notEqual\", batch:\"text\", handler:function(a,b){ return a != b; }},\n\t\t{ id:\"contains\", batch:\"text\", handler:function(a,b){\n\t\t\treturn a.toString().toLowerCase().indexOf(b.toString().toLowerCase()) !== -1;\n\t\t}},\n\t\t{ id:\"notContains\", batch:\"text\", handler:function(a,b){\n\t\t\treturn a.toString().toLowerCase().indexOf(b.toString().toLowerCase()) === -1;\n\t\t}}\n\t],\n\ttext: [\n\t\t{ id:\"contains\", batch:\"text\", handler:function(a,b){\n\t\t\treturn a.toString().toLowerCase().indexOf(b.toString().toLowerCase()) !== -1;\n\t\t}},\n\t\t{ id:\"notContains\", batch:\"text\", handler:function(a,b){\n\t\t\treturn a.toString().toLowerCase().indexOf(b.toString().toLowerCase()) === -1;\n\t\t}},\n\t\t{ id:\"equal\", batch:\"text\", handler:function(a,b){\n\t\t\treturn a.toString().toLowerCase() === b.toString().toLowerCase();\n\t\t}},\n\t\t{ id:\"notEqual\", batch:\"text\", handler:function(a,b){\n\t\t\treturn a.toString().toLowerCase() !== b.toString().toLowerCase();\n\t\t}},\n\t\t{ id:\"beginsWith\", batch:\"text\", handler:function(a,b){\n\t\t\treturn a.toString().toLowerCase().lastIndexOf(b.toString().toLowerCase(), 0) === 0;\n\t\t}},\n\t\t{ id:\"notBeginsWith\", batch:\"text\", handler:function(a,b){\n\t\t\treturn a.toString().toLowerCase().lastIndexOf(b.toString().toLowerCase(), 0) !== 0;\n\t\t}},\n\t\t{ id:\"endsWith\", batch:\"text\", handler:function(a,b){\n\t\t\ta = a.toString();\n\t\t\tb = b.toString();\n\t\t\treturn a.toLowerCase().indexOf(b.toLowerCase(), a.length - b.length) !== -1;\n\t\t}},\n\t\t{ id:\"notEndsWith\", batch:\"text\", handler:function(a,b){\n\t\t\ta = a.toString();\n\t\t\tb = b.toString();\n\t\t\treturn a.toLowerCase().indexOf(b.toLowerCase(), a.length - b.length) === -1;\n\t\t}}\n\t],\n\tdate: [\n\t\t{ id:\"greater\", batch:\"datepicker\", handler: function(a, b){\n\t\t\treturn isDate(a) && a > b;\n\t\t}},\n\t\t{ id:\"less\", batch:\"datepicker\", handler: function(a, b){\n\t\t\treturn isDate(a) && a < b;\n\t\t}},\n\t\t{ id:\"greaterOrEqual\", batch:\"datepicker\", handler: function(a, b){\n\t\t\treturn isDate(a) && a >= b;\n\t\t}},\n\t\t{ id:\"lessOrEqual\", batch:\"datepicker\", handler: function(a, b){\n\t\t\treturn isDate(a) && a <= b;\n\t\t}},\n\t\t{ id:\"equal\", batch:\"datepicker\", handler: function(a, b){\n\t\t\treturn isDate(a) && a == b;\n\t\t}},\n\t\t{ id:\"notEqual\", batch:\"datepicker\", handler: function(a, b){\n\t\t\treturn !isDate(a) || a != b;\n\t\t}},\n\t\t{ id:\"between\", batch: \"daterangepicker\", handler: function(a, b){\n\t\t\tif (!isDate(a)) return false;\n\t\t\treturn (!b.start || a > b.start) && (!b.end || a < b.end);\n\t\t}},\n\t\t{ id:\"notBetween\", batch: \"daterangepicker\", handler: function(a, b){\n\t\t\tif (!isDate(a)) return false;\n\t\t\treturn (!b.start || a <= b.start) || (!b.end || a >= b.end);\n\t\t}}\n\t]\n};","import group from \"./undo_group\";\nimport {eachRange} from \"../helpers/column_names\";\nimport {setSpanCss} from \"./spans\";\nimport {conditions} from \"../helpers/conditional\";\nimport {getType} from \"./types\";\nimport * as arr from \"../helpers/array\";\n\nexport function init(view){\n\tview.conditions = {\n\t\t_empty:true,\n\t\t_pull: {},\n\t\thandlers: createRules(),\n\t\tadd: function(rId, cId, cond, val, style){\n\t\t\tadd.apply(this, [view, rId, cId, cond, val, style]);\n\t\t},\n\t\tupdate: function(r, c, data){\n\t\t\tupdate.apply(this, [view, r, c, data]);\n\t\t},\n\t\tremove,\n\t\tget,\n\t\tparse,\n\t\tserialize,\n\t\tclear\n\t};\n\n\tview.attachEvent(\"onConditionSet\", (data) => _setCondition(view, data));\n\n\tview.attachEvent(\"onUndo\", (type_action, row, column, value) => {\n\t\tif(type_action == \"condition\")\n\t\t\t_undoCondition(view, row, column, value);\n\t});\n\n\tview.attachEvent(\"onDataSerialize\", (data) => _serialize(view, data));\n\tview.attachEvent(\"onDataParse\", (data) => _parse(view, data));\n\n\tview.attachEvent(\"onReset\", () => view.conditions.clear() );\n\n\tview.attachEvent(\"onAction\", (action, p)=> {\n\t\tif(action == \"before-grid-change\")\n\t\t\tupdatePosition(view, p.name, p.inc, p.data, p.start);\n\t});\n\n\treset(view);\n}\n\nfunction createRules(){\n\tconst rules = webix.copy(conditions);\n\trules.number = rules.number.concat([\n\t\t{ id:\"between\", handler: function(a, b){\n\t\t\treturn (!b.start || a > b.start) && (!b.end || a < b.end);\n\t\t}},\n\t\t{ id:\"notBetween\", handler: function(a, b){\n\t\t\treturn (!b.start || a <= b.start) || (!b.end || a >= b.end);\n\t\t}}\n\t]);\n\treturn rules;\n}\n\nfunction getCellValue(view, value){\n\tif(isNaN(value*1)){\n\t\tif (value.charAt(0) == \"=\" && value.length > 1){\n\t\t\tvalue = view._mData.getStore().exec(value.substring(1), view._mPage.getContext());\n\t\t\tif(value === null)\n\t\t\t\tvalue = \"\";\n\t\t}\n\t}\n\telse {\n\t\tvalue = value*1;\n\t}\n\treturn value;\n}\n\nfunction reset(view){\n\tview.conditions.clear();\n}\n\nfunction _setCondition(view, data){\n\tgroup.set(function(){\n\t\tview.eachSelectedCell((cell) => {\n\t\t\tconst collection = view.conditions.get(cell.row, cell.column);\n\t\t\tif(collection)\n\t\t\t\tfor (let i = 0; i < collection.length; i++)\n\t\t\t\t\tsetSpanCss(view, cell.row, cell.column, collection[i][2], false);\n\t\t\t_changeCondition(\"update\", cell.row, cell.column, (collection||null), data, view);\n\t\t});\n\t});\n\tview.refresh();\n}\n\nfunction _undoCondition(view, row, column, value){\n\tif(view.conditions.get(row, column))\n\t\tview.conditions.remove(row, column);\n\tif(value)\n\t\tview.conditions.update(row, column, value);\n}\n\nfunction _serialize(view, obj){\n\tobj.conditions = view.conditions.serialize();\n}\n\nfunction _parse(view, obj){\n\tview.conditions.parse(obj.conditions);\n}\n\nexport function getConditionCss(view, row, column, rendered){\n\tlet css = \"\";\n\n\tif (!view.conditions._empty){\n\t\tconst collection = view.conditions.get(row, column);\n\t\tif(collection){\n\t\t\tconst span = view.$$(\"cells\").getSpan(row, column);\n\t\t\tlet value = view.getCellValue(row,column,false);\n\t\t\tif(!value && value !== 0)\n\t\t\t\tvalue = \"\";\n\n\t\t\tlet type = getType(view, row, column);\n\t\t\tif(!type || type == \"string\")\n\t\t\t\ttype = \"text\";\n\n\t\t\tfor (let i = collection.length - 1; i >= 0; i--){\n\t\t\t\tlet currentValue = value;\n\t\t\t\tconst rule = collection[i][0];\n\t\t\t\tconst handlers = view.conditions.handlers;\n\t\t\t\tlet handler;\n\n\t\t\t\tlet checkOrder = [\"text\", type, \"number\", \"date\"];\n\t\t\t\tcheckOrder = checkOrder.filter((v, i) => checkOrder.indexOf(v) == i);\n\n\t\t\t\tfor(let k = 0; k < checkOrder.length; k++){\n\t\t\t\t\tconst checkType = checkOrder[k];\n\n\t\t\t\t\thandler = arr.find(handlers[checkType], obj => obj.id == rule);\n\t\t\t\t\tif(handler){\n\t\t\t\t\t\thandler = handler.handler;\n\t\t\t\t\t\tif(checkType == \"text\" && rule != \"equal\" && rule != \"notEqual\")\n\t\t\t\t\t\t\tcurrentValue = rendered;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tlet compare = collection[i][1];\n\t\t\t\tif(webix.isArray(compare))\n\t\t\t\t\tcompare = {\n\t\t\t\t\t\tstart: getCellValue(view, compare[0]),\n\t\t\t\t\t\tend: getCellValue(view, compare[1])\n\t\t\t\t\t};\n\t\t\t\telse\n\t\t\t\t\tcompare = getCellValue(view, compare);\n\n\t\t\t\tif(!css && handler && handler(currentValue, compare)){\n\t\t\t\t\tcss = collection[i][2];\n\t\t\t\t\tif(!span)\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tsetSpanCss(view, row, column, collection[i][2], true);\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t\tsetSpanCss(view, row, column, collection[i][2], false);\n\t\t\t}\n\t\t}\n\t}\n\treturn css;\n}\n\n\nfunction addEmptyCollection(pull, row, column, state){\n\tstate._empty = false;\n\tif(!pull[row])\n\t\tpull[row] = {};\n\tif(!pull[row][column])\n\t\tpull[row][column] = [];\n\treturn pull[row][column];\n}\n\n\nfunction parse(data){\n\t//backward compatibility\n\tconst oldConditions = {\n\t\t\">\": \"greater\",\n\t\t\"<\": \"less\",\n\t\t\"=\": \"equal\",\n\t\t\"!=\": \"notEqual\",\n\t\t\"<>\": \"between\"\n\t};\n\n\tthis._empty = true;\n\tif (!data) return;\n\n\tlet i = data.length;\n\twhile(i--){\n\t\tconst c = data[i];\n\t\tconst collection = addEmptyCollection(this._pull,c[0],c[1],this);\n\t\tc[2] = oldConditions[ c[2] ] || c[2];\n\t\tcollection.push([c[2],c[3],c[4]]);\n\t}\n}\n\nfunction clear(){\n\tthis._pull = {};\n}\n\nfunction update(view, row, column, newData){\n\tvar collection = this.get(row, column);\n\tif(!collection)\n\t\taddEmptyCollection(this._pull, row, column, this);\n\n\tnewData.map(item => _normalizeValue(view, item) );\n\tthis._pull[row][column] = newData;\n}\n\nfunction get(rowId, columnId){\n\tif(!rowId)\n\t\treturn this._pull;\n\tif(!columnId)\n\t\treturn this._pull[rowId];\n\treturn this._pull[rowId]?this._pull[rowId][columnId]:null;\n}\n\nfunction add(view, rowId, columnId, condition, value, style){\n\tconst collection = addEmptyCollection(this._pull, rowId, columnId, this);\n\tcollection.push( _normalizeValue(view, [condition, value, style]) );\n}\n\nfunction remove(rowId, columnId){\n\tvar collection = this.get(rowId, columnId);\n\tif(collection)\n\t\tdelete this._pull[rowId][columnId];\n}\n\nfunction serialize(){\n\tvar column, condition, i, row,\n\t\tdata = [];\n\n\tfor( row in this._pull)\n\t\tfor( column in this._pull[row])\n\t\t\tfor(i=0; i < this._pull[row][column].length; i++){\n\t\t\t\tcondition = this._pull[row][column][i];\n\t\t\t\tdata.push([row,column, condition[0],condition[1],condition[2]]);\n\t\t\t}\n\n\treturn data;\n}\n\nfunction updatePosition(view, name, inc, data, start){\n\tlet conditions = data.conditions,\n\t\ti = conditions.length;\n\n\tif(inc){\n\t\twhile(i--){\n\t\t\tlet [row,column] = conditions[i];\n\t\t\tif(name == \"row\" && row>= start.row || name == \"column\" && column >= start.column){\n\t\t\t\tif (name == \"row\"){\n\t\t\t\t\tif (row < start.row - inc)\t//delete lock mark if row was deleted\n\t\t\t\t\t\tconditions.splice(i,1);\n\t\t\t\t\telse\t\t\t\t\t\t//update mark position if upper row was deleted\n\t\t\t\t\t\tconditions[i][0] = row*1 + inc;\n\t\t\t\t} else if (name == \"column\"){\n\t\t\t\t\tif (column < start.column - inc){\n\t\t\t\t\t\tconditions.splice(i, 1);\n\t\t\t\t\t} else \n\t\t\t\t\t\tconditions[i][1] = column*1 + inc;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n}\n\nexport function clearConditionalFormats(view, range){\n\tgroup.set(function(){\n\t\teachRange(range, view, function(view, cell){\n\t\t\tvar condition = view.conditions.get(cell.row, cell.column);\n\t\t\tif(condition)\n\t\t\t\t_changeCondition(\"remove\", cell.row, cell.column, condition, null, view);\t\t\t\t\n\t\t});\n\t\tview.refresh();\n\t});\n}\n\nexport function pasteCondition(view, extra, row, col, cutted){\n\tvar condition = extra.condition;\n\tvar collection = view.conditions.get(row,col);\n\t_changeCondition(\"update\", row, col, (collection||null), condition, view);\n\tif(cutted === 1)\n\t\t_changeCondition(\"remove\", extra.row, extra.col, condition, null, view);\n}\n\nexport function _changeCondition(name, row, column, oldCondition, newCondition, view){\n\tif (view.callEvent(\"onBeforeConditionSet\", [row, column, oldCondition, newCondition])){\n\t\tview.conditions[name].apply(view.conditions, [row, column, newCondition]);\n\t\tview.callEvent(\"onAfterConditionSet\", [row, column, oldCondition, newCondition]);\n\t}\n}\n\nfunction _normalizeValue(view, condition){\n\tconst val = condition[1];\n\tif(val[0] == \"=\")\n\t\tcondition[1] = view._mData.getStore().parse(val).source; //fixes formula\n\treturn condition;\n}","export function init(view){\n\t//parsing initial data\n\tview.attachEvent(\"onDataParse\", (data) => _parse(view, data));\n\tview.attachEvent(\"onDataSerialize\", (data, config) => _serialize(view, data, config));\n\n\t// undo\n\tview.attachEvent(\"onUndo\", (type, row, column, value) => {\n\t\tif(type == \"value\")\n\t\t\t_undoValue(view, row, column, value);\n\t});\n}\n\nfunction _serialize(view, obj, config){\n\tvar math = !config || config.math!==false;\n\n\tvar grid = view.$$(\"cells\");\n\tvar state = grid.getState();\n\tvar columns = state.ids.concat(state.hidden);\n\n\t// remove \"rowId\" column\n\tcolumns.splice(columns.indexOf(\"rowId\"), 1);\n\n\tobj.data = getSheetData(view, math);\n\n\twebix.extend(\n\t\tobj.table,\n\t\t{\n\t\t\tfrozenColumns : (view._frozenColumns || 0),\n\t\t\tfrozenRows : (view._frozenRows || 0)\n\t\t}\n\t);\n}\n\nfunction _parse(view, obj){\n\tconst tconfig = obj.table || { frozenColumns : 0, frozenRows : 0 };\n\tview._frozenColumns = view._frozenRows = 0;\n\tif (tconfig){\n\t\tif (!webix.isUndefined(tconfig.frozenColumns))\n\t\t\tview.freezeColumns(tconfig.frozenColumns);\n\t\tif (!webix.isUndefined(tconfig.frozenRows))\n\t\t\tview.freezeRows(tconfig.frozenRows);\n\t}\n\n\tif(obj.sizes)\n\t\tview.$$(\"cells\").define(\"fixedRowHeight\", false);\n}\n\nfunction _undoValue(view, row, column, value){\n\tview.setCellValue(row, column, value);\n}\n\nexport function getSheetData(view, math, page){\n\tpage = page ? view._mData.getPage(page) : view._mPage;\n\treturn page.serialize(math)\n\t\t.map(arr =>{\n\t\t\tlet value = arr[2].value;\n\t\t\tif(value === null)\n\t\t\t\tvalue = \"\";\n\t\t\treturn [ ++arr[0], ++arr[1], value, arr[2].style||\"\", arr[2].type];\n\t\t})\n\t\t.filter(arr => {\n\t\t\treturn arr[2] || arr[2] === 0 || arr[3];\n\t\t});\n}","import * as arr from \"./helpers/array\";\nimport {getSheetData} from \"./operations/data\";\nimport {DataStore} from \"@xbs/muon\";\nimport {loadCell} from \"./operations/types\";\nimport {removeUnusedStyles, styleFromText, styleToText} from \"./operations/styles\";\nimport {getFormatFromData, checkFormat} from \"./operations/formats\";\nimport {updateMaxColumn, encode, escapeSheet} from \"./helpers/column_names\";\n\nconst options = [\n\t\"rename-sheet\",\n\t\"remove-sheet\",\n\t\"copy-sheet\",\n\t\"hide-sheet\"\n];\n\nconst actionMap = {\n\t\"remove-sheet\": view => _remove(view),\n\t\"rename-sheet\": view => edit(view),\n\t\"new-sheet\": view => add(view),\n\t\"copy-sheet\": view => copy(view),\n\t\"hide-sheet\": view => setState(view, view._activeSheet, \"hidden\")\n};\n\nexport function init(view){\n\tview.attachEvent(\"onComponentInit\", () => ready(view));\n}\n\nexport const numbers = [0.5, 0.75, 0.9, 1, 1.1, 1.25, 1.5, 1.75, 2, 3, 4];\n\nexport function defaultBottom(view){\n\tconst locale = webix.i18n.spreadsheet.tooltips;\n\tconst readonly = view.config.readonly;\n\tconst tabWidth = view.config.sheetTabWidth;\n\tconst minTabWidth = tabWidth == \"auto\" ? view.defaults.sheetTabWidth : tabWidth;\n\n\tconst toolbar =  {\n\t\tview: \"toolbar\",\n\t\tid: \"bottom-toolbar\",\n\t\tcss: \"webix_ssheet_bottom_toolbar webix_layout_toolbar\",\n\t\tpaddingY: 0,\n\t\theight: 34,\n\t\telements:[\n\t\t\t{\n\t\t\t\thidden:readonly,\n\t\t\t\tpadding: {\n\t\t\t\t\ttop: 2,\n\t\t\t\t\tbottom: 2,\n\t\t\t\t\tleft: 4\n\t\t\t\t},\n\t\t\t\tcols:[\n\t\t\t\t\t{\n\t\t\t\t\t\tview:\"icon\", icon:\"wxi-plus\", width:30, id: \"add-sheet\", click: ()=> add(view),\n\t\t\t\t\t\ttooltip: webix.i18n.spreadsheet.tooltips[\"add-sheet\"]\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tview:\"icon\", icon:\"wxi-dots\", width:30, id: \"show-sheet\", popup: getSheetsPopup(view),\n\t\t\t\t\t\ttooltip: webix.i18n.spreadsheet.tooltips[\"show-sheet\"]\n\t\t\t\t\t}\n\t\t\t\t]\n\t\t\t},\n\t\t\t{\n\t\t\t\tid:\"sheets\",\n\t\t\t\tview:\"sheets\",\n\t\t\t\tmaxWidth: 5 * minTabWidth,\n\t\t\t\tminWidth: minTabWidth,\n\t\t\t\teditable:!readonly,\n\t\t\t\teditaction: \"dblclick\",\n\t\t\t\teditor:\"text\",\n\t\t\t\teditValue:\"value\",\n\t\t\t\ttype:{\n\t\t\t\t\twidth: tabWidth,\n\t\t\t\t\theight: 32,\n\t\t\t\t\ttemplate: function(obj){\n\t\t\t\t\t\treturn \"<div>\"+obj.value+\"</div>\"+\n\t\t\t\t\t\t\t(!readonly?\"<div class='webix_input_icon wxi-menu-down webix_ssheet_sheet_arrow'></div>\":\"\");\n\t\t\t\t\t},\n\t\t\t\t\t//remove skin selection css on dnd\n\t\t\t\t\tcss:\"ssheet_order_sheets\"\n\t\t\t\t},\n\t\t\t\tonClick:{\n\t\t\t\t\twebix_ssheet_sheet_arrow: function(e, id){\n\t\t\t\t\t\tinitSheetMenu(view, e, id);\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\ton:{\n\t\t\t\t\tonItemClick: function(id){\n\t\t\t\t\t\tif(id != view._activeSheet)\n\t\t\t\t\t\t\tview.showSheet(id);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t},\n\t\t\t{\n\t\t\t\tview: \"button\", type:\"htmlbutton\", width: 34, id: \"prev-sheet\", disabled:true, hidden:true,\n\t\t\t\tlabel: \"<span class='webix_icon wxi-menu-left'></span>\", batch:\"pager\",\n\t\t\t\tclick:function(){scrollSheets(view, -1);}\n\t\t\t},\n\t\t\t{\n\t\t\t\tview: \"button\", type:\"htmlbutton\", width: 34, id: \"next-sheet\", hidden:true,\n\t\t\t\tlabel: \"<span class='webix_icon wxi-menu-right'></span>\", batch:\"pager\",\n\t\t\t\tclick:function(){scrollSheets(view, 1);}\n\t\t\t},\n\t\t\t{gravity:0.000001},\n\t\t\t{\n\t\t\t\tview: \"ssheet-zoom\",\n\t\t\t\tnumbers,\n\t\t\t\tvalue: 1,\n\t\t\t\twidth: 108,\n\t\t\t\ttooltip: locale[\"scale\"],\n\t\t\t\tid: \"zoom\",\n\t\t\t\ton: {\n\t\t\t\t\tonChange: (v, oldV, config) => {\n\t\t\t\t\t\tif (config == \"user\") view.zoom(v);\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t}\n\t\t]\n\t};\n\n\tview.callEvent(\"onViewInit\", [\"bottom-toolbar\", toolbar]);\n\n\treturn toolbar;\n}\n\nfunction scrollSheets(view, direction){\n\tconst sheets = view.$$(\"sheets\");\n\tlet step = view.config.sheetTabWidth;\n\tif(step == \"auto\")\n\t\tstep = view.defaults.sheetTabWidth;\n\tsheets.scrollTo(sheets.getScrollState().x+(direction*step), 0);\n}\n\nfunction menuInit(view){\n\tvar data = [];\n\tfor(var i=0; i < options.length;i++)\n\t\tdata.push({id: options[i], value:webix.i18n.spreadsheet.menus[options[i]]||options[i]});\n\n\tvar menu =  {\n\t\tview: \"ssheet-suggest\",\n\t\tdata: data\n\t};\n\tview.callEvent(\"onViewInit\", [\"sheet-menu\", menu]);\n\treturn menu;\n}\n\nexport function reset(view, obj){\n\tconst tabs = view.$$(\"sheets\");\n\tif (tabs){\n\t\ttabs.clearAll();\n\t\tconst set = [];\n\t\tobj.sheets.forEach(function(sheet){\n\t\t\tset.push({id:sheet.name, value: sheet.name});\n\t\t});\n\t\ttabs.parse(set);\n\t\t_filterTabs(view);\n\t}\n}\n\nfunction ready(view){\n\tprepare(view);\n\n\tview.attachEvent(\"onAfterSheetShow\", (name) => selectSheet(view,name));\n\n\tview.attachEvent(\"onCommand\", function(command){\n\t\tif(actionMap[command.id])\n\t\t\tactionMap[command.id](this);\n\t});\n\n\tif(view.$$(\"sheets\")){\n\t\tview.$$(\"sheets\").data.attachEvent(\"onStoreUpdated\", () => {\n\t\t\tchangePagerVisability(view);\n\t\t\tchangePagerStatus(view);\n\t\t});\n\t\tview.$$(\"sheets\").attachEvent(\"onAfterRender\", webix.once(() => {\n\t\t\twebix.delay(()=> changePagerVisability(view));\n\t\t}));\n\t\tview.$$(\"sheets\").attachEvent(\"onAfterScroll\", () => changePagerStatus(view));\n\t\tview.$$(\"sheets\").attachEvent(\"onAfterDrop\", (context) => dataOrder(view,context.start,context.index));\n\t\tview.$$(\"sheets\").attachEvent(\"onAfterEditStop\", (state) => rename(view,state.old,state.value));\n\t}\n}\n\nfunction getSheetsPopup(view){\n\treturn {\n\t\tview: \"popup\",\n\t\tcss: \"webix_ssheet_suggest\",\n\t\twidth: 125,\n\t\tbody:{\n\t\t\tview: \"list\",\n\t\t\tselect: true,\n\t\t\tcss: \"webix_ssheet_show_list\",\n\t\t\ttemplate: \"<span class='webix_icon wxi-#icon#'></span>#id#\",\n\t\t\ton:{\n\t\t\t\tonAfterSelect: function(id) {\n\t\t\t\t\tsetState(view, id, \"visible\");\n\t\t\t\t\tview.showSheet(id);\n\t\t\t\t\tthis.getParentView().hide();\n\t\t\t\t}\n\t\t\t},\n\t\t\tmaxHeight: 200,\n\t\t\tautoheight: true\n\t\t},\n\t\ton:{\n\t\t\tonShow: function(){\n\t\t\t\tthis.getBody().showItem(view.getActiveSheet());\n\t\t\t},\n\t\t\tonBeforeShow: function(){\n\t\t\t\tconst data = view._sheets\n\t\t\t\t\t.filter(sheet => sheet.state != \"veryHidden\")\n\t\t\t\t\t.map(sheet => {\n\t\t\t\t\t\treturn {\n\t\t\t\t\t\t\tid: sheet.name,\n\t\t\t\t\t\t\ticon: sheet.state == \"hidden\" ? \"eye-slash\" : \"eye\"\n\t\t\t\t\t\t};\n\t\t\t\t\t});\n\n\t\t\t\tconst list = this.getBody();\n\t\t\t\tlist.clearAll();\n\t\t\t\tlist.parse(data);\n\t\t\t\tlist.select(view.getActiveSheet());\n\t\t\t}\n\t\t}\n\t};\n}\n\nfunction initSheetMenu(view, e, id){\n\tif(!view.$sheetMenu){\n\t\tview.$sheetMenu = webix.ui(menuInit(view));\n\t\tview._destroy_with_me.push(view.$sheetMenu);\n\t\tview.$sheetMenu.attachEvent(\"onItemClick\", id => callAction(view,id));\n\t}\n\n\tconst oneSheet = view.$$(\"sheets\").count() == 1;\n\n\tif(view.$sheetMenu.getItem(\"remove-sheet\"))\n\t\tview.$sheetMenu[oneSheet ? \"disableItem\" : \"enableItem\"](\"remove-sheet\");\n\n\tif(view.$sheetMenu.getItem(\"hide-sheet\"))\n\t\tview.$sheetMenu[oneSheet ? \"disableItem\" : \"enableItem\"](\"hide-sheet\");\n\n\tif(view.callEvent(\"onBeforeSheetMenu\", [id]))\n\t\tview.$sheetMenu.show(e);\n}\n\nfunction changePagerStatus(view){\n\tconst sheets = view.$$(\"sheets\");\n\tconst scrollPos = sheets.getScrollState().x;\n\tif(scrollPos == 0)\n\t\tview.$$(\"prev-sheet\").disable();\n\telse{\n\t\tview.$$(\"prev-sheet\").enable();\n\t\tif(sheets.$view.scrollWidth - scrollPos == sheets.$width)\n\t\t\treturn view.$$(\"next-sheet\").disable();\n\t}\n\tview.$$(\"next-sheet\").enable();\n}\n\nfunction changePagerVisability(view){\n\tconst sheets = view.$$(\"sheets\");\n\tview.$$(\"bottom-toolbar\").showBatch(\"pager\", sheets.$width != sheets.$view.scrollWidth);\n}\n\nfunction dataOrder(view, name, num){\n\tfor (let id in view._sheets) {\n\t\tif (view._sheets[id].name == name) {\n\t\t\tconst item = view._sheets.splice(id, 1);\n\t\t\tview._sheets.splice(num, 0, item[0]);\n\t\t\tbreak;\n\t\t}\n\t}\n}\n\nexport function setState(view, sheet, state){\n\tconst tab = getSheet(view, sheet);\n\n\tif(state == tab.state || (state == \"visible\" && !tab.state))\n\t\treturn;\n\n\tif(state != \"visible\"){\n\t\tconst visibleSheets = getVisible(view);\n\n\t\t//don't hide last visible tab\n\t\tif(visibleSheets.length == 1 && visibleSheets[0] === tab)\n\t\t\treturn;\n\n\t\t//select the previous sheet in case we hide the selected sheet\n\t\tif(sheet == view._activeSheet)\n\t\t\tshowPrevious(view, sheet);\n\t}\n\n\ttab.state = state;\n\t_filterTabs(view);\n\n\tview.callEvent(\"onSheetStateChange\", [sheet, state]);\n}\n\nfunction _filterTabs(view){\n\tconst tabs = view.$$(\"sheets\");\n\tif(tabs)\n\t\ttabs.filter(obj => {\n\t\t\tconst state = getSheet(view, obj.id).state;\n\t\t\treturn state != \"hidden\" && state != \"veryHidden\";\n\t\t});\n}\n\nexport function add(view, content){\n\tvar index, name, newIndex;\n\n\tindex = arr.findIndex(view._sheets, x => x.name == view._activeSheet);\n\tnewIndex = index>-1?index+1:view._sheets.length;\n\tname = getNewTitle(view);\n\tcontent = content || {data:[]};\n\tview._sheets.splice(newIndex, 0, {\n\t\tname: name,\n\t\tcontent: content\n\t});\n\n\tif(view.$$(\"sheets\"))\n\t\tview.$$(\"sheets\").add({id: name, value: name},newIndex);\n\n\tview._mData.addPage(name);\n\n\tparseToStore(view, name, content, view.config.prepareData);\n\n\tview.showSheet(name);\n\tview.callEvent(\"onSheetAdd\", [name]);\n\treturn name;\n}\n\nfunction getNewTitle(view){\n\tvar index = view._sheets.length+1;\n\twhile(getSheet(view, (webix.i18n.spreadsheet.labels.sheet+index)))\n\t\tindex++;\n\tvar name = webix.i18n.spreadsheet.labels.sheet+index;\n\treturn name;\n}\n\nfunction selectSheet(view,name){\n\tif(view.$$(\"sheets\")){\n\t\tview.$$(\"sheets\").select(name);\n\t\tview.$$(\"sheets\").showItem(name);\n\t}\n}\n\nexport function edit(view,name){\n\tif(!name)\n\t\tname = view._activeSheet;\n\tview.$$(\"sheets\").edit(name);\n}\n\nfunction _remove(view){\n\tview.confirm({\n\t\ttext: webix.i18n.spreadsheet.labels[\"sheet-remove-confirm\"]\n\t}).then(()=>{\n\t\tremove(view, view._activeSheet);\n\t});\n}\n\nfunction getVisible(view){\n\treturn view._sheets.filter(s => s.state != \"hidden\" && s.state != \"veryHidden\");\n}\n\nfunction showPrevious(view, name){\n\tconst visibleSheets = getVisible(view);\n\n\tlet index = arr.findIndex(visibleSheets, x => x.name == name);\n\t\t\t\n\tlet prevIndex = index - 1;\n\tif(!visibleSheets[prevIndex])\n\t\tprevIndex = 0;\n\tvisibleSheets.splice(index, 1);\n\n\tview.showSheet(visibleSheets[prevIndex].name);\n}\n\nexport function remove(view, name){\n\tif(view._sheets.length > 1){\n\t\tconst visibleSheets = getVisible(view);\n\n\t\t//don't remove last visible tab\n\t\tif(visibleSheets.length == 1 && visibleSheets[0] === getSheet(view, name))\n\t\t\treturn;\n\n\t\t//select the previous sheet in case we remove the selected sheet\n\t\tif(view._activeSheet == name)\n\t\t\tshowPrevious(view, name);\n\n\t\tconst index = arr.findIndex(view._sheets, x => x.name == name);\n\t\tview._sheets.splice(index, 1);\n\t\tview._mData.removePage(name);\n\n\t\tif(view.$$(\"sheets\")){\n\t\t\tview.$$(\"sheets\").remove(name);\n\t\t\tview.$$(\"sheets\").refresh();\n\t\t}\n\n\t\tview.callEvent(\"onSheetRemove\", [name]);\n\t}\n}\n\nexport function rename(view,name,newName){\n\tif (name == newName) return;\n\n\t//correct sheet name\n\tvar i = 1;\n\twhile (!newName || getSheet(view, newName)){\n\t\tnewName = webix.i18n.spreadsheet.labels.sheet + i;\n\t\ti++;\n\t}\n\tnewName = newName.replace(/[*?:[\\]\\\\/]/g,\"\").substring(0, 31);\n\n\tvar sheet = getSheet(view, name);\n\tvar sheets = view.$$(\"sheets\");\n\n\tsheet.name = newName;\n\tif(view._activeSheet == name)\n\t\tview._activeSheet = newName;\n\n\tif(sheets){\n\t\tlet item = sheets.getItem(name);\n\t\titem.value = newName;\n\t\tsheets.data.changeId(name,newName);\n\t\tsheets.refresh(newName);\n\t}\n\n\tview._mData.renamePage(name, newName);\n\tview.callEvent(\"onSheetRename\", [name, newName]);\n}\n\nexport function serialize(view, obj, config){\n\tconst active = getSheet(view, view._activeSheet);\n\tactive.content = obj;\n\tactive.state = active.state || \"visible\";\n\n\tconst sheets = webix.copy(view._sheets);\n\n\tconst math = !config || config.math!==false;\n\tconst compactStyles = config && config.compactStyles;\n\n\tsheets.forEach(sheet => {\n\t\tif(sheet.name != view._activeSheet){\n\t\t\tsheet.content.data = getSheetData(view, math, sheet.name);\n\t\t\tsheet.state = sheet.state || \"visible\";\n\t\t\tif(compactStyles)\n\t\t\t\tsheet.content.styles = removeUnusedStyles(sheet.content);\n\t\t\tsheet.content.ranges = view.ranges.serialize(sheet.name);\n\t\t}\n\t});\n\n\treturn sheets;\n}\n\nfunction parseToStore(view, name, obj, prepareData){\n\tview.ranges.parse(obj.ranges, name);\n\n\twebix.extend(obj, {\n\t\tstyles: [],\n\t\tformats: [],\n\t\teditors: []\n\t});\n\n\tconst page = view._mData.getPage(name);\n\tconst data = obj.data.map(arr => {\n\t\tconst invalidValue = webix.isUndefined(arr[2]) || arr[2] === null;\n\n\t\tif(prepareData){\n\t\t\tif(invalidValue)\n\t\t\t\tarr[2] = \"\";\n\t\t\telse {\n\t\t\t\tconst linkRegex = /^=link\\(/i;\n\t\t\t\tif(typeof arr[2] == \"string\" && linkRegex.test(arr[2])){\n\t\t\t\t\t// LINK is deprecated\n\t\t\t\t\tarr[2] = arr[2].replace(linkRegex, \"=HYPERLINK(\");\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tconst cell = loadCell(view, obj, arr);\n\t\t\t//cell value and type can be changed via types module\n\t\t\tarr[2] = cell.value;\n\t\t\tarr[3] = arr[3] || \"\";\n\t\t\tarr[4] = cell.type;\n\n\t\t\tprepareCell(arr, obj);\n\t\t}\n\t\telse if(invalidValue)\n\t\t\tthrow `unsupported value in ${escapeSheet(name)}!${encode[arr[0]]}${arr[1]}`;\n\n\t\treturn [ arr[0]-1, arr[1]-1, {\n\t\t\tvalue: arr[2],\n\t\t\ttype: arr[4],\n\t\t\tstyle: arr[3],\n\t\t\t$format: checkFormat({ fmt: getFormatFromData(obj, arr) }, \"string\") ? 1 : 0\n\t\t}];\n\t});\n\n\tpage.parse(data, true);\n}\n\nexport function prepareCell(cell, data, update){\n\tconst isDate = cell[4] == \"date\";\n\tif(isDate || update){\n\t\tconst isString = typeof cell[2] == \"string\";\n\n\t\tconst link = update && isString && /^=hyperlink\\(/i.test(cell[2]);\n\n\t\tconst styleProperties = cell[3] ? arr.find(data.styles, style => style[0] == cell[3]) : null;\n\t\tconst styleObj = styleProperties ? styleFromText(styleProperties[1]) : {};\n\n\t\tif((isDate && !styleProperties || !styleObj.format) || link){\n\t\t\tlet props = {};\n\n\t\t\tif(link){\n\t\t\t\tcell[3] = \"wss_link\" + (styleProperties ? \"_\"+cell[3] : \"\");\n\t\t\t\tprops = { color: \"#0000ff\", underline: \"underline\" };\n\t\t\t}\n\t\t\telse if(isString && /^=time\\(/i.test(cell[2])){\n\t\t\t\tcell[3] = \"wss_load_time\" + (styleProperties ? \"_\"+cell[3] : \"\");\n\t\t\t\tprops.format = cell[3]+\"_fmt\";\n\t\t\t\tdata.formats.push([props.format, webix.i18n.spreadsheet.formats.timeFormat]);\n\t\t\t}\n\t\t\telse{\n\t\t\t\tcell[3] = \"wss_load_date\" + (styleProperties ? \"_\"+cell[3] : \"\");\n\t\t\t\tprops.format = \"date\";\n\t\t\t}\n\n\t\t\tif(!arr.find(data.styles, style => style[0] == cell[3]))\n\t\t\t\tdata.styles.push([\n\t\t\t\t\tcell[3],\n\t\t\t\t\tstyleToText({props: webix.extend(styleObj, props, true)})\n\t\t\t\t]);\n\t\t}\n\t}\n}\n\nexport function load(view, obj, excel){\n\tview._loading_data = true;\n\tobj = webix.isArray(obj)?{sheets:obj}:obj;\n\tconst prepareData = view.config.prepareData || excel;\n\n\tif(!obj.sheets && view._activeSheet){\n\t\t//loading into active sheet\n\t\tconst name = view._activeSheet;\n\t\tgetSheet(view, name).content = obj;\n\t\tparseToStore(view, name, obj, prepareData);\n\t\trefresh(view, obj);\n\t} else {\n\t\t//creating new set of sheets\n\t\tprepare(view, obj, prepareData);\n\t}\n\tview._loading_data = false;\n}\n\nexport function prepare(view, obj, prepareData){\n\tif(!obj) obj = {data:[]}; \n\tif(!obj.sheets){\n\t\tobj = newSheet(obj);\n\t}\n\n\tview._activeSheet = \"\";\n\tview._sheets = obj.sheets;\n\tview._mData = new DataStore({strict: view.config.strict});\n\n\t// first add all pages then parse data in them\n\tobj.sheets.forEach(sheet => {\n\t\tview._mData.addPage(sheet.name);\n\t});\n\n\tobj.sheets.forEach(sheet => {\n\t\tconst content = sheet.content;\n\t\tconst sheetName = sheet.name;\n\n\t\tparseToStore(view, sheetName, content, prepareData);\n\t});\n\n\treset(view, obj);\n\tshow(view, getVisible(view)[0].name);\n}\n\nexport function newSheet(obj){\n\treturn {\n\t\tsheets:[{\n\t\t\tname: webix.i18n.spreadsheet.labels.sheet + 1,\n\t\t\tcontent: obj\n\t\t}]\n\t};\n}\n\nexport function show(view, name){\n\tif (name == view._activeSheet) return;\n\n\tif(view.callEvent(\"onBeforeSheetShow\", [name])){\n\t\tif (view._activeSheet)\n\t\t\tgetSheet(view, view._activeSheet).content = view.serialize();\n\n\t\tview._activeSheet = name;\n\t\tconst obj = getSheet(view, name).content;\n\n\t\tview._mPage = view._mData.getPage(name);\n\n\t\trefresh(view, obj);\n\n\t\tview.callEvent(\"onAfterSheetShow\", [name]);\n\t}\n}\n\nexport function getSheet(view, name){\n\treturn arr.find(view._sheets, x => x.name == name);\n}\n\nexport function isVisible(view, sheet){\n\tsheet = getSheet(view, sheet);\n\treturn sheet.state != \"hidden\" && sheet.state != \"veryHidden\";\n}\n\nexport function eachSheet(view, callback){\n\tfor (var i=0; i<view._sheets.length; i++)\n\t\tcallback(view._sheets[i].name);\n}\n\nexport function getActive(view){\n\treturn view._activeSheet;\n}\n\nfunction refresh(view, obj){\n\tconst data = getSheetData(view);\n\n\tlet [rows, cols] = arr.getDimension(data, obj.spans, view.config.rowCount, view.config.columnCount);\n\n\tif (rows != view.config.rowCount || cols != view.config.columnCount){\n\t\tview.config.rowCount = rows;\n\t\tview.config.columnCount = cols;\n\t\tview._resetTable();\n\t}\n\n\tupdateMaxColumn(cols);\n\n\tview.callEvent(\"onReset\", []);\n\n\tview._loading_data = true;\n\tview.callEvent(\"onDataParse\", [obj]);\n\tview._loading_data = false;\n\n\tview._table.refresh();\n\tif(view.config.bottombar)\n\t\tview.$$(\"sheets\").refresh();\n}\n\nfunction copy(view){\n\tadd(view, view.serialize());\n}\n\nfunction callAction(view, id){\n\tif(!view.$sheetMenu.data.getMark(id, \"webix_disabled\")){\n\t\tif(actionMap[id])\n\t\t\tactionMap[id](view);\n\t\telse\n\t\t\tview.callEvent(\"onCommand\", [{id}]);\n\t}\n}\n\n","import {getSheet} from \"../sheets\";\nimport {isCell, adress, range as getRange} from \"../helpers/column_names\";\n\nfunction error(view, silent){\n\tif(!silent)\n\t\tview.alert({\n\t\t\ttype: \"alert-error\",\n\t\t\ttext: webix.i18n.spreadsheet.labels[\"error-link\"]\n\t\t});\n\treturn false;\n}\n\nexport function showCells(view, ref, silent) {\n\ttry {\n\t\tlet r1, r2, c1, c2, sheet;\n\n\t\tlet cellRef = ref.split(\"!\");\n\t\tswitch(cellRef.length){\n\t\t\tcase 1:\n\t\t\t\t[cellRef] = cellRef;\n\t\t\t\tbreak;\n\t\t\tcase 2:\n\t\t\t\t[sheet, cellRef] = cellRef;\n\t\t\t\tif(sheet.indexOf(\" \") != -1 && (sheet[0] != \"'\" || sheet[sheet.length - 1] != \"'\"))\n\t\t\t\t\treturn error(view, silent);\n\t\t\t\tbreak;\n\t\t\tdefault:\n\t\t\t\treturn error(view, silent);\n\t\t}\n\n\t\tif(isCell(cellRef))\n\t\t\t[r1, c1] = adress(cellRef);\n\t\telse{\n\t\t\tconst rangePos = getRange(ref, view);\n\t\t\tif(rangePos)\n\t\t\t\t[r1, c1, r2, c2, sheet] = rangePos;\n\t\t\telse\n\t\t\t\treturn error(view, silent);\n\t\t}\n\n\t\tif(sheet){\n\t\t\tsheet = sheet.replaceAll(\"'\", \"\");\n\t\t\tif(!getSheet(view, sheet))\n\t\t\t\treturn error(view, silent);\n\t\t\tif(sheet != view.getActiveSheet())\n\t\t\t\tview.showSheet(sheet);\n\t\t}\n\n\t\tconst grid = view.$$(\"cells\");\n\t\tgrid.showCell(r1, c1);\n\t\tgrid.addSelectArea(\n\t\t\t{ row: r1, column: c1 },\n\t\t\t{ row: r2 || r1, column: c2 || c1 }\n\t\t);\n\n\t\treturn true;\n\t}\n\tcatch(err){\n\t\treturn error(view, silent);\n\t}\n}","import * as cop from \"./operations/column_operations\";\nimport {getConditionCss} from \"./operations/conditional_formats\";\nimport * as nms from \"./helpers/column_names\";\nimport * as fmt from \"./operations/formats\";\nimport {showCells} from \"./operations/show_cells\";\n\nexport function init(view, extra){\n\tview.attachEvent(\"onComponentInit\", () => ready(view));\n\n\tvar datatable = {\n\t\tview:\"datatable\", id:\"cells\", css:\"webix_ssheet_table webix_data_border wss_\"+view.$index,\n\t\theaderRowHeight: webix.skin.$name == \"contrast\" || webix.skin.$name == \"flat\" ? 24 : 20,\n\t\tspans: true,\n\t\tleftSplit: 1,\n\t\tareaselect:true,\n\t\tminColumnWidth:40,\n\t\teditable:true,\n\t\teditaction:(extra.liveEditor ? \"custom\" : \"dblclick\"),\n\t\tminRowHeight:1,\n\t\tnavigation:true,\n\t\tonClick:{ \n\t\t\t\"webix_ssheet_ref\" : event => {\n\t\t\t\tconst ref = event.target.getAttribute(\"data-ref\").replaceAll(\"&#x27;\", \"'\");\n\t\t\t\tif(showCells(view, ref))\n\t\t\t\t\treturn false;\n\t\t\t}\n\t\t}\n\t};\n\n\tif (extra)\n\t\tdatatable = webix.extend(datatable, extra, true);\n\n\treturn datatable;\n}\n\nfunction ready(view){\n\tvar grid = view._table;\n\n\tvar showCommentHandler = webix.event(document.body, \"pointermove\", function(){\n\t\tvar thread;\n\t\treturn function(e) {\n\t\t\tif (e.pointerType !== \"mouse\") return;\n\n\t\t\tclearTimeout(thread);\n\t\t\tthread = webix.delay(function(e){\n\t\t\t\tif(view.comments._activeComment.editStatus)\n\t\t\t\t\treturn;\n\n\t\t\t\tvar cell = grid.locate(e);\n\t\t\t\tvar visible = view.comments.commentsView && view.comments.commentsView.isVisible();\n\n\t\t\t\tif(cell && view.comments.get(cell.row, cell.column)){\n\t\t\t\t\tvar activeCell = view.comments._activeComment.cell;\n\t\t\t\t\tif((activeCell && (activeCell.row != cell.row || activeCell.column != cell.column)) || !visible)\n\t\t\t\t\t\tview.callEvent(\"onCommand\",[{id: \"add-comment\", cell, viewonly: true }]);\n\t\t\t\t}\n\t\t\t\telse if(visible && !view.comments.commentsView.$view.contains(e.target))\n\t\t\t\t\tview.callEvent(\"onCommentHide\", []);\n\t\t\t}, true, [e], 250);\n\t\t};\n\t}());\n\n\t//in grid math\n\tif (view.config.math){\n\t\tgrid.config.editMath = true;\n\t}\n\n\t//saving value after edit\n\tgrid.attachEvent(\"onBeforeEditStop\", (st, ed) => {\n\t\tgrid.$anyKey = false;\n\t\tconst old = view.getCellValue(ed.row, ed.column);\n\t\t//ignore empty cells\n\t\tif (old === \"\" && st.value === \"\") return;\n\n\t\tif (st.value != old){\n\t\t\tview.setCellValue(ed.row, ed.column, st.value);\n\t\t\tgrid.refresh();\n\t\t}\n\t\tst.value = st.old;\n\t});\n\n\tgrid.attachEvent(\"onEnter\", function(ev){\n\t\tif (grid.getEditor()){\n\t\t\twebix.delay(function(){\n\t\t\t\tgrid.moveSelection(\"down\");\n\t\t\t});\n\t\t}\n\t\twebix.html.preventEvent(ev);\n\t});\n\n\t//prevent editing of locked cells\n\tview.attachEvent(\"onBeforeEditStart\", (row, column) => !view.isCellLocked(row, column));\n\tgrid.attachEvent(\"onAfterEditStart\", ({row, column}) => {\n\t\tlet v = view.getCellValue(row, column);\n\n\t\tif(grid.$anyKey){\n\t\t\tgrid.$anyKey = false;\n\t\t\tv = \"\";\n\t\t}\n\n\t\tgrid.getEditor().setValue(v);\n\t});\n\tgrid.attachEvent(\"onBeforeEditStart\", (editor) => \n\t\tview.callEvent(\"onBeforeEditStart\", [editor.row, editor.column]) );\n\n\t//column drag event checking\n\tlet dragStartColumn;\n\tlet dragEndColumn;\n\n\t//column and row selection\n\tgrid.attachEvent(\"onBeforeSelect\", (id) => id.column != \"rowId\" );\n\tgrid.attachEvent(\"onBeforeBlockSelect\", (start, end, finalStep) => {\n\t\tcop.highlightColRow(\n\t\t\tfinalStep ? start : webix.copy(start),\n\t\t\tfinalStep ? end : webix.copy(end),\n\t\t\tview\n\t\t);\n\t});\n\n\tfunction highlightHeaders(){\n\t\tlet ids = grid.getSelectedId(true);\n\t\tif(ids.length){\n\t\t\tlet start = ids[0];\n\t\t\tlet end = ids[ids.length-1]?ids[ids.length-1]:ids[0];\n\t\t\tcop.highlightColRow(start, end, view);\n\t\t}\n\t\telse {\n\t\t\tlet data = {row:0, column:0};\n\t\t\tcop.highlightColRow(data, data, view);\n\t\t}\n\t}\n\n\tgrid.attachEvent(\"onSelectChange\", () => highlightHeaders());\n\tgrid.attachEvent(\"onAfterColumnShow\", () => {\n\t\twebix.delay(() => highlightHeaders());\n\t});\n\tgrid.attachEvent(\"onColumnResize\", () => {\n\t\twebix.delay(() => highlightHeaders());\n\t});\n\n\twebix.event(grid.$view.firstChild, \"mousedown\", e => {\n\t\tconst resizeColumn = grid.config.resizeColumn;\n\t\tconst col = grid.locate(e);\n\n\t\tif(col && col.cind){\n\t\t\tif(resizeColumn){\n\t\t\t\tconst dx = grid.getColumnConfig(col.column).width;\n\t\t\t\tconst pos = webix.html.posRelative(e);\n\t\t\t\tif(pos.x < resizeColumn.size || dx-pos.x < resizeColumn.size+1)\n\t\t\t\t\treturn;\n\t\t\t}\n\t\t\tdragStartColumn = col.cind;\n\t\t}\n\t});\n\n\twebix.event(grid.$view.firstChild, \"mousemove\", e => {\n\t\tif(dragStartColumn){\n\t\t\tconst col = grid.locate(e);\n\n\t\t\tif(col){\n\t\t\t\tdragEndColumn = col.cind;\n\t\t\t\tcop.highlightColRow(\n\t\t\t\t\t{column: grid.columnId(dragStartColumn)},\n\t\t\t\t\t{column: grid.columnId(dragEndColumn||1)},\n\t\t\t\t\tview\n\t\t\t\t);\n\t\t\t}\n\t\t}\n\t});\n\n\tconst selectColumnHandler = webix.event(document.body, \"mouseup\", () => {\n\t\tif(dragStartColumn){\n\t\t\tif(dragEndColumn != null){\n\t\t\t\tcop.selectColumn(\n\t\t\t\t\tgrid.columnId(dragStartColumn),\n\t\t\t\t\tview,\n\t\t\t\t\tgrid.columnId(dragEndColumn||1)\n\t\t\t\t);\n\t\t\t\tdragEndColumn = null;\n\t\t\t}\n\t\t\tdragStartColumn = null;\n\t\t}\n\t});\n\n\tgrid.attachEvent(\"onItemDblClick\", (id) => {\n\t\tif (id.column === \"rowId\")\n\t\t\tcop.adjustRow(id.row, view);\n\t});\n\n\tlet lastHeaderClick = 0;\n\tgrid.attachEvent(\"onHeaderClick\", (id, e) => {\n\t\tif(id.column == \"rowId\"){\n\t\t\tcop.selectAll(view);\n\t\t\treturn;\n\t\t}\n\t\tlet headerClick = new Date();\n\t\tlet dblClick = (headerClick - lastHeaderClick <= 300);\n\n\t\tif (dblClick) {\n\t\t\tcop.adjustColumn(id.column, view);\n\t\t} else {\n\t\t\tlastHeaderClick = headerClick;\n\t\t\tif (e.shiftKey) {\n\t\t\t\tcop.selectColumns(id.column, view);\n\t\t\t} else {\n\t\t\t\tcop.selectColumn(id.column, view);\n\t\t\t}\n\t\t}\n\t});\n\n\t//select rows by shift click\n\tvar lastClickedRow = null;\n\tgrid.attachEvent(\"onItemClick\", (cell, e) => {\n\t\tif (cell.column === \"rowId\") {\n\t\t\tif (!e.shiftKey)\n\t\t\t\tcop.selectRow(cell.row, view);\n\t\t\telse {\n\t\t\t\tif (!lastClickedRow)\n\t\t\t\t\tcop.selectRow(cell.row, view);\n\t\t\t\telse\n\t\t\t\t\tcop.selectRow(lastClickedRow, view, cell.row);\n\t\t\t}\n\t\t\tlastClickedRow = cell.row;\n\t\t}\n\t});\n\n\t//reset API\n\tview.attachEvent(\"onReset\", () => reset(view));\n\n\tview.attachEvent(\"onBeforeSheetShow\", () => grid.editStop());\n\n\tgrid.attachEvent(\"onBlur\", function(){\n\t\t//after focus moved out, check and if it is somewhere\n\t\t//on the spreadsheet controls them move focus back to datatable\n\t\twebix.delay(function(){\n\t\t\tvar target = document.activeElement;\n\n\t\t\tif (target && target.tagName == \"INPUT\") return;\n\n\t\t\tvar focus = webix.UIManager.getFocus();\n\t\t\tvar need_focus = focus &&\n\t\t\t\tfocus != grid &&\n\t\t\t\tfocus.getTopParentView &&\n\t\t\t\tfocus.getTopParentView() === view;\n\n\t\t\tif (need_focus)\n\t\t\t\twebix.UIManager.setFocus(grid);\n\n\t\t}, this, [], 100);\n\t});\n\n\tgrid.attachEvent(\"onMoveSelection\", (cell, mode, details) => {\n\t\tif(cell.column == \"rowId\" && mode == \"left\" && details.ctrl)\n\t\t\tcell.column = 1;\n\t});\n\n\tsetDefaultCss(view);\n\n\tview.attachEvent(\"onDestruct\", () => {\n\t\twebix.eventRemove(showCommentHandler);\n\t\twebix.eventRemove(selectColumnHandler);\n\t});\n}\n\nexport function cell_template(view, obj, common, _v, column, valueOnly){\n\tconst formulasMode = view.$$(\"cells\").config.showFormulas && !valueOnly;\n\n\tconst col = column.id;\n\tconst row = obj.id;\n\n\tif (!view._mPage) return \"\";\n\tconst cell = view._mPage.getCell(row-1, col-1);\n\n\tlet value = cell ? cell.value : \"\";\n\tconst format = cell ? cell.format : \"\";\n\n\tconst math = view.getCellValue(row, col);\n\n\tif(formulasMode)\n\t\tvalue = math;\n\n\tif(math != value){\n\t\tconst locale = webix.i18n.spreadsheet.table;\n\t\tif(value == \"#REF!\")\n\t\t\tvalue = locale[\"math-ref-error\"];\n\t\telse if(value == \"#ERROR\")\n\t\t\tvalue = locale[\"math-error\"];\n\t}\n\n\tlet css = \"\";\n\tconst text = (typeof value == \"string\" && value.trim()[0] == \"+\") || (!value && value !== 0) || isNaN(value);\n\tconst invalidDate = !formulasMode && fmt.checkFormat(format, \"date\") && fmt.isDateInvalid(value);\n\n\tlet extra = \"\";\n\tif (!valueOnly){\n\t\textra += view.comments.get(row, col) ? \"<div class='ssheet_commented_sign'></div>\" : \"\";\n\t\textra += view.getCellFilter(row, col) ? \"<div class='ssheet_filter_sign'></div>\" : \"\";\n\t}\n\n\t//text can be formatted only in case of string number format\n\tif(!invalidDate && (typeof value == \"boolean\" || !text || fmt.checkFormat(format, \"string\"))){\n\t\tif (format){\n\t\t\tconst cell = { css:\"\" };\n\t\t\tconst helper = fmt.getFormat(format);\n\t\t\tif (helper){\n\t\t\t\tlet newValue = helper(value, cell);\n\n\t\t\t\tif(newValue != webix.i18n.spreadsheet.table[\"format-error\"]){\n\t\t\t\t\tif (cell.css)\n\t\t\t\t\t\tcss = `class=\"${cell.css}\"`;\n\t\t\t\t\tvalue = newValue;\n\t\t\t\t}\n\t\t\t\telse if(!text)\n\t\t\t\t\tvalue *= 1;\n\t\t\t}\n\t\t}\n\t\telse\n\t\t\tvalue *= 1;\n\t}\n\n\t//print only cell values (td with position:relative ignores borders while printing)\n\tif(view._print && !(value || value === 0))\n\t\treturn \"\";\n\n\tif(webix.isUndefined(value) || value === null)\n\t\tvalue = \"\";\n\n\treturn `<div ${css}>${value}</div>${view._print ? \"\" : extra}`;\n}\n\nexport function reset(view){\n\tconst grid = view.$$(\"cells\");\n\tgrid.clearAll();\n\n\tconst columns = view.config.columnCount;\n\tconst rows = view.config.rowCount;\n\n\tconst cols = [{\n\t\tid:\"rowId\",\n\t\theader:\"\",\n\t\twidth:40,\n\t\tcss:\"sheet_column_0\",\n\t\ttemplate:(el) => {\n\t\t\treturn el.id;\n\t\t}\n\t}];\n\n\tfor (let i=1; i<=columns; i++){\n\t\tcols.push({\n\t\t\tid:i,\n\t\t\teditor:\"text\",\n\t\t\theader:{\n\t\t\t\ttext: nms.encode[i]\n\t\t\t},\n\t\t\ttemplate:function(obj, common, value, column){\n\t\t\t\treturn cell_template(view, obj, common, value, column);\n\t\t\t},\n\t\t\tcssFormat:function(value, obj, row, column){\n\t\t\t\tconst rendered = getRenderedValue(view, row, column);\n\t\t\t\tconst cell = view._mPage.getCell(row-1, column-1);\n\n\t\t\t\tlet css = cell ? (cell.style || \"\") : \"\";\n\n\t\t\t\tconst conditional = getConditionCss(view, row, column, rendered);\n\t\t\t\tif(conditional)\n\t\t\t\t\tcss += (css ? \" \" : \"\") + conditional;\n\n\t\t\t\tconst borders = view._printBorders.$render;\n\t\t\t\tif(borders){\n\t\t\t\t\tif(borders.cols[column])\n\t\t\t\t\t\tcss += (css ? \" \" : \"\") + \"webix_ss_print_border_right\";\n\t\t\t\t\tif(borders.rows[row])\n\t\t\t\t\t\tcss += (css ? \" \" : \"\") + \"webix_ss_print_border_bottom\";\n\t\t\t\t}\n\n\t\t\t\treturn css;\n\t\t\t}\n\t\t});\n\t\tview.callEvent(\"onColumnInit\",[cols[i]]);\n\t}\n\tgrid.refreshColumns(cols);\n\n\tconst data = [];\n\tfor (let i=1; i<=rows; i++)\n\t\tdata.push({ id:i });\n\n\tgrid.parse(data);\n}\n\nexport function getRenderedValue(view, row, col){\n\tconst htmlFilter = /<[^>]*>/gi;\n\treturn cell_template(view, {id: row}, null, null, {id: col}, true).replace(htmlFilter, \"\");\n}\n\n// nowrap by default\nfunction setDefaultCss(view){\n\twebix.html.addStyle(\"#\"+view._table.$view.id+\".webix_dtable .webix_cell { white-space:nowrap;}\");\n}\n","import group from \"./operations/undo_group\";\nimport {selectAll} from \"./operations/column_operations\";\nimport {styleFormats} from \"./toolbar/buttons\";\n\nexport function init(view){\n\tconst grid = view.$$(\"cells\");\n\tconst key = webix.env.isMac ? \"command\" : \"ctrl\";\n\n\twebix.UIManager.addHotKey(key+\"-a\", () => { if(!grid.getEditor()) selectAll(view); }, grid);\n\twebix.UIManager.addHotKey(key+\"-p\", (v, e) => dialog(\"print\", view, e), grid);\n\n\tif(!view.config.readonly){\n\t\twebix.UIManager.addHotKey(\"any\", (view, ev) => {\n\t\t\tconst code = ev.which || ev.keyCode;\n\t\t\tconst f2 = code == 113;\n\n\t\t\t//ignore shift key, f1, f3 - f12 (f2 - edit)\n\t\t\tif (code == 16 || (code >= 112 && code <= 123 && !f2)) return;\n\n\t\t\tconst sel = view.getSelectedId(true);\n\t\t\tif (sel.length){\n\t\t\t\tif(!(view.config.liveEditor && f2))\n\t\t\t\t\tgrid.$anyKey = true;\n\t\t\t\tgrid.edit(sel[0]);\n\t\t\t}\n\t\t}, grid);\n\n\t\twebix.UIManager.addHotKey(\"enter\", (view) => {\n\t\t\tconst sel = view.getSelectedId(true);\n\t\t\tif (sel.length){\n\t\t\t\tif(!(view.config.liveEditor && !grid.callEvent(\"onBeforeLiveEditor\", [sel[0]])))\n\t\t\t\t\tgrid.edit(sel[0]);\n\t\t\t}\n\t\t}, grid);\n\n\t\twebix.UIManager.addHotKey(\"backspace\", () => del(view), grid);\n\t\twebix.UIManager.addHotKey(\"delete\", () => del(view), grid);\n\n\t\tconst redo = webix.env.isMac ? \"command-shift-z\" : \"ctrl-y\";\n\t\twebix.UIManager.addHotKey(redo, () => view.redo(), grid);\n\t\twebix.UIManager.addHotKey(key+\"-z\", () => view.undo(), grid);\n\n\t\twebix.UIManager.addHotKey(key+\"-b\", () => styleHotKey(view, \"font-weight\"), grid);\n\t\twebix.UIManager.addHotKey(key+\"-i\", () => styleHotKey(view, \"font-style\"), grid);\n\t\twebix.UIManager.addHotKey(key+\"-u\", (v, e) => ctrlU(view, e), grid);\n\n\t\tconst strike = webix.env.isMac ? \"command-shift-x\" : \"ctrl-alt-s\";\n\t\twebix.UIManager.addHotKey(strike, () => styleHotKey(view, \"strike\"), grid);\n\n\t\twebix.UIManager.addHotKey(key+\"-add\", (v, e) => zoom(view, \"in\", e), grid);\n\t\twebix.UIManager.addHotKey(key+\"-subtract\", (v, e) => zoom(view, \"out\", e), grid);\n\t\twebix.UIManager.addHotKey(key+\"-0\", (v, e) => zoom(view, 1, e), grid);\n\t\twebix.UIManager.addHotKey(key+\"-`\", () => view.showFormulas(\"toggle\"), grid);\n\t}\n}\n\nfunction del(view) {\n\tif(!view.$$(\"cells\").getEditor())\n\t\tgroup.set(function(){\n\t\t\tview.eachSelectedCell((cell) => view.setCellValue(cell.row,cell.column, \"\"));\n\t\t\tview.refresh();\n\t\t});\n}\n\nfunction zoom(view, value, e) {\n\tview.zoom(value);\n\treturn webix.html.preventEvent(e);\n}\n\nfunction ctrlU(view, e) {\n\tstyleHotKey(view, \"underline\");\n\treturn webix.html.preventEvent(e);\n}\n\nfunction dialog(id, view, e) {\n\tview.callEvent(\"onCommand\",[{id}]);\n\treturn webix.html.preventEvent(e);\n}\n\nfunction styleHotKey(view, attr) { \n\tvar cell = view.getSelectedId();\n\tif(cell){\n\t\tvar style = view.getStyle(cell.row, cell.column);\n\n\t\tvar elementOn = styleFormats[attr]||attr;\n\t\tvar elementOff = \"normal\";\n\n\t\tvar state = (style && style.props[attr] === elementOn)? elementOff : elementOn;\n\t\tview.callEvent(\"onStyleSet\", [attr, state]);\n\t}\n}","import {methods} from \"@xbs/muon\";\n\nlet methodsName = [];\nfor(let name in methods)\n\tmethodsName.push(name);\n\nexport function init(view){\n\tview.attachEvent(\"onComponentInit\", () => ready(view));\n\n\treturn {\n\t\tview:\"toolbar\",\n\t\tcss:\"webix_ssheet_toolbar\",\n\t\telements:[\n\t\t\t{\n\t\t\t\tview:\"text\",\n\t\t\t\ticon: \"wxi-menu-down\",\n\t\t\t\ton: {\n\t\t\t\t\tonItemClick: function(){\n\t\t\t\t\t\tconst suggest = webix.$$(this.config.suggest);\n\t\t\t\t\t\tif(!suggest.isVisible())\n\t\t\t\t\t\t\tsuggest.show(this.getInputNode());\n\t\t\t\t\t},\n\t\t\t\t\tonChange: (val, oldVal, config) => {\n\t\t\t\t\t\tif(config == \"user\" && val !== \"\")\n\t\t\t\t\t\t\tview.showCell(val);\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\tsuggest: {\n\t\t\t\t\tview:\"ssheet-suggest-labels\",\n\t\t\t\t\tcss: \"webix_ssheet_nav_suggest\",\n\t\t\t\t\tbody: {\n\t\t\t\t\t\ttemplate: \"<span class='webix_ssheet_left'>#name#</span><span class='webix_ssheet_right'>#value#</span>\",\n\t\t\t\t\t\twidth: 250\n\t\t\t\t\t},\n\t\t\t\t\ton:{\n\t\t\t\t\t\tonBeforeShow: function(){\n\t\t\t\t\t\t\tconst data = view.ranges.serialize(view.getActiveSheet()).map(r => ({name: r[0], value: r[1]}));\n\n\t\t\t\t\t\t\tif(!data.length)\n\t\t\t\t\t\t\t\treturn false;\n\n\t\t\t\t\t\t\tconst list = this.getList();\n\t\t\t\t\t\t\tlist.clearAll();\n\t\t\t\t\t\t\tlist.parse(data);\n\t\t\t\t\t\t}\n\t\t\t\t\t},\n\t\t\t\t\tdata: []\n\t\t\t\t},\n\t\t\t\twidth: 150,\n\t\t\t\tid: \"navigation\"\n\t\t\t},\n\t\t\t{\n\t\t\t\tview: \"ssheet-separator\"\n\t\t\t},\n\t\t\t{\n\t\t\t\tview:\"label\",\n\t\t\t\tlabel:webix.i18n.spreadsheet.liveEditor[\"edit\"],\n\t\t\t\twidth:65\n\t\t\t},\n\t\t\t{\n\t\t\t\tview:\"live-editor\",\n\t\t\t\tdisabled:true,\n\t\t\t\tid:\"liveEditor\",\n\t\t\t\tsuggestData: methodsName\n\t\t\t}\n\t\t]\n\t};\n}\n\nfunction ready(view){\n\tconst editor = view.$$(\"liveEditor\");\n\tconst nav = view.$$(\"navigation\");\n\tconst grid = view._table;\n\n\t//block native editor, and move focus to the custom input\n\t//edit by key press\n\tgrid.attachEvent(\"onBeforeEditStart\", function(cell){\n\t\tconst mode = grid.$anyKey;\n\t\tgrid.$anyKey = false;\n\n\t\treturn startEdit(this, cell, mode);\n\t});\n\t//edit by enter key\n\tgrid.attachEvent(\"onBeforeLiveEditor\", function(cell){\n\t\treturn startEdit(this, cell, false);\n\t});\n\t//edit by dbl-click\n\tgrid.attachEvent(\"onItemDblClick\", function(cell){\n\t\tif(view.getCellEditor(cell.row, cell.column))\n\t\t\tthis.edit(cell);\n\t\telse\n\t\t\tstartEdit(this, cell, false);\n\t});\n\n\tgrid.attachEvent(\"onAfterScroll\", function(){\n\t\tif(editor.$view.contains(document.activeElement))\n\t\t\teditor.paintValue();\n\t});\n\n\tview.attachEvent(\"onCellChange\", (r,c,v,p) => {\n\t\tif(p == view.getActiveSheet()){\n\t\t\tconst cell = editor.config.activeCell;\n\t\t\tif (cell && cell.row == r && cell.column == c)\n\t\t\t\teditor.setValue(v);\n\t\t}\n\t});\n\n\tview.attachEvent(\"onAfterSelect\", data => {\n\t\tif (!view.$handleSelection)\n\t\t\tfillEditor(data[0]);\n\t});\n\n\tview.attachEvent(\"onChange\", mode => {\n\t\tif (mode == \"update\" && editor.isEnabled()){\n\t\t\tconst cell = editor.config.activeCell;\n\t\t\tif(cell && editor.getValue() != view.getCellValue(cell.row, cell.column)){\n\t\t\t\tdelete editor._update_range;\n\t\t\t\teditor.showActiveSheet();\n\t\t\t\teditor.updateCellValue();\n\t\t\t}\n\t\t}\n\t});\n\n\tview.attachEvent(\"onBeforeSheetShow\", name => {\n\t\tif(view._rangeDialog)\n\t\t\treturn;\n\t\tconst cell = editor.config.activeCell;\n\t\tif(cell){\n\t\t\tconst cursor = editor.getInputNode().selectionStart;\n\t\t\tconst val = editor.getValue();\n\t\t\tif(view.getCellValue(cell.row, cell.column) != val){\n\t\t\t\tif(!editor._activeMath)\n\t\t\t\t\teditor._activeMath = view.getActiveSheet();\n\t\t\t\twebix.delay(()=>{\n\t\t\t\t\tif(name == editor._activeMath){\n\t\t\t\t\t\tview.$handleSelection = null;\n\t\t\t\t\t\tconst cell = editor.config.activeCell;\n\t\t\t\t\t\tgrid.select(cell.row, cell.column);\n\t\t\t\t\t}\n\n\t\t\t\t\teditor.setValue(val);\n\t\t\t\t\t//update highlight\n\t\t\t\t\teditor.refresh();\n\n\t\t\t\t\teditor.getInputNode().setSelectionRange(cursor, cursor);\n\t\t\t\t\teditor.paintValue();\n\n\t\t\t\t\tview.$handleSelection = function(a,b,st,en){ return pasteRange(st, en, a); };\n\t\t\t\t});\n\t\t\t}\n\t\t\telse{\n\t\t\t\tnav.setValue(\"\");\n\t\t\t\tclearEditor();\n\t\t\t}\n\t\t}\n\t});\n\n\tview.attachEvent(\"onReset\", () => {\n\t\tif(!view._rangeDialog)\n\t\t\tview.$handleSelection = null;\n\t});\n\tview.$$(\"cells\").attachEvent(\"onFocus\", ()=>{\n\t\t//ignore table clipboard logic\n\t\tif(editor._activeMath){\n\t\t\twebix.delay(()=>editor.focus());\n\t\t}\n\t});\n\n\tview.attachEvent(\"onAfterLoad\", () => clearEditor());\n\n\tview.attachEvent(\"onAction\", function(name, options){\n\t\tconst cell = editor.config.activeCell;\n\t\tconst isActiveCell = cell && cell.row == options.row && cell.column == options.column;\n\t\tif(isActiveCell && (name == \"lock\" || name == \"dropdown\"))\n\t\t\tdisableEditor(options.row, options.column);\n\t});\n\n\tview.attachEvent(\"onFormatChange\", (r, c) => updateEditor(r, c));\n\tview.attachEvent(\"onCellChange\", (r, c, v , p) => {\n\t\tif(p == view.getActiveSheet())\n\t\t\tupdateEditor(r, c);\n\t});\n\n\tfunction updateEditor(row, column){\n\t\tconst activeCell = editor.config.activeCell;\n\t\tif(activeCell && activeCell.row == row && activeCell.column == column)\n\t\t\tfillEditor({row, column});\n\t}\n\n\tfunction startEdit(table, cell, clear){\n\t\t//do not interfere with custom editors\n\t\tif (!view.getCellEditor(cell.row, cell.column) && fillEditor(cell, clear)){\n\t\t\teditor.focus();\n\n\t\t\tif(!clear){\n\t\t\t\teditor.paintValue();\n\n\t\t\t\tconst input = editor.getInputNode();\n\t\t\t\tconst symbols = input.value.length;\n\t\t\t\tinput.setSelectionRange(symbols, symbols);\n\t\t\t}\n\t\t\treturn false;\n\t\t}\n\t\treturn true;\n\t}\n\n\tfunction disableEditor(row,column){\n\t\tconst disabled = view.getCellEditor(row, column) || view.isCellLocked(row, column);\n\t\tif(disabled)\n\t\t\teditor.disable();\n\t\telse\n\t\t\teditor.enable();\n\t\treturn disabled;\n\t}\n\n\tfunction fillEditor(cell, clear){\n\t\tconst disabled = disableEditor(cell.row, cell.column);\n\t\teditor.config.activeCell = cell;\n\t\teditor.setValue( clear ? \"\" : editor.getCellValue(cell.row, cell.column) );\n\n\t\tif(!view._rangeDialog)\n\t\t\tview.$handleSelection = disabled ? null : function(a,b,st,en){ return pasteRange(st, en, a); };\n\n\t\treturn !disabled;\n\t}\n\n\tfunction pasteRange(st, en, cell){\n\t\tconst updateRange = editor._update_range;\n\t\tlet cursor = editor.getInputNode().selectionStart;\n\n\t\tlet sheet = \"\";\n\t\tif(editor._activeMath){\n\t\t\tconst activeSheet = view.getActiveSheet();\n\t\t\tif(editor._activeMath != activeSheet)\n\t\t\t\tsheet = editor.prepareSheet(activeSheet);\n\t\t}\n\n\t\tlet range;\n\t\tif(st == en){\n\t\t\tconst colon = editor.getValue()[ (updateRange ? updateRange.pos : cursor)-1 ] == \":\";\n\t\t\trange = colon ? st : sheet+st;\n\t\t}\n\t\telse\n\t\t\trange = `${sheet+st}:${en}`;\n\n\t\tif(updateRange && updateRange.pos == cursor - updateRange.len){\n\t\t\teditor.setRange(range, true);\n\t\t\tcursor = editor._update_range.pos + range.length;\n\t\t}\n\t\telse if(editor.expectOperator()){\n\t\t\teditor.setRange(range);\n\t\t\tcursor += range.length;\n\t\t}\n\t\telse\n\t\t\treturn endEdit(cell);\n\n\t\teditor.focus();\n\t\teditor.getInputNode().setSelectionRange(cursor, cursor);\n\t\teditor.paintValue();\n\n\t\treturn false;\n\t}\n\n\tfunction endEdit(st){\n\t\tif (editor.isEnabled()){\n\t\t\tconst cell = editor.config.activeCell;\n\t\t\teditor.showActiveSheet();\n\t\t\teditor.updateCellValue(cell);\n\t\t\teditor.setValue(st ? view.getCellValue(st.row, st.column) : \"\");\n\t\t}\n\t\treturn true;\n\t}\n\n\tfunction clearEditor(){\n\t\teditor.define({activeCell:null});\n\t\teditor.setValue(\"\");\n\t\teditor.disable();\n\t}\n}\n","import \"../views/formlate\";\n\nexport class Dialog{\n\tconstructor(view){\n\t\tthis.view = view;\n\t}\n\t$init(){}\n\t$show(){}\n\t$hide(){}\n\topen(){\n\t\tif(!this.$dialog){\n\t\t\tthis.$dialog = webix.ui(this.$init());\n\t\t\tthis.view._destroy_with_me.push(this.$dialog);\n\t\t\tthis.$dialog.attachEvent(\"onHide\", ()=> {\n\t\t\t\tthis.$hide();\n\t\t\t\twebix.UIManager.setFocus(this.view);\n\t\t\t});\n\t\t\tthis.$dialog.attachEvent(\"onShow\", ()=> {\n\t\t\t\twebix.UIManager.setFocus(this.$dialog);\n\t\t\t});\n\t\t}\n\t\telse if(this.$dialog.isVisible())\n\t\t\treturn;\n\n\t\tconst form = this.$dialog.getBody();\n\t\tthis.$dialog.show();\n\t\tif (this.$show(this.$dialog, form) === false)\n\t\t\tthis.close();\n\t}\n\tclose(){\n\t\tthis.$dialog.hide();\n\t}\n}","export function image(url){\n\treturn `=IMAGE(\"${url}\")`;\n}\n\nexport function chart(config){\n\tconfig = webix.copy(config);\n\n\tconst bar = config.type == \"bar\";\n\tif(bar && config.horizontal)\n\t\tconfig.type = \"barH\";\n\n\tlet result = `=SPARKLINE(${config.range},\"${config.type}\"`;\n\tif (bar)\n\t\tresult += `,\"${config.color}\",\"${config.negativeColor}\"`;\n\telse if(config.color)\n\t\tresult += `,\"${config.color}\"`;\n\treturn result+\")\";\n}\n\nexport function parseImage(value){\n\tif (value && value.indexOf(\"=IMAGE(\") === 0)\n\t\treturn {\n\t\t\turl: unescape(value.substr(7, value.length-8))\n\t\t};\n}\n\nexport function parseChart(value){\n\tif (value && value.indexOf(\"=SPARKLINE(\") === 0){\n\t\tlet text = value.substr(11, value.length-12).split(\",\");\n\t\tconst result = {\n\t\t\trange: text[0],\n\t\t\ttype: unescape(text[1]),\n\t\t\tcolor: unescape(text[2]),\n\t\t\tnegativeColor: unescape(text[3])\n\t\t};\n\n\t\tif(result.type == \"barH\"){\n\t\t\tresult.type = \"bar\";\n\t\t\tresult.horizontal = 1;\n\t\t}\n\n\t\treturn result;\n\t}\n}\n\nfunction unescape(text){\n\tif (!text) return \"\";\n\n\ttext = text.trim();\n\tif (text[0] === \"\\\"\") \n\t\ttext = text.substr(1);\n\tif (text[text.length-1] === \"\\\"\")\n\t\ttext = text.substr(0, text.length-1);\n\treturn text;\n}","import {Dialog} from \"./common\";\nimport {parseImage} from \"../mathematics/writer\";\n\nexport const action = \"add-image-cell\";\n\nexport class DialogBox extends Dialog{\n\t$show(box, form){\n\t\tthis.cell = this.view.getSelectedId();\n\t\tif(!this.cell)\n\t\t\treturn false;\n\n\t\tform.elements.preview.setHTML(\"\");\n\t\tform.elements.url.setValue(\"\");\n\n\t\t//sync state of dialog to data with  the selected cell\n\t\tlet value = this.view.getCellValue(this.cell.row, this.cell.column);\n\t\tlet data = parseImage(value);\n\t\tif (data && data.url)\n\t\t\tform.elements.url.setValue(data.url);\n\n\t\tform.elements.url.focus();\n\t}\n\t$init(){\n\t\tconst save = this.view.config.save;\n\t\tconst server = (save && save.images) || null;\n\n\t\treturn {\n\t\t\tview: \"ssheet-dialog\",\n\t\t\thead: webix.i18n.spreadsheet.labels[\"image-title\"],\n\t\t\tmove: true,\n\t\t\tposition: \"center\",\n\t\t\tbody:{\n\t\t\t\tview:\"form\",\n\t\t\t\telements:[\n\t\t\t\t\t{ view:\"text\", name:\"url\",  placeholder:webix.i18n.spreadsheet.labels[\"image-url\"], on:{\n\t\t\t\t\t\t\"onChange\":(image) => this.showPreview(image)\n\t\t\t\t\t}},\n\t\t\t\t\t{ view:\"label\", label:webix.i18n.spreadsheet.labels[\"image-or\"], align: \"center\"},\n\t\t\t\t\t{ view:\"uploader\", label:webix.i18n.spreadsheet.labels[\"image-upload\"], upload:server, on:{\n\t\t\t\t\t\tonBeforeFileAdd: function(file){\n\t\t\t\t\t\t\tif (!this.config.upload){\n\t\t\t\t\t\t\t\tconst reader = new FileReader();\n\t\t\t\t\t\t\t\treader.onload = (e) => this.getFormView().elements.url.setValue(e.target.result);\n\t\t\t\t\t\t\t\treader.readAsDataURL(file.file);\n\t\t\t\t\t\t\t\treturn false;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\telse\n\t\t\t\t\t\t\t\tthis.getFormView().elements.preview.setHTML(\"\");\n\t\t\t\t\t\t},\n\t\t\t\t\t\tonFileUpload: function(item, response){\n\t\t\t\t\t\t\tthis.getFormView().elements.url.setValue(response.imageURL);\n\t\t\t\t\t\t}\n\t\t\t\t\t}},\n\t\t\t\t\t{ view:\"formlate\", name:\"preview\", borderless: true, css: \"webix_ssheet_preview\", template:\"\", height:50 }\n\n\t\t\t\t]\n\t\t\t},\n\t\t\ton:{\n\t\t\t\tonSaveClick: () => this.okClick(),\n\t\t\t\tonCancelClick: () => this.close()\n\t\t\t}\n\t\t};\n\t}\n\tokClick(){\n\t\tconst cell = this.cell;\n\t\tconst image = this.fillUrl(this.$dialog.getBody().elements.url.getValue());\n\t\tthis.view.addImage(cell.row, cell.column, image);\n\t\tthis.close();\n\t}\n\tfillUrl(url){\n\t\tif (!/^[/]|((https?:\\/|data:image)\\/)/i.test(url))\n\t\t\turl = \"http://\" + url;\n\t\treturn url;\n\t}\n\tshowPreview(image){\n\t\tif (image){\n\t\t\timage = webix.template.escape(this.fillUrl(image));\n\t\t\tthis.$dialog.queryView(\"form\").elements.preview.setHTML(\"<img class='webix_ssheet_cimage' src='\"+image+\"'></img>\");\n\t\t}\n\t}\n}","import * as box from \"./imagecell\";\n\nexport const action = \"add-image-top\";\n\nexport class DialogBox extends box.DialogBox{\n\topen(action){\n\t\tthis.config = action.config;\n\t\tthis.viewid = action.viewid;\n\n\t\tthis.view.callEvent(\"onUIEditStart\", [this.viewid, \"image\"]);\n\n\t\tbox.DialogBox.prototype.open.apply(this, arguments);\n\t}\n\t$hide(){\n\t\tthis.view.callEvent(\"onUIEditStop\", [this.viewid, \"image\"]);\n\t\tthis.config = this.viewid = null;\n\t}\n\t$init(){\n\t\tthis.view.attachEvent(\"onUIEditStart\", (id, type)=>{\n\t\t\tif(this.$dialog && this.$dialog.isVisible() && type != \"image\")\n\t\t\t\tthis.close();\n\t\t});\n\n\t\tthis.view.attachEvent(\"onCommand\", obj =>{\n\t\t\tif(obj.id == \"close-ui-editor\" && this.$dialog && this.$dialog.isVisible())\n\t\t\t\tthis.close();\n\t\t});\n\n\t\treturn box.DialogBox.prototype.$init.apply(this, arguments);\n\t}\n\t$show(box, form){\n\n\t\tform.elements.preview.setHTML(\"\");\n\t\tform.elements.url.setValue(\"\");\n\n\t\tif(this.config && this.config.data)\n\t\t\tform.elements.url.setValue(this.config.data);\n\n\t\tform.elements.url.focus();\n\t}\n\tokClick(){\n\t\tconst image = this.fillUrl(this.$dialog.getBody().elements.url.getValue());\n\t\tif(this.viewid)\n\t\t\tthis.view.views.update(this.viewid, image);\n\t\telse{\n\t\t\tconst id = this.view.views.add(null, null, \"image\", image);\n\t\t\tthis.view.views.highlight(id);\n\t\t}\n\t\tthis.close();\n\t}\n}","import {isCellLocked} from \"./lock_cell\";\nimport group from \"./undo_group\";\n\n\nvar ignoreUndoReset = false;\n\nexport function init(view){\n\treset(view);\n\tundoHandlers(view);\n\tview.attachEvent(\"onHardReset\", () => reset(view));\n\tview.attachEvent(\"onAfterSheetShow\", () => reset(view));\n\t// styles\n\tview.attachEvent(\"onBeforeStyleChange\", (row, column, nstyle, ostyle) =>{\n\t\tif (isCellLocked(view, row, column)) return false;\n\t\taddToHistory(view, {action: \"style\", row:row, column: column, value: ostyle, newValue: nstyle, group: group.value});\n\t});\n\t// editing\n\tview.attachEvent(\"onBeforeValueChange\", (row, column, nvalue, ovalue) => {\n\t\tif (isCellLocked(view, row, column)) return false;\n\t\taddToHistory(view, {action: \"value\", row:row, column: column, value: ovalue, newValue: nvalue, group: group.value});\n\t});\n\t// merge cells\n\tview.attachEvent(\"onBeforeSpan\", (row, column, value) => {\n\t\tif (isCellLocked(view, row, column)) return false;\n\t\taddToHistory(view, {action: \"span\", row:row, column: column, value: value, newValue:value, group: group.value});\n\t});\n\t// split cells\n\tview.attachEvent(\"onBeforeSplit\", (row, column, value) => {\n\t\tif (isCellLocked(view, row, column)) return false;\n\t\taddToHistory(view, {action: \"split\", row:row, column: column, value: value, newValue:value, group: group.value});\n\t});\n\t// Any abstract undo actions\n\tview.attachEvent(\"onAction\", (action, obj) =>\n\t\taddToHistory(\n\t\t\tview,\n\t\t\t{\n\t\t\t\taction: action,\n\t\t\t\trow: obj.row || null,\n\t\t\t\tcolumn: obj.column || null,\n\t\t\t\tvalue: webix.isUndefined(obj.value) ? null : obj.value,\n\t\t\t\tnewValue: webix.isUndefined(obj.newValue) ? null : obj.newValue,\n\t\t\t\textra: obj.extra || null,\n\t\t\t\tgroup: group.value\n\t\t\t}\n\t\t)\n\t);\n\n\t// column resize\n\tview.$$(\"cells\").attachEvent(\"onColumnResize\", (column, nvalue, ovalue) =>\n\t\taddToHistory(view, {action: \"c-resize\", row:0, column:column, value: ovalue, newValue: nvalue, group: group.value})\n\t);\n\t// column hide\n\tview.attachEvent(\"onColumnOperation\", (action, start, end) => {\n\t\tif (action !== \"add\" && action !== \"del\")\n\t\t\taddToHistory(view, { action:{id: action, group:\"column\"}, group: group.value, column: {\n\t\t\t\tstart: { column:start }, end: { column:end }\n\t\t\t}});\n\t});\n\t// row hide\n\tview.attachEvent(\"onRowOperation\", (action, start, end) => {\n\t\tif (action !== \"add\" && action !== \"del\")\n\t\t\taddToHistory(view, { action: {id: action, group:\"row\"}, group: group.value, row: {\n\t\t\t\tstart: {row: start}, end: {row: end}\n\t\t\t}});\n\t});\n\t// row resize\n\tview.$$(\"cells\").attachEvent(\"onRowResize\", (row,  nvalue, ovalue) =>\n\t\taddToHistory(view, {action: \"r-resize\", row: row, column:0, value: ovalue, newValue: nvalue, group: group.value})\n\t);\n\n\t// condition formats\n\tview.attachEvent(\"onBeforeConditionSet\", (row, column, value, nvalue) => {\n\t\tif (isCellLocked(view, row, column)) return false;\n\n\t\tvalue = value ? webix.copy(value) : null;\n\t\taddToHistory(view, {action: \"condition\", row: row, column: column, value: value, newValue: nvalue, group: group.value});\n\t});\n\n\t// zoom\n\tview.attachEvent(\"onZoom\", (value, oldVal) =>\n\t\taddToHistory(view, {action: \"zoom\", value: oldVal, newValue: value, group: group.value})\n\t);\n\n\tview.$skipHistory = 0;\n}\n\nexport function undo(view){\n\trestoreHistory(view,-1);\n}\n\nexport function redo(view){\n\trestoreHistory(view,1);\n}\n\nexport function reset(view){\n\tif(!ignoreUndoReset){\n\t\tview._ssUndoHistory = [];\n\t\tview._ssUndoCursor = -1;\n\t}\n}\n\nfunction addToHistory(view, data){\n\tif(!view.$skipHistory && !view._loading_data){\n\t\t// remove futher history\n\t\tview._ssUndoHistory.splice(view._ssUndoCursor+1);\n\t\t// add to an array and increase cursor\n\t\tview._ssUndoHistory.push(data);\n\t\tview._ssUndoCursor++;\n\t}\n}\n\nexport function ignoreUndo(func, view){\n\tview.$skipHistory++;\n\ttry{\n\t\tfunc.call(view);\n\t}\n\tfinally {\n\t\tview.$skipHistory--;\n\t}\n}\n\nexport function ignoreReset(func){\n\tignoreUndoReset = true;\n\tfunc();\n\tignoreUndoReset = false;\n}\n\nfunction restoreHistory(view, step){\n\tvar data = view._ssUndoHistory[step>0?(view._ssUndoCursor+step):view._ssUndoCursor];\n\tif(data){\n\t\tvar value = step > 0 ? data.newValue : data.value;\n\t\tvar direction = step>0;\n\t\tvar params = [data.action, data.row, data.column, value, direction, data.extra];\n\n\t\tview._ssUndoCursor += step;\n\n\t\t// group support\n\t\tvar group = data.group;\n\t\tvar prevData = view._ssUndoHistory[step>0?(view._ssUndoCursor+step):view._ssUndoCursor];\n\n\t\tignoreUndo(function(){\n\t\t\tview.callEvent(\"onUndo\", params);\n\t\t\tif (!group || !(prevData && group == prevData.group)){\n\t\t\t\tview.refresh();\n\t\t\t\tview.callEvent(\"onAfterUndo\", []);\n\t\t\t}\n\t\t},view);\n\n\t\tif(prevData && group && group == prevData.group){\n\t\t\trestoreHistory(view, step);\n\t\t}\n\t}\n}\n\nfunction undoHandlers(view){\n\tview.attachEvent(\"onUndo\", function(type, row, column, value) {\n\t\tswitch (type) {\n\t\t\tcase \"freeze-row\":\n\t\t\t\tview.freezeRows(value);\n\t\t\t\tbreak;\n\t\t\tcase \"freeze-column\":\n\t\t\t\tview.freezeColumns(value);\n\t\t\t\tbreak;\n\t\t}\n\t});\n}","import {range, toRange, changeRange, encode, isRange} from \"../helpers/column_names\";\nimport {ignoreUndo} from \"./undo\";\nimport * as arr from \"../helpers/array\";\n\nexport function init(view){\n\tconst grid = view._table.$view.querySelector(\".webix_ss_center\");\n\n\tview.views = {\n\t\tregister:function(type, render, track){\n\t\t\tif(!this._types[type])\n\t\t\t\tthis._types[type] = { render:render, track:track };\n\t\t},\n\t\tmove: function(id, x, y){\n\t\t\tconst win = webix.$$(id);\n\t\t\tconst old = webix.copy(this._pull[id]);\n\t\t\tthis._pull[id].x = _correctPos(view, old.config.width, x/view._zoom, \"x\");\n\t\t\tthis._pull[id].y = _correctPos(view, old.config.height, y/view._zoom, \"y\");\n\t\t\tview.callEvent(\"onAction\", [\"move-view\", { row:id, newValue:webix.copy(this._pull[id]), value:old} ]);\n\t\t\t_showOne(view, win, this._pull[id]);\n\t\t},\n\t\tadd: function(x, y, type, data, config, id){\n\t\t\tconfig = config || {};\n\t\t\tif(type == \"chart\"){\n\t\t\t\tconfig = webix.extend(config, {\n\t\t\t\t\ttype: \"line\",\n\t\t\t\t\tdataSeries:\"columns\"\n\t\t\t\t});\n\t\t\t}\n\n\t\t\tconst height = config.height = config.height || 300;\n\t\t\tconst width = config.width = config.width || 500;\n\n\t\t\tconst win = webix.ui({ \n\t\t\t\tid:id || \"$ssheet-ui\"+webix.uid(), // fixed id is for undo only\n\t\t\t\tview: \"ssheet-ui\",\n\t\t\t\tcontainer:grid, master:view._table.config.id,\n\t\t\t\twidth:width, height:height\n\t\t\t});\n\n\t\t\twin.attachEvent(\"onViewMoveEnd\", (x, y) => {\n\t\t\t\tconst state = view._table.getScrollState();\n\t\t\t\tthis.move(id, x, y+state.y);\n\t\t\t});\n\t\t\twin.attachEvent(\"onViewResize\", () => {\n\t\t\t\tconst conf =  this._pull[id];\n\t\t\t\tconst old = webix.copy(conf);\n\n\t\t\t\tconf.config.height = win.$height;\n\t\t\t\tconf.config.width = win.$width;\n\t\t\t\tview.callEvent(\"onAction\", [\"resize-view\", { row:id, newValue:webix.copy(conf), value:old } ]);\n\t\t\t});\n\t\t\twin.attachEvent(\"onViewEdit\", () => {\n\t\t\t\tconst config = this._pull[id];\n\t\t\t\tconst command = this._commands[config.type] || config.type;\n\t\t\t\tview.callEvent(\"onCommand\", [{ id:command, viewid:id, config }]);\n\t\t\t});\n\t\t\twin.attachEvent(\"onViewRemove\", () => this.remove(id));\n\n\t\t\tid = win.config.id;\n\n\t\t\tx = _correctPos(view, height, x, \"x\");\n\t\t\ty = _correctPos(view, width, y, \"y\");\n\n\t\t\tthis._pull[id] = { x, y, type, data, config };\n\t\t\tthis.update(id, data, config, true);\n\t\t\t_showOne(view, win, this._pull[id]);\n\n\t\t\treturn id; \n\t\t},\n\t\tremove: function(id){\n\t\t\tconst old = this._pull[id];\n\t\t\twebix.$$(id).close();\n\t\t\tdelete this._pull[id];\n\n\t\t\tview.callEvent(\"onAction\", [\"add-view\", { row:id, newValue:null, value:old } ]);\n\t\t},\n\t\tget:function(id){\n\t\t\treturn webix.$$(id).getBody();\n\t\t},\n\t\tgetConfig:function(id){\n\t\t\treturn this._pull[id];\n\t\t},\n\t\tupdate:function(id, data, config, inner){\n\t\t\tconst old = inner ? null : webix.copy(this._pull[id]);\n\t\t\tconst conf = this._pull[id];\n\t\t\tconst actions = this._types[conf.type];\n\n\t\t\tdata = data || config.data || \"\";\n\t\t\tconfig = config || {};\n\n\t\t\tdelete config.data;\n\n\t\t\tif(conf.type == \"chart\"){\n\t\t\t\tconst type = config.type;\n\t\t\t\tif(type && !config.series){\n\t\t\t\t\tconst xAxis = config.xAxis && config.xAxis.range;\n\t\t\t\t\tconst legend = config.legend && config.legend.range;\n\n\t\t\t\t\tlet oldLeftColumn;\n\t\t\t\t\tif(old && old.config){\n\t\t\t\t\t\tif(_isPie(type)){\n\t\t\t\t\t\t\tif(old.config.legend && old.config.legend.fromData)\n\t\t\t\t\t\t\t\toldLeftColumn = 1;\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse if(old.config.xAxis && old.config.xAxis.fromData)\n\t\t\t\t\t\t\toldLeftColumn = 1;\n\t\t\t\t\t}\n\n\t\t\t\t\tconfig.series = _getSeries(view, data, config.dataSeries, {xAxis, legend}, oldLeftColumn);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tconst win = webix.$$(id);\n\n\t\t\tconst height = config.height || 300;\n\t\t\tconst width = config.width || 500;\n\n\t\t\tif(win.$width != width && win.$height != height){\n\t\t\t\twin.define({width, height});\n\t\t\t\twin.resize();\n\t\t\t}\n\n\t\t\tconf.data = data;\n\t\t\tconf.config = config;\n\n\t\t\tlet node = this.get(id);\n\n\t\t\tdata = _fromRange(view, conf);\n\n\t\t\tif(actions.render){\n\t\t\t\tconst renderConfig = webix.copy(conf);\n\n\t\t\t\t//clear width and height for inner view resizing\n\t\t\t\trenderConfig.config.width = renderConfig.config.height = 0;\n\n\t\t\t\tnode = actions.render(node, renderConfig, data);\n\t\t\t\t_processTables(node);\n\t\t\t}\n\n\t\t\tif(actions.track)\n\t\t\t\t_trackOne(view, node, actions.track, conf);\n\n\t\t\tview.callEvent(\"onAction\", [\"add-view\", { row:id, newValue:webix.copy(this._pull[id]), value:old} ]);\n\t\t},\n\t\thighlight:function(id){\n\t\t\tconst win = webix.$$(id);\n\t\t\tconst css = \"webix_ssheet_ui_focused\";\n\n\t\t\tconst oldWin = webix.$$(this._activeWin);\n\t\t\tif(oldWin && !oldWin.$destructed)\n\t\t\t\twebix.html.removeCss(oldWin.$view, css);\n\n\t\t\tif(win){\n\t\t\t\tthis._activeWin = id;\n\t\t\t\twebix.html.addCss(win.$view, css);\n\t\t\t}\n\t\t\telse\n\t\t\t\tdelete this._activeWin;\n\t\t},\n\t\t_commands:{\n\t\t\t\"image\":\"add-image-top\",\n\t\t\t\"chart\":\"add-chart\"\n\t\t},\n\t\t_types:{},\n\t\t_pull:{}\n\t};\n\n\t// handle events\n\tview._table.attachEvent(\"onResize\", () => _showAll(view) );\n\tview._table.attachEvent(\"onScrollY\", () => _showAll(view) );\n\tview._table.attachEvent(\"onScrollX\", () => _showAll(view) );\n\n\tview.attachEvent(\"onReset\", () => _reset(view));\n\tview.attachEvent(\"onUndo\", (type, row, column, value) => {\n\t\tconst move = type === \"move-view\";\n\t\tif (move || type == \"resize-view\" || type === \"add-view\")\n\t\t\t_undoUI(view, move, row, value);\n\t});\n\tview.attachEvent(\"onAction\", (action, p) => {\n\t\tif(action == \"header-hide\")\n\t\t\t_showAll(view);\n\t\telse if(action == \"before-grid-change\")\n\t\t\t_updateData(view, p.name, p.inc, p.data, p.start);\n\t});\n\tview.attachEvent(\"onZoom\", () => _showAll(view, true));\n\tview.attachEvent(\"onColumnOperation\", () =>  _showAll(view, true));\n\tview.attachEvent(\"onRowOperation\", () => _showAll(view, true));\n\tview.attachEvent(\"onDataParse\", (data) => _parse(view, data));\n\tview.attachEvent(\"onDataSerialize\", (data, config) => _serialize(view, data, config));\n\tview.attachEvent(\"onCellChange\", (r,c,v,p) => {\n\t\tif(p == view.getActiveSheet())\n\t\t\t_trackAll(view);\n\t});\n\tview.attachEvent(\"onMathRefresh\", () => _trackAll(view));\n\n\tview.attachEvent(\"onDestruct\", () => {\n\t\tfor(let i in view.views._pull) webix.$$(i).destructor();\n\t});\n\n\tlet editUIType;\n\twebix.attachEvent(\"onClick\", function(ev){\n\t\tlet focus = webix.$$(ev);\n\t\tif(focus && focus.config.externalUI)\n\t\t\tfocus = webix.$$(focus.config.externalUI);\n\n\t\tconst ui = focus && (focus.queryView(\"ssheet-ui\",\"self\") || focus.queryView(\"ssheet-ui\",\"parent\"));\n\n\t\tif(ui){\n\t\t\tview.views.highlight(ui);\n\t\t\tconst id = ui.config.id;\n\n\t\t\tif(editUIType){\n\t\t\t\tif(view.views.getConfig(id).type == editUIType)\n\t\t\t\t\tui.callEvent(\"onViewEdit\", []); //start editing if any editor is open\n\t\t\t\telse\n\t\t\t\t\tview.callEvent(\"onCommand\", [{ id:\"close-ui-editor\" }]);\n\t\t\t}\n\t\t}\n\t\telse if(!editUIType)\n\t\t\tview.views.highlight();\n\t});\n\n\tview.attachEvent(\"onUIEditStart\", function(id, type){\n\t\tview.views.highlight(id);\n\t\teditUIType = type;\n\t});\n\n\tview.attachEvent(\"onUIEditStop\", function(id, type){\n\t\tif(editUIType == type)\n\t\t\twebix.delay(()=>{ // after onClick handler (to save focus)\n\t\t\t\teditUIType = null;\n\t\t\t});\n\t});\n\n\t// set default views\n\tview.views.register(\"chart\", (node, conf, data) => {\n\t\tconst dataRange = _getNames(view, conf);\n\t\tconst config = _genChartConfig(conf, data, dataRange);\n\t\treturn webix.ui(config, node);\n\t}, (view, data) => {\n\t\tview.clearAll();\n\t\tview.parse(data);\n\t});\n\n\tview.views.register(\"image\", (node, conf, data) => {\n\t\tconst config = webix.extend({ css:\"webix_ssheet_bgimage\", template:`<img src=\"${data}\"/>` }, conf.config||{}, true );\n\t\treturn webix.ui(config, node);\n\t});\n}\n\nfunction _parse(view, data){\n\tconst views = data.views;\n\tif(views){\n\t\tignoreUndo(function(){\n\t\t\tviews.forEach(obj => view.views.add.apply(view.views, obj));\n\t\t}, view);\n\t}\n}\n\nfunction _serialize(view, data, config){\n\tdata.views = [];\n\tfor(let i in view.views._pull){\n\t\tconst conf = view.views._pull[i];\n\t\tconst one = [conf.x, conf.y, conf.type, conf.data, conf.config];\n\t\tif(config && config.viewIds)\n\t\t\tone.push(i);\n\t\tdata.views.push(one);\n\t}\n}\n\nlet thread;\nfunction _trackAll(view){\n\tclearTimeout(thread);\n\tthread = webix.delay(() => {\n\t\tconst ui = view.views;\n\t\tfor(let id in ui._pull){\n\t\t\tconst conf = ui._pull[id];\n\n\t\t\tconst viewMethods = ui._types[conf.type];\n\t\t\tconst render = viewMethods.render;\n\t\t\tconst track = viewMethods.track;\n\n\t\t\tif(track)\n\t\t\t\t_trackOne(view, ui.get(id), track, conf, render);\n\t\t}\n\t});\n}\n\nfunction _trackOne(view, node, track, conf, render){\n\tconst data = _fromRange(view, conf);\n\n\tif(conf.type == \"chart\"){\n\t\tif(render)\n\t\t\tnode = render(node, conf, data, true);\n\n\t\tconst config = conf.config;\n\t\tif(config && !_isPie(config.type))\n\t\t\t_removeLegend(data, conf, view);\n\t}\n\n\ttrack(node, data);\n}\n\nfunction _updateData(view, name, inc, data, start){\n\tconst views = data.views;\n\tfor(let i = 0; i < views.length; i++){\n\t\tif(_isRange(views[i][3])){\n\t\t\tconst series = views[i][4].series;\n\t\t\tif(series){\n\t\t\t\tseries.forEach(obj => {\n\t\t\t\t\tobj.range = changeRange(obj.range, name, inc, start);\n\t\t\t\t\tobj.active = changeRange(obj.active, name, inc, start);\n\t\t\t\t});\n\t\t\t}\n\n\t\t\tconst legend = views[i][4].legend && views[i][4].legend.range;\n\t\t\tif(legend)\n\t\t\t\tviews[i][4].legend.range = _getDataParts(legend).map(range => changeRange(range, name, inc, start)).join(\",\");\n\n\t\t\tconst xAxis = views[i][4].xAxis && views[i][4].xAxis.range;\n\t\t\tif(xAxis)\n\t\t\t\tviews[i][4].xAxis.range = changeRange(xAxis, name, inc, start);\n\n\t\t\tviews[i][3] = _getDataParts(views[i][3]).map(range => changeRange(range, name, inc, start)).join(\",\");\n\t\t}\n\t}\n}\n\nfunction _showAll(view, pos){\n\t//close possibly open menus of embedded ui\n\twebix.callEvent(\"onClick\", []);\n\n\tfor(let id in view.views._pull){\n\t\tconst win = webix.$$(id);\n\t\tconst conf = view.views._pull[id];\n\t\tif(pos){\n\t\t\tconf.x = _correctPos(view, conf.config.width, conf.x, \"x\");\n\t\t\tconf.y = _correctPos(view, conf.config.height, conf.y, \"y\");\n\t\t}\n\t\t_showOne(view, win, conf);\n\t}\n}\n\nfunction _showOne(view, win, conf){\n\tconst state = view._table.getScrollState();\n\n\twin.define({\n\t\twidth: conf.config.width * view._zoom,\n\t\theight: conf.config.height * view._zoom\n\t});\n\twin.resize();\n\n\twin.show({\n\t\tx:conf.x * view._zoom,\n\t\ty:(conf.y * view._zoom) - state.y\n\t});\n}\n\nfunction _correctPos(view, winSize, v, type){\n\tif(!v && v !==0 )\n\t\tv = view._table.getScrollState()[type]+50;\n\telse{\n\t\tconst size = (type == \"x\" ? _getWidth(view) : _getHeight(view)) - winSize;\n\t\tv = Math.min(Math.max(v, 0), size);\n\t}\t\n\treturn v;\n}\n\nfunction _reset(view){\n\tignoreUndo(function(){\n\t\tfor(let id in view.views._pull)\n\t\t\tview.views.remove(id);\n\t}, view);\n}\n\nfunction _undoUI(view, move, id, value){\n\tif(value){\n\t\tconst {x, y, type, data, config} = value;\n\t\tif(view.views._pull[id]){\n\t\t\tif(move)\n\t\t\t\tview.views.move(id, x, y);\n\t\t\telse\n\t\t\t\tview.views.update(id, data, config);\n\t\t}\n\t\telse\n\t\t\tview.views.add(x, y, type, data, config, id);\n\n\t\tconst editor = view.$$(\"chartEditor\");\n\t\tif(editor && editor.viewId == id)\n\t\t\teditor.queryView(\"form\").setValues(config);\n\t}\n\telse\n\t\tview.views.remove(id);\n}\n\nfunction _getWidth(view){\n\tlet width = 0;\n\tview._table.eachColumn(function(id){\n\t\tif(id !== \"rowId\")\n\t\t\twidth += this.getColumnConfig(id).width;\n\t});\n\treturn width / view._zoom;\n}\n\nfunction _getHeight(view){\n\tlet height = 0;\n\tview._table.data.each(function(obj){\n\t\theight += obj.$height || webix.skin.$active.rowHeight;\n\t});\n\treturn height / view._zoom;\n}\n\n//disable datatables not to interfere with ss table events\nfunction _processTables(node){\n\tconst query = function(view){\n\t\treturn view.name == \"datatable\" || view.name == \"treetable\";\n\t};\n\tlet tables = node.queryView(query, \"self\");\n\tif(tables) tables = [tables];\n\telse tables = node.queryView(query, \"all\");\n\ttables.forEach((dt) => dt.disable());\n}\n\n/* chart-specific helpers */\n\nfunction _prepareType(config){\n\tconst type = config.type;\n\tif(config.stacked && type.indexOf(\"stacked\") == -1)\n\t\tconfig.type = \"stacked\"+config.type.charAt(0).toUpperCase()+config.type.substr(1);\n\tif(config[\"3D\"] && type.indexOf(\"3D\") == -1)\n\t\tconfig.type += \"3D\";\n\tif(config.horizontal && type.indexOf(\"H\") == -1)\n\t\tconfig.type += \"H\";\n\n\treturn config.type;\n}\n\nfunction _genChartConfig(conf, data, dataRange){\n\tconst htmlFilter = /<[^>]*>/gi;\n\tlet config = webix.copy(conf.config);\n\n\tconfig = _normalizeConfig(config);\n\n\tconst scale = config.scale.lines;\n\tconst scaleColor = config.scale.color || undefined;\n\tconst type = (config.type = _prepareType(config));\n\tconst pie = _isPie(type);\n\n\tconst lines = config.series;\n\tconfig.series = [];\n\tconst xAxis = config.xAxis;\n\n\tconst legendConfig = config.legend;\n\tlet pieLegend;\n\tlet legendRange;\n\n\tconst legend = {\n\t\theight:24,\n\t\talign: legendConfig.align || \"center\",\n\t\tvalign: legendConfig.valign || \"bottom\",\n\t};\n\tlegend.layout = legend.valign == \"middle\" ? \"y\" : \"x\";\n\n\tif(pie){\n\t\tif(legendConfig.fromData)\n\t\t\tpieLegend = \"data0\";\n\t\telse if(legendConfig.range)\n\t\t\tpieLegend = dataRange[legendConfig.range];\n\n\t\tlegend.template = `#${pieLegend}#`;\n\t}\n\telse{\n\t\tlegend.values = [];\n\n\t\tlegendRange = !legendConfig.fromData && legendConfig.range;\n\t\tif(legendRange){\n\t\t\tconst switchDirection = config.dataSeries == \"rows\";\n\t\t\tlegendRange = _getParts(legendConfig.range, switchDirection, dataRange);\n\t\t}\n\n\t\tconfig.yAxis = config.yAxis||{};\n\t\tfor(let property in config.yAxis)\n\t\t\tif(config.yAxis[property] === \"\")\n\t\t\t\tdelete config.yAxis[property];\n\n\t\tconfig.yAxis = webix.extend(config.yAxis, {\n\t\t\tlineColor: scaleColor,\n\t\t\tcolor: scaleColor,\n\t\t\tlines: scale,\n\t\t\tlineShape: config.scale.circle ? \"arc\" : \"default\"\n\t\t});\n\n\t\tif(xAxis.fromData)\n\t\t\txAxis.range = legendRange ? Object.keys(data[0]).filter(line => legendRange.indexOf(line) == -1)[0] : \"data0\";\n\t\telse if(xAxis.range)\n\t\t\txAxis.range = dataRange[xAxis.range];\n\t}\t\n\n\tfor(let i = 0; i < lines.length; i++){\n\t\tconst color = lines[i].color;\n\t\tconst item = dataRange[lines[i].range];\n\n\t\tif(item != xAxis.range && !(pie && item == pieLegend /*(item == pieLegend || legendConfig.range == lines[i].active)*/)){\n\t\t\tconst s = {\n\t\t\t\tvalue:`#${item}#`,\n\t\t\t\ttooltip:{\n\t\t\t\t\ttemplate: lines[i].tooltip ? `#${item}#` : \"\"\n\t\t\t\t}\n\t\t\t};\n\n\t\t\ts[pie ? \"pieInnerText\" : \"label\"] = lines[i].label ? `#${item}#` : \"\";\n\n\t\t\tif(type == \"radar\" || type == \"line\" || type == \"spline\" || type == \"scatter\"){\n\t\t\t\ts.line = { color };\n\t\t\t\ts.item = { borderColor:color, type:lines[i].marker };\n\t\t\t}\n\t\t\telse if(!pie)\n\t\t\t\ts.color = color;\n\n\t\t\tif(type == \"area\" || type == \"splineArea\")\n\t\t\t\ts.alpha = 0.7;\n\n\t\t\tif(data[0] && !pie && (legendRange || legendConfig.fromData)){\n\t\t\t\tconst val = legendRange ? data[0][legendRange[i]] : data[0][item];\n\t\t\t\tconst text = (val || val === 0) ? (val+\"\").replace(htmlFilter, \"\") : \"\";\n\t\t\t\tlegend.values.push({text, color});\n\t\t\t}\n\n\t\t\tconfig.series.push(s);\n\t\t}\n\t}\n\n\tif(!pie){\n\t\tconfig.xAxis = {\n\t\t\ttitle: config.xAxis.title,\n\t\t\tlineColor: scaleColor,\n\t\t\tcolor: scaleColor,\n\t\t\tlines: scale\n\t\t};\n\n\t\tconfig[type == \"barH\" || type == \"stackedBarH\" ? \"yAxis\" : \"xAxis\"].template = obj => {\n\t\t\tconst val = obj[xAxis.range];\n\t\t\treturn (val || val === 0) ? (val+\"\").replace(htmlFilter, \"\") : \"\";\n\t\t};\n\t}\n\n\tif(pieLegend || (legend.values && legend.values.length))\n\t\tconfig.legend = legend;\n\telse\n\t\tdelete config.legend;\n\n\tif(type == \"scatter\"){\n\t\tconfig.xValue = config.xAxis.template;\n\t\tconfig.origin = \"auto\";\n\t\tdelete config.xAxis.template;\n\t}\n\n\treturn webix.extend({\n\t\tview:\"chart\",\n\t\tpadding:{\n\t\t\tleft:80\n\t\t}\n\t}, config, true);\n}\n\nfunction _isRange(data){\n\treturn typeof data == \"string\" && data.indexOf(\"data:image\") === -1;\n}\n\nfunction _fromRange(view, conf){\n\tlet data = conf.data;\n\n\tif(/^(http|data:image|\\/)/i.test(data))\n\t\treturn data;\n\n\tconst arr = [];\n\tif(data){\n\t\tconst config = conf.config;\n\t\tconst switchDirection = config.dataSeries == \"rows\";\n\t\tlet lastIndex = 0;\n\n\t\tdata = _getDataParts(data);\n\t\tfor(let i = 0; i < data.length; i++){\n\t\t\tconst cells = _isRange(data[i]) ? range(data[i], view) : null;\n\t\t\tif(cells){\n\t\t\t\tconst page = cells[4] ? view._mData.getPage(cells[4]) : view._mPage;\n\t\t\t\tcells[5] = lastIndex;\n\n\t\t\t\tif(page){\n\t\t\t\t\tconst subdata = switchDirection ? getRangeRows.apply(page, cells) : getRangeCols.apply(page, cells);\n\t\t\t\t\tlastIndex += subdata[2];\n\t\t\t\t\tfor(let i = 0; i < subdata[0].length; i++){\n\t\t\t\t\t\tif(!arr[i])\n\t\t\t\t\t\t\tarr[i] = {};\n\t\t\t\t\t\twebix.extend(arr[i], subdata[0][i]);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\treturn arr;\n}\n\nfunction _removeLegend(arr, conf, view){\n\tconst config = conf.config;\n\tif(typeof(config.legend) != \"object\")\n\t\tconfig.legend = {fromData: !!config.legend};\n\n\tconst legend = config.legend;\n\n\tif(legend.fromData)\n\t\tarr.shift();\n\telse if(legend.range){\n\t\tconst names = _getNames(view, conf);\n\t\tconst switchDirection = config.dataSeries == \"rows\";\n\t\tconst legendRange = _getParts(legend.range, switchDirection, names);\n\t\tfor (let i = 0; i < legendRange.length; i++){\n\t\t\tconst item = legendRange[i];\n\t\t\tdelete arr[0][item];\n\t\t}\n\t}\n}\n\nfunction _getNames(view, conf){\n\tlet data = conf.data;\n\n\tif(/^(http|data:image|\\/)/i.test(data))\n\t\treturn;\n\n\tlet names = {};\n\tif(data){\n\t\tconst config = conf.config;\n\t\tconst switchDirection = config.dataSeries == \"rows\";\n\t\tlet lastIndex = 0;\n\n\t\tdata = _getDataParts(data);\n\t\tfor(let i = 0; i < data.length; i++){\n\t\t\tconst cells = _isRange(data[i]) ? range(data[i], view) : null;\n\t\t\tif(cells){\n\t\t\t\tconst page = cells[4] ? view._mData.getPage(cells[4]) : view._mPage;\n\t\t\t\tcells[5] = lastIndex;\n\n\t\t\t\tif(page){\n\t\t\t\t\tconst subdata = switchDirection ? getRangeRows.apply(page, cells) : getRangeCols.apply(page, cells);\n\t\t\t\t\tlastIndex += subdata[2];\n\t\t\t\t\twebix.extend(names, subdata[1]);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\treturn names;\n}\n\nexport function _getDataParts(data){\n\treturn data.replace(/\\s/g, \"\").split(\",\");\n}\n\nexport function _isPie(type){\n\treturn /pie|donut/.test(type);\n}\n\nexport function _getSeries(view, data, dataSeries, active, oldLeftColumn){\n\tconst dir = dataSeries == \"rows\";\n\tlet vals = [];\n\n\tif(data){\n\t\tlet xAxis = [];\n\t\tlet legend = [];\n\t\tlet activeVals = [];\n\n\t\tif(active){\n\t\t\tif(active.legend)\n\t\t\t\tlegend = _getParts(active.legend, dir);\n\t\t\tif(active.xAxis)\n\t\t\t\txAxis = _getParts(active.xAxis, dir);\n\t\t\tif(active.series)\n\t\t\t\tactiveVals = active.series.filter(val => legend.indexOf(val.range) == -1 && xAxis.indexOf(val.range) == -1);\n\t\t}\n\n\t\tdata = _getDataParts(data);\n\t\tlet colorIndex = 0;\n\t\tlet firstRange = 1;\n\t\tdata.forEach(subdata => {\n\t\t\tconst series = isRange(subdata) ? range(subdata, view) : null;\n\t\t\tif(series){\n\t\t\t\tconst start = dir ? series[0] : series[1];\n\t\t\t\tconst end = dir ? series[2] : series[3];\n\n\t\t\t\tlet inActiveSeries;\n\t\t\t\tfor(let i = start; i <= end; i++){\n\t\t\t\t\tconst range = dir ? toRange(i, series[1], i, series[3], series[4]) : toRange(series[0], i, series[2], i, series[4]);\n\t\t\t\t\tconst seria = arr.find(activeVals, val => val.range == range && (!val.active || val.active == subdata));\n\n\t\t\t\t\tif(seria){\n\t\t\t\t\t\tif(!seria.active)\n\t\t\t\t\t\t\tseria.active = subdata;\n\t\t\t\t\t\tinActiveSeries = 1;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tfor(let i = start; i <= end; i++){\n\t\t\t\t\tconst range = dir ? toRange(i, series[1], i, series[3], series[4]) : toRange(series[0], i, series[2], i, series[4]);\n\t\t\t\t\tif(legend.indexOf(range) != -1 || xAxis.indexOf(range) != -1)\n\t\t\t\t\t\tcontinue;\n\n\t\t\t\t\tconst activeVal = activeVals.filter(val => val.range == range && val.active == subdata)[0];\n\n\t\t\t\t\tif(inActiveSeries && !activeVal && !(oldLeftColumn && firstRange && i == start))\n\t\t\t\t\t\tcontinue;\n\n\t\t\t\t\tvals.push(activeVal || {\n\t\t\t\t\t\tactive: subdata,\n\t\t\t\t\t\trange,\n\t\t\t\t\t\tmarker: \"square\",\n\t\t\t\t\t\ttooltip: 1,\n\t\t\t\t\t\tcolor: _getColor(colorIndex)\n\t\t\t\t\t});\n\n\t\t\t\t\tcolorIndex++;\n\t\t\t\t}\n\t\t\t\tfirstRange = 0;\n\t\t\t}\n\t\t});\n\t}\n\treturn vals;\n}\n\nexport function _getParts(ranges, dir, dataRange){\n\tconst parts = [];\n\n\tranges = _getDataParts(ranges);\n\tranges.forEach(subRange => {\n\t\tsubRange = isRange(subRange) ? range(subRange) : null;\n\t\tif(subRange){\n\t\t\tconst start = dir ? subRange[0] : subRange[1];\n\t\t\tconst end = dir ? subRange[2] : subRange[3];\n\n\t\t\tfor(let i = start; i <= end; i++){\n\t\t\t\tconst range = dir ?\n\t\t\t\t\ttoRange(i, subRange[1], i, subRange[3], subRange[4]):\n\t\t\t\t\ttoRange(subRange[0], i, subRange[2], i, subRange[4]);\n\n\t\t\t\tparts.push(dataRange ? dataRange[range] : range);\n\t\t\t}\n\t\t}\n\t});\n\n\treturn parts;\n}\n\nexport function _normalizeConfig(config){\n\tif(typeof(config.xAxis) != \"object\")\n\t\tconfig.xAxis = {fromData: !!config.xAxis};\n\n\tif(typeof(config.legend) != \"object\")\n\t\tconfig.legend = {fromData: !!config.legend};\n\n\tconfig.legend = webix.extend(config.legend, {\n\t\tlayout:\"x\",\n\t\talign:\"center\",\n\t\tvalign:\"bottom\"\n\t});\n\n\tif(!config.scale)\n\t\tconfig.scale = {\n\t\t\tlines:1\n\t\t};\n\n\treturn config;\n}\n\nfunction _getColor(index){\n\tconst colors = [\n\t\t\"#e06666\", \"#6aa84f\", \"#3c78d8\", \"#e69138\", \"#783f04\", \"#134f5c\", \"#674ea7\", \"#c27ba0\"\n\t];\n\treturn colors[index%colors.length];\n}\n\nfunction getRangeCols(r1,c1,r2,c2,sheetName,lastIndex){\n\tconst data = [];\n\tconst rangeToData = {};\n\tfor (let i = r1, rind = 0; i <= r2; i++, rind++){\n\t\tdata[rind] = {};\n\t\tfor (let j = c1, cind = lastIndex; j <= c2; j++, cind++){\n\t\t\tif(i == r2){\n\t\t\t\trangeToData[`${sheetName ? sheetName+\"!\" : \"\"}${encode[j]}${r1}:${encode[j]}${r2}`] = `data${cind}`;\n\t\t\t\tlastIndex++;\n\t\t\t}\n\t\t\tdata[rind][`data${cind}`] = this.getValue(i-1,j-1);\n\t\t}\n\t}\n\treturn [data, rangeToData, lastIndex];\n}\n\nfunction getRangeRows(r1,c1,r2,c2,sheetName,lastIndex){\n\tconst data = [];\n\tconst rangeToData = {};\n\tfor (let i = c1, cind = 0; i <= c2; i++, cind++){\n\t\tdata[cind] = {};\n\t\tfor (let j = r1, rind = lastIndex; j <= r2; j++, rind++){\n\t\t\tif(i == c2){\n\t\t\t\trangeToData[`${sheetName ? sheetName+\"!\" : \"\"}${encode[c1]}${j}:${encode[c2]}${j}`] = `data${rind}`;\n\t\t\t\tlastIndex++;\n\t\t\t}\n\t\t\tdata[cind][`data${rind}`] = this.getValue(j-1,i-1);\n\t\t}\n\t}\n\treturn [data, rangeToData, lastIndex];\n}","import {range, toRange} from \"./helpers/column_names\";\nimport {_getSeries, _isPie, _normalizeConfig, _getDataParts} from \"./operations/views\";\n\nconst labels = webix.i18n.spreadsheet.labels;\n\nexport function init(view){\n\tview.attachEvent(\"onComponentInit\", () => ready(view));\n\tconst activeSkin = webix.skin.$active;\n\tconst padding = activeSkin.dataPadding-2;\n\tconst margin = activeSkin.layoutMargin.form;\n\n\treturn {\n\t\twidth:440,\n\t\thidden: true,\n\t\tid:\"chartEditor\",\n\t\tcss:\"ssheet_chart\",\n\t\trows:[\n\t\t\t{\n\t\t\t\theight: activeSkin.barHeight,\n\t\t\t\tcss: \"ssheet_chart_wizard_head\",\n\t\t\t\tpadding: { left:4 },\n\t\t\t\tcols: [\n\t\t\t\t\t{ view:\"icon\", inputHeight:activeSkin.inputHeight, hotkey:\"esc\", icon:\"webix_ssheet_icon ssi-arrow-left\", click: () => closeEditor(view)  },\n\t\t\t\t\t{ type:\"header\", borderless:true, template: labels[\"chart-edit\"] }\n\t\t\t\t]\n\t\t\t},\n\t\t\t{\n\t\t\t\tview:\"form\",\n\t\t\t\tcomplexData:true,\n\t\t\t\tborderless: true,\n\t\t\t\tpadding:{\n\t\t\t\t\ttop: 0\n\t\t\t\t},\n\t\t\t\telementsConfig:{\n\t\t\t\t\tlabelWidth:184\n\t\t\t\t},\n\t\t\t\telements:[{\n\t\t\t\t\tview:\"tabview\",\n\t\t\t\t\tid:\"chartTabs\",\n\t\t\t\t\tcells:[\n\t\t\t\t\t\t{ id:\"common\", borderless:true, type:\"form\", paddingX:0, header:labels[\"chart-common\"], rows:[\n\t\t\t\t\t\t\t{view:\"scrollview\", body:{\n\t\t\t\t\t\t\t\tmargin,\n\t\t\t\t\t\t\t\trows:[\n\t\t\t\t\t\t\t\t\taddRichselect(\"type\", \"chart-type\", getTypes()),\n\t\t\t\t\t\t\t\t\t{ view:\"checkbox\", label:labels[\"stacked-chart\"], name:\"stacked\", hidden:true},\n\t\t\t\t\t\t\t\t\t{ view:\"checkbox\", label:labels[\"horizontal-chart\"], name:\"horizontal\", hidden:true},\n\t\t\t\t\t\t\t\t\t{ view:\"checkbox\", label:labels[\"chart-pie-3d\"], name:\"3D\", batch:\"pie\"},\n\t\t\t\t\t\t\t\t\t{ view:\"text\", label:labels[\"chart-range\"], name:\"range\"},\n\t\t\t\t\t\t\t\t\t{ view:\"checkbox\", label:labels[\"chart-col-xAxis\"], name:\"xAxis.fromData\", batch:\"axis\"},\n\t\t\t\t\t\t\t\t\t{ view:\"checkbox\", label:labels[\"chart-row-legend\"], name:\"legend.fromData\"},\n\t\t\t\t\t\t\t\t\t{ view:\"radio\", label:labels[\"chart-data-from\"], name:\"dataSeries\", vertical:true, options:[\n\t\t\t\t\t\t\t\t\t\t{id:\"columns\", value:labels[\"chart-columns\"]},\n\t\t\t\t\t\t\t\t\t\t{id:\"rows\", value:labels[\"chart-rows\"]}\n\t\t\t\t\t\t\t\t\t]},\n\t\t\t\t\t\t\t\t\t{}\n\t\t\t\t\t\t\t\t]\n\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t]},\n\t\t\t\t\t\t{ id:\"advanced\", borderless:true, type:\"form\", paddingX:0, padding:{bottom:0}, header:labels[\"chart-series\"], rows:[\n\t\t\t\t\t\t\t{ view: \"ssheet-series\", name:\"series\" },\n\t\t\t\t\t\t]},\n\t\t\t\t\t\t{ id:\"extras\", borderless:true, type:\"form\", paddingX:0, header:labels[\"chart-extras\"], rows:[\n\t\t\t\t\t\t\t{view:\"scrollview\", body:{\n\t\t\t\t\t\t\t\tview: \"accordion\",\n\t\t\t\t\t\t\t\tmargin: webix.skin.$active.layoutMargin.form,\n\t\t\t\t\t\t\t\tcss: \"webix_ssheet_accordion\",\n\t\t\t\t\t\t\t\tmulti: true,\n\t\t\t\t\t\t\t\ttype: \"clean\",\n\t\t\t\t\t\t\t\trows:[\n\t\t\t\t\t\t\t\t\t{ header:labels[\"chart-legend\"], body:{\n\t\t\t\t\t\t\t\t\t\tmargin,\n\t\t\t\t\t\t\t\t\t\tpadding,\n\t\t\t\t\t\t\t\t\t\trows:[\n\t\t\t\t\t\t\t\t\t\t\t{ view: \"text\", label:labels[\"chart-legend-range\"], name:\"legend.range\"},\n\t\t\t\t\t\t\t\t\t\t\taddRichselect(\"legend.align\", \"chart-legend-align\", getLegendAlign()),\n\t\t\t\t\t\t\t\t\t\t\taddRichselect(\"legend.valign\", \"chart-legend-valign\", getLegendValign())\n\t\t\t\t\t\t\t\t\t\t]\n\t\t\t\t\t\t\t\t\t}},\n\t\t\t\t\t\t\t\t\t{ header:labels[\"chart-scale\"], batch:\"axis\", id:\"scale\", body:{\n\t\t\t\t\t\t\t\t\t\tmargin,\n\t\t\t\t\t\t\t\t\t\tpadding,\n\t\t\t\t\t\t\t\t\t\trows:[\n\t\t\t\t\t\t\t\t\t\t\t{ view:\"checkbox\", label:labels[\"chart-lines\"], name:\"scale.lines\", batch:\"axis\"},\n\t\t\t\t\t\t\t\t\t\t\t{ view:\"checkbox\", label:labels[\"chart-radar-circle\"], name:\"scale.circle\", hidden:true},\n\t\t\t\t\t\t\t\t\t\t\t{ view:\"ssheet-colorpicker\", label:labels[\"chart-scale-color\"], name:\"scale.color\", batch:\"axis\"}\n\t\t\t\t\t\t\t\t\t\t]\n\t\t\t\t\t\t\t\t\t}},\n\t\t\t\t\t\t\t\t\t{ header:labels[\"chart-x-axis\"], batch:\"axis\", body:{\n\t\t\t\t\t\t\t\t\t\tmargin,\n\t\t\t\t\t\t\t\t\t\tpadding,\n\t\t\t\t\t\t\t\t\t\trows:[\n\t\t\t\t\t\t\t\t\t\t\t{ view:\"text\", label:labels[\"chart-xAxis-range\"], name:\"xAxis.range\", range:true, batch:\"axis\" },\n\t\t\t\t\t\t\t\t\t\t\t{ view:\"text\", label:labels[\"chart-xAxis-title\"], name:\"xAxis.title\", batch:\"axisTitle\" },\n\t\t\t\t\t\t\t\t\t\t]\n\t\t\t\t\t\t\t\t\t}},\n\t\t\t\t\t\t\t\t\t{ header:labels[\"chart-y-axis\"], batch:\"axis\", body:{\n\t\t\t\t\t\t\t\t\t\tmargin,\n\t\t\t\t\t\t\t\t\t\tpadding,\n\t\t\t\t\t\t\t\t\t\trows:[\n\t\t\t\t\t\t\t\t\t\t\t{ view:\"text\", label:labels[\"chart-yAxis-title\"], name:\"yAxis.title\", batch:\"axisTitle\" },\n\t\t\t\t\t\t\t\t\t\t\t{ view:\"text\", label:labels[\"chart-yAxis-origin\"], name:\"origin\", batch:\"axis\", attributes:{ type:\"number\" } },\n\t\t\t\t\t\t\t\t\t\t\t{ view:\"label\", label:labels[\"chart-yAxis-note\"], css:\"ssheet_note\", height:20},\n\t\t\t\t\t\t\t\t\t\t\t{ view:\"text\", label:labels[\"chart-yAxis-start\"], name:\"yAxis.start\", batch:\"axis\", attributes:{ type:\"number\" } },\n\t\t\t\t\t\t\t\t\t\t\t{ view:\"text\", label:labels[\"chart-yAxis-end\"], name:\"yAxis.end\", batch:\"axis\", attributes:{ type:\"number\" } },\n\t\t\t\t\t\t\t\t\t\t\t{ view:\"text\", label:labels[\"chart-yAxis-step\"], name:\"yAxis.step\", batch:\"axis\", attributes:{ type:\"number\" } }\n\t\t\t\t\t\t\t\t\t\t]\n\t\t\t\t\t\t\t\t\t}},\n\t\t\t\t\t\t\t\t\t{}\n\t\t\t\t\t\t\t\t]\n\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t]}\n\t\t\t\t\t]\n\t\t\t\t}]\n\t\t\t}\n\t\t]\n\t};\n}\n\nfunction ready(view){\n\tconst chartEditor = view.$$(\"chartEditor\");\n\tconst form = chartEditor.queryView(\"form\");\n\tconst elements = form.elements;\n\n\tview.attachEvent(\"onCommand\", action => {\n\t\tif(action.id == \"add-chart\"){\n\t\t\tconst config = action.config;\n\t\t\tlet values = config && config.config || {};\n\n\t\t\tchartEditor.show();\n\n\t\t\tview.$handleSelection = function(st, end, a, b){\n\t\t\t\tconst focus = webix.UIManager.getFocus();\n\n\t\t\t\tif(chartEditor.queryView(view => view == focus)){\n\t\t\t\t\tif(focus == elements.range || focus == elements[\"legend.range\"]){\n\t\t\t\t\t\tlet val = focus.getValue();\n\t\t\t\t\t\tconst last = val.lastIndexOf(\",\");\n\n\t\t\t\t\t\tval = last == -1 ? \"\" : val.substring(0, last + 1);\n\t\t\t\t\t\tfocus.setValue(val + a+\":\"+b);\n\t\t\t\t\t}\n\t\t\t\t\telse if(focus.config.range)\n\t\t\t\t\t\tfocus.setValue(a+\":\"+b);\n\t\t\t\t}\n\n\t\t\t\treturn false;\n\t\t\t};\n\n\t\t\tform.clear();\n\t\t\tview.$$(\"chartTabs\").setValue(\"common\");\n\n\t\t\tvalues = _normalizeConfig(values);\n\n\t\t\tvalues.range = config ? config.data : view.getSelectedRange();\n\t\t\tchartEditor.viewId = action.viewid ? action.viewid : view.views.add(null, null, \"chart\", values.range, values);\n\n\t\t\tview.callEvent(\"onUIEditStart\", [chartEditor.viewId, \"chart\"]);\n\n\t\t\tupdateValign(values.legend.align);\n\t\t\tupdateAlign(values.legend.valign);\n\n\t\t\tconst formValues = inValues(values);\n\t\t\tform.setValues(formValues);\n\t\t\tupdateType(formValues.type);\n\n\t\t\tif(!_isPie(formValues.type) && values.legend.fromData)\n\t\t\t\tupdateLegendRange(values.legend.fromData);\n\t\t\tif(values.xAxis.fromData)\n\t\t\t\tupdateXaxisRange(values.xAxis.fromData);\n\n\t\t\tupdateSeries();\n\n\t\t\tform.queryView(\"accordionitem\", \"all\").forEach(view => view.expand());\n\n\t\t\telements.range.focus();\n\t\t}\n\t});\n\n\tview.attachEvent(\"onUIEditStart\", (id, type)=>{\n\t\tif(chartEditor.isVisible() && type != \"chart\")\n\t\t\tcloseEditor(view);\n\t});\n\n\tview.attachEvent(\"onCommand\", obj =>{\n\t\tif(obj.id == \"close-ui-editor\" && chartEditor.isVisible())\n\t\t\tcloseEditor(view);\n\t});\n\n\tview.attachEvent(\"onAction\", (id, values) => {\n\t\tif(id == \"add-view\" && !values.newValue){\n\t\t\tif(chartEditor.isVisible() && chartEditor.viewId == values.row)\n\t\t\t\tcloseEditor(view);\n\t\t}\n\t});\n\n\tform.attachEvent(\"onChange\", function(val, oldVal){\n\t\tconst source = this.$eventSource;\n\n\t\t//upper case ranges\n\t\tif(source === elements.range || source === elements[\"xAxis.range\"] || source === elements[\"legend.range\"]){\n\t\t\tconst parts = val.split(\"!\");\n\t\t\tconst upper = parts.length == 2 ? parts[0]+\"!\"+parts[1].toUpperCase() : val.toUpperCase();\n\n\t\t\tif(val != upper){\n\t\t\t\tval = upper;\n\t\t\t\tsetSilentValue(source, upper);\n\t\t\t}\n\t\t}\n\n\t\tswitch (source){\n\t\t\tcase elements.type:\n\t\t\t\tupdateType(val);\n\t\t\t\tbreak;\n\t\t\tcase elements.horizontal:\n\t\t\t\tswitchRowsCols();\n\t\t\t\tbreak;\n\t\t\tcase elements.range:\n\t\t\tcase elements.dataSeries:\n\t\t\t\tif(this.$eventSource == elements.dataSeries)\n\t\t\t\t\tswitchRowsCols();\n\t\t\t\tif(elements[\"legend.fromData\"].getValue())\n\t\t\t\t\thandlePieLegend();\n\t\t\t\tif(elements[\"xAxis.fromData\"].getValue())\n\t\t\t\t\tsetSilentValue(elements[\"xAxis.range\"], getLeftColumn());\n\t\t\t\tupdateSeries();\n\t\t\t\tbreak;\n\t\t\tcase elements[\"xAxis.fromData\"]:\n\t\t\t\tupdateXaxisRange(val);\n\n\t\t\t\tupdateSeries(oldVal);\n\t\t\t\tbreak;\n\t\t\tcase elements[\"legend.fromData\"]:\n\t\t\t\tupdateLegendRange(val);\n\n\t\t\t\tupdateSeries(_isPie(elements.type.getValue()) ? oldVal : 0);\n\t\t\t\tbreak;\n\t\t\tcase elements[\"legend.align\"]:\n\t\t\t\tupdateValign(val);\n\t\t\t\tbreak;\n\t\t\tcase elements[\"legend.valign\"]:\n\t\t\t\tupdateAlign(val);\n\t\t\t\tbreak;\n\t\t\tcase elements[\"xAxis.range\"]:\n\t\t\t\tif(elements[\"xAxis.fromData\"].getValue())\n\t\t\t\t\tsetSilentValue(elements[\"xAxis.fromData\"]);\n\t\t\t\tupdateRange(val, oldVal);\n\t\t\t\tbreak;\n\t\t\tcase elements[\"legend.range\"]:\n\t\t\t\tif(elements[\"legend.fromData\"].getValue())\n\t\t\t\t\tsetSilentValue(elements[\"legend.fromData\"]);\n\t\t\t\tupdateRange(val, oldVal);\n\t\t\t\tbreak;\n\t\t}\n\n\t\tconst config = form.getValues();\n\t\tview.views.update(chartEditor.viewId, config.range, config);\n\t});\n\n\telements.series.attachEvent(\"onRangeChange\", updateRange);\n\n\tfunction handlePieLegend(){\n\t\tif(elements[\"legend.fromData\"].getValue()){\n\t\t\tconst handler = _isPie(elements.type.getValue()) ? getLeftColumn : getTopRow;\n\t\t\tsetSilentValue(elements[\"legend.range\"], handler());\n\t\t}\n\t}\n\n\tfunction updateLegendRange(val){\n\t\tif(val){\n\t\t\tconst legendRange = elements[\"legend.range\"].getValue();\n\t\t\tupdateRange(\"\", legendRange);\n\t\t}\n\n\t\tconst handler = _isPie(elements.type.getValue()) ? getLeftColumn : getTopRow;\n\t\tval = val ? handler() : \"\";\n\n\t\tsetSilentValue(elements[\"legend.range\"], val);\n\t}\n\n\tfunction updateXaxisRange(val){\n\t\tif(val){\n\t\t\tconst xAxisRange = elements[\"xAxis.range\"].getValue();\n\t\t\tupdateRange(\"\", xAxisRange);\n\t\t}\n\n\t\tval = val ? getLeftColumn() : \"\";\n\n\t\tsetSilentValue(elements[\"xAxis.range\"], val);\n\t}\n\n\tfunction setSilentValue(element, val){\n\t\telement.blockEvent();\n\t\telement.setValue(val);\n\t\telement.unblockEvent();\n\t}\n\n\tfunction getLeftColumn(){\n\t\tconst data = elements.range.getValue();\n\t\tconst dataSeries = elements.dataSeries.getValue();\n\t\tconst legendRange = elements[\"legend.range\"].getValue();\n\t\tlet leftColumn = \"\";\n\n\t\tconst series = _getSeries(view, data, dataSeries, {legend: legendRange || \"\"});\n\n\t\tif(series.length)\n\t\t\tleftColumn = series[0].range;\n\n\t\treturn leftColumn;\n\t}\n\n\tfunction getTopRow(){\n\t\tconst data = _getDataParts(elements.range.getValue());\n\t\tconst dir = elements.dataSeries.getValue() == \"rows\";\n\t\tconst xAxisRange = _getDataParts(elements[\"xAxis.range\"].getValue());\n\t\tlet topRow = [];\n\n\t\tdata.forEach(subdata => {\n\t\t\tif(xAxisRange.indexOf(subdata) == -1){\n\t\t\t\tconst part = range(subdata, view);\n\t\t\t\tif(part){\n\t\t\t\t\tconst range = dir ?\n\t\t\t\t\t\ttoRange(part[0], part[1], part[2], part[1], part[4]) :\n\t\t\t\t\t\ttoRange(part[0], part[1], part[0], part[3], part[4]);\n\n\t\t\t\t\tif(data.indexOf(range) == -1)\n\t\t\t\t\t\ttopRow.push(range);\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\n\t\treturn topRow.join(\",\");\n\t}\n\n\tfunction updateRange(val, oldVal){\n\t\tlet data = elements.range.getValue();\n\n\t\tconst legend = elements[\"legend.range\"].getValue();\n\t\tconst xAxis = elements[\"xAxis.range\"].getValue();\n\t\tconst dataSeries = elements.dataSeries.getValue();\n\n\t\tconst series = _getSeries(view, data, dataSeries, {legend, xAxis});\n\n\t\toldVal = _getDataParts(oldVal);\n\n\t\tdata = _getDataParts(data).filter(val => oldVal.indexOf(val) == -1);\n\n\t\tif(val){\n\t\t\tval = _getDataParts(val);\n\t\t\tval.forEach(range => {\n\t\t\t\tconst exist = series.filter(obj => obj.range == range);\n\t\t\t\tif(!exist.length)\n\t\t\t\t\tdata.push(range);\n\t\t\t});\n\t\t}\n\n\t\tsetSilentValue(elements.range, data.join(\",\"));\n\t}\n\n\tfunction updateAlign(val){\n\t\tconst align = elements[\"legend.align\"];\n\t\tconst list = align.getList();\n\n\t\tif(val == \"middle\"){\n\t\t\tif(list.exists(\"center\"))\n\t\t\t\tlist.remove(\"center\");\n\t\t}\n\t\telse if(!list.exists(\"center\"))\n\t\t\tlist.add({id:\"center\", value:labels[\"chart-legend-center\"]}, 1);\n\t}\n\n\tfunction updateValign(val){\n\t\tconst align = elements[\"legend.valign\"];\n\t\tconst list = align.getList();\n\n\t\tif(val == \"center\"){\n\t\t\tif(list.exists(\"middle\"))\n\t\t\t\tlist.remove(\"middle\");\n\t\t}\n\t\telse if(!list.exists(\"middle\"))\n\t\t\tlist.add({id:\"middle\", value:labels[\"chart-legend-middle\"]}, 1);\n\t}\n\n\tfunction updateType(val){\n\t\thandlePieLegend();\n\n\t\tconst isPie = _isPie(val);\n\t\tconst isBar = val == \"bar\";\n\t\tconst series = elements.series;\n\t\tconst markersVisible = val == \"radar\" || val == \"line\" || val == \"spline\" || val == \"scatter\";\n\n\t\tseries.hideSubviews(\"marker\", markersVisible);\n\t\tseries.hideSubviews(\"label\", markersVisible || isBar || isPie);\n\t\tseries.hideSubviews(\"color\", !isPie);\n\n\t\tif(val == \"area\" || isBar) elements.stacked.show();\n\t\telse hideField(elements.stacked);\n\n\t\tif(isBar) elements.horizontal.show();\n\t\telse hideField(elements.horizontal);\n\n\t\tif(val == \"radar\")\n\t\t\telements[\"scale.circle\"].show();\n\t\telse\n\t\t\thideField(elements[\"scale.circle\"]);\n\n\t\tif(isPie){\n\t\t\thideBatch(\"axis\");\n\t\t\thideBatch(\"pie\", true);\n\t\t}\n\t\telse{\n\t\t\thideBatch(\"axis\", true);\n\t\t\thideBatch(\"pie\");\n\t\t}\n\n\t\tif(isPie || val == \"radar\")\n\t\t\thideBatch(\"axisTitle\");\n\t\telse\n\t\t\thideBatch(\"axisTitle\", true);\n\n\t\tswitchRowsCols();\n\t}\n\n\tfunction updateSeries(oldXaxis){\n\t\tlet data = elements.range.getValue();\n\n\t\tlet series = elements.series.getValue();\n\t\tconst legend = elements[\"legend.range\"].getValue();\n\t\tconst xAxis = elements[\"xAxis.range\"].getValue();\n\t\tconst dataSeries = elements.dataSeries.getValue();\n\n\t\tseries = _getSeries(view, data, dataSeries, {series, legend, xAxis}, oldXaxis);\n\n\t\telements.series.setValue(series);\n\t}\n\n\tfunction switchRowsCols(){\n\t\tconst dir = elements.dataSeries.getValue() == \"rows\";\n\t\tconst horizontal = elements.horizontal.getValue();\n\t\tconst pie = _isPie(elements.type.getValue());\n\n\t\tif((!pie && dir) || (!dir && pie)){\n\t\t\telements[\"legend.fromData\"].define(\"label\", labels[\"chart-col-legend\"]);\n\t\t\telements[\"xAxis.fromData\"].define(\"label\", labels[\"chart-row-\" + (horizontal ? \"yAxis\" : \"xAxis\")]);\n\t\t}\n\t\telse{\n\t\t\telements[\"legend.fromData\"].define(\"label\", labels[\"chart-row-legend\"]);\n\t\t\telements[\"xAxis.fromData\"].define(\"label\", labels[\"chart-col-\" + (horizontal ? \"yAxis\" : \"xAxis\")]);\n\t\t}\n\t\telements[\"legend.fromData\"].refresh();\n\t\telements[\"xAxis.fromData\"].refresh();\n\t}\n\n\tfunction hideField(field){\n\t\tif(field.setValue)\n\t\t\tsetSilentValue(field);\n\t\tfield.hide();\n\t}\n\n\tfunction hideBatch(batch, visible){\n\t\tform.queryView({batch:batch}, \"all\").forEach(field => {\n\t\t\tif(visible)\n\t\t\t\tfield.show();\n\t\t\telse\n\t\t\t\thideField(field);\n\t\t});\n\t}\n\n\tfunction inValues(values){\n\t\t[\n\t\t\t{value:\"H\", name:\"horizontal\"},\n\t\t\t{value:\"stacked\"},\n\t\t\t{value:\"3D\"}\n\t\t].forEach(property => {\n\t\t\tif(values.type.indexOf(property.value) != -1){\n\t\t\t\tvalues[property.name || property.value] = 1;\n\t\t\t\tvalues.type = values.type.replace(property.value, \"\").toLowerCase();\n\t\t\t}\n\t\t});\n\n\t\treturn values;\n\t}\n}\n\nfunction closeEditor(view){\n\tconst chartEditor = view.$$(\"chartEditor\");\n\tview.callEvent(\"onUIEditStop\", [chartEditor.viewId, \"chart\"]);\n\tchartEditor.viewId = null;\n\tview.$handleSelection = null;\n\tchartEditor.hide();\n}\n\nfunction addRichselect(name, label, data){\n\treturn { view: \"richselect\", name:name, label:labels[label], suggest:{\n\t\tview: \"ssheet-form-suggest\",\n\t\tdata: data\n\t}};\n}\n\nexport function getTypes(){\n\treturn [\n\t\t{id:\"line\", value:labels[\"line-chart\"]},\n\t\t{id:\"spline\", value:labels[\"spline-chart\"]},\n\t\t{id:\"splineArea\", value:labels[\"splinearea-chart\"]},\n\t\t{id:\"area\", value:labels[\"area-chart\"]},\n\t\t{id:\"bar\", value:labels[\"bar-chart\"]},\n\t\t{id:\"radar\", value:labels[\"radar-chart\"]},\n\t\t{id:\"pie\", value:labels[\"pie-chart\"]},\n\t\t{id:\"donut\", value:labels[\"donut-chart\"]},\n\t\t{id:\"scatter\", value:labels[\"scatter-chart\"]}\n\t];\n}\n\nfunction getLegendAlign(){\n\treturn [\n\t\t{id:\"left\", value:labels[\"chart-legend-left\"]},\n\t\t{id:\"center\", value:labels[\"chart-legend-center\"]},\n\t\t{id:\"right\", value:labels[\"chart-legend-right\"]}\n\t];\n}\n\nfunction getLegendValign(){\n\treturn [\n\t\t{id:\"top\", value:labels[\"chart-legend-top\"]},\n\t\t{id:\"middle\", value:labels[\"chart-legend-middle\"]},\n\t\t{id:\"bottom\", value:labels[\"chart-legend-bottom\"]}\n\t];\n}","import {Dialog} from \"./common\";\nimport {range} from \"../helpers/column_names\";\nimport {parseChart} from \"../mathematics/writer\";\nimport {getTypes} from \"../chart\";\n\nexport const action = \"add-sparkline\";\n\nconst labels = webix.i18n.spreadsheet.labels;\n\nexport class DialogBox extends Dialog{\n\t$show(box, form){\n\t\tthis.cell = this.view.getSelectedId();\n\t\tif(!this.cell)\n\t\t\treturn false;\n\n\t\tconst els = form.elements;\n\t\tthis.view.$handleSelection = function(st, end, a, b){\n\t\t\tels.range.setValue(a+\":\"+b);\n\t\t\treturn false;\n\t\t};\n\n\t\tels.range.setValue(\"\");\n\n\t\t//sync state of dialog to data with  the selected cell\n\t\tlet value = this.view.getCellValue(this.cell.row, this.cell.column);\n\t\tlet data = parseChart(value);\n\t\tif (data){\n\t\t\tform.blockEvent();\n\t\t\tels.type.setValue(data.type);\n\t\t\tels.range.setValue(data.range);\n\t\t\tif (data.color){\n\t\t\t\tels.color_def.setValue(data.color);\n\t\t\t\tels.color_pos.setValue(data.color);\t\t\n\t\t\t}\n\t\t\tif (data.negativeColor)\n\t\t\t\tels.color_neg.setValue(data.negativeColor);\n\t\t\tif (data.horizontal)\n\t\t\t\tels.horizontal.setValue(1);\n\n\t\t\tform.unblockEvent();\n\t\t\tthis.renderPreview();\n\t\t}\t\n\n\t\tels.range.focus();\n\t}\n\t$hide(){\n\t\tthis.view.$handleSelection = null;\n\t}\n\t$init(){\n\t\treturn {\n\t\t\tview: \"ssheet-dialog\",\n\t\t\thead:labels[\"sparkline-title\"],\n\t\t\tmove: true,\n\t\t\tposition: \"center\",\n\t\t\tbody:{\n\t\t\t\tview:\"form\", visibleBatch:1, on:{ onChange : ()=> this.renderPreview() },  elements:[\n\t\t\t\t\t{view: \"richselect\", name:\"type\", label:labels[\"sparkline-type\"], value:\"line\", labelPosition:\"left\", suggest:{\n\t\t\t\t\t\tview:  \"ssheet-form-suggest\",\n\t\t\t\t\t\tdata:getTypes()\n\t\t\t\t\t}, on:{\n\t\t\t\t\t\tonChange: function(type){\n\t\t\t\t\t\t\tconst form = this.getFormView();\n\t\t\t\t\t\t\tswitch(type){\n\t\t\t\t\t\t\t\tcase \"pie\":\n\t\t\t\t\t\t\t\tcase \"donut\":\n\t\t\t\t\t\t\t\t\tform.showBatch(3);\n\t\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t\tcase \"bar\":\n\t\t\t\t\t\t\t\t\tform.showBatch(2);\n\t\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t\tdefault:\n\t\t\t\t\t\t\t\t\tform.showBatch(1);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}},\n\t\t\t\t\t{ view:\"text\", label:labels[\"sparkline-range\"], name:\"range\"},\n\t\t\t\t\t{ view:\"ssheet-colorpicker\", label:labels[\"sparkline-color\"], name:\"color_def\", id:\"add_sparkline_color\", value:\"#6666FF\", batch:\"1\"},\n\t\t\t\t\t{ view:\"ssheet-colorpicker\", label:labels[\"sparkline-positive\"], name:\"color_pos\", value:\"#6666FF\", batch:\"2\"},\n\t\t\t\t\t{ view:\"ssheet-colorpicker\", label:labels[\"sparkline-negative\"], name:\"color_neg\", value:\"#FF6666\", batch:\"2\"},\n\t\t\t\t\t{ view:\"checkbox\", label:labels[\"horizontal-chart\"], name:\"horizontal\", batch:\"2\"},\n\t\t\t\t\t{ view:\"formlate\", name:\"preview\", borderless:true, css:\"webix_ssheet_preview\", height:50 }\n\t\t\t\t]\n\t\t\t},\n\t\t\ton:{\n\t\t\t\tonSaveClick: () => this.okClick(),\n\t\t\t\tonCancelClick: () => this.close()\n\t\t\t}\n\t\t};\n\t}\n\tcheckRange(text){\n\t\tif(text && range(text, this.view))\n\t\t\treturn true;\n\t\tthis.view.alert({text:labels[\"error-range\"]});\n\t}\n\tokClick(){\n\t\tconst form = this.$dialog.getBody();\n\t\tconst data = form.getValues();\n\t\tdata.range = data.range.toUpperCase();\n\n\t\tif (data.range && this.checkRange(data.range)){\n\t\t\tconst config = this.sparkConfig(data);\n\n\t\t\tthis.view.addSparkline(this.cell.row, this.cell.column, config);\n\t\t\tthis.close();\n\t\t}\n\t}\n\n\trenderPreview(){\n\t\tconst form = this.$dialog.getBody();\n\t\tconst data = form.getValues();\n\t\tdata.range = data.range.toUpperCase();\n\n\t\tif (data.range && this.checkRange(data.range)){\n\t\t\tconst pos = range(data.range, this.view);\n\t\t\tconst values = this.view._mPage.getRange(pos[0]-1, pos[1]-1, pos[2]-1, pos[3]-1);\n\t\t\tconst config = this.sparkConfig(data, true);\n\n\t\t\tfor(let i = 0; i < values.length; i++)\n\t\t\t\tvalues[i] = values[i]||0;\n\t\t\tform.elements.preview.setValue(webix.Sparklines.getTemplate(config)(values, { width:200, height: 40 }));\n\t\t}\n\t\telse\n\t\t\tform.elements.preview.setValue(\"\");\n\t}\n\n\tsparkConfig(config, preview){\n\t\tconfig = webix.copy(config);\n\t\tconst form = this.$dialog.getBody();\n\n\t\tif (config.type === \"bar\"){\n\t\t\tconfig.color = config.color_pos;\n\t\t\tconfig.negativeColor = config.color_neg;\n\t\t}\n\t\telse if(form.elements.color_def.isVisible())\n\t\t\tconfig.color = config.color_def;\n\t\telse if(config.type == \"donut\" && preview)\n\t\t\twebix.extend(config, {type:\"pie\", donut:1}, true);\n\n\t\treturn config;\n\t}\n}","import {Dialog} from \"./common\";\nimport {isRange, toSheetRange, escapeSheet} from \"../helpers/column_names\";\nimport {getLastCharIndex} from \"../mathematics/parser\";\n\nexport const action = \"add-range\";\n\nexport class DialogBox extends Dialog{\n\t$show(box){\n\t\tconst form = box.$$(\"form\");\n\n\t\tform.clear();\n\t\tform.clearValidation();\n\n\t\tconst elements = form.elements;\n\n\t\telements.name.focus();\n\n\t\tlet selectedCell = this.view.getSelectedRange();\n\t\tif(selectedCell)\n\t\t\tselectedCell = escapeSheet(this.view.getActiveSheet())+\"!\"+selectedCell;\n\n\t\tform.setValues({\n\t\t\trange: selectedCell,\n\t\t\tscope: \"$global\"\n\t\t});\n\n\t\tthis._updateData();\n\n\t\tthis.view._rangeDialog = true;\n\t\tthis.view.$handleSelection = (st, end, a, b)=>{\n\t\t\tform.elements.range.setValue(toSheetRange(a,b,this.view.getActiveSheet()));\n\t\t\treturn false;\n\t\t};\n\t}\n\t$hide(){\n\t\tthis.view.$handleSelection = null;\n\t\tthis.view._rangeDialog = null;\n\t}\n\tsaveClick(){\n\t\tconst view = this.view;\n\t\tconst form = this.$dialog.$$(\"form\");\n\t\tconst data = form.getValues();\n\n\t\tif(data.range){\n\t\t\tconst rangeParts = data.range.split(\"!\");\n\n\t\t\tif(rangeParts.length == 1)\n\t\t\t\trangeParts.unshift( escapeSheet(view.getActiveSheet()) );\n\n\t\t\tdata.range = rangeParts[0]+\"!\"+rangeParts[1].toUpperCase();\n\t\t}\n\n\t\tdata.name = data.name.toUpperCase();\n\n\t\tform.setValues(data);\n\n\t\tif (form.validate()){\n\t\t\tconst table = this.$dialog.$$(\"table\");\n\n\t\t\tif(data.id){\n\t\t\t\tconst oldData = table.getItem(data.id);\n\n\t\t\t\tview.ranges.remove(oldData.name, this._getScope(oldData));\n\t\t\t\ttable.updateItem(data.id, data);\n\t\t\t}\n\t\t\telse\n\t\t\t\ttable.add(data);\n\n\t\t\tview.ranges.add(\n\t\t\t\tdata.name,\n\t\t\t\tdata.range,\n\t\t\t\tthis._getScope(data)\n\t\t\t);\n\n\t\t\tview.refresh();\n\n\t\t\ttable.unselect();\n\t\t\tform.setValues({scope: \"$global\"});\n\t\t}\n\t}\n\t_getScope(data){\n\t\treturn data.scope == \"$global\" ? true : data.scope;\n\t}\n\tremoveRange(id){\n\t\tconst view = this.view;\n\t\tview.confirm({\n\t\t\ttext: webix.i18n.spreadsheet.labels[\"range-remove-confirm\"]\n\t\t}).then(()=>{\n\t\t\tconst table = this.$dialog.$$(\"table\");\n\t\t\tconst item = table.getItem(id);\n\n\t\t\tview.ranges.remove(item.name, this._getScope(item));\n\n\t\t\tview.refresh();\n\t\t\ttable.remove(id);\n\t\t});\n\t}\n\teditRange(id){\n\t\tconst form = this.$dialog.$$(\"form\");\n\t\tconst table = this.$dialog.$$(\"table\");\n\n\t\tform.clearValidation();\n\t\tconst item = webix.copy(table.getItem(id));\n\n\t\tform.setValues(item);\n\t}\n\t$init(){\n\t\tthis.view.attachEvent(\"onSheetRename\", (name, newName)=> this._updateData(name, newName));\n\t\tthis.view.attachEvent(\"onSheetRemove\", (name)=> this._updateData(name));\n\t\tthis.view.attachEvent(\"onSheetAdd\", ()=> this._updateData());\n\n\t\tconst locale = webix.i18n.spreadsheet.labels;\n\t\tconst theform = {\n\t\t\tpadding:0,\n\t\t\ttype: \"clean\",\n\t\t\tcols:[\n\t\t\t\t{ view: \"ssheet-dialog-table\", id: \"table\", borderless:true, columns:[\n\t\t\t\t\t{ id:\"name\", header:locale[\"range-name\"], width: 120 },\n\t\t\t\t\t{ id:\"range\", header:locale[\"range-cells\"], width: 150 },\n\t\t\t\t\t{ id:\"scope\", header:locale[\"range-scope\"], width: 95, template: obj => {\n\t\t\t\t\t\treturn obj.scope == \"$global\" ? locale[\"range-global\"] : obj.scope;\n\t\t\t\t\t}},\n\t\t\t\t\t{ template:\"<span class='webix_icon ssheet_ranges_edit wxi-pencil'></span>\", width:44 },\n\t\t\t\t\t{ template:\"<span class='webix_icon ssheet_ranges_edit wxi-trash'></span>\", width:44 }\n\t\t\t\t],\n\t\t\t\tautowidth:true, height: 200, select:\"row\",\n\t\t\t\ton:{\n\t\t\t\t\tonBeforeSelect: id =>{\n\t\t\t\t\t\treturn id == this.$dialog.$$(\"form\").getValues().id;\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\tonClick:{\n\t\t\t\t\t\"wxi-trash\":(ev, id) => this.removeRange(id),\n\t\t\t\t\t\"wxi-pencil\":(ev, id) => this.editRange(id)\n\t\t\t\t}},\n\t\t\t\t{ width: 270, view: \"form\", id:\"form\",\n\t\t\t\t\trules:{\n\t\t\t\t\t\tname: (_, obj)=> {\n\t\t\t\t\t\t\tconst notUnique = this.$dialog.$$(\"table\").find(item => {\n\t\t\t\t\t\t\t\treturn item.name == obj.name && item.scope == obj.scope && item.id != obj.id;\n\t\t\t\t\t\t\t}, true);\n\n\t\t\t\t\t\t\treturn !notUnique && !getLastCharIndex(obj.name);\n\t\t\t\t\t\t},\n\t\t\t\t\t\trange: isRange,\n\t\t\t\t\t\tscope: webix.rules.isNotEmpty\n\t\t\t\t\t},\n\t\t\t\t\telementsConfig:{\n\t\t\t\t\t\tlabelWidth: 95\n\t\t\t\t\t},\n\t\t\t\t\telements:[\n\t\t\t\t\t\t{ view: \"text\", name:\"name\", label: locale[\"range-name\"]},\n\t\t\t\t\t\t{ view: \"text\", name:\"range\", id:\"range\", label: locale[\"range-cells\"], on:{\n\t\t\t\t\t\t\tonFocus:() => this.view.showCell(this.$dialog.$$(\"range\").getValue(), true)\n\t\t\t\t\t\t}},\n\t\t\t\t\t\t{ view: \"richselect\", name:\"scope\", id:\"sheets\", label: locale[\"range-scope\"], suggest:{\n\t\t\t\t\t\t\tview: \"ssheet-form-suggest\",\n\t\t\t\t\t\t\tbody:{\n\t\t\t\t\t\t\t\tdata: []\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}}\n\t\t\t\t\t]\n\t\t\t\t}\n\t\t\t]\n\t\t};\n\n\t\treturn {\n\t\t\tview: \"ssheet-dialog\",\n\t\t\tmove:true,\n\t\t\thead: webix.i18n.spreadsheet.labels[\"range-title\"],\n\t\t\tautoheight: true,\n\t\t\twidth: 800,\n\t\t\tposition: \"center\",\n\t\t\tbody: theform,\n\t\t\ton:{\n\t\t\t\tonSaveClick: () => this.saveClick(),\n\t\t\t\tonCancelClick: () => this.close()\n\t\t\t}\n\t\t};\n\t}\n\t_updateData(name, newName){\n\t\tif(!this.$dialog.isVisible())\n\t\t\treturn;\n\n\t\tconst ranges = this.view._mData.getRanges();\n\t\tconst locale = webix.i18n.spreadsheet.labels;\n\t\tconst table = this.$dialog.$$(\"table\");\n\t\tconst form = this.$dialog.$$(\"form\");\n\n\t\tlet editRange = table.getItem( form.getValues().id );\n\t\tif(editRange){\n\t\t\tlet rangeName = editRange.name;\n\n\t\t\tif(name == editRange.scope)\n\t\t\t\trangeName = newName ? newName+\"!\"+rangeName : null;\n\t\t\telse\n\t\t\t\trangeName = editRange.scope+\"!\"+rangeName;\n\n\t\t\teditRange = rangeName ? ranges.get(rangeName) : null;\n\t\t}\n\n\t\ttable.clearAll();\n\n\t\tconst allRanges = ranges.serialize();\n\t\tconst data = [];\n\n\t\tlet selectedId;\n\t\tfor(let i = 0; i < allRanges.length; i++){\n\t\t\tconst id = i+1;\n\t\t\tlet [name, range] = allRanges[i];\n \n\t\t\tif(editRange && ranges.get(name) == editRange)\n\t\t\t\tselectedId = id;\n\n\t\t\tconst nameParts = name.split(\"!\");\n\n\t\t\tdata.push({\n\t\t\t\tscope: nameParts.length == 1 ? \"$global\" : nameParts[0],\n\t\t\t\tname: nameParts[1] || nameParts[0],\n\t\t\t\trange,\n\t\t\t\tid\n\t\t\t});\n\t\t}\n\n\t\ttable.parse(data);\n\n\t\tform.setValues({id:selectedId}, true);\n\t\tif(selectedId)\n\t\t\ttable.select(selectedId);\n\n\t\tconst select = this.$dialog.$$(\"sheets\");\n\t\tconst selectList = select.getList();\n\n\t\tselectList.clearAll();\n\n\t\tconst sheets = [{\n\t\t\tid: \"$global\", value: locale[\"range-global\"]\n\t\t}];\n\t\tthis.view._sheets.forEach(sheet => {\n\t\t\tsheets.push({id:sheet.name, value: sheet.name});\n\t\t});\n\t\tselectList.parse(sheets);\n\n\t\tif(name){\n\t\t\tconst range = this.$dialog.$$(\"range\");\n\t\t\tconst rangeVal = range.getValue();\n\n\t\t\t//remove sheet\n\t\t\tnewName = newName || this.view.getActiveSheet();\n\n\t\t\tif(rangeVal.indexOf(escapeSheet(name)+\"!\") == 0)\n\t\t\t\trange.setValue(escapeSheet(newName)+\"!\"+rangeVal.split(\"!\")[1]);\n\n\t\t\tif(select.getValue() == name)\n\t\t\t\tselect.setValue(newName);\n\t\t}\n\t}\n}","import {Dialog} from \"./common\";\nimport {range} from \"../helpers/column_names\";\nimport group from \"../operations/undo_group\";\n\nexport const action = \"add-dropdown\";\n\nexport class DialogBox extends Dialog{\n\t$show(){\n\t\tlet form = this.$dialog.$$(\"form\");\n\t\tthis.cell = this.view.getSelectedId(true);\n\t\tif (!this.cell.length)\n\t\t\treturn false;\n\n\t\tform.clear();\n\n\t\t//restore previosly selected range\n\t\tconst value = this.view.getCellEditor(this.cell[0].row, this.cell[0].column);\n\t\tif(value)\n\t\t\tform.setValues({\n\t\t\t\trange: value.options,\n\t\t\t\tempty: value.empty\n\t\t\t});\n\n\t\tthis.view.$handleSelection = function(st, end, a, b){\n\t\t\tform.elements.range.setValue(a+\":\"+b);\n\t\t\treturn false;\n\t\t};\n\n\t\tform.elements.range.focus();\n\t}\n\t$hide(){\n\t\tthis.view.$handleSelection = null;\n\t}\n\t$init(){\n\t\treturn {\n\t\t\tview: \"ssheet-dialog\",\n\t\t\tposition:\"center\",\n\t\t\thead:webix.i18n.spreadsheet.labels[\"dropdown-title\"],\n\t\t\tmove: true,\n\t\t\tbody:{\n\t\t\t\tpadding:0,\n\t\t\t\tview:\"form\",\n\t\t\t\tid:\"form\",\n\t\t\t\telementsConfig: {\n\t\t\t\t\tlabelWidth: 130\n\t\t\t\t},\n\t\t\t\trows:[\n\t\t\t\t\t{ view:\"text\", label:webix.i18n.spreadsheet.labels[\"dropdown-range\"], name:\"range\" },\n\t\t\t\t\t{ view:\"checkbox\", label:webix.i18n.spreadsheet.labels[\"dropdown-empty-option\"], name:\"empty\" }\n\t\t\t\t]\n\t\t\t},\n\t\t\ton:{\n\t\t\t\tonSaveClick: () => this.okClick(),\n\t\t\t\tonCancelClick: () => this.close()\n\t\t\t}\n\t\t};\n\t}\n\tokClick(){\n\t\tconst values = this.$dialog.$$(\"form\").getValues();\n\n\t\tif(!range(values.range, this.view))\n\t\t\tthis.view.alert({text:webix.i18n.spreadsheet.labels[\"error-range\"], type: \"alert-error\"});\n\t\telse{\n\t\t\tgroup.set(function(){\n\t\t\t\tfor (let i = 0; i < this.cell.length; i++)\n\t\t\t\t\tthis.view.setCellEditor(this.cell[i].row, this.cell[i].column, { editor:\"ss_richselect\", options:values.range, empty:values.empty });\n\t\t\t}, this);\n\t\t\tthis.close();\n\t\t}\n\t}\n}","import {range as getRangePos} from \"../helpers/column_names\";\nimport {cell_template} from \"../table\";\nimport * as arr from \"../helpers/array\";\nimport {serialize as getSpans} from \"../operations/spans\";\n\nclass Ranges{\n\tconstructor(view){\n\t\tthis._master = view;\n\t}\n\tclear(scope){\n\t\tconst sheet = typeof scope == \"string\" ? scope : this._master.getActiveSheet();\n\t\tconst ranges = this.serialize(sheet);\n\t\tranges.forEach(range => {\n\t\t\tif(scope === true){\n\t\t\t\tif(range[2])\n\t\t\t\t\tthis.remove(range[0], scope);\n\t\t\t\treturn;\n\t\t\t}\n\t\t\telse\n\t\t\t\tthis.remove(range[0], scope);\n\t\t});\n\t}\n\t_normalizeName(name, scope){\n\t\tif(scope !== true)\n\t\t\tname = (scope || this._master.getActiveSheet())+\"!\"+name;\n\t\treturn name;\n\t}\n\t_normalizeRange(range, scope){\n\t\tconst rangeParts = range.split(\"!\");\n\t\tif(rangeParts.length == 1)\n\t\t\trange = (typeof scope == \"string\" ? scope : this._master.getActiveSheet()) + \"!\" + range;\n\t\treturn range;\n\t}\n\tadd(name, range, scope){\n\t\tconst view = this._master;\n\n\t\tview.callEvent(\"onAfterRangeSet\", [name, range, scope]);\n\n\t\tname = this._normalizeName(name, scope);\n\n\t\tview._mData.getRanges().add(name, this._normalizeRange(range, scope));\n\t\tview.callEvent(\"onMathRefresh\", []);\n\t}\n\tgetCode(name, scope){\n\t\tname = this._normalizeName(name, scope);\n\n\t\tconst range = this._master._mData.getRanges().get(name);\n\t\tif(range)\n\t\t\treturn range.source;\n\t}\n\tremove(name, scope){\n\t\tname = this._normalizeName(name, scope);\n\n\t\tthis._master._mData.getRanges().remove(name);\n\t\tthis._master.callEvent(\"onMathRefresh\", []);\n\t}\n\tparse(data, sheet){\n\t\tif(!data)\n\t\t\treturn;\n\t\tfor(let i = 0; i < data.length; i++){\n\t\t\tconst ranges = this._master._mData.getRanges();\n\t\t\tlet [name, range, globalRange] = data[i];\n\t\t\tname = this._normalizeName(name, globalRange||sheet);\n\n\t\t\tif(!ranges.get(name))\n\t\t\t\tranges.add(name, this._normalizeRange(range, sheet));\n\t\t}\n\t}\n\tserialize(sheet){\n\t\tsheet = sheet || this._master.getActiveSheet();\n\t\tconst allRanges = this._master._mData.getRanges().serialize();\n\t\tconst out = [];\n\n\t\tfor(let i = 0; i < allRanges.length; i++){\n\t\t\tconst arr = allRanges[i];\n\t\t\tconst nameParts = arr[0].split(\"!\");\n\t\t\tconst globalRange = nameParts.length == 1;\n\n\t\t\tif(globalRange || nameParts[0] == sheet)\n\t\t\t\tout.push([\n\t\t\t\t\tnameParts[ globalRange ? 0 : 1 ],\n\t\t\t\t\tarr[1],\n\t\t\t\t\tglobalRange\n\t\t\t\t]);\n\t\t}\n\n\t\treturn out;\n\t}\n\tgetRanges(sheet){\n\t\tconst data = this.serialize(sheet);\n\t\treturn data.map(arr => {\n\t\t\treturn {\n\t\t\t\tname: arr[0],\n\t\t\t\trange: arr[1],\n\t\t\t\tglobal: arr[2]\n\t\t\t};\n\t\t});\n\t}\n}\n\nexport function init(view) {\n\tview.ranges = new Ranges(view);\n\n\tview.attachEvent(\"onDataSerialize\", data => {\n\t\tdata.ranges = view.ranges.serialize();\n\t});\n}\n\nfunction nullFilter(){ \n\tconst locale = webix.i18n.spreadsheet.labels;\n\treturn { id:\"$empty\", value:\"\", $value:\"<span class='webix_ssheet_empty'>\"+locale[\"dropdown-empty\"]+\"</span>\" };\n}\n\nfunction getRange(view, r1, c1, r2, c2, spans){\n\tconst out = [];\n\tconst activeSheet = view._mPage === this;\n\n\tfor (let i = r1-1; i <= r2-1; i++) {\n\t\tfor (let j = c1-1; j <= c2-1; j++){\n\t\t\tlet inSpan;\n\t\t\tfor(let s = 0; s < spans.length; s++){\n\t\t\t\tconst span = spans[s];\n\t\t\t\tconst row = i + 1;\n\t\t\t\tconst col = j + 1;\n\t\t\t\tif(!(row == span[0] && col == span[1]) && row >= span[0] && row < span[0] + span[3] && col >= span[1] && col < span[1] + span[2]){\n\t\t\t\t\tinSpan = true;\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t\tif(inSpan)\n\t\t\t\tcontinue;\n\t\t\tlet obj = this.getCell(i, j);\n\t\t\tlet cell;\n\n\t\t\tif(!obj)\n\t\t\t\tcell = {\n\t\t\t\t\tvalue: \"\"\n\t\t\t\t};\n\t\t\telse\n\t\t\t\tcell = webix.copy(obj);\n\n\t\t\tif(activeSheet)\n\t\t\t\tcell.$value = cell_template(view, {id: i+1}, null, null, {id:j+1}, true);\n\t\t\telse\n\t\t\t\tdelete cell.format;\n\n\t\t\tcell.id = cell.value;\n\t\t\tout.push(cell);\n\t\t}\n\t}\n\n\treturn out;\n}\n\nexport function rangeOptions(view, text, extra){\n\tlet values = [];\n\tif (typeof text == \"string\"){\n\t\tconst pos = getRangePos(text, view);\n\t\tif (pos){\n\t\t\tlet page = view._mPage;\n\t\t\tif(pos[4])\n\t\t\t\tpage = view._mData.getPage(pos[4]);\n\t\n\t\t\tif(page){\n\t\t\t\tconst spans = (\n\t\t\t\t\tpage == view._mPage ?\n\t\t\t\t\t\tgetSpans(view, {}) :\n\t\t\t\t\t\tarr.find(view._sheets, sheet => sheet.name == pos[4]).content\n\t\t\t\t).spans;\n\t\t\t\tvalues = getRange.apply(page, [view, pos[0], pos[1], pos[2], pos[3], spans]);\n\t\t\t}\n\t\t}\n\t}\n\telse if (webix.isArray(text))\n\t\tfor (let i=0; i<text.length; i++){\n\t\t\tlet v = (text[i] || text[i] === 0) ? text[i] : \"\";\n\t\t\tv = (typeof v === \"object\") ? webix.copy(v) : { id:v, value:v };\n\t\t\tvalues.push(v);\n\t\t}\n\n\tconst test = {};\n\tfor (let i=values.length-1; i>=0; i--){\n\t\tconst boolean = typeof values[i].value === \"boolean\";\n\t\tif(boolean)\n\t\t\tvalues[i].value *= 1;\n\t\tif(boolean || values[i].id === 0)\n\t\t\tvalues[i].id = String(values[i].value);\n\n\t\tif(extra && extra.unique){\n\t\t\tif (test[values[i].id])\n\t\t\t\tvalues.splice(i, 1);\n\t\t\telse\n\t\t\t\ttest[values[i].id] = true;\n\t\t}\n\t}\n\n\tif (extra){\n\t\tlet empty = false;\n\t\tfor (let i=values.length-1; i>=0; i--){\n\t\t\tlet value = values[i].value;\n\t\t\tif (!value && value !== 0){\n\t\t\t\tvalues.splice(i, 1);\n\t\t\t\tempty = true;\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\tvalues[i].value = String(value);\n\t\t}\n\n\t\tif (extra.order)\n\t\t\tvalues.sort(function(objA, objB){\n\t\t\t\tconst sorters = view.$$(\"cells\").data.sorting.as;\n\t\t\t\tconst a = objA.value;\n\t\t\t\tconst b = objB.value;\n\n\t\t\t\treturn webix.rules.isNumber(a) && webix.rules.isNumber(b) ? sorters.int(a, b) : sorters.string(a, b);\n\t\t\t});\n\n\t\tif (empty && extra.filter)\n\t\t\tvalues.unshift( nullFilter() );\n\n\t\tif (extra.empty)\n\t\t\tvalues.unshift({ id:\"$empty\", $empty:true, value:\"\" });\n\t}\n\treturn values;\n}","import group from \"./undo_group\";\nimport {getType} from \"./types\";\nimport {setSpanCss} from \"./spans\";\nimport {rangeOptions} from \"../mathematics/ranges\";\nimport {changeRange, eachRange, toRange} from \"../helpers/column_names\";\nimport {conditions} from \"../helpers/conditional\";\n\nexport function init(view){\n\tconst table = view._table;\n\n\tview.attachEvent(\"onReset\", () => reset(view));\n\treset(view);\n\n\ttable.on_click.ssheet_filter_sign = (e, id) => {\n\t\tconst filter = table._ssFilters[id.row][id.column];\n\t\tconst mode = filter.mode || getFilterMode(view, id.row, id.column);\n\n\t\tlet options = [];\n\t\tif (filter.options){\n\t\t\tif (typeof filter.options == \"string\")\n\t\t\t\toptions = rangeOptions(view, filter.options, { unique:true, order:true, filter:true });\n\t\t\telse if (webix.isArray(filter.options))\n\t\t\t\toptions = rangeOptions(view, filter.options, { filter:true });\n\t\t}\n\t\tview.callEvent(\"onCommand\", [{id:\"start-filter\", cell:id, mode, options, filter}]);\n\t};\n\ttable.on_dblclick.ssheet_filter_sign = () => false;\n\n\tview.attachEvent(\"onCommand\", (cm) => {\n\t\tif (cm.id === \"create-filter\")\n\t\t\ttoggleFilters(view);\n\t});\n\n\tlet refilter = false;\n\tview.attachEvent(\"onUndo\", (type, row, column, value) => {\n\t\tif (type == \"filter\"){\n\t\t\tvalue = (typeof value == \"object\") ? value : null;\n\t\t\tview.setCellFilter(row, column, value);\n\t\t\trefilter = true;\n\t\t}\n\t\telse if (type == \"apply-filter\"){\n\t\t\tconst filter = view.getCellFilter(row, column);\n\n\t\t\tfilter.value = value;\n\t\t\tdelete filter.handler;\n\t\t\tif (value && value.condition){\n\t\t\t\tconst mode = filter.mode || getFilterMode(view, row, column);\n\t\t\t\tfilter.handler = getFilterFunction(mode, filter.value);\n\t\t\t}\n\t\t\trefilter = true;\n\n\t\t\t// update css\n\t\t\tconst add = value && isValueActive(value);\n\t\t\ttable[add?\"addCellCss\":\"removeCellCss\"](row, column, \"ss_filter_active\");\n\t\t\tsetSpanCss(view, row, column, \"ss_filter_active\", add);\n\t\t}\n\t});\n\n\tview.attachEvent(\"onAfterUndo\", () => {\n\t\tif (refilter){\n\t\t\tview.filterSpreadSheet();\n\t\t\trefilter = false;\n\t\t}\n\t});\n\n\tview.attachEvent(\"onAction\", (action, p) => {\n\t\tif (action == \"filter\"){\n\t\t\tsetSpanCss(view, p.row, p.column, \"ss_filter\", p.newValue);\n\t\t\tsetSpanCss(view, p.row, p.column, \"ss_filter_active\", (p.newValue && p.newValue.value && isValueActive(p.newValue.value)));\n\t\t\tmarkBarFilter(view);\n\t\t}\n\t\telse if (action == \"before-grid-change\")\n\t\t\tupdatePosition(view, p.name, p.inc, p.data, p.start);\n\t});\n}\n\nfunction reset(view){\n\tview._table._ssFilters = {};\n\tmarkBarFilter(view);\n}\n\nexport function getFilters(table){\n\tconst filters = table._ssFilters;\n\tconst all = [];\n\tfor (let row in filters)\n\t\tfor (let column in filters[row])\n\t\t\tall.push(filters[row][column]);\n\treturn all;\n}\n\nexport function serialize(view,data){\n\tconst filters = getFilters(view._table);\n\tconst result = data.filters = [];\n\n\tfor (let i = 0; i<filters.length; i++){\n\t\tlet {row, column, options, mode, value, lastRow} = filters[i];\n\t\tvalue = value && webix.copy(value);\n\t\tresult.push([row, column, {value, options, mode, lastRow}]);\n\t}\n}\n\nexport function load(view,data){\n\tconst filters = data.filters;\n\n\tif (filters){\n\t\tfor (let i = 0; i < filters.length; i++){\n\t\t\tview.setCellFilter(filters[i][0], filters[i][1], (filters[i][2] || {options:\"\"}));\n\t\t}\n\t\tview.filterSpreadSheet();\n\t}\n}\n\nexport function clearFilters(view, range){\n\tlet refilter = false;\n\teachRange(range, view, function(view, cell){\n\t\tlet filter = view._table._ssFilters[cell.row];\n\t\tif (filter){\n\t\t\tif (filter[cell.column]){\n\t\t\t\trefilter = true;\n\t\t\t\tdelete filter[cell.column];\n\n\t\t\t\tview._table.removeCellCss(cell.row, cell.column, \"ss_filter\");\n\t\t\t\tview._table.removeCellCss(cell.row, cell.column, \"ss_filter_active\");\n\n\t\t\t\tsetSpanCss(view, cell.row, cell.column, \"ss_filter\", false);\n\t\t\t\tsetSpanCss(view, cell.row, cell.column, \"ss_filter_active\", false);\n\t\t\t}\n\t\t}\n\t});\n\n\tif (refilter)\n\t\tview.filterSpreadSheet();\n}\n\nexport function isFilter(view, row, column){\n\tconst filters = view._table._ssFilters;\n\treturn filters[row] && !!filters[row][column];\n}\n\nexport function calibrateRange(view, row, column, range, lastRow){\n\tif(!range)\n\t\trange = {end:{row:row}};\n\n\tif (range.end){\n\t\tvar endRow = range.end.row;\n\t\trange = getFilterRange(view, row, column, endRow, lastRow);\n\t}\n\treturn range;\n}\n\nexport function isValueActive(value){\n\treturn !!(value.includes || (value.condition && value.condition.filter));\n}\n\nfunction isFilterExists(view){\n\tconst filters = view._table._ssFilters;\n\tfor (let row in filters)\n\t\tfor (let column in filters[row])\n\t\t\tif (filters[row][column]) return true;\n\treturn false;\n}\n\nfunction markBarFilter(view){\n\tconst value = isFilterExists(view);\n\tview.callEvent(\"onCommand\", [{id:\"toolbar-update\", name:\"create-filter\", value}]);\n}\n\n\nfunction getFilterRange(view, row, column, endRow, lastRow){\n\tconst span = view._table.getSpan(row, column);\n\tif (row === endRow || (span && row == endRow - span[3] + 1)){\n\t\tfor (endRow = row; endRow < view.config.rowCount; endRow++){\n\t\t\tconst r = endRow+1;\n\n\t\t\tconst span = view._table.getSpan(r, column);\n\t\t\tif(span && span[0] != r)\n\t\t\t\tcontinue;\n\n\t\t\tconst value = view.getCellValue(r, column);\n\t\t\tif(!value && value !== 0)\n\t\t\t\tbreak;\n\t\t}\n\t}\n\n\tif(lastRow)\n\t\treturn endRow;\n\n\treturn toRange(row+1, column, endRow, column);\n}\n\nexport function getFilterMode(view, row, column){\n\tfor (let i=row+1; i<view.config.rowCount; i++){\n\t\tconst value = view.getCellValue(i, column);\n\n\t\tif (value || value === 0){\n\t\t\tconst type = getType(view, i, column);\n\t\t\treturn (type == \"number\" || type == \"date\") ? type : \"text\";\n\t\t}\n\t\telse if (value !== \"\")\n\t\t\tbreak;\n\t}\n\treturn \"text\";\n}\n\nfunction toggleFilters(view){\n\tconst range = view._table.getSelectArea();\n\n\tif (isFilterExists(view)){\n\t\tgroup.set(()=> view.removeFilters());\n\t\tif (range)\n\t\t\tview._table.addSelectArea(range.start, range.end);\n\t}\n\telse if (range)\n\t\tgroup.set(()=>{\n\t\t\tlet row = range.start.row;\n\t\t\tfor (let i = range.start.column; i <= range.end.column; i++)\n\t\t\t\tview.setCellFilter(row, i, { options:range, lastRow: calibrateRange(view, row, i, range, true) });\n\t\t});\n\tmarkBarFilter(view);\n}\n\nfunction updatePosition(view, name, inc, data, start){\n\tconst filters = data.filters;\n\tif (inc){\n\t\tfor(let i=filters.length-1; i>=0; i--){\n\t\t\tlet [row,column,filter] = filters[i];\n\t\t\tif (name == \"row\" && row >= start.row || name == \"column\" && column >= start.column){\n\t\t\t\tif (name == \"row\"){\n\t\t\t\t\tif (row < start.row - inc){\t//delete filter mark if row was deleted\n\t\t\t\t\t\tfilters.splice(i,1);\n\t\t\t\t\t\tcontinue;\n\t\t\t\t\t} else\t\t\t\t\t\t//update mark position if upper row was deleted\n\t\t\t\t\t\tfilters[i][0] = row*1 + inc;\n\t\t\t\t\tif(filter.lastRow)\n\t\t\t\t\t\tfilter.lastRow += inc;\n\t\t\t\t}\n\t\t\t\telse if (name == \"column\"){\n\t\t\t\t\tif (column < start.column - inc){\n\t\t\t\t\t\tfilters.splice(i, 1);\n\t\t\t\t\t\tcontinue;\n\t\t\t\t\t} else \n\t\t\t\t\t\tfilters[i][1] = column*1 + inc;\n\t\t\t\t}\n\t\t\t\tfilter.options = changeRange(filter.options, name, inc, start);\n\t\t\t}\n\t\t}\n\t}\n}\n\nexport function pasteFilter(view, extra, row, col, cutted, translate){\n\tconst filter = extra.filter;\n\n\tfilter.options = changeRange(filter.options, \"row\", translate.row, {column:extra.col, row:extra.row});\n\tfilter.options = changeRange(filter.options, \"column\", translate.column, {column:extra.col, row:extra.row});\n\n\tdelete filter.value; delete filter.handler;\n\tview.setCellFilter(row, col, filter);\n}\n\nexport function getSingleOption(mode, type){\n\tconst c = conditions[mode];\n\tfor (let i=0; i<c.length; i++)\n\t\tif (c[i].id == type) return c[i];\n}\n\nexport function getConditions(name){\n\treturn webix.copy( conditions[name] );\n}\n\nexport function getFilterFunction(mode, value){\n\tconst { includes, condition } = value;\n\tconst opt = getSingleOption(mode, condition.type);\n\tconst handler = opt ? opt.handler : function(){ return true; };\n\n\tif (includes){\n\t\tfor (let i=0; i<includes.length; i++)\n\t\t\tincludes[i] = String(includes[i]);\n\t}\n\n\treturn function(value){\n\t\tif (includes){\n\t\t\treturn includes.indexOf(value) !== -1;\n\t\t} else {\n\t\t\treturn condition.filter === \"\" || handler(value, condition.filter);\n\t\t}\n\t};\n}","import {Dialog} from \"./common\";\nimport * as flt from \"../operations/filter\";\n\nexport const action = \"start-filter\";\n\nexport class DialogBox extends Dialog{\n\topen(action){\n\t\tthis.cell = action.cell;\n\t\tthis.$mode = action.mode;\n\t\tthis.$filter = action.filter;\n\n\t\t// cell not provided\n\t\tif (!this.cell || \n\t\t\t// cell is locked\n\t\t\t(this.view.isCellLocked(this.cell.row, this.cell.column))){\n\t\t\treturn false;\n\t\t}\n\n\t\tif (!this.$dialog){\n\t\t\tthis.$dialog = webix.ui(this.$init());\n\t\t\tthis.view._destroy_with_me.push(this.$dialog);\n\t\t\tthis.$dialog.attachEvent(\"onHide\", () => this.$hide());\n\n\t\t\tconst table = this.view.$$(\"cells\");\n\t\t\ttable.attachEvent(\"onScrollY\", () => this.syncScroll());\n\t\t\ttable.attachEvent(\"onScrollX\", () => this.syncScroll());\n\t\t}\n\n\t\tif (this.$show(this.$filter.value, action.options) === false)\n\t\t\treturn this.close();\n\t\tthis.$dialog.show( this._getTargetNode() );\n\t}\n\t_getTargetNode(){\n\t\tconst table = this.view.$$(\"cells\");\n\t\tconst span = table.getSpan(this.cell.row, this.cell.column);\n\t\treturn span ? table.getSpanNode(this.cell) : table.getItemNode(this.cell);\n\t}\n\t$show(value, options){\n\t\tconst list = this.getList();\n\t\tconst filter = this.getFilter();\n\n\t\tif (filter.config.mode !== this.$mode){\n\t\t\tfilter.define(\"conditions\", this.getConditions(this.$mode));\n\t\t\tfilter.define(\"mode\", this.$mode);\n\t\t}\n\n\t\t// if the filter mode for the current column has been changed - reset the value\n\t\tconst type = value && value.conditions && value.conditions.type;\n\t\tif (type && !flt.getSingleOption(this.$mode, type))\n\t\t\tvalue = \"\";\n\n\t\tlist.clearAll();\n\t\tlist.data.importData(options);\n\n\t\t// filter data has been changed - reset value\n\t\tfilter.config.value = \"\";\n\t\tfilter.setValue( webix.copy(value||{}) );\n\t}\n\t$init(){\n\t\tconst locale = webix.i18n.spreadsheet.labels;\n\t\treturn {\n\t\t\tview:\"popup\",\n\t\t\tcss:\"ssheet_filter\",\n\t\t\tpadding:7,\n\t\t\trelative:\"right\",\n\t\t\tbody:{\n\t\t\t\tmargin:4,\n\t\t\t\trows:[\n\t\t\t\t\t{\n\t\t\t\t\t\tview:\"filter\",\n\t\t\t\t\t\tfield:\"value\",\n\t\t\t\t\t\tmode:\"text\",\n\t\t\t\t\t\tconditions:this.getConditions(\"text\"),\n\t\t\t\t\t\tinputs:[\n\t\t\t\t\t\t\t\"text\",\n\t\t\t\t\t\t\t{ view:\"ssheet-datepicker\", timepicker:true, batch:\"datepicker\", on:{\n\t\t\t\t\t\t\t\tonChange:() => this.getFilter().applyFilter()\n\t\t\t\t\t\t\t}},\n\t\t\t\t\t\t\t{ view:\"ssheet-daterangepicker\", timepicker:true, batch:\"daterangepicker\", on:{\n\t\t\t\t\t\t\t\tonChange:() => this.getFilter().applyFilter()\n\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t],\n\t\t\t\t\t\ttemplate:function(obj){\n\t\t\t\t\t\t\treturn obj.$value || obj.value;\n\t\t\t\t\t\t}\n\t\t\t\t\t},\n\t\t\t\t\t{ cols:[\n\t\t\t\t\t\t{ },\n\t\t\t\t\t\t{ view:\"button\", label:locale[\"cancel\"], autowidth:true, css:\"webix_transparent\", on:{\n\t\t\t\t\t\t\t\"onItemClick\": () => this.close()\n\t\t\t\t\t\t}},\n\t\t\t\t\t\t{ view:\"button\", label:locale[\"apply\"], autowidth:true, css:\"webix_secondary\", on:{\n\t\t\t\t\t\t\t\"onItemClick\": () => this.applyFilter()\n\t\t\t\t\t\t}},\n\t\t\t\t\t]}\n\t\t\t\t]\n\t\t\t}\n\t\t};\n\t}\n\tapplyFilter(){\n\t\tconst filter = this.getFilter();\n\t\tconst oldValue = this.$filter.value;\n\t\tconst value = this.$filter.value = filter.getValue();\n\t\tthis.$filter.handler = flt.getFilterFunction(this.$mode, value);\n\n\t\tthis.view.filterSpreadSheet();\n\t\tthis.view.callEvent(\"onAction\", [\"apply-filter\", { row:this.cell.row, column:this.cell.column, value:oldValue, newValue:value }]);\n\t\tthis.setCellStyle(this.cell.row, this.cell.column, \"ss_filter_active\", flt.isValueActive(value));\n\n\t\tthis.close();\n\t}\n\tsetCellStyle(row, column, css, add){\n\t\tconst table = this.view.$$(\"cells\");\n\t\tconst span = this.getSpan(table, row, column);\n\n\t\tif (span){\n\t\t\tif (add){\n\t\t\t\tif (span[3].indexOf(css) == -1)\n\t\t\t\t\tspan[3] += \" \" + css;\n\t\t\t} else {\n\t\t\t\tspan[3] = span[3].replace(\" \" + css, \"\");\n\t\t\t}\n\t\t}\n\t\ttable[add?\"addCellCss\":\"removeCellCss\"](row, column, css);\n\t}\n\tgetSpan(table, row, column){\n\t\tlet item = table.getSpan()[row];\n\t\tif (item)\n\t\t\treturn item[column];\n\t}\n\tgetList(){\n\t\treturn this.getFilter().getChildViews()[2];\n\t}\n\tgetFilter(){\n\t\treturn this.$dialog.getBody().getChildViews()[0];\n\t}\n\tsyncScroll(){\n\t\tif (this.$dialog.isVisible()){\n\t\t\tconst node = this._getTargetNode();\n\t\t\tconst table = this.view.$$(\"cells\");\n\n\t\t\tlet isHidden = false;\n\t\t\tif (node){\n\t\t\t\tconst nodeOffset = webix.html.offset( node );\n\t\t\t\tconst tableOffset = webix.html.offset( table.$view.getElementsByClassName(\"webix_ss_body\")[0] );\n\t\t\t\tconst ydiff = nodeOffset.y - tableOffset.y;\n\t\t\t\tconst xdiff = nodeOffset.x - tableOffset.x + nodeOffset.width;\n\n\t\t\t\tisHidden = (ydiff < 0 || ydiff+nodeOffset.height > tableOffset.height || \n\t\t\t\t\txdiff < 0 || xdiff-nodeOffset.width > tableOffset.width - webix.env.scrollSize);\n\t\t\t}\n\t\t\tif (!node || isHidden)\n\t\t\t\tthis.$dialog.show({x:-9999, y:-9999});\n\t\t\telse \n\t\t\t\tthis.$dialog.show(node);\n\t\t}\n\t}\n\tgetConditions(name){\n\t\tconst locale = webix.i18n.filter;\n\t\tconst conditions = flt.getConditions(name);\n\n\t\tfor (let i=0; i<conditions.length; i++)\n\t\t\tif (conditions[i].id)\n\t\t\t\tconditions[i].value = locale[conditions[i].id];\n\n\t\treturn conditions;\n\t}\n}","import {Dialog} from \"./common\";\nimport {getFormat} from \"../operations/styles\";\nimport * as fmt from \"../operations/formats\";\nimport group from \"../operations/undo_group\";\n\nexport const action = \"custom\";\n\nexport class DialogBox extends Dialog{\n\t$show(){\n\t\tthis.form = this.$dialog.$$(\"form\");\n\t\tthis.list = this.$dialog.$$(\"list\");\n\t\tthis.preview = this.$dialog.$$(\"preview\");\n\n\t\tthis.cell = this.view.getSelectedId(true);\n\t\tif (!this.cell.length)\n\t\t\treturn false;\n\n\t\tthis.fillForm(this.view);\n\n\t\tthis.view.$handleSelection = function(){\n\t\t\treturn false;\n\t\t};\n\t}\n\t$hide(){\n\t\tthis.view.$handleSelection = null;\n\t}\n\t$init(){\n\t\tconst i18n = webix.i18n.spreadsheet;\n\t\tconst labelsLocale = i18n.labels;\n\t\tconst formatsLocale = i18n.formats;\n\n\t\tconst docsLink = \"https://webix-guides.gitbook.io/spreadsheet-user-guide/formatting_numbers#custom-number-format\";\n\t\tconst delimiters = fmt.getDelimiters(\"int\");\n\n\t\tconst commonConfig = [\n\t\t\t{\n\t\t\t\tname:\"zeros\",\n\t\t\t\tview:\"counter\",\n\t\t\t\tcss:\"webix_ssheet_counter\",\n\t\t\t\tlabel:labelsLocale[\"decimal-places\"],\n\t\t\t\tvalue:0,\n\t\t\t\tbatch:\"common\"\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"separator\",\n\t\t\t\tview:\"checkbox\",\n\t\t\t\tlabel:labelsLocale[\"separator\"],\n\t\t\t\tbatch:\"common\"\n\t\t\t},\n\t\t\t{\n\t\t\t\tview:\"richselect\",\n\t\t\t\tname:\"symbol\",\n\t\t\t\tlabel:labelsLocale[\"currency-symbol\"],\n\t\t\t\toptions:fmt.currencies,\n\t\t\t\tbatch:\"common\"\n\t\t\t},\n\t\t\t{\n\t\t\t\tview:\"formlist\",\n\t\t\t\tlabel:labelsLocale[\"negative\"],\n\t\t\t\theight: 160,\n\t\t\t\tname:\"negative\",\n\t\t\t\tbatch:\"common\",\n\t\t\t\tcss:\"webix_ssheet_format_negative\",\n\t\t\t\ttemplate: obj => {\n\t\t\t\t\tif(this.list){\n\t\t\t\t\t\tlet format = this.getFormat(obj.id);\n\t\t\t\t\t\tformat = fmt.format2code(format.fmt, format.delimiters);\n\t\t\t\t\t\tconst style = {css:\"\"};\n\t\t\t\t\t\tconst value = format(-1234.56789, style);\n\n\t\t\t\t\t\treturn \"<span class='\"+style.css+\"'>\"+value+\"</span>\";\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\tdata:[{id:1}, {id:2}, {id:3}, {id:4}]\n\t\t\t}\n\t\t];\n\n\t\tconst customConfig = [\n\t\t\t{\n\t\t\t\tview:\"text\",\n\t\t\t\tlabel: labelsLocale[\"format-pattern\"],\n\t\t\t\tname:\"format\",\n\t\t\t\tlabelPosition:\"top\",\n\t\t\t\tbatch:\"custom\",\n\t\t\t\tplaceholder:\"[>100]0\"+delimiters.groupSign+\"000\"+delimiters.decimalSign+\"00;[>0]None\"\n\t\t\t},\n\t\t\t{\n\t\t\t\tid: \"docs\",\n\t\t\t\ttemplate: \"<a href='\"+docsLink+\"' target='_blank' class = 'docs'>\"+labelsLocale[\"format-docs\"]+\"</a>\",\n\t\t\t\tborderless:true,\n\t\t\t\tbatch:\"custom\"\n\t\t\t}\n\t\t];\n\n\t\tconst dateConfig = [\n\t\t\t{\n\t\t\t\tname:\"date\",\n\t\t\t\tbatch:\"date\",\n\t\t\t\tview:\"formlist\",\n\t\t\t\tlabelWidth: 90,\n\t\t\t\theight: 160,\n\t\t\t\tlabel:labelsLocale[\"date-format\"],\n\t\t\t\tcss:\"webix_ssheet_format_date\",\n\t\t\t\ttemplate: obj => fmt.format2code(obj.value, delimiters)(45000),\n\t\t\t\tdata:[\n\t\t\t\t\tformatsLocale.dateFormat,\n\t\t\t\t\tformatsLocale.timeFormat,\n\t\t\t\t\tformatsLocale.fullDateFormat,\n\t\t\t\t\tformatsLocale.longDateFormat\n\t\t\t\t]\n\t\t\t}\n\t\t];\n\n\t\treturn {\n\t\t\tview: \"ssheet-dialog\",\n\t\t\tposition:\"center\",\n\t\t\twidth:460,\n\t\t\thead: labelsLocale[\"format-title\"],\n\t\t\tmove: true,\n\t\t\tbody:{\n\t\t\t\tpadding:0,\n\t\t\t\tcols:[\n\t\t\t\t\t{\n\t\t\t\t\t\tview:\"list\",\n\t\t\t\t\t\tid:\"list\",\n\t\t\t\t\t\tcss:\"webix_ssheet_format_type\",\n\t\t\t\t\t\twidth:120,\n\t\t\t\t\t\tscroll:false,\n\t\t\t\t\t\tdata:this.getFormats(),\n\t\t\t\t\t\tselect:true,\n\t\t\t\t\t\ton:{\n\t\t\t\t\t\t\tonSelectChange: (id)=>{\n\t\t\t\t\t\t\t\tthis.updateForm();\n\t\t\t\t\t\t\t\tswitch(id[0]){\n\t\t\t\t\t\t\t\t\tcase \"custom\":\n\t\t\t\t\t\t\t\t\tcase \"date\":\n\t\t\t\t\t\t\t\t\t\tthis.form.showBatch(id[0]);\n\t\t\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t\t\tdefault:{\n\t\t\t\t\t\t\t\t\t\tconst elements = this.form.elements;\n\t\t\t\t\t\t\t\t\t\tthis.form.showBatch(\"common\");\n\n\t\t\t\t\t\t\t\t\t\telements.separator[ id[0] == \"percent\" ? \"hide\" : \"show\" ]();\n\t\t\t\t\t\t\t\t\t\telements.symbol[ id[0] == \"price\" ? \"show\" : \"hide\" ]();\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tview:\"form\",\n\t\t\t\t\t\tid:\"form\",\n\t\t\t\t\t\theight:340,\n\t\t\t\t\t\tpaddingY:0,\n\t\t\t\t\t\tpaddingX:20,\n\t\t\t\t\t\telements:[\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tid: \"preview\",\n\t\t\t\t\t\t\t\ttemplate: function(obj){\n\t\t\t\t\t\t\t\t\tif(obj.value == i18n.table[\"format-error\"])\n\t\t\t\t\t\t\t\t\t\treturn obj.value;\n\t\t\t\t\t\t\t\t\treturn \"<span class ='\"+obj.css+\"'>\"+obj.value+\"</span>\";\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\tcss: \"webix_ssheet_format_preview\",\n\t\t\t\t\t\t\t\tautoheight: true,\n\t\t\t\t\t\t\t\tborderless:true\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t].concat(commonConfig, customConfig, dateConfig),\n\t\t\t\t\t\telementsConfig: {\n\t\t\t\t\t\t\tlabelWidth: 140\n\t\t\t\t\t\t},\n\t\t\t\t\t\ton: {\n\t\t\t\t\t\t\tonChange: () => this.updateForm()\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t]\n\t\t\t},\n\t\t\ton:{\n\t\t\t\tonSaveClick: () => this.okClick(),\n\t\t\t\tonCancelClick: () => this.closeWin()\n\t\t\t}\n\t\t};\n\t}\n\tokClick(){\n\t\tlet type = this.list.getSelectedId();\n\t\tlet values = (type == \"custom\")?{format:this.form.getValues().format}:this.form.getValues();\n\t\tvalues.type = type;\n\n\t\tgroup.set(()=>{\n\t\t\tfor (let i = 0; i < this.cell.length; i++)\n\t\t\t\tfmt.addFormat(this.view, this.cell[i].row, this.cell[i].column, values.format, values);\n\t\t});\n\n\t\tthis.view.$$(\"cells\").refresh();\n\t\tthis.closeWin();\n\t}\n\tcloseWin(){\n\t\tconst format = getFormat(this.view, this.cell[0].row, this.cell[0].column);\n\t\tconst name = format || \"common\";\n\n\t\t//default format\n\t\tif(!fmt.isCustom(name))\n\t\t\tthis.view.callEvent(\"onCommand\", [{id:\"toolbar-update\", name:\"format\", value:name}]);\n\t\tthis.close();\n\t}\n\tgetFormat(negative){\n\t\tconst type = this.list.getSelectedId();\n\t\tlet values = this.form.getValues();\n\n\t\tvalues.negative = negative || values.negative;\n\t\tif(type != \"custom\"){\n\t\t\tif(type != \"date\")\n\t\t\t\tvalues.date = \"\";\n\n\t\t\tvalues = fmt.formToValues(type, values);\n\t\t\treturn {\n\t\t\t\tfmt: fmt.serializeFormat(values),\n\t\t\t\tdelimiters:fmt.getDelimiters(type)\n\t\t\t};\n\t\t}\n\t\telse\n\t\t\treturn {\n\t\t\t\tfmt: values.format,\n\t\t\t\tdelimiters: fmt.getDelimiters(type)\n\t\t\t};\n\t}\n\tfillForm(view){\n\t\tconst locale = webix.i18n.spreadsheet;\n\t\tconst format = getFormat(view, this.cell[0].row, this.cell[0].column);\n\t\tlet values = { zeros:0, separator: 0, negative: 1, date: locale.formats.dateFormat, symbol:fmt.currencies[0].value, format: \"\"};\n\t\tlet type;\n\n\t\tlet name = format || \"\";\n\n\t\tvalues.format = fmt.getFormatSource(name || \"price\");\n\n\t\tif(!name)\n\t\t\ttype = name = \"price\";\n\t\telse if(name == \"string\")\n\t\t\ttype = name = \"custom\";\n\t\telse\n\t\t\ttype = fmt.formatHelpers[name].values.type;\n\n\t\tif(type != \"custom\")\n\t\t\twebix.extend(values, fmt.formatHelpers[name].values, true);\n\n\t\tconst item = this.view.$$(\"cells\").getItem(this.cell[0].row);\n\t\tconst col = this.cell[0].column;\n\n\t\tthis.value = webix.isUndefined(item[col]) ? \"\" : item[col];\n\n\t\tthis.form.setValues(values);\n\t\tthis.list.select(type);\n\t\tthis.updateForm();\n\t}\n\tupdateForm(){\n\t\tconst form = this.form.elements;\n\t\tconst format = this.getFormat();\n\t\tlet value = this.value;\n\n\t\tconst isText = value === \"\" || isNaN(value);\n\n\t\tif(fmt.checkFormat(format, \"date\") && (isText || fmt.isDateInvalid(value)))\n\t\t\tvalue = 45000;\n\t\telse if(isText && !fmt.checkFormat(format, \"string\"))\n\t\t\tvalue = 1234.56789;\n\n\t\tlet style = {css:\"\"};\n\t\tvalue = fmt.format2code(format.fmt, format.delimiters)(value, style);\n\n\t\t//preview values\n\t\tthis.preview.parse({value:value, css:style.css});\n\t\tform.negative.refresh();\n\t\tform.date.refresh();\n\n\t\t//set new format string\n\t\tform.format.setValue(format.fmt);\n\t}\n\tgetFormats(){\n\t\tconst locale = webix.i18n.spreadsheet.labels;\n\t\treturn [\n\t\t\t{id: \"price\", value: locale.currency},\n\t\t\t{id: \"int\", value: locale.number},\n\t\t\t{id: \"percent\", value: locale.percent},\n\t\t\t{id: \"date\", value: locale.date},\n\t\t\t{id: \"custom\", value: locale[\"custom-format\"]}\n\t\t];\n\t}\n}","import {Dialog} from \"./common\";\nimport {getJsDateFromExcel, getExcelDateFromJs} from \"../mathematics/methods\";\nimport {isDateInvalid} from \"../operations/formats\";\nimport {getDateEditFormat} from \"../operations/formats\";\nimport {getType} from \"../operations/types\";\nimport {find} from \"../helpers/array\";\n\nexport const action = \"conditional-format\";\n\nfunction getConditionStyle(data){\n\treturn data.map(item => {\n\t\titem.id = item.css;\n\t\treturn item;\n\t});\n}\n\nexport class DialogBox extends Dialog{\n\t_rulesToArr(){\n\t\tconst conditions = this.view.conditions.handlers;\n\t\treturn [\n\t\t\t{\n\t\t\t\tvalue: webix.i18n.spreadsheet.labels[\"conditional-common\"],\n\t\t\t\tdisabled:true,\n\t\t\t\t$css:\"webix_ssheet_cformats_type\"\n\t\t\t},\n\t\t\t...conditions.date, //number rules equal to date\n\t\t\t{\n\t\t\t\tvalue: webix.i18n.spreadsheet.labels[\"conditional-text\"],\n\t\t\t\tdisabled:true,\n\t\t\t\t$css:\"webix_ssheet_cformats_type\"\n\t\t\t},\n\t\t\t...conditions.text\n\t\t].map(rule => {\n\t\t\tif(!rule.value)\n\t\t\t\trule.value = webix.i18n.filter[ rule.id ];\n\t\t\treturn rule;\n\t\t});\n\t}\n\n\t_getCondition() {\n\t\tconst view = this.view;\n\t\tconst values = this._getDatalayout().getValue();\n\n\t\tconst data = [];\n\t\tvalues.forEach(v => {\n\t\t\tconst item = [v.condition];\n\t\t\tif (v.condition != \"between\" && v.condition != \"notBetween\")\n\t\t\t\titem.push(this._normalizeValue(v.value, v.condition));\n\t\t\telse\n\t\t\t\titem.push([\n\t\t\t\t\tthis._normalizeValue(v.value, v.condition),\n\t\t\t\t\tthis._normalizeValue(v.value2, v.condition)\n\t\t\t\t]);\n\n\t\t\titem.push(v.style);\n\t\t\tfor (let i=0; i<item.length; i++){\n\t\t\t\tif (item[i] === \"\" || (webix.isArray(item[i]) && item[i].indexOf(\"\") != -1))\n\t\t\t\t\treturn false;\n\t\t\t}\n\t\t\tdata.push(item);\n\t\t});\n\n\t\tview.callEvent(\"onConditionSet\", [data]);\n\t}\n\n\t_safeInt(a){\n\t\tconst num = parseFloat(a);\n\t\tif (num == a) return num;\n\t\treturn a;\n\t}\n\n\t_setCondition() {\n\t\tconst view = this.view;\n\t\tconst collection = view.conditions.get(this.cell.row, this.cell.column);\n\n\t\tconst data = [];\n\t\tif (collection) {\n\t\t\tcollection.forEach(item => {\n\t\t\t\tconst values = {};\n\t\t\t\tvalues.condition = item[0];\n\t\t\t\tif (webix.isArray(item[1])) {\n\t\t\t\t\tvalues.value = this._formatValue(item[1][0], values.condition);\n\t\t\t\t\tvalues.value2 = this._formatValue(item[1][1], values.condition);\n\t\t\t\t} else\n\t\t\t\t\tvalues.value = this._formatValue(item[1], values.condition);\n\n\t\t\t\tvalues.style = item[2];\n\t\t\t\tdata.push(values);\n\t\t\t});\n\t\t}\n\n\t\twhile (data.length < 3)\n\t\t\tdata.push({ });\n\n\t\tthis._getDatalayout().setValue(data);\n\t}\n\n\t_getDatalayout(){\n\t\treturn this.$dialog.getBody().getChildViews()[0].getChildViews()[1].getBody();\n\t}\n\n\t_formatValue(value, condition){\n\t\tif(!(condition && this._isNotDateRule(condition))){\n\t\t\tif(this.editFormat && value !== \"\" && value[0] != \"=\"){\n\t\t\t\tvalue = getJsDateFromExcel(value);\n\t\t\t\treturn this.editFormat(value);\n\t\t\t}\n\t\t}\n\t\treturn value.toString();\n\t}\n\n\t_normalizeValue(value, condition){\n\t\tif(!this._isNotDateRule(condition)){\n\t\t\tif(this.editFormat){\n\t\t\t\tif(isNaN(value)){\n\t\t\t\t\tif(value[0] != \"=\"){\n\t\t\t\t\t\tconst parser = webix.Date.strToDate( webix.i18n.spreadsheet.formats.parseDateTime );\n\t\t\t\t\t\tvalue = parser(value);\n\t\t\t\t\t\tvalue = isNaN(value) ? \"\" : getExcelDateFromJs(value);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t\tvalue = isDateInvalid(value) ? \"\" : value;\n\t\t\t}\n\t\t\telse\n\t\t\t\tvalue = this._safeInt(value, 10);\n\t\t}\n\t\treturn value;\n\t}\n\n\t_isNotDateRule(condition){\n\t\tif(condition == \"equal\" || condition == \"notEqual\")\n\t\t\treturn false;\n\t\treturn find(this.view.conditions.handlers.text, obj => obj.id == condition);\n\t}\n\n\tokClick(){\n\t\tthis._getCondition();\n\t\tthis.close();\n\t}\n\n\t$show(){\n\t\tthis.cell = this.view.getSelectedId();\n\t\tif(!this.cell)\n\t\t\treturn false;\n\n\t\tconst type = getType(this.view, this.cell.row, this.cell.column);\n\n\t\tif(type == \"date\")\n\t\t\tthis.editFormat = getDateEditFormat(this.view, this.cell.row, this.cell.column);\n\n\t\tthis.$dialog.queryView(\"text\", \"all\").forEach(view => {\n\t\t\tview.define({placeholder: type == \"date\" ? this._formatValue(45000) : \"\"});\n\t\t\tview.refresh();\n\t\t});\n\n\t\tthis.view.$handleSelection = (st, end, a, b)=>{\n\t\t\tif (this.activeValue && a == b){\n\t\t\t\tthis.activeValue.setValue(\"=\"+a);\n\t\t\t}\n\t\t\treturn false;\n\t\t};\n\t\tthis._setCondition();\n\t}\n\n\t$hide(){\n\t\tthis.view.$handleSelection = null;\n\t\tdelete this.editFormat;\n\t\tthis._getDatalayout().clearAll();\n\t}\n\n\tgetRows(data){\n\t\tconst dialog = this;\n\t\treturn {\n\t\t\tview: \"form\",\n\t\t\tpadding: 0,\n\t\t\tborderless: true,\n\t\t\tcss:\"webix_ssheet_cformats\",\n\t\t\telements: [{\n\t\t\t\tmargin: 10,\n\t\t\t\tpadding: { right: 4 },\n\t\t\t\tcols: [\n\t\t\t\t\t{\n\t\t\t\t\t\tview:\"richselect\",\n\t\t\t\t\t\tname: \"style\",\n\t\t\t\t\t\twidth:120,\n\t\t\t\t\t\tplaceholder: webix.i18n.spreadsheet.labels[\"conditional-style\"],\n\t\t\t\t\t\tcss: \"webix_ssheet_cformat_select\",\n\t\t\t\t\t\tsuggest: {\n\t\t\t\t\t\t\tpadding:0,\n\t\t\t\t\t\t\tborderless: true,\n\t\t\t\t\t\t\tcss: \"webix_ssheet_cformat_list\",\n\t\t\t\t\t\t\tbody: {\n\t\t\t\t\t\t\t\ttemplate(obj) {\n\t\t\t\t\t\t\t\t\tconst css = \"webix_ssheet_cformat \"+obj.css;\n\t\t\t\t\t\t\t\t\treturn `<div class=\"${css}\">${obj.name}</div>`;\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\tdata: data\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tview:\"richselect\",\n\t\t\t\t\t\twidth: 150,\n\t\t\t\t\t\tname: \"condition\",\n\t\t\t\t\t\tplaceholder: webix.i18n.spreadsheet.labels[\"conditional-operator\"],\n\t\t\t\t\t\ton: {\n\t\t\t\t\t\t\tonChange: function(newv) {\n\t\t\t\t\t\t\t\tconst elements = this.getFormView().elements;\n\n\t\t\t\t\t\t\t\tif (dialog.editFormat){\n\t\t\t\t\t\t\t\t\tif (dialog._isNotDateRule(newv))\n\t\t\t\t\t\t\t\t\t\telements.value.define({placeholder: \"\"});\n\t\t\t\t\t\t\t\t\telse {\n\t\t\t\t\t\t\t\t\t\tconst value = dialog._normalizeValue(elements.value.getValue(), newv);\n\t\t\t\t\t\t\t\t\t\telements.value.setValue(dialog._formatValue(value, newv));\n\t\t\t\t\t\t\t\t\t\telements.value.define({placeholder: dialog._formatValue(45000)});\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\telements.value.refresh();\n\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\tif (newv == \"between\" || newv == \"notBetween\")\n\t\t\t\t\t\t\t\t\telements.value2.show();\n\t\t\t\t\t\t\t\telse\n\t\t\t\t\t\t\t\t\telements.value2.hide();\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t},\n\t\t\t\t\t\tsuggest:{\n\t\t\t\t\t\t\tview: \"ssheet-form-suggest\",\n\t\t\t\t\t\t\tbody:{\n\t\t\t\t\t\t\t\tdata: this._rulesToArr()\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tcols: [\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tview: \"text\",\n\t\t\t\t\t\t\t\ton: {\n\t\t\t\t\t\t\t\t\tonFocus: (current_view)=>{\n\t\t\t\t\t\t\t\t\t\tthis.activeValue = current_view;\n\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\tonBlur: (current_view)=>{\n\t\t\t\t\t\t\t\t\t\tlet value = current_view.getValue();\n\t\t\t\t\t\t\t\t\t\tif(value !== \"\"){\n\t\t\t\t\t\t\t\t\t\t\tconst elements = current_view.getFormView().elements;\n\t\t\t\t\t\t\t\t\t\t\tconst condition = elements.condition.getValue();\n\t\t\t\t\t\t\t\t\t\t\tvalue = this._normalizeValue(value, condition);\n\t\t\t\t\t\t\t\t\t\t\tcurrent_view.setValue(this._formatValue(value, condition));\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\tname: \"value\"\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tview: \"text\",\n\t\t\t\t\t\t\t\tname: \"value2\",\n\t\t\t\t\t\t\t\ton: {\n\t\t\t\t\t\t\t\t\tonFocus: (current_view)=>{\n\t\t\t\t\t\t\t\t\t\tthis.activeValue = current_view;\n\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\tonBlur: (current_view)=>{\n\t\t\t\t\t\t\t\t\t\tlet value = current_view.getValue();\n\t\t\t\t\t\t\t\t\t\tif(value !== \"\"){\n\t\t\t\t\t\t\t\t\t\t\tconst elements = current_view.getFormView().elements;\n\t\t\t\t\t\t\t\t\t\t\tconst condition = elements.condition.getValue();\n\t\t\t\t\t\t\t\t\t\t\tvalue = this._normalizeValue(value, condition);\n\t\t\t\t\t\t\t\t\t\t\tcurrent_view.setValue(this._formatValue(value, condition));\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\thidden: true\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t]\n\t\t\t\t\t},\n\t\t\t\t\t{ view:\"icon\", css:\"webix_ssheet_cformat_icon\", icon:\"wxi-trash\", click: vid => {\n\t\t\t\t\t\tconst form = webix.$$(vid).getFormView();\n\t\t\t\t\t\tconst dlayout = this._getDatalayout();\n\t\t\t\t\t\tdlayout.getValue();\t\t\t// save local changes before rendering\n\n\t\t\t\t\t\tconst index = dlayout.getChildViews().indexOf(form);\n\t\t\t\t\t\tdlayout.remove(dlayout.getIdByIndex(index));\n\n\t\t\t\t\t\tif (dlayout.count() < 3) dlayout.add({ });\n\t\t\t\t\t}}\n\t\t\t\t]}\n\t\t\t]};\n\t}\n\n\t$init(){\n\t\tconst margin = webix.skin.$active.layoutMargin.form;\n\t\treturn {\n\t\t\tview: \"ssheet-dialog\",\n\t\t\thead: webix.i18n.spreadsheet.labels[\"conditional-format\"],\n\t\t\tposition: \"center\",\n\t\t\twidth: 770,\n\t\t\tmove: true,\n\t\t\tmargin,\n\t\t\tbody: { margin:0, rows:[\n\t\t\t\t{\n\t\t\t\t\theight: 36,\n\t\t\t\t\tpadding: { left: 12 },\n\t\t\t\t\tcols: [\n\t\t\t\t\t\t{ view:\"label\", width: 131, label: webix.i18n.spreadsheet.labels.display },\n\t\t\t\t\t\t{ view:\"label\", width: 161, label: webix.i18n.spreadsheet.labels.condition },\n\t\t\t\t\t\t{ view:\"label\", label: webix.i18n.spreadsheet.labels.value },\n\t\t\t\t\t\t{ view:\"icon\", css:\"webix_ssheet_cformat_icon\", icon:\"wxi-plus-circle\",\n\t\t\t\t\t\t\tclick: () => {\n\t\t\t\t\t\t\t\tconst dlayout = this._getDatalayout();\n\t\t\t\t\t\t\t\tdlayout.getValue();\t\t\t// save local changes before rendering\n\t\t\t\t\t\t\t\tdlayout.add({ });\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t},\n\t\t\t\t\t\t{ width: 4 + webix.env.scrollSize }\n\t\t\t\t\t]\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tview: \"scrollview\",\n\t\t\t\t\tmaxHeight: webix.skin.$active.inputHeight * 3 + 4,\n\t\t\t\t\tborderless: true,\n\t\t\t\t\tscroll: \"y\",\n\t\t\t\t\tbody: {\n\t\t\t\t\t\tview: \"datalayout\",\n\t\t\t\t\t\tpadding: 0,\n\t\t\t\t\t\tborderless: true,\n\t\t\t\t\t\trows: [ this.getRows(getConditionStyle(this.view.config.conditionStyle)) ]\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t]},\n\t\t\ton: {\n\t\t\t\tonSaveClick: () => this.okClick(),\n\t\t\t\tonCancelClick: () => this.close()\n\t\t\t}\n\t\t};\n\t}\n}","import {Dialog} from \"./common\";\n\nexport const action = \"excel-export\";\n\nexport class DialogBox extends Dialog{\n\t$show(box, form){\n\t\tthis.view.$handleSelection = function(){\n\t\t\treturn false;\n\t\t};\n\n\t\tform.elements.sheets.setValue(this.getSheets());\n\t\tform.elements.filename.setValue(\"Data\");\n\t\tform.elements.filename.getInputNode().select();\n\t}\n\t$hide(){\n\t\tthis.view.$handleSelection = null;\n\t}\n\t$init(){\n\t\treturn {\n\t\t\tview: \"ssheet-dialog\",\n\t\t\thead: webix.i18n.spreadsheet.labels[\"export-title\"],\n\t\t\tmove: true,\n\t\t\tposition: \"center\",\n\t\t\tbody:{\n\t\t\t\tview:\"form\",\n\t\t\t\telements:[\n\t\t\t\t\t{ view:\"text\", name:\"filename\",  placeholder:webix.i18n.spreadsheet.labels[\"export-name\"] },\n\t\t\t\t\t{ view:\"multicheckbox\", name:\"sheets\", css:\"webix_ssheet_multicheckbox\" }\n\t\t\t\t]\n\t\t\t},\n\t\t\ton:{\n\t\t\t\tonSaveClick: () => this.okClick(),\n\t\t\t\tonCancelClick: () => this.close()\n\t\t\t}\n\t\t};\n\t}\n\tgetSheets(){\n\t\tconst view = this.view;\n\t\tconst sheets = view._sheets;\n\t\tlet value = [];\n\n\t\tfor(let i = 0; i < sheets.length; i++){\n\t\t\tconst state = sheets[i].state;\n\t\t\tif(state == \"veryHidden\")\n\t\t\t\tcontinue;\n\n\t\t\tvalue.push({\n\t\t\t\tname: sheets[i].name,\n\t\t\t\thidden: state == \"hidden\",\n\t\t\t\tactive: view._activeSheet === sheets[i].name ? 1 : 0\n\t\t\t});\n\t\t}\n\n\t\treturn value;\n\t}\n\tokClick(){\n\t\tconst values = this.$dialog.getBody().getValues();\n\t\twebix.toExcel(this.view, values);\n\t\tthis.close();\n\t}\n}","import {Dialog} from \"./common\";\n\nexport const action = \"add-link\";\n\nexport class DialogBox extends Dialog{\n\t$show(box, form){\n\t\tconst cell = this.view.getSelectedId();\n\t\tif(!cell)\n\t\t\treturn false;\n\t\tif (!this.restoreValue(form))\n\t\t\tform.clear();\n\t\tform.elements.name.focus();\n\n\t\tthis.view.$handleSelection = (st, end, a)=>{\n\t\t\tform.elements.url.setValue(\"#\"+a);\n\t\t\treturn false;\n\t\t};\n\t}\n\t$hide(){\n\t\tthis.view.$handleSelection = null;\n\t}\n\trestoreValue(form){\n\t\tconst cell = this.view.getSelectedId();\n\t\tif (cell){\n\t\t\tconst value = this.view.getCellValue(cell.row, cell.column);\n\t\t\tif (value && typeof value == \"string\" && value.indexOf(\"=HYPERLINK\") === 0){\n\t\t\t\tconst parts = value.split(\"\\\"\");\n\t\t\t\tform.setValues({\n\t\t\t\t\tname: (parts[3] || \"\"),\n\t\t\t\t\turl: (parts[1] || \"\")\n\t\t\t\t});\n\t\t\t\treturn true;\n\t\t\t}\n\t\t}\n\t\treturn false;\n\t}\n\t$init(){\n\t\treturn {\n\t\t\tview: \"ssheet-dialog\",\n\t\t\thead: webix.i18n.spreadsheet.labels[\"link-title\"],\n\t\t\tmove: true,\n\t\t\tposition: \"center\",\n\t\t\tbody:{\n\t\t\t\tview:\"form\",\n\t\t\t\telements:[\n\t\t\t\t\t{ view:\"text\", name:\"name\",  placeholder:webix.i18n.spreadsheet.labels[\"link-name\"]},\n\t\t\t\t\t{ view:\"text\", name:\"url\",  placeholder:webix.i18n.spreadsheet.labels[\"link-url\"]}\n\t\t\t\t]\n\t\t\t},\n\t\t\ton:{\n\t\t\t\tonSaveClick: () => this.okClick(),\n\t\t\t\tonCancelClick: () => this.close()\n\t\t\t}\n\t\t};\n\t}\n\tokClick(){\n\t\tconst cell = this.view.getSelectedId();\n\t\tconst data = this.$dialog.getBody().getValues();\n\n\t\tlet text = \"\";\n\t\tif (data.url){\n\t\t\tdata.name = data.name || data.url;\n\t\t\tif (!/^(#|(https?:\\/\\/))/i.test(data.url))\n\t\t\t\tdata.url = \"http://\" + data.url;\n\t\t\ttext = `=HYPERLINK(\"${data.url}\",\"${data.name}\")`;\n\t\t}\n\n\t\tthis.view.setCellValue(cell.row, cell.column, text);\n\t\tthis.view.refresh();\n\t\tthis.close();\n\t}\n}","import {isVisible} from \"../sheets\";\n\nexport function print(view, options, htmlOnly){\n\tconst views = [];\n\tconst order = {};\n\tconst active = view._activeSheet;\n\n\tconst html = _buildHtml(view, options, active, views, order);\n\tview.showSheet(active);\n\n\tconst promise = webix.promise.defer();\n\twebix.promise.all(views).then(res =>{\n\t\tconst keys = Object.keys(order).sort( view.$$(\"cells\").data.sorting.as.int );\n\t\tfor (let i = keys.length - 1; i >= 0; i--) {\n\t\t\tconst index = keys[i];\n\t\t\thtml.insertBefore(res[index], html.childNodes[ order[index] ]);\n\t\t}\n\n\t\tif(htmlOnly)\n\t\t\treturn promise.resolve(html);\n\n\t\twebix.html.insertBefore(html, options.docFooter, document.body);\n\t\twindow.print();\n\t\t_cleanHtml(view, html);\n\n\t\tpromise.resolve();\n\t});\n\treturn promise;\n}\n\nexport function init(view){\n\tview.$customPrint = function(options, htmlOnly){\n\t\treturn print(view, options, htmlOnly);\n\t};\n\n\tview._printBorders = {\n\t\tpaper: webix.env.printSizes.find(s => s.id == \"a4\") ? \"a4\" : webix.env.printSizes[0].id,\n\t\tfit: \"page\",\n\t\tmode: \"landscape\",\n\t\tmargin: 1,\n\t\tsheetnames: 1\n\t};\n\n\tview.attachEvent(\"onUndo\", (action, row, column, value) => {\n\t\tif (action == \"print-borders\")\n\t\t\tview.showPrintBorders(value);\n\t});\n\n\tview.attachEvent(\"onAfterSheetShow\", ()=> showBorders(view, true));\n\tview.attachEvent(\"onChange\", ()=> showBorders(view, true));\n}\n\nfunction _cleanHtml(view, html){\n\twebix.html.remove(html);\n\n\tview._sheets.forEach((sheet, i) => {\n\t\twebix.html.removeStyle(\".wss_\"+view.$index+\"_\"+i);\n\t});\n}\nfunction _buildHtml(view, options, active, views, order){\n\tlet doc = webix.html.create(\"div\", { \"class\":\"webix_ssheet_print\"});\n\n\toptions.xCorrection = 1;\n\toptions.header = options.header || false;\n\toptions.trim = webix.isUndefined(options.trim) ? true : options.trim;\n\toptions.sheetnames = webix.isUndefined(options.sheetnames) ? true : options.sheetnames;\n\tconst baseIndex = view.$index;\n\tconst pageSize = getPageSize(options);\n\n\tlet sheets = options.sheets;\n\t\n\t// backward compatibility, options.data can be only \"selection\"\n\t// \"current\" and \"all\" are deprecated\n\tconst data = options.data;\n\n\tif(!sheets || data == \"current\" || data == \"selection\"){\n\t\tsheets = [active];\n\t}\n\telse if(typeof sheets == \"string\")\n\t\tsheets = [sheets];\n\telse if(sheets === true || data == \"all\")\n\t\tsheets = view._sheets.map(sheet => sheet.name);\n\n\tsheets = sheets.filter(sheet => isVisible(view, sheet));\n\n\tsheets.forEach((name, i) => {\n\t\tview.$index = baseIndex+\"_\"+i;\n\t\tconst grid = view.$$(\"cells\");\n\n\t\tview.showSheet(name);\n\t\tconst oldZoom = view._zoom;\n\t\tview.ignoreUndo(() => view.zoom(1));\n\n\t\tlet prefix = \"wss_\"+view.$index;\n\n\t\tview._print = true;\n\t\tlet table = grid.$customPrint(options, true);\n\t\tdelete view._print;\n\n\t\tconst tbl = table.firstChild;\n\t\tconst [header, body] = tbl.children;\n\n\t\tconst topSplit = header.childElementCount;\n\t\tconst sheetName = options.sheetnames ? 20 : 0;\n\t\tlet splitHeight = sheetName;\n\n\t\tfor (let s = 1; s <= topSplit; s++)\n\t\t\tsplitHeight += grid.getItem(s).$height || grid.config.rowHeight;\n\n\t\tif(splitHeight > pageSize.height / 4)\n\t\t\tfor (let i = topSplit - 1; i >= 0; i--){\n\t\t\t\tif(body.firstChild)\n\t\t\t\t\twebix.html.insertBefore(header.children[i], body.firstChild);\n\t\t\t\telse\n\t\t\t\t\tbody.appendChild(header.children[i]);\n\t\t\t}\n\n\t\tif(sheetName){\n\t\t\tconst sheetNode = webix.html.create(\"tr\", {class:\"webix_ssheet_sheetname\"}, `<td>${name}:</td>`);\n\n\t\t\tif(header.firstChild)\n\t\t\t\twebix.html.insertBefore(sheetNode, header.firstChild);\n\t\t\telse\n\t\t\t\theader.appendChild(sheetNode);\n\t\t}\n\n\t\t//for empty sheet we don't have any HTML\n\t\tconst node = table.firstChild;\n\t\tif (node){\n\t\t\twebix.html.removeCss(node, \"wss_\"+baseIndex);\n\t\t\twebix.html.addCss(node, prefix);\n\t\t}\n\n\t\tdoc.appendChild(table);\n\n\t\tif(options.external)\n\t\t\tfor(let id in view.views._pull){\n\t\t\t\tconst innerView = view.views._pull[id];\n\t\t\t\tif(innerView.type == \"image\"){\n\t\t\t\t\tconst img = webix.html.create(\"IMG\", {\n\t\t\t\t\t\tsrc: innerView.data,\n\t\t\t\t\t\twidth: (innerView.config.width || 500)+\"px\",\n\t\t\t\t\t\theight: (innerView.config.height || 300)+\"px\"\n\t\t\t\t\t});\n\n\t\t\t\t\tconst promise = webix.promise.defer();\n\t\t\t\t\tviews.push(promise);\n\t\t\t\t\timg.onload = ()=> promise.resolve();\n\n\t\t\t\t\tdoc.appendChild(img);\n\t\t\t\t}\n\t\t\t\telse{\n\t\t\t\t\tconst externalUI = webix.$$(id).getBody();\n\t\t\t\t\tif(externalUI.$customPrint){\n\t\t\t\t\t\tconst customPrint = externalUI.$customPrint({size: options.size}, true);\n\t\t\t\t\t\tif(customPrint.then){\n\t\t\t\t\t\t\torder[views.length] = doc.childElementCount;\n\t\t\t\t\t\t\tviews.push(customPrint);\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse\n\t\t\t\t\t\t\tdoc.appendChild( customPrint );\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t\tdoc.appendChild( printInnerView(webix.$$(id).getBody()) );\n\t\t\t\t}\n\t\t\t}\n\n\t\tif(i+1 < view._sheets.length){\n\t\t\tconst br = webix.html.create(\"DIV\", {\"class\":\"webix_print_pagebreak\"});\n\t\t\tdoc.appendChild(br);\n\t\t}\n\n\t\tview.$index = baseIndex;\n\t\tview.ignoreUndo(() => view.zoom(oldZoom));\n\t});\n\n\treturn doc;\n}\n\nfunction printInnerView(view){\n\tconst body = view.$view.cloneNode(true);\n\n\t//copy data from all canvases\n\tconst canvases = view.$view.getElementsByTagName(\"canvas\");\n\tif(canvases.length)\n\t\tfor(let i = canvases.length-1; i >=0; i--){\n\t\t\tconst destCtx = body.getElementsByTagName(\"canvas\")[i].getContext(\"2d\");\n\t\t\tdestCtx.drawImage(canvases[i], 0, 0);\n\t\t}\n\n\tconst container = webix.html.create(\"div\", {class:\"webix_ssheet_ui\"});\n\tcontainer.appendChild(body);\n\n\treturn container;\n}\n\nfunction getPageSize(options){\n\tconst size = webix.env.printSizes.find(size => size.id == options.paper);\n\tconst landscape = options.mode == \"landscape\";\n\n\tconst margin = options.margin ? 2 * webix.env.printMargin : 0;\n\n\treturn {\n\t\twidth: size[landscape ? \"height\" : \"width\"] * webix.env.printPPI - margin,\n\t\theight: size[landscape ? \"width\" : \"height\"] * webix.env.printPPI - margin\n\t};\n}\n\nexport function showBorders(view, redraw){\n\tif(redraw && !view._printBorders.$render)\n\t\treturn;\n\n\tconst borders = {rows:{}, cols:{}};\n\tconst grid = view.$$(\"cells\");\n\tconst options = view._printBorders;\n\n\tconst pageSize = getPageSize(options);\n\n\tconst sheetName = options.sheetnames ? 20 : 0;\n\tlet topSplit = grid.config.topSplit;\n\tlet splitHeight = sheetName;\n\n\tfor (let s = 1; s <= topSplit; s++)\n\t\tsplitHeight += (grid.getItem(s).$height || grid.config.rowHeight) / view._zoom;\n\n\tif(splitHeight > pageSize.height / 4){\n\t\ttopSplit = 0;\n\t\tsplitHeight = sheetName;\n\t}\n\n\tlet rowsHeight = splitHeight;\n\tfor (let r = topSplit + 1; r <= view.config.rowCount; r++) {\n\t\tconst height = (grid.getItem(r).$height || grid.config.rowHeight) / view._zoom;\n\n\t\tif(rowsHeight + height > pageSize.height){\n\t\t\trowsHeight = splitHeight;\n\t\t\tborders.rows[r == 1 ? r : r-1] = 1;\n\t\t}\n\n\t\trowsHeight += height;\n\t}\n\n\tif(options.fit != \"page\"){\n\t\tlet colsWidth = 0;\n\t\tfor (let c = 1; c <= view.config.columnCount; c++) {\n\t\t\tconst width = (grid.getColumnConfig(c).width || grid.config.columnWidth) / view._zoom;\n\n\t\t\tif(colsWidth + width > pageSize.width){\n\t\t\t\tcolsWidth = 0;\n\t\t\t\tborders.cols[c == 1 ? c : c-1] = 1;\n\t\t\t}\n\n\t\t\tcolsWidth += width;\n\t\t}\n\t}\n\n\tview._printBorders.$render = borders;\n\tview.refresh();\n}","import {Dialog} from \"./common\";\nimport {isVisible} from \"../sheets\";\nimport {showBorders} from \"../operations/print\";\n\nexport const action = \"print\";\n\nexport class DialogBox extends Dialog{\n\t$show(box, form){\n\t\tconst list = form.elements.sheets.getList();\n\t\tlist.clearAll();\n\t\tlist.parse( this.getSheets(this.view) );\n\n\t\tform.setValues({\n\t\t\tdata:\"full\",\n\t\t\tsheets: this.view.getActiveSheet(),\n\t\t}, true);\n\t}\n\t$init(){\n\t\tconst labels = webix.i18n.spreadsheet.labels;\n\n\t\tlet paperSize;\n\n\t\tconst printSizes = webix.env.printSizes.map(size => {\n\t\t\tif(size.id == \"a4\")\n\t\t\t\tpaperSize = \"a4\";\n\t\t\tsize.value = labels[\"page-\"+size.id] || size.id;\n\t\t\treturn size;\n\t\t});\n\n\t\tif(!paperSize) paperSize = printSizes[0].id;\n\n\t\treturn {\n\t\t\tview: \"ssheet-dialog\",\n\t\t\thead: labels[\"print-title\"],\n\t\t\tmove: true,\n\t\t\tmodal:true,\n\t\t\twidth:580,\n\t\t\tposition: \"center\",\n\t\t\tbuttons:false,\n\t\t\ton:{\n\t\t\t\tonHide: ()=> {\n\t\t\t\t\twebix.extend(this.view._printBorders, this.getValues(), true);\n\t\t\t\t\tshowBorders(this.view, true);\n\t\t\t\t}\n\t\t\t},\n\t\t\tbody:{\n\t\t\t\tview:\"form\",\n\t\t\t\telementsConfig:{\n\t\t\t\t\tlabelWidth: 0\n\t\t\t\t},\n\t\t\t\telements:[\n\t\t\t\t\t{ type:\"section\", template: labels[\"print-settings\"]},\n\t\t\t\t\t{ cols:[\n\t\t\t\t\t\t{ view:\"radio\", name:\"data\", vertical:true, options:[\n\t\t\t\t\t\t\t{ id:\"full\", value: labels[\"sheets\"]},\n\t\t\t\t\t\t\t{ id:\"selection\", value: labels[\"selection\"]}\n\t\t\t\t\t\t], on:{\n\t\t\t\t\t\t\tonChange:function(newv){\n\t\t\t\t\t\t\t\tconst elements = this.getFormView().elements;\n\t\t\t\t\t\t\t\tconst sheets = elements.sheets;\n\n\t\t\t\t\t\t\t\tif(newv == \"full\"){\n\t\t\t\t\t\t\t\t\telements.sheetnames.setValue(1);\n\t\t\t\t\t\t\t\t\tsheets.enable();\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\telse\n\t\t\t\t\t\t\t\t\tsheets.disable();\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}},\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tpadding:{\n\t\t\t\t\t\t\t\tright:30\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\trows:[\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tname: \"sheets\",\n\t\t\t\t\t\t\t\t\tview: \"multiselect\",\n\t\t\t\t\t\t\t\t\twidth: 160,\n\t\t\t\t\t\t\t\t\tstringResult:false,\n\t\t\t\t\t\t\t\t\tsuggest: {\n\t\t\t\t\t\t\t\t\t\tselectAll: true,\n\t\t\t\t\t\t\t\t\t\tbody:{\n\t\t\t\t\t\t\t\t\t\t\tdata:[]\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t{}\n\t\t\t\t\t\t\t]\n\t\t\t\t\t\t},\n\t\t\t\t\t\t{ rows:[\n\t\t\t\t\t\t\t{view:\"checkbox\", name:\"sheetnames\", value:1, labelRight:labels[\"sheet-names\"]},\n\t\t\t\t\t\t\t{view:\"checkbox\", name:\"borderless\", labelRight:labels[\"borderless\"]},\n\t\t\t\t\t\t\t{view:\"checkbox\", name:\"skiprows\", labelRight:labels[\"skip-rows\"]},\n\t\t\t\t\t\t\t{view:\"checkbox\", name:\"margin\", labelRight:labels[\"margin\"]},\n\t\t\t\t\t\t\t{view:\"checkbox\", name:\"external\", labelRight:labels[\"external-ui\"]},\n\t\t\t\t\t\t]}\n\t\t\t\t\t]},\n\t\t\t\t\t{ type:\"section\", template: labels[\"print-paper\"]},\n\t\t\t\t\t{ view:\"radio\", name:\"paper\", value:paperSize, options:printSizes},\n\t\t\t\t\t{ type:\"section\", template: labels[\"print-layout\"]},\n\t\t\t\t\t{ rows:[\n\t\t\t\t\t\t{view:\"radio\", name:\"fit\", value:\"page\", options:[\n\t\t\t\t\t\t\t{ id:\"page\", value:labels[\"page-width\"]},\n\t\t\t\t\t\t\t{ id:\"data\", value:labels[\"page-actual\"]}\n\t\t\t\t\t\t]},\n\t\t\t\t\t\t{ view:\"radio\", name:\"mode\", value:\"landscape\", options:[\n\t\t\t\t\t\t\t{ id:\"portrait\", value:labels[\"page-portrait\"]},\n\t\t\t\t\t\t\t{ id:\"landscape\", value:labels[\"page-landscape\"]}\n\t\t\t\t\t\t]}\n\t\t\t\t\t]},\n\t\t\t\t\t{\n\t\t\t\t\t\tcols:[\n\t\t\t\t\t\t\t{ },\n\t\t\t\t\t\t\t{ view: \"button\", css:\"ssheet_cancel_button\", hotkey:\"esc\",\n\t\t\t\t\t\t\t\tvalue: labels.cancel, autowidth:true,\n\t\t\t\t\t\t\t\tclick: () => this.close()\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t{ view: \"button\", value: labels[\"print-borders\"], autowidth:true,\n\t\t\t\t\t\t\t\tclick: () => this.printPreview()\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t{ view: \"button\", value: labels.print, hotkey:\"enter\", autowidth:true,\n\t\t\t\t\t\t\t\tclick: () => this.okClick()\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t]\n\t\t\t\t\t}\n\t\t\t\t]\n\t\t\t}\n\t\t};\n\t}\n\tgetValues(){\n\t\tconst data = this.$dialog.getBody().getValues({disabled:false});\n\t\tdata.margin = data.margin?0:{};\n\t\treturn data;\n\t}\n\tprintPreview(){\n\t\tthis.close();\n\t\tthis.view.showPrintBorders(true);\n\t}\n\tgetSheets(view){\n\t\treturn view._sheets\n\t\t\t.map(sheet => ({value: sheet.name, id: sheet.name}))\n\t\t\t.filter(sheet => isVisible(view, sheet.id));\n\t}\n\tokClick(){\n\t\tconst data = this.$dialog.getBody().getValues({disabled:false});\n\t\tdata.margin = data.margin?0:{};\n\t\tthis.close();\n\t\twebix.print(this.view, data);\n\t}\n}\n","import {Dialog} from \"./common\";\n\nexport const action = \"add-comment\";\n\nexport class DialogBox extends Dialog{\n\topen(action){\n\t\t//we get cell only on hover commented cell\n\t\tthis.cell = action.cell ? action.cell : this.view.getSelectedId();\n\n\t\t// cell not provided\n\t\tif (!this.cell || \n\t\t\t// cell is locked and in the edit mode\n\t\t\t(this.view.isCellLocked(this.cell.row, this.cell.column) && !action.viewonly) ||\n\t\t\t// action blocked by user's code\n\t\t\t!(this.view.callEvent(\"onBeforeCommentShow\", [this.cell.row, this.cell.column, !action.viewonly]))){\n\t\t\treturn false;\n\t\t}\n\n\t\tthis.view.comments._activeComment = {editStatus: !action.viewonly, cell: this.cell};\n\n\t\tif(!this.$dialog){\n\t\t\tthis.$dialog = webix.ui(this.$init());\n\t\t\tthis.view._destroy_with_me.push(this.$dialog);\n\t\t\tthis.view.comments.commentsView = this.$dialog;\n\t\t\tthis.$dialog.attachEvent(\"onHide\", ()=>this.$hide());\n\t\t\tthis.view.attachEvent(\"onCommentHide\", ()=>this.$dialog.hide());\n\t\t}\n\n\t\tconst form = this.$dialog.getBody();\n\n\t\tconst span = this.view.$$(\"cells\").getSpan(this.cell.row, this.cell.column);\n\t\tconst item = span ? {row: this.cell.row, column:(span[1]*1+span[2]-1)} : this.cell;\n\n\t\twebix.delay(()=>{\n\t\t\tthis.$dialog.show(this.view.$$(\"cells\").getItemNode(item));\n\t\t\tthis._setComment();\n\t\t});\n\t\tif (this.$show(this.$dialog, form) === false)\n\t\t\tthis.close();\n\t}\n\t$show(){\n\t\tthis.textarea = this.$dialog.queryView({view:\"textarea\"});\n\t\tthis.template = this.$dialog.queryView({view:\"template\"});\n\t}\n\t$init(){\n\t\treturn {\n\t\t\tview: \"popup\",\n\t\t\tcss:\"ssheet_comments\",\n\t\t\tminWidth:250,\n\t\t\tminHeight:150,\n\t\t\trelative:\"right\",\n\t\t\tresize:true,\n\t\t\ton:{\n\t\t\t\tonViewResize:()=>{\n\t\t\t\t\tthis.$dialog.hide();\n\t\t\t\t\tthis.$dialog.show();\n\t\t\t\t\tif(this.textarea.isVisible())\n\t\t\t\t\t\tthis.textarea.focus();\n\t\t\t\t}\n\t\t\t},\n\t\t\tbody:{\n\t\t\t\tanimate:false,\n\t\t\t\tcells:[\n\t\t\t\t\t{\n\t\t\t\t\t\tview: \"template\",\n\t\t\t\t\t\tcss:\"ssheet_comment_view\",\n\t\t\t\t\t\tborderless: true,\n\t\t\t\t\t\tscroll:\"auto\",\n\t\t\t\t\t\tonClick:{\n\t\t\t\t\t\t\t\"ssheet_comment_view\":() => {\n\t\t\t\t\t\t\t\tif(!(this.view.config.readonly || this.view.isCellLocked(this.cell.row, this.cell.column)))\n\t\t\t\t\t\t\t\t\tthis.showInput(this.view.comments.get(this.cell.row, this.cell.column));\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tview: \"textarea\",\n\t\t\t\t\t\ton:{\n\t\t\t\t\t\t\tonChange:()=>{\n\t\t\t\t\t\t\t\tthis.addComment();\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\tonFocus:()=>{\n\t\t\t\t\t\t\t\tthis.view.comments._activeComment = {editStatus: true, cell: this.cell};\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\tonBlur:()=>{\n\t\t\t\t\t\t\t\tthis.view.comments._activeComment = {};\n\t\t\t\t\t\t\t\tthis.$dialog.hide();\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t]\n\t\t\t}\n\t\t};\n\t}\n\t_setComment(){\n\t\tconst comment = this.view.comments.get(this.cell.row, this.cell.column);\n\t\tif(this.view.comments._activeComment.editStatus)\n\t\t\tthis.showInput(comment);\n\t\telse\n\t\t\tthis.showTemplate(comment);\n\t}\n\tshowTemplate(text){\n\t\tthis.template.show();\n\t\tthis.template.setHTML(text);\n\t}\n\tshowInput(text){\n\t\tthis.view.$$(\"cells\").select(this.cell.row, this.cell.column);\n\t\twebix.delay(()=>{\n\t\t\tthis.changeTextarea(text);\n\t\t\tthis.textarea.show();\n\t\t\tthis.textarea.focus();\n\t\t});\n\t}\n\taddComment(){\n\t\tthis.view.comments.add(this.cell.row, this.cell.column, this.textarea.getValue());\n\t}\n\tchangeTextarea(text){\n\t\tthis.textarea.blockEvent();\n\t\tthis.textarea.setValue(text||\"\");\n\t\tthis.textarea.unblockEvent();\n\t}\n}","import {Dialog} from \"./common\";\nexport const action = \"resize\";\n\nexport class DialogBox extends Dialog{\n\topen(action){\n\t\tthis.group = action.group;\n\t\tthis.header = action.value;\n\t\tDialog.prototype.open.apply(this, arguments);\n\t}\n\t$show(){\n\t\tconst sel = this.view.getSelectedId();\n\t\tif(!sel)\n\t\t\treturn false;\n\t\tthis.view.$handleSelection = ()=>{\n\t\t\treturn false;\n\t\t};\n\n\t\tconst elements = this.$dialog.getBody().elements;\n\t\tthis.type = elements[\"type\"];\n\t\tthis.size = elements[\"size\"];\n\n\t\tthis.$dialog.getHead().getChildViews()[0].setHTML(this.header);\n\t\tconst grid = this.view.$$(\"cells\");\n\n\t\tlet value;\n\t\tif(this.group == \"row\")\n\t\t\tvalue = grid.getItem(sel.row).$height || grid.config.rowHeight;\n\t\telse\n\t\t\tvalue = grid.getColumnConfig(sel.column).width || grid.config.columnWidth;\n\n\t\tvalue = value / this.view._zoom;\n\n\t\tthis.type.getOption(1).value = webix.i18n.spreadsheet.labels[this.group == \"row\" ? \"height\" : \"width\"];\n\t\tthis.type.setValue(1);\n\t\tthis.type.refresh();\n\n\t\tthis.size.setValue(Math.ceil(value));\n\t\tthis.size.focus();\n\t}\n\t$hide(){\n\t\tthis.view.$handleSelection = null;\n\t}\n\tokClick(){\n\t\tconst type = this.type.getValue();\n\n\t\tlet size = \"auto\";\n\t\tif(type == 1)\n\t\t\tsize = this.size.getValue()*1;\n\t\telse if(type == 3)\n\t\t\tsize = this.view.$$(\"cells\").config[this.group == \"row\" ? \"rowHeight\" : \"columnWidth\"];\n\n\t\tif(this.group == \"row\")\n\t\t\tthis.view.setRowHeight(null, size);\n\t\telse\n\t\t\tthis.view.setColumnWidth(null, size);\n\n\t\tthis.close();\n\t}\n\t$init(){\n\t\tconst locale = webix.i18n.spreadsheet.labels;\n\t\treturn {\n\t\t\tview: \"ssheet-dialog\",\n\t\t\tposition:\"center\",\n\t\t\twidth: 300,\n\t\t\tmove: true,\n\t\t\tbody:{\n\t\t\t\tpadding:0,\n\t\t\t\tcols:[\n\t\t\t\t\t{\n\t\t\t\t\t\tview:\"radio\", name:\"type\", vertical:true, optionHeight:40,\n\t\t\t\t\t\ton:{\n\t\t\t\t\t\t\tonChange: id => {\n\t\t\t\t\t\t\t\tif(id == 1)\n\t\t\t\t\t\t\t\t\tthis.size.enable();\n\t\t\t\t\t\t\t\telse\n\t\t\t\t\t\t\t\t\tthis.size.disable();\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t},\n\t\t\t\t\t\toptions:[\n\t\t\t\t\t\t\t{id:1, value: \"\"},\n\t\t\t\t\t\t\t{id:2, value: locale[\"fit-content\"]},\n\t\t\t\t\t\t\t{id:3, value: locale[\"default-size\"]},\n\t\t\t\t\t\t]\n\t\t\t\t\t},\n\t\t\t\t\t{rows: [\n\t\t\t\t\t\t{view:\"text\", name: \"size\", width:120},\n\t\t\t\t\t]}\n\t\t\t\t]\n\t\t\t},\n\t\t\ton:{\n\t\t\t\tonSaveClick: () => this.okClick(),\n\t\t\t\tonCancelClick: () => this.close()\n\t\t\t}\n\t\t};\n\t}\n}","import * as imc from \"./imagecell\";\nimport * as imt from \"./imagetop\";\nimport * as asw from \"./sparkline\";\nimport * as rgs from \"./ranges\";\nimport * as dpd from \"./dropdown\";\nimport * as flt from \"./filter\";\nimport * as fmt from \"./format\";\nimport * as cnd from \"./conditional\";\nimport * as exp from \"./export\";\nimport * as lnk from \"./link\";\nimport * as pnt from \"./print\";\nimport * as cmt from \"./comments\";\nimport * as siz from \"./sizing\";\n\nconst bases = [ imt, imc, asw, rgs, dpd, flt, fmt, cnd, exp, lnk, pnt, cmt, siz ];\n\nexport function init(view){\n\tconst dialogs = {};\n\tconst viewBases = view.config.readonly ? [cmt, exp, pnt] : bases;\n\n\tfor (let i = 0; i < viewBases.length; i++)\n\t\tdialogs[viewBases[i].action] = new viewBases[i].DialogBox(view);\n\n\tview.attachEvent(\"onCommand\", function(action){\n\t\tconst box = dialogs[action.id];\n\t\tif (box) box.open(action);\n\t});\n\n\tview.attachEvent(\"onAction\", function(id, values){\n\t\t//hide win when the external ui is removed\n\t\tif(id == \"add-view\" && !values.newValue){\n\t\t\tconst box = dialogs[\"add-image-top\"];\n\t\t\tif(box && box.viewid == values.row){\n\t\t\t\tbox.close();\n\t\t\t}\n\t\t}\n\t});\n}","import {ignoreReset, ignoreUndo}  from \"../operations/undo\";\nimport group  from \"../operations/undo_group\";\nimport {adjustSpan}  from \"../operations/spans\";\nimport {updateMaxColumn} from \"../helpers/column_names\";\nimport {find} from \"../helpers/array\";\n\nexport function init(view){\n\tview.attachEvent(\"onCommand\", (action, start, end) => {\n\t\tif (action.id == \"add\" || action.id == \"del\"){\n\t\t\tvar area = view._table.getSelectArea();\n\t\t\tif(area && !(start && end)){\n\t\t\t\tstart = area.start;\n\t\t\t\tend = area.end;\n\t\t\t}\n\n\t\t\tif (start && end){\n\t\t\t\tif(action.group == \"column\" && action.id == \"add\")\n\t\t\t\t\tupdateMaxColumn(view.config.columnCount + (end.column - start.column) + 1);\n\n\t\t\t\tgroup.set(function(){\n\t\t\t\t\tprocess(action, start, end, view);\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\t});\n\n\tview.attachEvent(\"onUndo\", (action, row, column, value, dir, extra) => {\n\t\tif (action == \"grid-change\"){\n\t\t\tconst state = view._table.getScrollState();\n\n\t\t\t//if we added rows/cols - regine can update cell references on other pages on undo\n\t\t\tif(extra){\n\t\t\t\tif(!dir)\n\t\t\t\t\tview._mPage[row ? \"removeRow\" : \"removeColumn\"]((row || column)-1, extra.count);\n\t\t\t\telse\n\t\t\t\t\tview._mPage[row ? \"addRow\" : \"addColumn\"]((row || column)-1, extra.count);\n\t\t\t}\n\t\t\t//if removed - can't, so parse full data and show sheet\n\t\t\telse\n\t\t\t\tstate.sheet = view.getActiveSheet();\n\n\t\t\tloadChangedData(view, value, state);\n\t\t}\n\t});\n}\n\nfunction process(action, start, end, view) {\n\tlet select = view._table.getSelectArea();\n\tconst state = view._table.getScrollState();\n\n\tconst del = action.id == \"del\";\n\tconst oldData = view.serialize({sheets: del, viewIds:true});\n\tconst newData = webix.copy(oldData);\n\tconst data = {value:oldData, newValue:newData};\n\n\tif(!del)\n\t\twebix.extend(data, {\n\t\t\t[action.group]: start[action.group],\n\t\t\textra: {\n\t\t\t\tcount: end.row - start.row + 1\n\t\t\t}\n\t\t});\n\n\tconst obj = del ? find(newData, sheet => sheet.name == view.getActiveSheet()).content : newData;\n\n\tconst spanData = [];\n\tconst spans = obj.spans;\n\tfor (let i in spans){\n\t\tconst span = adjustSpan(spans[i], action, start, end, view, obj.data, spanData);\n\t\tif (span[2] <= 0 || span[3] <= 0)\n\t\t\tspans.splice(i, 1);\n\t}\n\n\tconst values = getUpdateValues(action, start, end);\n\tignoreUndo(function(){\n\t\tview.callEvent(\"onAction\", [\"before-grid-change\", {\n\t\t\tname: values.name,\n\t\t\tinc: values.inc,\n\t\t\tdata: obj,\n\t\t\tstart: start\n\t\t}]);\n\t},view);\n\n\tif (action.group == \"column\"){\n\t\tif (del)\n\t\t\t_delColumn(action, start, end, view);\n\t\telse\n\t\t\t_addColumn(action, start, end, view);\n\t}\n\telse if (action.group == \"row\") {\n\t\tif (del)\n\t\t\t_delRow(action, start, end, view);\n\t\telse\n\t\t\t_addRow(action, start, end, view);\n\t}\n\n\t// muon updates data and ranges\n\tconst updatedData = view.serialize();\n\tobj.data = updatedData.data;\n\tobj.ranges = updatedData.ranges;\n\n\tspanData.forEach(item => {\n\t\tobj.data.push(item);\n\t});\n\n\tview.callEvent(\"onAction\", [\"grid-change\", data]);\n\n\tignoreUndo(function() {\n\t\tloadChangedData(view, obj, state);\n\t},view);\n\n\tif (select){\n\t\tselect = fixSelectArea(select, view);\n\t\tif (select)\n\t\t\tview.$$(\"cells\").addSelectArea(select.start, select.end);\n\t}\n}\n\nfunction fixSelectArea(select, view){\n\tconst config = view.config;\n\n\tconst rows = config.rowCount;\n\tconst cols = config.columnCount;\n\n\tif (select.start.row*1 > rows) select.start.row = rows;\n\tif (select.end.row*1 > rows) select.end.row = rows;\n\tif (select.start.column*1 > cols) select.start.column = cols;\n\tif (select.end.column*1 > cols) select.end.column = cols;\n\n\tif (\n\t\tview.isRowVisible(select.start.row) &&\n\t\tview.isRowVisible(select.end.row) &&\n\t\tview.isColumnVisible(select.start.column) &&\n\t\tview.isColumnVisible(select.end.column)\n\t)\n\t\treturn select;\n}\n\nfunction loadChangedData(view, data, state){\n\t// data loading resets undo history, and\n\t// we need to preserve it\n\tignoreReset(function(){\n\t\tview.$handleSelection = null;\n\t\tview.parse(data);\n\n\t\tif(state){\n\t\t\tif(state.sheet)\n\t\t\t\tview.showSheet(state.sheet);\n\t\t\tview._table.scrollTo(state.x, state.y);\n\t\t}\n\t});\n}\n\nfunction getUpdateValues( action, start, end){\n\tvar name = action.group,\n\t\tinc = action.id==\"add\"?1:(action.id==\"del\"?-1:0);\n\n\tif(inc) {\n\t\t// span support\n\t\tif (name == \"row\")\n\t\t\tinc += inc * (end.row - start.row);\n\t\tif (name == \"column\")\n\t\t\tinc += inc * (end.column - start.column);\n\t}\n\treturn {name: name, inc: inc};\n}\n\nfunction _addColumn(action, start, end, view) {\n\tlet count = end.column - start.column + 1;\n\n\tview._mPage.addColumn(start.column-1, count);\n\tview.config.columnCount += count;\n\n\tview.callEvent(\"onColumnOperation\", [action.id, start.column, end.column]);\n}\n\nfunction _delColumn(action, start, end, view) {\n\tlet count = end.column - start.column + 1;\n\n\tif (view.config.columnCount === count){\n\t\tif (start.column == end.column)\n\t\t\treturn; //deleting last column, ignoring\n\t\t//prevent deleting all columns\n\t\tend.column--;\n\t\tcount--;\n\t}\n\n\tview._mPage.removeColumn(start.column-1, count);\n\tview.config.columnCount -= count;\n\n\tview.callEvent(\"onColumnOperation\", [action.id, start.column, end.column]);\n}\n\nfunction _addRow(action, start, end, view) {\n\tconst count = end.row - start.row + 1;\n\n\tview._mPage.addRow(start.row-1, count);\n\tview.config.rowCount += count;\n\n\tview.callEvent(\"onRowOperation\", [action.id, start.row, end.row]);\n}\n\nfunction _delRow(action, start, end, view) {\n\tlet count = end.row - start.row + 1;\n\n\tif (view.config.rowCount === count){\n\t\tif (start.row == end.row)\n\t\t\treturn; //deleting last column, ignoring\n\t\t//prevent deleting all columns\n\t\tend.row--;\n\t\tcount--;\n\t}\n\n\tview._mPage.removeRow(start.row-1, count);\n\tview.config.rowCount -= count;\n\n\tview.callEvent(\"onRowOperation\", [action.id, start.row, end.row]);\n}","import group from \"./undo_group\";\nimport {setSpanCss} from \"./spans\";\nimport {rangeOptions} from \"../mathematics/ranges\";\nimport * as fmt from \"../operations/formats\";\nimport {changeRange, eachRange} from \"../helpers/column_names\";\n\nexport function init(view){\n\tconst table = view._table;\n\n\tview.attachEvent(\"onReset\", () => reset(view));\n\treset(view);\n\n\ttable.attachEvent(\"onBeforeEditStart\", function(id){\n\t\tlet col = this.getColumnConfig(id.column);\n\t\tif (this._ssEditors[id.row]){\n\t\t\tlet ed = this._ssEditors[id.row][id.column];\n\t\t\tif (ed){\n\t\t\t\twebix.extend(col, ed, true);\n\t\t\t\twebix.extend(col, {row: view.getRow(id.row)}, true);\n\t\t\t\tif (ed.options){\n\t\t\t\t\tif (typeof ed.options == \"string\")\n\t\t\t\t\t\tcol.options = rangeOptions(view, ed.options, { unique:true, order:true, empty:ed.empty });\n\t\t\t\t\telse if (webix.isArray(ed.options))\n\t\t\t\t\t\tcol.options = rangeOptions(view, ed.options, { empty:ed.empty });\n\n\t\t\t\t\tif(col.collection){\n\t\t\t\t\t\tcol.collection.clearAll();\n\t\t\t\t\t\tcol.collection.parse(col.options);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t});\n\n\t// update format if editor supports this feature\n\ttable.attachEvent(\"onBeforeEditStop\", function(state, editor, ignore){\n\t\tif (!ignore && editor.getFormat){\n\t\t\tconst value = editor.getValue();\n\t\t\tlet format = editor.getFormat(value);\n\n\t\t\tgroup.set(function(){\n\t\t\t\tview.setCellValue(editor.row, editor.column, value);\n\t\t\t\tif (format){\n\t\t\t\t\tfmt.addFormat(view, editor.row, editor.column, fmt.getFormatSource(format));\n\t\t\t\t} else\n\t\t\t\t\tfmt.removeFormat(view, editor.row, editor.column);\n\t\t\t});\n\n\t\t\tconst cell = view.getSelectedId();\n\t\t\tif (cell && cell.row == editor.row && cell.column == editor.column){\n\t\t\t\tformat = format || \"common\";\n\t\t\t\tformat = fmt.isCustom(format) ? \"custom\" : format;\n\t\t\t\tview.callEvent(\"onCommand\", [{id:\"toolbar-update\", name:\"format\", value:format}]);\n\t\t\t}\n\t\t}\n\t});\n\n\ttable.attachEvent(\"onAfterEditStop\", function(state, editor){\n\t\tconst col = this.getColumnConfig(editor.column);\n\n\t\tcol.editor = \"text\";\n\t\tdelete col.popup; delete col.$popup; delete col.row;\n\t});\n\n\tview.attachEvent(\"onUndo\", (type, row, column, value) => {\n\t\tif (type == \"dropdown\")\n\t\t\tview.setCellEditor(row, column, value);\n\t});\n\n\tview.attachEvent(\"onAction\", (action, p) => {\n\t\tif (action == \"dropdown\"){\n\t\t\tsetSpanCss(view, p.row, p.column, \"ss_editor\", p.newValue);\n\t\t}\n\t\telse if (action == \"before-grid-change\")\n\t\t\tupdatePosition(view, p.name, p.inc, p.data, p.start);\n\t});\n}\n\nfunction reset(view){\n\tview._table._ssEditors = {};\n}\n\nexport function serialize(view,data){\n\tvar row, column,\n\t\ttblEditors = view._table._ssEditors,\n\t\teditors = [];\n\n\tfor (row in tblEditors){\n\t\tfor (column in tblEditors[row])\n\t\t\teditors.push([row, column, tblEditors[row][column]]);\n\t}\n\tdata.editors = editors;\n}\n\nexport function load(view,data){\n\tconst editors = data.editors;\n\n\tif (editors)\n\t\tfor (let i=0; i<editors.length; i++)\n\t\t\tview.setCellEditor.apply(view, editors[i]);\n}\n\nexport function clearEditors(view, range){\n\tview._table.editStop();\n\teachRange(range, view, function(view, cell){\n\t\tlet editor = view._table._ssEditors[cell.row];\n\t\tif (editor){\n\t\t\tif (editor[cell.column]){\n\t\t\t\tdelete editor[cell.column];\n\t\t\t\tview._table.removeCellCss(cell.row, cell.column, \"ss_editor\");\n\t\t\t\tsetSpanCss(view, cell.row, cell.column, \"ss_editor\", false);\n\t\t\t}\n\t\t}\n\t});\n}\n\nexport function isEditor(view, row, column){\n\tconst editor = view._table._ssEditors;\n\treturn editor[row] && !!editor[row][column];\n}\n\n// called on column/row add, delete, hide,show\nfunction updatePosition(view, name, inc, data, start){\n\tconst editors = data.editors;\n\n\tif (inc){\n\t\t// create new editors\n\t\tfor(let i=editors.length-1; i>=0; i--){\n\t\t\tlet [row,column,editor] = editors[i];\n\t\t\tif (name == \"row\" && row >= start.row || name == \"column\" && column >= start.column){\n\n\t\t\t\tif (name == \"row\"){\n\t\t\t\t\tif (row < start.row - inc){\t//delete editor mark if row was deleted\n\t\t\t\t\t\teditors.splice(i,1);\n\t\t\t\t\t\tcontinue;\n\t\t\t\t\t} else\t\t\t\t\t\t//update mark position if upper row was deleted\n\t\t\t\t\t\teditors[i][0] = row*1 + inc;\n\t\t\t\t}\n\t\t\t\telse if (name == \"column\"){\n\t\t\t\t\tif (column < start.column - inc){\n\t\t\t\t\t\teditors.splice(i, 1);\n\t\t\t\t\t\tcontinue;\n\t\t\t\t\t} else \n\t\t\t\t\t\teditors[i][1] = column*1 + inc;\n\t\t\t\t}\n\t\t\t\teditor.options = changeRange(editor.options, name, inc, start);\n\t\t\t}\n\t\t}\n\t}\n}\n\nexport function pasteDropdown(view, extra, row, col, cutted){\n\tconst editor = extra.dropdown;\n\n\tview.setCellEditor(row, col, editor);\n\tif (cutted === 1)\n\t\tview.setCellEditor(extra.row, extra.col, {});\n}","import group from \"./undo_group\";\nimport {pasteCondition} from \"../operations/conditional_formats\";\nimport {pasteDropdown} from \"../operations/dropdown\";\nimport {pasteFilter} from \"../operations/filter\";\nimport {pasteSpan} from \"../operations/spans\";\n\nlet styledata, clipdata, origin, cutted, updateFilters, specialPaste;\n\nexport function init(view){\n\tconst clipboard = view.config.clipboard;\n\tconst browserClipboard = navigator.clipboard;\n\n\tif(clipboard === false)\n\t\treturn;\n\n\twebix.clipbuffer.init();\n\tconst buffer = document.querySelector(\".webix_clipbuffer\");\n\n\tconst keyC = 67; //keyboard 'c' code\n\tconst keyX = 88; //keyboard 'x' code\n\tconst grid = view.$$(\"cells\");\n\n\tgrid.attachEvent(\"onAfterAreaAdd\", () => _sel_to_clip(view, buffer));\n\n\tgrid.attachEvent(\"onKeyPress\", (code, e) => {\n\t\tif((code === keyC || code === keyX) && (e.ctrlKey || e.metaKey) && grid.getSelectedId()){\n\t\t\tcutted = (code === keyX)*1;\n\t\t\tsetClipboard(view, buffer);\n\t\t}\n\t});\n\n\tview.attachEvent(\"onCommand\", action => {\n\t\tif(action.id.indexOf(\"paste\") != -1){\n\t\t\tspecialPaste = action.id.split(\"-\")[1];\n\n\t\t\tif(browserClipboard && browserClipboard.readText){\n\t\t\t\tbrowserClipboard.readText()\n\t\t\t\t\t.then(text => {\n\t\t\t\t\t\twebix.clipbuffer.set(text);\n\t\t\t\t\t\t_clip_to_sel(view, grid, buffer.value);\n\t\t\t\t\t})\n\t\t\t\t\t.catch(()=> {\n\t\t\t\t\t\t_clip_to_sel(view, grid, clipdata);\n\t\t\t\t\t})\n\t\t\t\t\t.finally(()=> {\n\t\t\t\t\t\tspecialPaste = null;\n\t\t\t\t\t});\n\t\t\t}\n\t\t\telse {\n\t\t\t\t_clip_to_sel(view, grid, clipdata);\n\t\t\t\tspecialPaste = null;\n\t\t\t}\n\t\t}\n\t\telse if(action.id == \"copy\" || action.id == \"cut\"){\n\t\t\tcutted = (action.id == \"cut\")*1;\n\t\t\tsetClipboard(view, buffer, browserClipboard, true);\n\t\t}\n\t});\n\n\tif (!view.config.readonly) {\n\t\tgrid.attachEvent(\"onPaste\", text => {\n\t\t\t_clip_to_sel(view, grid, text);\n\t\t});\n\t}\n}\n\nfunction setClipboard(view, buffer, browserClipboard, menu){\n\tconst grid = view.$$(\"cells\");\n\tstyledata = _get_sel_style(view, grid);\n\n\tif(menu && browserClipboard && browserClipboard.writeText)\n\t\tbrowserClipboard.writeText(buffer.value);\n\n\tclipdata = buffer.value;\n\torigin = grid.getSelectArea();\n\n\tif(cutted && Object.keys(grid._ssFilters).length !== 0)\n\t\tupdateFilters = allFiltersInZone(grid._ssFilters, origin, view.config.columnCount);\n}\n\nfunction _sel_to_clip(view, buffer){\n\tconst grid = view.$$(\"cells\");\n\tif(grid.getSelectedId())\n\t\twebix.delay(()=>{\n\t\t\tconst data = [];\n\t\t\tgrid.mapSelection(function(value, row, col, row_ind) {\n\t\t\t\tvalue = _updateDelimiter(view._mPage.getValue(row-1, col-1), view.config);\n\t\t\t\tif (!data[row_ind]) data[row_ind] = [];\n\t\t\t\tdata[row_ind].push(value);\n\t\t\t});\n\t\t\tconst clipdata = webix.csv.stringify(data, grid.config.delimiter);\n\n\t\t\tif (grid.getEditor()){\n\t\t\t\tbuffer.value = clipdata;\n\t\t\t} else {\n\t\t\t\tbuffer.focus();\n\t\t\t\twebix.clipbuffer.set(clipdata);\n\t\t\t}\n\t\t\twebix.UIManager.setFocus(grid);\n\t\t});\n}\n\nfunction _updateDelimiter(value, config) {\n\tconst format = getClipboardNumberFormat(config);\n\n\tif(webix.rules.isNumber(value) && format)\n\t\tvalue = webix.Number.numToStr(format)(value);\n\n\treturn value;\n}\n\nfunction _clip_to_sel(view, grid, text){\n\tif(!text)\n\t\ttext = \"\";\n\n\tvar leftTop = grid.getSelectArea();\n\tif (!leftTop) return;\n\tvar start = leftTop.start;\n\tvar fromSheet = text === clipdata;\n\n\tvar data = fromSheet ? styledata : webix.csv.parse(text, grid.config.delimiter);\n\tif(!fromSheet)\n\t\tdata = _changeDelimiter(data, view.config);\n\n\tvar translate = { id:\"move\", column:0, row: 0, cut:cutted };\n\tif (fromSheet){\n\t\ttranslate.column = start.column - origin.start.column;\n\t\ttranslate.row = start.row - origin.start.row;\n\t}\n\n\tif(specialPaste || !fromSheet){\n\t\tcutted = 0;\n\t\tupdateFilters = 0;\n\t}\n\n\tgroup.set(function(){\n\t\tif (updateFilters)\n\t\t\tview.removeFilters();\n\n\t\t_add_row_col(view, start, data);\n\n\t\tif (cutted === 1) {\n\t\t\tfor (let row = origin.start.row; row <= origin.end.row; row++) {\n\t\t\t\tfor (let column = origin.start.column; column <= origin.end.column; column++) {\n\t\t\t\t\tview.setCellValue(row, column, null);\n\t\t\t\t\tview.setStyle(row, column, null);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tconst colCount = leftTop.end.column - start.column + 1;\n\t\tconst rowCount = leftTop.end.row - start.row + 1;\n\n\t\tconst dataRowCount = data.length;\n\t\tconst dataColCount = data[0].length;\n\n\t\tif (!updateFilters && (rowCount > dataRowCount || colCount > dataColCount)) {\n\t\t\tfor(let r = 0, ri = 0; r < Math.max(rowCount, dataRowCount); r++, ri++){\n\t\t\t\tif(ri == data.length) ri = 0;\n\t\t\t\tfor (let c = 0, ci = 0; c < Math.max(colCount, dataColCount); c++, ci++){\n\t\t\t\t\tif(ci == data[0].length) ci = 0;\n\n\t\t\t\t\tconst subtrans = {\n\t\t\t\t\t\tid: \"move\",\n\t\t\t\t\t\tcolumn: translate.column + Math.floor(c/dataColCount) * dataColCount,\n\t\t\t\t\t\trow: translate.row + Math.floor(r/dataRowCount) * dataRowCount,\n\t\t\t\t\t\tcut: cutted\n\t\t\t\t\t};\n\n\t\t\t\t\t_clipboardToTable(view, start.row + r, start.column + c, data[ri][ci], fromSheet, subtrans);\n\t\t\t\t}\n\t\t\t}\n\t\t} else {\n\t\t\tgrid.mapCells(\n\t\t\t\tstart.row,\n\t\t\t\tstart.column,\n\t\t\t\tdataRowCount,\n\t\t\t\tnull,\n\t\t\t\tfunction(value, row, col, row_ind, col_ind) {\n\t\t\t\t\tif (data[row_ind] && data[row_ind].length > col_ind) {\n\t\t\t\t\t\tvar cdata = data[row_ind][col_ind];\n\t\t\t\t\t\t_clipboardToTable(view, row, col, cdata, fromSheet, translate);\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\ttrue\n\t\t\t);\n\t\t}\n\n\t\tif (cutted === 1){\n\t\t\t//cut and cleared\n\t\t\tcutted = 2;\n\t\t\tupdateFilters = false;\n\t\t}\n\t});\n\t\n\tview.refresh();\n}\n\nfunction _clipboardToTable(view, row, col, cdata, fromSheet, translate){\n\tlet newValue = cdata;\n\tconst setValue = !specialPaste || specialPaste == \"values\" || specialPaste == \"formulas\";\n\n\tif (typeof cdata === \"object\"){\n\t\tif(setValue){\n\t\t\tif (cdata.math && specialPaste != \"values\"){\n\t\t\t\tif(translate.cut)\n\t\t\t\t\tnewValue = cdata.math;\n\t\t\t\telse\n\t\t\t\t\tnewValue = view._mData.getStore().transposeMath(cdata.math, translate.row, translate.column);\n\t\t\t}\n\t\t\telse\n\t\t\t\tnewValue = cdata.text;\n\t\t}\n\n\t\tif(cdata.style && cdata.style.props && (!specialPaste || specialPaste == \"styles\")){\n\t\t\tconst style = view.addStyle(cdata.style.props);\n\t\t\tview.setStyle(row, col, style);\n\t\t}\n\n\t\tconst extra = cdata.extra;\n\t\tif(extra){\n\t\t\tif(extra.condition && (!specialPaste || specialPaste == \"conditions\"))\n\t\t\t\tpasteCondition(view, extra, row, col, cutted);\n\t\t\tif(extra.dropdown && !specialPaste)\n\t\t\t\tpasteDropdown(view, extra, row, col, cutted, translate);\n\t\t\tif(extra.filter && updateFilters)\n\t\t\t\tpasteFilter(view, extra, row, col, cutted, translate);\n\t\t}\n\n\t\tif(!specialPaste)\n\t\t\tpasteSpan(view, extra, row, col, cutted, translate);\n\t}\n\n\tif(setValue)\n\t\tview.setCellValue(row, col, newValue);\n}\n\nfunction _get_sel_style(view, grid){\n\tvar data = [];\n\tvar row, last;\n\n\tgrid.mapSelection(function(value, id, col) {\n\t\tif (id != last){\n\t\t\trow = []; data.push(row);\n\t\t\tlast = id;\n\t\t}\n\n\t\tvar math =  view._mPage.getValue(id-1, col-1, true);\n\t\tmath = math && math[0] == \"=\" ? math : null;\n\t\tvalue = view._mPage.getValue(id-1, col-1);\n\t\tvar obj = { text:value, math, style:view.getStyle(id, col) };\n\n\t\tvar condition = view.conditions.get(id,col);\n\t\tvar editor = view.getCellEditor(id, col);\n\t\tvar filter = view.getCellFilter(id, col);\n\t\tvar span = view._table.getSpan(id, col);\n\n\t\tif (editor || filter || condition || span){\n\t\t\tvar extra = { row:id, col:col };\n\t\t\tif (condition) extra.condition = condition;\n\t\t\tif (editor) extra.dropdown = editor;\n\t\t\tif (filter) extra.filter = filter;\n\t\t\tif (span) extra.span = span;\n\t\t\tobj.extra = extra;\n\t\t}\n\n\t\trow.push(obj);\n\t\treturn value;\n\t});\n\n\treturn data;\n}\n\nfunction allFiltersInZone(extra, origin, columnCount){\n\tvar filters = Object.keys(extra);\n\tvar startRow = Math.min.apply(null, filters);\n\tvar endRow = Math.max.apply(null, filters);\n\tvar startCol = columnCount;\n\tvar endCol = 1;\n\n\tfor (var i = startRow; i <= endRow; i++){\n\t\tif(extra[i]){\n\t\t\tvar columns = Object.keys(extra[i]);\n\t\t\tstartCol = Math.min(startCol, Math.min.apply(null, columns));\n\t\t\tendCol = Math.max(endCol, Math.max.apply(null, columns));\n\t\t}\n\t}\n\n\tif(origin.start.row <= startRow && origin.end.row >= endRow && origin.start.column <= startCol && origin.end.column >= endCol)\n\t\treturn true;\n\telse\n\t\treturn false;\n}\n//dynamically increase rows and columns according to pasted data size\nfunction _add_row_col(view, start, data){\n\tvar maxRow = start.row + data.length - 1;\n\tvar maxCol = start.column + data[0].length - 1;\n\n\tif(maxRow > view.config.rowCount || maxCol > view.config.columnCount){\n\t\tvar action = { id:\"add\" };\n\t\tif (maxRow > view.config.rowCount) {\n\t\t\taction.group = \"row\";\n\t\t\tview.callEvent(\"onCommand\", [\n\t\t\t\taction, \n\t\t\t\t{ row: view.config.rowCount + 1 }, \n\t\t\t\t{ row: maxRow }\n\t\t\t]);\n\t\t}\n\t\tif (maxCol > view.config.columnCount) {\n\t\t\taction.group = \"column\";\n\t\t\tview.callEvent(\"onCommand\", [\n\t\t\t\taction, \n\t\t\t\t{ column: view.config.columnCount + 1 },\n\t\t\t\t{ column: maxCol }\n\t\t\t]);\n\t\t}\n\t}\n}\n\nfunction _changeDelimiter(data, config){\n\tconst format = getClipboardNumberFormat(config);\n\n\tif(format)\n\t\tfor(let i = 0; i < data.length; i++)\n\t\t\tfor(let k = 0; k < data[i].length; k++){\n\t\t\t\tconst record = webix.Number.parse(data[i][k], format);\n\t\t\t\tif(webix.rules.isNumber(record))\n\t\t\t\t\tdata[i][k] = record;\n\t\t\t}\n\n\treturn data;\n}\n\nfunction getClipboardNumberFormat(config){\n\tlet format = config.clipboardNumberFormat;\n\n\tif(!format && config.clipboardDecimalDelimiter) // backward compatibility\n\t\tformat = {\n\t\t\tdecimalDelimiter: config.clipboardDecimalDelimiter,\n\t\t\tdecimalOptional: true\n\t\t};\n\n\treturn format;\n}","import group from \"./undo_group\";\n\nexport function init(view) {\n\tview.attachEvent(\"onCommand\", (action) => {\n\t\tif (action.id == \"show\" || action.id == \"hide\"){\n\t\t\tconst sel = view._table.getSelectArea();\n\t\t\tif (sel)\n\t\t\t\tprocess(action, webix.copy(sel.start), webix.copy(sel.end), view);\n\t\t}\n\t});\n\treset(view);\n\n\tview.attachEvent(\"onUndo\", (action, row, column, value, direction) => {\n\t\tif ((action.id == \"hide\" || action.id == \"show\") && (action.group == \"column\" || action.group == \"row\")){\n\t\t\tlet type = action.id;\n\t\t\tif (!direction)\n\t\t\t\ttype = type == \"hide\" ? \"show\" : \"hide\";\n\t\t\tconst obj = (row || column);\n\t\t\tprocess({ id: type, group: action.group, neighbors: action.neighbors }, obj.start, obj.end, view, true);\n\t\t}\n\t});\n\n\tview.attachEvent(\"onHardReset\", () => reset(view));\n\n\tview.attachEvent(\"onAction\", (action, p)=> {\n\t\tif(action == \"before-grid-change\")\n\t\t\t_updatePosition(view, p.name, p.inc, p.data, p.start);\n\t});\n}\n\nexport function reset(view, mode) {\n\tif(mode) view[\"_hidden_\"+mode+\"_hash\"] = {};\n\telse{\n\t\tview._hidden_cols_hash = {};\n\t\tview._hidden_rows_hash = {};\n\t\tview.filterSpreadSheet();\n\t}\n}\n\nfunction getIds(id){\n\treturn webix.isArray(id) ? id : [id, id];\n}\n\nexport function isColumnVisible(view, column){\n\treturn !view._hidden_cols_hash[column];\n}\n\nexport function setState(view, indexes, state, type){\n\t// hide\n\tif(!indexes){\n\t\tconst sel = view.getSelectedId(true);\n\t\tconst action = {\n\t\t\tid: state === false ? \"show\" : \"hide\",\n\t\t\tgroup: type\n\t\t};\n\n\t\tif(sel.length)\n\t\t\tview.callEvent(\"onCommand\", [action, sel[0], sel[sel.length-1]]);\n\t}\n\telse {\n\t\tconst ids = getIds(indexes);\n\t\tconst hidden = type == \"row\" ? view._hidden_rows_hash : view._hidden_cols_hash;\n\n\t\tif (!hidden[ids[0]] && (webix.isUndefined(state) || state)){\n\t\t\t(type == \"row\" ? _hideRow : _hideColumn)({id: \"hide\", group: type}, {[type]: ids[0]}, {[type]: ids[1]}, view);\n\t\t}\n\t\t// show\n\t\telse if (hidden[ids[0]] && (webix.isUndefined(state) || !state)) {\n\t\t\t(type == \"row\" ? _showRow : _showColumn)({id: \"hide\", group: type}, {[type]: ids[0]}, {[type]: ids[1]}, view);\n\t\t}\n\t}\n}\n\nexport function isRowVisible(view, row){\n\treturn !view._hidden_rows_hash[row];\n}\n\nexport function serialize(view, data){\n\tlet hrows  = []; let hcols = [];\n\tfor(let r in view._hidden_rows_hash) hrows.push(r);\n\tfor(let c in view._hidden_cols_hash) hcols.push(c);\n\n\tif(hrows.length || hcols.length)\t\n\t\tdata.table.hidden = {};\n\tif(hrows.length)\n\t\tdata.table.hidden.row = hrows;\n\tif(hcols.length)\n\t\tdata.table.hidden.column = hcols;\n}\n\nexport function load(view, data){\n\treset(view);\n\t\n\tif(!webix.isUndefined(data.table) && !webix.isUndefined(data.table.hidden)){\n\t\tconst hidden = data.table.hidden;\n\n\t\tif(hidden.row && hidden.row.length){\n\t\t\tfor(let r = 0; r < hidden.row.length; r++)\n\t\t\t\t_hideRow({id:\"hide\", group:\"row\"}, {row:hidden.row[r]}, {row:hidden.row[r]}, view, true);\n\t\t}\n\n\t\tif(hidden.column && hidden.column.length){\n\t\t\tfor(let c = 0; c < hidden.column.length; c++)\n\t\t\t\t_hideColumn({id:\"hide\", group:\"column\"}, {column:hidden.column[c]}, {column:hidden.column[c]}, view, true);\n\t\t}\n\t}\n}\n\nfunction process(action) {\n\tif (action.group == \"column\"){\n\t\tif (action.id == \"show\")\n\t\t\t_showColumn.apply(this, arguments);\n\t\telse if (action.id == \"hide\")\n\t\t\t_hideColumn.apply(this, arguments);\n\t} else if (action.group == \"row\") {\n\t\tif (action.id == \"show\")\n\t\t\t_showRow.apply(this, arguments);\n\t\telse if (action.id == \"hide\")\n\t\t\t_hideRow.apply(this, arguments);\n\t}\n}\n\nfunction _showColumn(action, start, end, view, silent) {\n\tconst grid = view.$$(\"cells\");\n\tconst sel = grid.getSelectArea();\n\n\tconst hash = view._hidden_cols_hash;\n\n\tif(action.neighbors){\n\t\tif(hash[ start.column-1 ])\n\t\t\twhile(hash[ start.column-1 ])\n\t\t\t\tstart.column--;\n\t\telse\n\t\t\twhile(hash[ end.column+1 ])\n\t\t\t\tend.column++;\n\t}\n\n\tgroup.set(()=>{\n\t\tfor (let i = start.column; i <= end.column; i++) {\n\t\t\tif(hash[i]){\n\t\t\t\tdelete hash[i];\n\t\t\t\tconst cell = grid.getColumnConfig(i - 1 || \"rowId\").header[0];\n\t\t\t\tcell.css = cell.css.replace(\"webix_ssheet_hide_column\", \"\");\n\t\t\t\tgrid.showColumn(i);\n\t\t\t\tif (!silent)\n\t\t\t\t\tview.callEvent(\"onColumnOperation\", [action.id, i, i]);\n\t\t\t}\n\t\t}\n\n\t\tconst split = view._frozenColumns;\n\t\tif(split && split >= start.column){\n\t\t\tview.freezeColumns(0); // remove freeze (split is equal with current frozen col)\n\t\t\tview.freezeColumns(split); // if col was freezed on hidden column - move it\n\t\t}\n\n\t\tif (sel)\n\t\t\tgrid.addSelectArea(sel.start, sel.end);\n\t}, view);\n}\n\nfunction _showRow(action, start, end, view, silent) {\n\tconst grid = view.$$(\"cells\");\n\tconst sel = grid.getSelectArea();\n\n\tconst hash = view._hidden_rows_hash;\n\n\tif(action.neighbors){\n\t\tif(hash[ start.row-1 ])\n\t\t\twhile(hash[ start.row-1 ])\n\t\t\t\tstart.row--;\n\t\telse\n\t\t\twhile(hash[ end.row+1 ])\n\t\t\t\tend.row++;\n\t}\n\n\tgroup.set(()=>{\n\t\tconst split = view._frozenRows;\n\t\tif(split){\n\t\t\t//Frozen rows ignore filtering applied to the datatable\n\t\t\tview.freezeRows(0);\n\t\t}\t\t\n\n\t\tfor (let i = start.row; i <= end.row; i++) {\n\t\t\tif(hash[i]){\n\t\t\t\tdelete hash[i];\n\n\t\t\t\tif (i - 1 === 0) {\n\t\t\t\t\tconst cell = grid.getColumnConfig(\"rowId\").header[0];\n\t\t\t\t\tcell.css = cell.css.replace(\"webix_ssheet_hide_row\", \"\");\n\t\t\t\t\tgrid.refreshColumns();\n\t\t\t\t} else\n\t\t\t\t\tgrid.removeCellCss(i - 1, \"rowId\", \"webix_ssheet_hide_row\");\n\n\t\t\t\tif (!silent)\n\t\t\t\t\tview.callEvent(\"onRowOperation\", [action.id, i, i]);\n\t\t\t}\n\t\t}\n\n\t\tview.filterSpreadSheet();\n\n\t\tif(split)\n\t\t\tview.freezeRows(split);\n\n\t\tif (sel)\n\t\t\tgrid.addSelectArea(sel.start, sel.end);\n\t}, view);\n}\n\nfunction _hideColumn(action, start, end, view, silent) {\n\tconst grid = view.$$(\"cells\");\n\tlet i = end.column;\n\tview.$handleSelection = null;\n\tgrid.unselect();\n\n\tif (end.column<1 || start.column<1){\n\t\tdelete view._hidden_cols_hash[start.column];\n\t\treturn;\n\t}\n\twhile (i >= start.column) {\n\t\tif(grid.getColumnIndex(i) != -1){\n\t\t\tview._hidden_cols_hash[i] = i;\n\n\t\t\tlet cell = grid.getColumnConfig(i - 1 || \"rowId\").header[0];\n\t\t\tcell.css = (cell.css || \"\") + \" webix_ssheet_hide_column\";\n\n\t\t\tgrid.hideColumn(i);\n\t\t}\n\t\ti--;\n\t}\n\n\tif (!silent)\n\t\tview.callEvent(\"onColumnOperation\", [action.id, start.column, end.column]);\n}\n\nfunction _hideRow(action, start, end, view, silent) {\n\tif (end.row<1 || start.row<1){\n\t\tdelete view._hidden_rows_hash[start.row];\n\t\treturn;\n\t}\n\n\tconst split = view._frozenRows;\n\tif(split){\n\t\t//Frozen rows ignore filtering applied to the datatable\n\t\tview.freezeRows(0);\n\t}\n\n\tconst grid = view.$$(\"cells\");\n\tlet i = end.row;\n\n\twhile (i >= start.row) {\n\t\tview._hidden_rows_hash[i] = i;\n\n\t\tif (i - 1 === 0) {\n\t\t\tlet cell = grid.getColumnConfig(\"rowId\").header[0];\n\t\t\tcell.css = (cell.css || \"\") + \" webix_ssheet_hide_row\";\n\t\t\tgrid.refreshColumns();\n\t\t}\n\t\telse\n\t\t\tgrid.addCellCss(i - 1, \"rowId\", \"webix_ssheet_hide_row\");\n\n\t\ti--;\n\t}\n\n\tview.filterSpreadSheet();\n\n\tif(split)\n\t\tview.freezeRows(split);\n\n\tif (!silent)\n\t\tview.callEvent(\"onRowOperation\", [action.id, start.row, end.row]);\n}\n\nfunction _updatePosition(view, name, inc, data, start){\n\tif(data.table && data.table.hidden && data.table.hidden[name] && data.table.hidden[name].length){\n\t\treset(view, name == \"column\" ? \"cols\" : \"rows\");\n\n\t\tconst s = start[name];\n\t\tconst hidden = data.table.hidden[name];\n\n\t\tfor (let i = hidden.length - 1; i >= 0; i--) {\n\t\t\tconst hiddenIndex = hidden[i]*1;\n\t\t\tif(inc > 0 && hiddenIndex >= s)\n\t\t\t\thidden[i] = inc + hiddenIndex;\n\t\t\telse if(inc < 0 && hiddenIndex >= s) {\n\t\t\t\tif(hiddenIndex < s - inc)\n\t\t\t\t\thidden.splice(i, 1);\n\t\t\t\telse\n\t\t\t\t\thidden[i] = inc + hiddenIndex;\n\t\t\t}\n\t\t}\n\t}\n}","import {getStyle, getTextSize} from \"./styles\";\nimport {save} from \"./save\";\nimport * as arr from \"../helpers/array\";\n\nexport function init(view){\n\n\tif (view.config.resizeCell){\n\t\tvar grid = view.$$(\"cells\");\n\t\tgrid.define(\"resizeRow\", { headerOnly: true, size: 10 });\n\t\tgrid.define(\"resizeColumn\", { headerOnly: true, size: 10 });\n\t\tgrid.define(\"fixedRowHeight\", false);\n\n\t\tgrid.attachEvent(\"onRowResize\", (id) => {\n\t\t\tview.$$(\"cells\").refreshSelectArea();\n\t\t\tsave(view, \"sizes\", { row: id, column: 0, size: view.$$(\"cells\").getItem(id).$height });\n\t\t});\n\t\tgrid.attachEvent(\"onColumnResize\", (id) => {\n\t\t\tview.$$(\"cells\").refreshSelectArea();\n\t\t\tsave(view, \"sizes\", { row: 0, column: id, size: view.getColumn(id).width });\n\t\t});\n\n\t\t// undo\n\t\tview.attachEvent(\"onUndo\", (type, row, column, value) => {\n\t\t\tif(type == \"c-resize\" || type == \"r-resize\")\n\t\t\t\t_undoResize(view, row, column, value);\n\t\t});\n\t}\n\n\tview.attachEvent(\"onDataParse\", (data) => {\n\t\tload(view,data);\n\t});\n\n\t\n\tview.attachEvent(\"onDataSerialize\", (data) => {\n\t\tserialize(view,data);\n\t});\n\n\tview.attachEvent(\"onAction\", (action, p)=> {\n\t\tif(action == \"before-grid-change\")\n\t\t\tupdatePosition(view, p.name, p.inc, p.data, p.start);\n\t});\n\n\tview.attachEvent(\"onBeforeStyleChange\", function(row, column, n, o){\n\t\tif (o && o.props.wrap === \"wrap\" && (!n || n.props.wrap != o.props.wrap)){\n\t\t\tdelete view._table.getItem(row).$height;\n\t\t}\n\t});\n\tview.attachEvent(\"onStyleChange\", (r,c) => _adjustRowHeight(view,r,c));\n\tview.attachEvent(\"onCellChange\", (r,c,v,p)=> {\n\t\tif(p == view.getActiveSheet())\n\t\t\t_adjustRowHeight(view,r,c);\n\t});\n}\n\nfunction serialize(view, data, oldZoom){\n\tconst sizes = [];\n\tconst grid = view.$$(\"cells\");\n\tconst columns = grid.getState().order;\n\tconst order = grid.data.order;\n\n\tconst zoom = oldZoom || view._zoom;\n\n\tconst defWidth = grid.config.columnWidth;\n\tconst defHeight = grid.config.rowHeight;\n\n\tfor (let i = 1; i < columns.length; i++){\n\t\tconst width = Math.ceil(grid.getColumnConfig(columns[i]).width / zoom);\n\t\tif (width && width != defWidth)\n\t\t\tsizes.push([0, i, width]);\n\t}\n\n\tfor (let i = 0; i < order.length; i++){\n\t\tconst height = Math.ceil(grid.getItem(order[i]).$height / zoom);\n\t\tif (height && height != defHeight)\n\t\t\tsizes.push([order[i]*1, 0, height]);\n\t}\n\t\n\tdata.sizes = sizes;\n}\n\nexport function load(view, data){\n\tlet zoom = 1;\n\tif(data.table && data.table.zoom)\n\t\tzoom = data.table.zoom;\n\n\tconst grid = view.$$(\"cells\");\n\tconst defWidth = grid.config.columnWidth;\n\tconst defHeight = grid.config.rowHeight;\n\n\tfor(let i = 1; i <= view.config.rowCount; i++){\n\t\tconst row = view.$$(\"cells\").getItem(i);\n\t\trow.$height = defHeight*zoom;\n\t}\n\n\tconst rowHeight = (webix.skin.$name == \"contrast\" || webix.skin.$name == \"flat\" ? 24 : 20) * zoom;\n\tconst rowId = view.getColumn(\"rowId\");\n\trowId.width = 40 * zoom;\n\trowId.header[0].height = rowHeight;\n\n\tfor(let i = 1; i <= view.config.columnCount; i++){\n\t\tconst col = view.getColumn(i);\n\t\tcol.header[0].height = rowHeight;\n\t\tcol.width = defWidth*zoom;\n\t}\n\n\tif (data.sizes){\n\t\tfor (let i=0; i<data.sizes.length; i++){\n\t\t\tconst size = data.sizes[i];\n\t\t\tif (size[0]*1 !== 0){\n\t\t\t\tconst row = view.$$(\"cells\").getItem(size[0]);\n\t\t\t\tif(row) row.$height = size[2]*zoom;\n\t\t\t} else {\n\t\t\t\tconst col = view.getColumn(size[1]);\n\t\t\t\tif(col) col.width = size[2]*zoom;\n\t\t\t}\n\t\t}\n\t}\n\n\tview.refresh(true);\n}\n\nexport function zoomSizes(view, oldZoom){\n\tconst data = {table:{zoom:view._zoom}};\n\tserialize(view, data, oldZoom);\n\tload(view, data);\n}\n\nfunction _undoResize(view, row, column, value){\n\tif(row){\n\t\tview.$$(\"cells\").getItem(row).$height = value;\n\t\tsave(view, \"sizes\", { row:row, column: 0, size: value });\n\t}\n\telse{\n\t\tview._table.setColumnWidth(column, value);\n\t}\n\t// update area selection\n\tview._table.refreshSelectArea();\n}\n\nfunction updatePosition(view, name, inc, data, start){\n\tlet i,\n\t\tsizes = data.sizes,\n\t\tnsizes = [];\n\n\tif(inc){\n\t\tfor(i = sizes.length - 1; i >= 0; i--){\n\t\t\tlet [row, column, size] = sizes[i];\n\n\t\t\tif(row && name == \"row\" && row >= start.row){\n\t\t\t\tif(inc < 0 && row < start.row - inc)\n\t\t\t\t\tcontinue;\n\t\t\t\tnsizes.push([row*1 + inc, column, size]);\n\t\t\t}\n\t\t\telse if(column && name == \"column\" && column >= start.column){\n\t\t\t\tif(inc < 0 && column < start.column - inc)\n\t\t\t\t\tcontinue;\n\t\t\t\tnsizes.push([row, column*1 + inc, size]);\n\t\t\t}\n\t\t\telse\n\t\t\t\tnsizes.push(sizes[i]);\n\t\t}\n\n\t\tif(inc > 0){\n\t\t\t//col/row add: set sizes according to the selected area\n\t\t\tif(name == \"column\"){\n\t\t\t\tfor(let i = 0; i < inc; i++){\n\t\t\t\t\tconst size = arr.find(sizes, arr => arr[1] == start.column + i);\n\t\t\t\t\tif(size)\n\t\t\t\t\t\tnsizes.push([0, start.column + i, size[2]]);\n\t\t\t\t}\n\t\t\t}\n\t\t\telse{\n\t\t\t\tfor(let i = 0; i < inc; i++){\n\t\t\t\t\tconst size = arr.find(sizes, arr => arr[0] == start.row + i);\n\t\t\t\t\tif(size)\n\t\t\t\t\t\tnsizes.push([start.row + i, 0, size[2]]);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tdata.sizes = nsizes;\n\t}\n}\n\nfunction _adjustRowHeight(view, row, column){\n\tif(view._loading_data)\n\t\treturn;\n\n\tconst style = getStyle(view, {row:row, column:column});\n\n\t//changing styles or content of wrapped cell -> resize the related row\n\tif (style && style.props.wrap){\n\t\tconst grid = view._table;\n\t\tconst item = grid.getItem(row);\n\t\tlet height = item.$height || grid.config.rowHeight;\n\n\t\tgrid.eachColumn(function(col, config){\n\t\t\tconst style = getStyle(view, {row:row, column:col});\n\t\t\t//include only cells with active wrap into calculation \n\t\t\tif(style && style.props && style.props.wrap === \"wrap\"){\n\t\t\t\tlet text = this.getText(row, col);\n\t\t\t\tlet baseWidth = config.width;\n\n\t\t\t\tconst span = grid.getSpan(row, col);\n\t\t\t\tlet spanHeight;\n\n\t\t\t\tif(span){\n\t\t\t\t\tconst node = grid.getSpanNode({row:span[0], column:span[1]});\n\t\t\t\t\tbaseWidth = node.offsetWidth;\n\t\t\t\t\tspanHeight = node.offsetHeight;\n\t\t\t\t}\n\n\t\t\t\tif(view.getCellEditor(row, col) || view.getCellFilter(row, col))\n\t\t\t\t\tbaseWidth += 20;\n\n\t\t\t\tlet textHeight = getTextSize(view, text, style.id, baseWidth).height;\n\n\t\t\t\tif(spanHeight)\n\t\t\t\t\ttextHeight = spanHeight >= textHeight ? 0 : textHeight - spanHeight + height;\n\n\t\t\t\theight = Math.max(height, textHeight);\n\t\t\t}\n\t\t});\n\n\t\titem.$height  = height;\n\t}\n}\n","import {encode} from \"../helpers/column_names\";\nimport {pasteCondition} from \"./conditional_formats\";\nimport group from \"./undo_group\";\n\nexport function init(view){\n\tvar table = view._table;\n\n\tvar bs = 0;\n\ttable.attachEvent(\"onAreaDrag\", () => bs = new Date());\n\ttable.attachEvent(\"onBeforeAreaRemove\", function(){\n\t\t//[FIXME] currently we don't have enough info to know\n\t\t//is user selects new area, and removing need to be blocked\n\t\t//or is it some API which attempts to remove the area\n\t\tif (view.$handleSelection && (new Date() - bs)<500) return false;\n\t});\n\n\ttable.attachEvent(\"onBeforeAreaAdd\", (area) => {\n\t\t//[FIXME] \n\t\t//block selection of row-id column\n\t\t//temporary fix, we need to fire onBeforeBlockSelect when selection moves\n\t\t//so the common onBeforeBlockSelect handler will block rowId selection\n\t\tif (area.start.column == \"rowId\") return false;\n\n\t\t//if we have an active editor, we need to close it on block selection\n\t\t//ignore, when selecting the editor's cell\n\t\tvar editor = table.getEditor();\n\t\tif (editor && (\n\t\t\teditor.row != area.start.row || editor.column != area.start.column ||\n\t\t\teditor.row != area.start.row || editor.column != area.start.column ))\n\t\t\ttable.editStop();\n\n\t\tif (!view.$handleSelection) return true;\n\t\t\n\n\t\tlet blockStart = encode[area.start.column] + area.start.row;\n\t\tlet blockEnd = encode[area.end.column] + area.end.row;\n\n\t\tvar res = view.$handleSelection(area.start, area.end, blockStart, blockEnd);\n\n\t\tif (res !== false){\n\t\t\tview.$handleSelection = null;\n\t\t\ttable.removeSelectArea();\n\t\t}\n\n\t\treturn res;\n\t});\n\n\ttable.attachEvent(\"onBeforeBlockSelect\", (start, end, finalStep) => {\n\t\tif(finalStep && table.$handleStart){\n\t\t\tconst oldSel = table.getSelectArea();\n\t\t\tconst oldStart = oldSel.start;\n\t\t\tconst oldEnd = oldSel.end;\n\n\t\t\tconst sr = start.row;\n\t\t\tconst er = end.row;\n\t\t\tconst sc = start.column;\n\t\t\tconst ec = end.column;\n\n\t\t\tif(oldStart.row == sr && oldEnd.row > er)\n\t\t\t\tview.clearRange({start:{row:er+1,column:sc}, end:{row:oldEnd.row,column:ec}}, {values:true});\n\t\t\telse if(oldStart.column == sc && oldEnd.column > ec){\n\t\t\t\tview.clearRange({start:{row:sr,column:ec+1}, end:{row:er,column:oldEnd.column}}, {values:true});\n\t\t\t}\n\t\t\telse{\n\t\t\t\tlet type;\n\t\t\t\tif(sr != oldStart.row || er != oldEnd.row)\n\t\t\t\t\ttype = \"row\";\n\t\t\t\telse if(sc != oldStart.column || ec != oldEnd.column)\n\t\t\t\t\ttype = \"column\";\n\n\t\t\t\tif(type){\n\t\t\t\t\tgroup.start();\n\t\t\t\t\tconst isRow = type == \"row\";\n\t\t\t\t\tfor (\n\t\t\t\t\t\tlet i = (isRow ? sc : sr);\n\t\t\t\t\t\ti <= (isRow ? ec : er);\n\t\t\t\t\t\ti++\n\t\t\t\t\t){\n\t\t\t\t\t\tconst nums = [];\n\t\t\t\t\t\tlet border = [];\n\t\t\t\t\t\tfor (let j = oldStart[type]; j <= oldEnd[type]; j++) {\n\t\t\t\t\t\t\tconst [row, col] = type == \"row\" ? [j, i] : [i, j];\n\t\t\t\t\t\t\tconst value = view.getCellValue(row, col);\n\t\t\t\t\t\t\tif(webix.rules.isNumber(value)){\n\t\t\t\t\t\t\t\tif(!border[0]){\n\t\t\t\t\t\t\t\t\tborder.firstValue = value;\n\t\t\t\t\t\t\t\t\tborder[0] = border[1] = j;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\telse{\n\t\t\t\t\t\t\t\t\tborder[1] = j;\n\t\t\t\t\t\t\t\t\tif(webix.isUndefined(border.inc))\n\t\t\t\t\t\t\t\t\t\tborder.inc = value - border.firstValue;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tnums[j] = border;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\telse\n\t\t\t\t\t\t\t\tborder = [];\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tconst afterSel = oldStart[type] == (isRow ? sr : sc);\n\t\t\t\t\t\tconst start = afterSel ? oldStart[type] : oldEnd[type];\n\t\t\t\t\t\tconst dir = afterSel ? 1 : -1;\n\n\t\t\t\t\t\tfor(\n\t\t\t\t\t\t\tlet j = (afterSel ? oldEnd[type] + 1 : oldStart[type] - 1), index = 0, iteration = 1;\n\t\t\t\t\t\t\tafterSel ? j <= (isRow ? er : ec) : j >= (isRow ? sr : sc);\n\t\t\t\t\t\t\tafterSel ? j++ : j--, index++\n\t\t\t\t\t\t){\n\t\t\t\t\t\t\tif(index == oldEnd[type] - oldStart[type] + 1){\n\t\t\t\t\t\t\t\titeration++;\n\t\t\t\t\t\t\t\tindex = 0;\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tconst linkPos = start+index*dir;\n\t\t\t\t\t\t\tconst [linkRow, linkCol] = isRow ? [linkPos, i] : [i, linkPos];\n\n\t\t\t\t\t\t\tlet value = view.getCellValue(linkRow, linkCol);\n\n\t\t\t\t\t\t\tconst num = nums[linkPos];\n\t\t\t\t\t\t\tif(num)\n\t\t\t\t\t\t\t\tvalue += (num.inc || 1) * (num[1] - num[0] + 1) * iteration * dir;\n\n\t\t\t\t\t\t\telse if(typeof value == \"string\" && value[0] == \"=\" && value.length > 0){\n\t\t\t\t\t\t\t\tif(isRow)\n\t\t\t\t\t\t\t\t\tvalue = view._mData.getStore().transposeMath(value, j - start - index * dir, 0);\n\t\t\t\t\t\t\t\telse\n\t\t\t\t\t\t\t\t\tvalue = view._mData.getStore().transposeMath(value, 0, j - start - index * dir);\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tconst [row, col] = isRow ? [j, i] : [i, j];\n\t\t\t\t\t\t\tview.setCellValue(row, col, value);\n\t\t\t\t\t\t\tview.setStyle(row, col, view.getStyle(linkRow, linkCol));\n\n\t\t\t\t\t\t\tconst condition = view.conditions.get(linkRow, linkCol);\n\t\t\t\t\t\t\tif(condition)\n\t\t\t\t\t\t\t\tpasteCondition(view, {condition}, row, col);\n\t\t\t\t\t\t\telse\n\t\t\t\t\t\t\t\tview.conditions.clear(row, col);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tgroup.end();\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t});\n\n\twebix.event(table.$view, \"mousedown\", function(e){\n\t\tif (view.$handleSelection)\n\t\t\treturn webix.html.preventEvent(e);\n\t});\n}\n","export function expandSelection(r, view){\n\tlet maxY = view.config.rowCount;\n\tlet maxX = view.config.columnCount;\n\tlet table = view._table;\n\n\tlet nr1 = r.start.row, nr2 = r.end.row, nc1 = r.start.column, nc2 = r.end.column;\n\n\tfor (let i=nr1-1; i>0; i--){\n\t\tif (getValue(i, r.start.column, table))\n\t\t\tnr1 = i;\n\t\telse\n\t\t\tbreak;\n\t}\n\n\tfor (let i=nr2+1; i<maxY; i++){\n\t\tif (getValue(i, r.end.column, table))\n\t\t\tnr2 = i;\n\t\telse\n\t\t\tbreak;\n\t}\n\n\tfor (let i=nc1-1; i>0; i--){\n\t\tif (getValue(r.start.row, i, table))\n\t\t\tnc1 = i;\n\t\telse\n\t\t\tbreak;\n\t}\n\n\tfor (let i=nc2+1; i<maxX; i++){\n\t\tif (getValue(r.end.row, i, table))\n\t\t\tnc2 = i;\n\t\telse\n\t\t\tbreak;\n\t}\n\n\tlet newrange = { start:{ row:nr1, column:nc1 } , end:{ row: nr2, column: nc2 }};\n\tif (nr1 != r.start.row || nr2 != r.end.row || nc1 != r.start.column || nc2 != r.end.column){\n\t\tview._table.addSelectArea(newrange.start, newrange.end);\n\t}\n\n\treturn newrange;\n}\n\nfunction getValue(r,c, table){\n\tvar value = table.getItem(r)[c];\n\tif(value === undefined || value === \"\"){\n\t\treturn false;\n\t} else {\n\t\treturn true;\n\t}\n}","import {expandSelection} from \"../helpers/expand_selection\";\nimport {rangeObj} from \"../helpers/column_names\";\nimport group from \"./undo_group\";\nimport {_changeCondition} from \"./conditional_formats\";\n\nexport function init(view){\n\tview.attachEvent(\"onCommand\", (cm) => {\n\t\tif (cm.id === \"sort-asc\" || cm.id === \"sort-desc\")\n\t\t\tsortRange(view, null, cm.id.replace(\"sort-\",\"\"));\n\t});\n}\n\nconst sorters = {\n\t\"int\":function(dir, key){\n\t\treturn (a,b) => {\n\t\t\tif (!b[key]) return -1;\n\t\t\tif (!a[key]) return 1;\n\n\t\t\tlet c = parseFloat(a[key]) || dir*Infinity;\n\t\t\tlet d = parseFloat(b[key]) || dir*Infinity;\n\t\t\treturn (c > d ? 1 : (c == d ? 0 : -1))*dir;\n\t\t};\n\t},\n\t\"str\":function(dir, key){\n\t\treturn (a,b) => {\n\t\t\tif (!b[key]) return -1;\n\t\t\tif (!a[key]) return 1;\n\n\t\t\tlet c = a[key].toString().toLowerCase();\n\t\t\tlet d = b[key].toString().toLowerCase();\n\t\t\treturn (c > d ? 1 : (c == d ? 0 : -1))*dir;  \n\t\t};\n\t}\n};\n\nexport function sortRange(view, range, dir){\n\trange = range || view._table.getSelectArea();\n\n\tif (range){\n\t\trange = rangeObj(range, view);\n\t\tlet fullrange = range;\n\t\tif (range.start.row === range.end.row)\n\t\t\tfullrange = expandSelection(range, view);\n\n\t\tconst key = view.getCellValue(range.start.row, range.start.column, false);\n\t\tconst type = isNaN(parseFloat(key)) ? \"str\" : \"int\";\n\n\t\tdir = (!dir || dir === \"asc\") ? 1 : -1;\n\t\tgroup.set(()=>\n\t\t\tsort(fullrange, range.start.column, type, dir, view)\n\t\t);\n\t}\n}\n\nfunction sort(range, by, type, dir, view){\n\tfor (let column = range.start.column; column <= range.end.column; column++){\n\t\t//get all selected column values\n\t\tconst values = [];\n\t\tfor (let row = range.start.row; row <= range.end.row; row++) {\n\t\t\tif(view.isRowVisible(row)){\n\t\t\t\tconst value = view.getCellValue(row, column, false);\n\t\t\t\tconst style = view.getStyle(row, column);\n\n\t\t\t\tlet math = view.getCellValue(row, column);\n\t\t\t\tmath = math && math[0] == \"=\" ? math : null;\n\n\t\t\t\tconst conditions = view.conditions.get(row,column);\n\t\t\t\tif(conditions)\n\t\t\t\t\t_changeCondition(\"remove\", row, column, conditions, null, view);\n\n\t\t\t\tvalues.push({\n\t\t\t\t\tvalue,\n\t\t\t\t\tstyle,\n\t\t\t\t\tmath,\n\t\t\t\t\trow,\n\t\t\t\t\tconditions\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\n\t\t//sort them\n\t\tvalues.sort(sorters[type](dir, \"value\"));\n\n\t\t//set new values to original column\n\t\tfor (let row = range.start.row; row <= range.end.row; row++) {\n\t\t\tif(view.isRowVisible(row)){\n\t\t\t\tconst element = values.shift();\n\n\t\t\t\tview.setStyle(row, column, (element.style || null));\n\t\t\t\tif(element.conditions)\n\t\t\t\t\t_changeCondition(\"update\", row, column, null, element.conditions, view);\n\n\t\t\t\tif (!element.math) view.setCellValue(row, column, element.value);\n\t\t\t\telse {\n\t\t\t\t\tconst newMath = view._mData.getStore().transposeMath(element.math, row - element.row, 0);\n\t\t\t\t\tview.setCellValue(row, column, newMath);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tview.refresh();\n}","import {split} from \"./parser\";\n\nfunction updateSheetNames(view, formula, oldName, newName){\n\tif(formula.indexOf(\"!\") == -1)\n\t\treturn formula;\n\n\tconst stack = split(formula, view, true);\n\tfor(let i = 0; i < stack.length; i++){\n\t\tif(webix.isArray(stack[i])){\n\t\t\tconst thisSheet = stack[i][0] === oldName;\n\t\t\tlet sheet = thisSheet ? newName : stack[i][0];\n\t\t\tif(sheet.indexOf(\" \") != -1)\n\t\t\t\tsheet = `'${sheet}'`;\n\t\t\tstack[i] = `${sheet}!${stack[i][1]}`;\n\t\t}\n\t}\n\treturn stack.join(\"\");\n}\n\nfunction isFormula(val){\n\treturn typeof val == \"string\" && val[0] == \"=\";\n}\n\nexport function init(view){\n\tview.attachEvent(\"onSheetRename\", (name, newName) => {\n\t\tview._sheets.forEach(sheet => {\n\t\t\tconst activeSheet = sheet.name == view.getActiveSheet();\n\t\t\tif(activeSheet)\n\t\t\t\tsheet.content = view.serialize(); //actual data\n\n\t\t\tif(sheet.content.editors){\n\t\t\t\tsheet.content.editors.forEach(value => {\n\t\t\t\t\tconst options = value[2].options;\n\t\t\t\t\tif(options){\n\t\t\t\t\t\tif(typeof options == \"string\")\n\t\t\t\t\t\t\tvalue[2].options = updateSheetNames(view, options, name, newName);\n\t\t\t\t\t\telse\n\t\t\t\t\t\t\tfor (let i = 0; i < options.length; i++){\n\t\t\t\t\t\t\t\tconst option = options[i];\n\t\t\t\t\t\t\t\tif(typeof option == \"string\"){\n\t\t\t\t\t\t\t\t\tif(isFormula(option))\n\t\t\t\t\t\t\t\t\t\toptions[i] = updateSheetNames(view, option, name, newName);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\telse if(isFormula(option.id))\n\t\t\t\t\t\t\t\t\toption.id = updateSheetNames(view, option.id, name, newName);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\n\t\t\tif(sheet.content.conditions){\n\t\t\t\tsheet.content.conditions.forEach(value => {\n\t\t\t\t\tif(isFormula(value[3]))\n\t\t\t\t\t\tvalue[3] = updateSheetNames(view, value[3], name, newName);\n\t\t\t\t});\n\t\t\t\tif(activeSheet){\n\t\t\t\t\tview.conditions.clear();\n\t\t\t\t\tview.conditions.parse( sheet.content.conditions );\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t});\n}","export function init(view) {\n\tview.attachEvent(\"onUndo\", (action, row, column, value) => {\n\t\tif (action == \"gridlines-hide\"){\n\t\t\thideGridlines(view, value);\n\t\t}\n\t});\n}\n\nexport function hideGridlines(view, state = true){\n\tvar grid = view.$$(\"cells\");\n\tvar borderless = grid.$view.className.indexOf(\"webix_borderless\") !=-1;\n\tif (state === \"toggle\")\n\t\tstate = !borderless;\n\n\tif(!borderless && state){\n\t\twebix.html.addCss( grid.$view, \"webix_borderless\", true);\n\t\tview.callEvent(\"onCommand\", [{id:\"toolbar-update\", name:\"hide-gridlines\", value:true}]);\n\t\tview.callEvent(\"onAction\", [\"gridlines-hide\", {newValue:true, value: false}]);\n\t}\n\telse if(borderless && !state){\n\t\twebix.html.removeCss( grid.$view, \"webix_borderless\");\n\t\tview.callEvent(\"onCommand\", [{id:\"toolbar-update\", name:\"hide-gridlines\", value:false}]);\n\t\tview.callEvent(\"onAction\", [\"gridlines-hide\", {newValue:false, value: true}]);\n\t}\n}\n\nexport function serialize(view, data){\n\tdata.table.gridlines = view.$$(\"cells\").$view.className.indexOf(\"webix_borderless\") !=-1?0:1;\n}\n\nexport function load(view, data){\n\tvar mode = false;\n\tif(!webix.isUndefined(data.table) && !webix.isUndefined(data.table.gridlines))\n\t\tmode = !data.table.gridlines;\n\thideGridlines(view, mode);\n}","export function init(view) {\n\tview.attachEvent(\"onUndo\", (action, row, column, value) => {\n\t\tif (action == \"header-hide\"){\n\t\t\thideHeaders(view, value);\n\t\t}\n\t});\n}\n\nexport function hideHeaders(view, state){\n\tconst grid = view.$$(\"cells\");\n\tconst old = !grid.config.header;\n\n\tif (state == \"toggle\")\n\t\tstate = grid.config.header;\n\n\tif(state != old){\n\t\tgrid.config.header = !state;\n\t\tview.callEvent(\"onCommand\", [{id:\"toolbar-update\", name:\"hide-headers\", value:state}]);\n\t\tview.callEvent(\"onAction\", [\"header-hide\", {newValue:state, value:old}]);\n\t}\n\n\tconst firstVisible = grid.isColumnVisible(\"rowId\");\n\tif((firstVisible && state) || (!firstVisible && !state))\n\t\tgrid.hideColumn(\"rowId\", {}, true, state);\n\n\tgrid.refreshColumns();\n}\n\nexport function serialize(view, data){\n\tdata.table.headers = view.$$(\"cells\").config.header ? 1 : 0;\n}\n\nexport function load(view, data){\n\tlet mode;\n\tif(data.table && !webix.isUndefined(data.table.headers))\n\t\tmode = !data.table.headers;\n\thideHeaders(view, mode);\n}","import group from \"./undo_group\";\nimport {eachRange} from \"../helpers/column_names\";\n\nexport function init(view){\n\tview.comments = {\n\t\tget: function(row, column){\n\t\t\treturn getComment(view, row, column);\n\t\t},\n\t\tadd: function(row, column, comment){\n\t\t\tcommentCell(view, row, column, comment);\n\t\t},\n\t\tremove: function(row, column){\n\t\t\tremoveComment(view, row, column);\n\t\t},\n\t\t_activeComment: {},\n\t\t_pull:{}\n\t};\n\n\tview.attachEvent(\"onReset\", () => reset(view));\n\tview.attachEvent(\"onUndo\", (type, row, column, value) => {\n\t\tif (type === \"comment\")\n\t\t\t_undoComment(view, row, column, value);\n\t});\n\n\tview.attachEvent(\"onAction\", (action, p)=> {\n\t\tif(action == \"before-grid-change\")\n\t\t\tupdatePosition(view, p.name,p.inc,p.data, p.start);\n\t});\n}\n\nfunction _undoComment(view, row, column, value){\n\tif(getComment(view, row, column))\n\t\tremoveComment(view, row, column, true);\n\tif(value)\n\t\tcommentCell(view, row, column, value, true);\n}\n\nfunction reset(view){\n\tview.comments._pull = {};\n}\n\nfunction removeComment(view, row, column, silent){\n\tif(getComment(view, row, column)){\n\t\tif (!silent)\n\t\t\tview.callEvent(\"onAction\", [\"comment\", {row, column, newValue: null, value: view.comments._pull[row][column]}]);\n\t\tdelete view.comments._pull[row][column];\n\t}\n\tview.$$(\"cells\").updateItem(row,column);\n}\n\nexport function removeCommentsRange(view, range){\n\tgroup.set(function(){\n\t\teachRange(range, view, function(view, cell){\n\t\t\tif(getComment(view, cell.row, cell.column))\n\t\t\t\tremoveComment(view, cell.row, cell.column);\n\t\t});\n\t\tview.$$(\"cells\").refresh();\n\t});\n}\n\nfunction commentCell(view, row, column, comment, silent){\n\tvar oldValue = getComment(view, row, column) ? view.comments._pull[row][column] : null;\n\tvar table = view.$$(\"cells\");\n\n\tif(typeof comment == \"string\")\n\t\tcomment = comment.trim() ? comment : \"\";\n\tview.comments._pull[row] = view.comments._pull[row] ? view.comments._pull[row] : {};\n\tview.comments._pull[row][column] = comment;\n\n\ttable.addCellCss(row, column, \"ssheet_commented_cell\");\n\n\tif (!silent)\n\t\tview.callEvent(\"onAction\", [\"comment\", {row, column, newValue:comment, value:oldValue}]);\n}\n\nexport function serialize(view,data){\n\tvar row, column,\n\t\tcomments = [];\n\tfor(row in view.comments._pull){\n\t\tfor(column in view.comments._pull[row])\n\t\t\tif(view.comments._pull[row][column])\n\t\t\t\tcomments.push([row, column, view.comments._pull[row][column]]);\n\t}\n\tdata.comments = comments;\n}\n\nexport function load(view,data){\n\tvar i,\n\t\tcomments = data.comments;\n\n\tif(comments)\n\t\tfor(i = 0; i < comments.length; i++)\n\t\t\tcommentCell(view, comments[i][0], comments[i][1], comments[i][2], true);\n}\n\nfunction updatePosition(view, name, inc, data, start){\n\tlet comments = data.comments,\n\t\ti = comments.length;\n\n\tif(inc){\n\t\twhile(i--){\n\t\t\tlet [row,column] = comments[i];\n\t\t\tif(row && name == \"row\" && row>= start.row || column && name == \"column\" && column >= start.column){\n\t\t\t\tif (name == \"row\"){\n\t\t\t\t\tif (row < start.row - inc)\t//delete comment if row was deleted\n\t\t\t\t\t\tcomments.splice(i,1);\n\t\t\t\t\telse\t\t\t\t\t\t//update mark position if upper row was deleted\n\t\t\t\t\t\tcomments[i][0] = row*1 + inc;\n\t\t\t\t} else if (name == \"column\"){\n\t\t\t\t\tif (column < start.column - inc){\n\t\t\t\t\t\tcomments.splice(i, 1);\n\t\t\t\t\t} else \n\t\t\t\t\t\tcomments[i][1] = column*1 + inc;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n}\n\nfunction getComment(view, row, column){\n\treturn view.comments._pull[row] && view.comments._pull[row][column] ? view.comments._pull[row][column] : \"\";\n}","export function init(view) {\n\tview.attachEvent(\"onUndo\", (action, row, column, value) => {\n\t\tif (action == \"show-formulas\"){\n\t\t\tshowFormulas(view, value);\n\t\t}\n\t});\n}\n\nexport function showFormulas(view, value){\n\tconst grid = view.$$(\"cells\");\n\tconst old = grid.config.showFormulas;\n\n\tif(value == \"toggle\")\n\t\tvalue = !old;\n\n\tif(value != old){\n\t\tgrid.config.showFormulas = value;\n\n\t\tview.callEvent(\"onCommand\", [{id:\"toolbar-update\", name:\"show-formulas\", value}]);\n\t\tview.callEvent(\"onAction\", [\"show-formulas\", {newValue: value, value: old}]);\n\n\t\tgrid.refresh();\n\t}\n}\n\nexport function serialize(view, data){\n\tdata.table.showFormulas = view.$$(\"cells\").config.showFormulas ? 1 : 0;\n}\n\nexport function load(view, data){\n\tlet mode = false;\n\tif(data.table && data.table.showFormulas)\n\t\tmode = data.table.showFormulas;\n\tshowFormulas(view, mode);\n}","import * as m1  from \"./hide_gridlines\";\nimport * as m2  from \"./hide_headers\";\nimport * as m3  from \"./lock_cell\";\nimport * as m4  from \"./dropdown\";\nimport * as m5  from \"./filter\";\nimport * as m6  from \"./hide_row_col\";\nimport * as m7  from \"./comments\";\nimport * as m8  from \"./show_formulas\";\n\nexport function init(view){\n\tvar modules = [m1,m2,m3,m4,m5,m6,m7,m8];\n\tview.attachEvent(\"onDataSerialize\", function(data){\n\t\tfor (var i = 0; i < modules.length; i++){\n\t\t\tif(modules[i].serialize)\n\t\t\t\tmodules[i].serialize(view,data);\n\t\t}\n\n\t});\n\tview.attachEvent(\"onDataParse\", function(data){\n\t\tfor (var i = 0; i < modules.length; i++){\n\t\t\tif(modules[i].load)\n\t\t\t\tmodules[i].load(view,data);\n\t\t}\n\t});\n}","const types = [\".xls\",\".xlt\",\".xla\",\".xlsx\",\".xlsm\",\".xltx\",\".xltm\",\".xlam\",\".xlsb\"];\n\nexport function init(view){\n\tlet uploader;\n\tif (window.XMLHttpRequest && (new XMLHttpRequest()).upload){\n\t\tuploader = webix.ui({\n\t\t\tview:\"uploader\",\n\t\t\tapiOnly:true,\n\t\t\taccept: types.join()\n\t\t});\n\n\t\tuploader.attachEvent(\"onBeforeFileAdd\",webix.bind(function(upload){\n\t\t\tif(types.indexOf(\".\"+upload.type.toLowerCase())>-1){\n\t\t\t\tview.reset();\n\n\t\t\t\tif(!upload.file.options)\n\t\t\t\t\tupload.file.options = {};\n\t\t\t\twebix.extend(upload.file.options, {cellDates: false, sheetStubs: view.config.sheetStubs});\n\n\t\t\t\tview.parse(upload.file, \"excel\");\n\t\t\t}\n\t\t\treturn false;\n\t\t},this));\n\n\t\tview._destroy_with_me.push(uploader);\n\t}\n\n\tview.attachEvent(\"onCommand\", (obj) => {\n\t\tif (obj.id === \"excel-import\")\n\t\t\tstartImport(view, uploader);\n\t});\n}\n\nfunction startImport(view, uploader){\n\tif (!uploader)\n\t\tview.alert(webix.i18n.spreadsheet.labels[\"import-not-support\"]);\n\telse\n\t\twebix.delay(() => uploader.fileDialog());\n}","import { style_names } from \"../operations/styles\";\nimport { getType } from \"../operations/types\";\nimport { defaultStyles} from \"../toolbar/defaults\";\nimport { getFormatSource } from \"../operations/formats\";\nimport { getDimension } from \"../helpers/array\";\nimport { getConditionCss } from \"../operations/conditional_formats\";\nimport { getRenderedValue } from \"../table\";\nimport {getSheet, isVisible} from \"../sheets\";\n\nexport function init(view){\n\tconst table = view._table;\n\tview.$exportView = function(options){\n\t\tconst pdf = options.export_mode == \"pdf\";\n\t\tconst excel = options.export_mode == \"excel\";\n\t\tconst defaultOptions = {\n\t\t\tstubCells: true,\n\t\t\theader: false,\n\t\t\tfooter:false,\n\t\t\theights:true,\n\t\t\trawValues: !pdf,\n\t\t\tfilterHTML:true,\n\t\t\tspans: true,\n\t\t\tstyles:true,\n\t\t\tmath: !pdf,\n\t\t\thidden: excel,\n\t\t\txCorrection: table.config.header || options.hidden ? 1 : 0,\n\t\t\tignore:{rowId:true},\n\t\t\tconditions:true\n\t\t};\n\n\t\twebix.extend(options, defaultOptions);\n\n\t\tif(excel || pdf)\n\t\t\treturn _exportView(view, options);\n\t\telse\n\t\t\treturn table;\n\t};\n\n\ttable.$getExportValue = function(row, column, options){\n\t\tlet value = view.getCellValue(row, column, options.math);\n\t\tconst mode = options.export_mode;\n\t\tconst math = options.math && value[0] == \"=\" && value.length > 1;\n\n\t\tif((mode == \"pdf\" || mode == \"csv\") && !math && !options.rawValues)\n\t\t\tvalue = getRenderedValue(view, row, column);\n\t\telse if(mode == \"excel\" && math){\n\t\t\tif(/^=(image|sparkline)\\(/i.test(value))\n\t\t\t\tvalue = \"\";\n\t\t\telse\n\t\t\t\tvalue = {\n\t\t\t\t\tvalue: /^=hyperlink\\(/i.test(value) ? value.split(\"\\\"\")[3] : view.getCellValue(row, column, false),\n\t\t\t\t\tformula: value\n\t\t\t\t};\n\t\t}\n\n\t\treturn value;\n\t};\n}\n\nfunction _exportView(view, options){\n\tconst excel = options.export_mode == \"excel\";\n\n\tif(options.sheets === true) \n\t\toptions.sheets = view._sheets.map(function(s){ return s.name;});\n\telse if(!options.sheets || !options.sheets.length)\n\t\toptions.sheets = [view._activeSheet];\n\telse if(typeof options.sheets == \"string\")\n\t\toptions.sheets = [options.sheets];\n\n\tif(!excel)\n\t\toptions.sheets = options.sheets.filter(sheet => isVisible(view, sheet));\n\telse if(view._sheets.length != options.sheets.length){\n\t\tfor(let i = 0; i < view._sheets.length; i++){\n\t\t\t//add veryHidden sheets in any case\n\t\t\tconst sheet = view._sheets[i];\n\t\t\tif(sheet.state == \"veryHidden\" && options.sheets.indexOf(sheet.name) == -1)\n\t\t\t\toptions.sheets.push(sheet.name);\n\t\t}\n\t}\n\n\toptions.dataOnly = true;\n\n\tlet data = [];\n\tlet active = view._activeSheet;\n\n\tfor(let i = 0; i<options.sheets.length; i++){\n\t\tconst sheet = options.sheets[i];\n\t\tconst id = sheet.id || sheet;\n\n\t\tview.showSheet(id);\n\n\t\tconst oldZoom = view._zoom;\n\t\tview.ignoreUndo(() => view.zoom(1));\n\n\t\tif(options.hidden)\n\t\t\toptions.xCorrection = 1;\n\n\t\tconst sheetOptions = sheet.options ? webix.extend(sheet.options, options) : webix.copy(options);\n\t\tif(id != active)\n\t\t\tsheetOptions._hidden = true;\n\t\tif(!sheetOptions.name)\n\t\t\tsheetOptions.name = id;\n\n\t\tconst pdfTable = !excel && sheetOptions.display != \"image\";\n\n\t\tconst serialized = view.serialize();\n\t\tconst [rows, cols] = getDimension(serialized.data, serialized.spans, 0, 0);\n\n\t\tif(!excel){\n\t\t\tif(webix.isUndefined(sheetOptions.textBefore))\n\t\t\t\tsheetOptions.textBefore = sheetOptions.name;\n\t\t\tif(pdfTable){\n\t\t\t\tsheetOptions.ignore = sheetOptions.ignore || {};\n\t\t\t\tfor(let i = cols+1; i <= view.config.columnCount; i++){\n\t\t\t\t\tsheetOptions.ignore[i] = true;\n\t\t\t\t}\n\n\t\t\t\tconst filter = sheetOptions.filter || (()=>true);\n\t\t\t\tsheetOptions.filter = obj =>{\n\t\t\t\t\treturn obj.id <= rows && filter.apply(this, arguments);\n\t\t\t\t};\n\t\t\t}\n\t\t}\n\n\t\tconst sheetData = webix[excel ? \"toExcel\" : \"toPDF\"](view._table, sheetOptions);\n\n\t\tif(excel)\n\t\t\tsheetData[0].state = getSheet(view, id).state || \"visible\";\n\n\t\tif(pdfTable && sheetData[0].scheme.length == 0)\n\t\t\tcontinue;\n\n\t\tif((excel || pdfTable) && sheetOptions.styles){\n\t\t\tconst styles = sheetData[0].styles = _getStyles(view, sheetOptions, excel, rows, cols);\n\n\t\t\tif(pdfTable)\n\t\t\t\t_updatePdfData(styles, sheetData, sheetOptions, view, serialized);\n\t\t}\n\n\t\tdata = data.concat(sheetData);\n\n\t\tif(excel){\n\t\t\tdata[i].ranges = [];\n\n\t\t\tview.ranges.serialize(id).forEach(range => {\n\t\t\t\tconst ref = range[1].split(\"!\");\n\t\t\t\tdata[i].ranges.push({\n\t\t\t\t\tSheet: range[2] ? null : i,\n\t\t\t\t\tName: range[0],\n\t\t\t\t\tRef: ref[0]+\"!\"+ref[1].replace(/[0-9]+|[A-Z]+/gi, (match)=>`$${match}`)\n\t\t\t\t});\n\t\t\t});\n\t\t}\n\t\telse{\n\t\t\tif(options.autowidth)\n\t\t\t\tgetAutowidth(sheetOptions, options);\n\t\t}\n\n\t\tview.ignoreUndo(() => view.zoom(oldZoom));\n\t}\n\n\tview.showSheet(active);\n\tdelete options.dataOnly;\n\treturn data;\n}\n\nfunction _updatePdfData(styles, sheetData, sheetOptions, view, serialized){\n\tconst header = sheetOptions.header ? 1 : 0;\n\n\tif (sheetOptions.spans) {\n\t\tconst spans = serialized.spans.sort((a,b) => a[1]<b[1]?1:(a[1]>b[1]?-1:0));\n\t\tfor (let i = 0; i < spans.length; i++) {\n\t\t\tif (spans[i][2] > 1) {\n\t\t\t\tlet row = spans[i][0] - 1 + header, // zero-based row position\n\t\t\t\t\tcol = spans[i][1] - 1, // zero-based col position\n\t\t\t\t\tcols = spans[i][2];\n\t\t\t\tif (styles[row] && styles[row][col]) {\n\t\t\t\t\tstyles[row][col].colspan = cols;\n\t\t\t\t\t// if colspan, then remove merged cells (else PDFJS will shift columns)\n\t\t\t\t\tconst rowData = sheetData[0].exportData[row - header];\n\t\t\t\t\tif (rowData){\n\t\t\t\t\t\t// remove merged cell values\n\t\t\t\t\t\trowData.splice(col + 1, cols - 1);\n\t\t\t\t\t}\n\t\t\t\t\tlet style = Object.values(styles[row]);\n\t\t\t\t\tstyle.splice(col + 1, cols - 1); // remove merged cell styles\n\t\t\t\t\tstyles[row] = style;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tconst data = sheetData[0].exportData;\n\tfor(let r = 0; r < data.length; r++){\n\t\tfor (let c = 0; c < data[r].length; c++) {\n\t\t\tlet height = view.$$(\"cells\").config.rowHeight;\n\n\t\t\tif(sheetOptions.heights && serialized.sizes.length){\n\t\t\t\tfor(let s = 0; s < serialized.sizes.length; s++){\n\t\t\t\t\tconst rowSize = serialized.sizes[s][0];\n\t\t\t\t\tif(rowSize && rowSize == r+1){\n\t\t\t\t\t\theight = serialized.sizes[s][2];\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tconst cellStyle = styles[r + header][c];\n\t\t\tconst align = cellStyle.vertAlign;\n\t\t\tconst pad = height*0.75 - cellStyle.fontSize; // available px for padding in top & bottom\n\t\t\tcellStyle.paddingTop = (align == \"top\" ? 0 : (align == \"bottom\" ? pad : pad / 2));\n\t\t\tcellStyle.paddingBottom = (align == \"bottom\" ? 0 : (align == \"top\" ? pad : pad / 2));\n\t\t}\n\t}\n}\n\nfunction getAutowidth(view, options){\n\tconst prop = options.orientation && options.orientation == \"landscape\" ? \"height\" : \"width\";\n\tlet width;\n\n\tif(view.$width)\n\t\twidth = view.$width;\n\telse //'view' can be local settings and we need to compare them with common ones\n\t\twidth = view[prop];\n\n\toptions[prop] = Math.max(options[prop] || 0, width || 0);\n}\n\nfunction _safeColor(str){\n\tstr = str.substring(1);\n\tif(str.length === 3) str = str+str;\n\treturn str;\n}\n\nfunction _getDefaults(options){\n\tlet d = defaultStyles;\n\tif(options.export_mode == \"excel\")\n\t\treturn {\n\t\t\tfont:{\n\t\t\t\tsz:d[\"font-size\"]*0.75,\n\t\t\t\tname:d[\"font-family\"].replace(/'|,.*$/g, \"\"),\n\t\t\t\t//we do not export default color, but it is the right place to do it\n\t\t\t},\n\t\t\talignment:{\n\t\t\t\thorizontal:d[\"text-align\"],\n\t\t\t\tvertical:d[\"vertical-align\"]==\"middle\"?\"center\":d[\"vertical-align\"],\n\t\t\t\twrapText:d[\"white-space\"]!=\"nowrap\"\n\t\t\t}\n\t\t};\n\telse\n\t\treturn {\n\t\t\tfontSize: d[\"font-size\"]*0.75,\n\t\t\t//we do not export default color, but it is the right place to do it\n\t\t\ttextAlign: d[\"text-align\"],\n\t\t\twhiteSpace: (d[\"white-space\"]!=\"nowrap\")\n\t\t};\n}\n\nfunction _getStyles(view, options, excel, rows, cols){\n\tview.compactStyles();\n\n\tlet result = [];\n\tconst cached = {};\n\tconst cachedConditions = {};\n\tconst defaults = _getDefaults(options);\n\n\tif(excel && options.docHeader) result  = result.concat([{0:_getDocStyle(options.docHeader.css, defaults)}, {}]);\n\tif(options.header) result.push({});\n\n\tconst delta = result.length;\n\n\tconst grid = view.$$(\"cells\");\n\n\tlet rIndex = delta;\n\tgrid.eachRow(row =>{\n\t\tif(row > rows)\n\t\t\treturn;\n\n\t\tlet cIndex = 0;\n\t\tgrid.eachColumn(col => {\n\t\t\tif(cIndex > cols)\n\t\t\t\treturn;\n\n\t\t\tif(cIndex >= options.xCorrection){\n\t\t\t\tconst css = view.getStyle(row, col);\n\t\t\t\tconst index = cIndex - options.xCorrection;\n\n\t\t\t\tresult[rIndex] = result[rIndex] || {};\n\n\t\t\t\tlet styles;\n\t\t\t\tif(css){\n\t\t\t\t\tif(cached[css.id])\n\t\t\t\t\t\tstyles = webix.copy(cached[css.id]);\n\t\t\t\t\telse{\n\t\t\t\t\t\tstyles = _getCellStyle(css.text, excel, options);\n\n\t\t\t\t\t\tfor(let name in defaults){\n\t\t\t\t\t\t\tif(excel)\n\t\t\t\t\t\t\t\twebix.extend(styles[name], defaults[name]);\n\t\t\t\t\t\t\telse if (!styles[name])\n\t\t\t\t\t\t\t\tstyles[name] = defaults[name];\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tcached[css.id] = webix.copy(styles);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t\tstyles = webix.copy(defaults);\n\n\t\t\t\tif(options.conditions){\n\t\t\t\t\t//not real excel condition, save only bg and color (sheetJS doesn't support)\n\t\t\t\t\tconst condition = _getCellConditions(view, row, col, cachedConditions);\n\t\t\t\t\tif(condition)\n\t\t\t\t\t\t_updateStyleCondition(styles, condition, excel);\n\t\t\t\t}\n\n\t\t\t\tresult[rIndex][index] = styles;\n\n\t\t\t\tlet type;\n\t\t\t\tif(options.math){\n\t\t\t\t\tconst math = view.getCellValue(row, col);\n\t\t\t\t\tif(typeof math == \"string\" && math[0] == \"=\" && math.length > 1){\n\t\t\t\t\t\tconst value = view.getCellValue(row, col, false);\n\t\t\t\t\t\tif(isNaN(value))\n\t\t\t\t\t\t\ttype = \"string\";\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tresult[rIndex][index].type = type || getType(view, row, col);\n\t\t\t}\n\t\t\tcIndex++;\n\t\t}, options.hidden);\n\t\trIndex++;\n\t}, options.hidden);\n\n\tif(excel && options.docFooter) result  = result.concat([{},{0:_getDocStyle(options.docFooter.css, defaults)}]);\n\n\treturn result;\n}\n\nfunction _getCellStyle(styles, excel, options){\n\tlet str = styles.split(\";\");\n\tlet stl = {};\n\tif(excel)\n\t\tstl = { font:{}, alignment:{}, border:{}};\n\n\tfor(let s = 0; s<str.length; s++){\n\t\tif(str[s]){\n\t\t\tif(excel)\n\t\t\t\t_getExcelCellStyle(stl, str, s);\n\t\t\telse\n\t\t\t\t_getPdfCellStyle(stl, str, s, options.table);\n\t\t}\n\t}\n\n\treturn stl;\n}\n\nfunction _getCellConditions(view, r, c, cached){\n\tconst rendered = getRenderedValue(view, r, c);\n\tconst css = getConditionCss(view, r, c, rendered);\n\tif(css){\n\t\tif(cached[css])\n\t\t\treturn cached[css];\n\t\tconst el = webix.html.create(\"div\", {\"class\":css});\n\t\tdocument.body.appendChild(el);\n\n\t\tconst computed = window.getComputedStyle(el);\n\t\tconst bg = computed.backgroundColor;\n\t\tconst color = computed.color;\n\n\t\tdocument.body.removeChild(el);\n\n\t\tcached[css] = [bg, color];\n\t\treturn cached[css];\n\t}\n}\n\nfunction _updateStyleCondition(stl, condition, excel){\n\tlet [bg, color] = condition.map(val => webix.color.rgbToHex(val));\n\tif(excel){\n\t\tstl.fill = {fgColor:{rgb:bg}};\n\t\tstl.font.color = {rgb:color};\n\t}\n\telse{\n\t\tstl.backgroundColor = bg;\n\t\tstl.color = color;\n\t}\n}\n\nfunction _getExcelCellStyle(stl, str, s){\n\tswitch (style_names[s]){\n\t\tcase \"color\":\n\t\t\tstl.font.color = {rgb:_safeColor(str[s])};\n\t\t\tbreak;\n\t\tcase \"background\":{\n\t\t\tconst fill = _safeColor(str[s]);\n\t\t\tif(fill && fill.toLowerCase() !== \"ffffff\")\n\t\t\t\tstl.fill = { fgColor:{ rgb:fill}};\n\t\t\tbreak;\n\t\t}\t\n\t\tcase \"text-align\":\n\t\t\tstl.alignment.horizontal = str[s];\n\t\t\tbreak;\n\t\tcase \"font-family\":\n\t\t\tstl.font.name = str[s].replace(/'|,.*$/g, \"\"); // cut off fallback font\n\t\t\tbreak;\n\t\tcase \"font-size\":\n\t\t\tstl.font.sz = str[s].replace(\"px\", \"\")*0.75; //px to pt conversion\n\t\t\tbreak;\n\t\tcase \"font-style\":\n\t\t\tstl.font.italic = str[s] == \"italic\";\n\t\t\tbreak;\n\t\tcase \"underline\":\n\t\t\tstl.font.underline = str[s] == \"underline\";\n\t\t\tbreak;\n\t\tcase \"strike\":\n\t\t\tstl.font.strike = str[s] == \"strike\";\n\t\t\tbreak;\n\t\tcase \"font-weight\":\n\t\t\tstl.font.bold = str[s] == \"bold\";\n\t\t\tbreak;\n\t\tcase \"vertical-align\":\n\t\t\tstl.alignment.vertical = str[s] == \"middle\"?\"center\":str[s];\n\t\t\tbreak;\n\t\tcase \"wrap\":\n\t\t\tstl.alignment.wrapText = str[s] == \"wrap\";\n\t\t\tbreak;\n\t\tcase \"borders\":\n\t\t\tbreak;\n\t\tcase \"format\":\n\t\t\tstl.format = getFormatSource(str[s], true) || \"\";\n\t\t\tbreak;\n\t\tcase \"border-right\":\n\t\tcase \"border-bottom\":\n\t\tcase \"border-left\":\n\t\tcase \"border-top\":\n\t\t\tstl.border[ style_names[s].split(\"-\")[1] ] = getBorderStyles(str[s], true);\n\t\t\tbreak;\n\t\tcase \"indent\":\n\t\t\tstl.alignment.indent = str[s];\n\t\t\tbreak;\n\t}\n}\n\nfunction _getPdfCellStyle(stl, str, s, table){\n\tswitch (style_names[s]) {\n\t\tcase \"color\":\n\t\t\tstl.color = _safeColor(str[s]);\n\t\t\tbreak;\n\t\tcase \"background\":\n\t\t\tstl.backgroundColor = _safeColor(str[s]);\n\t\t\tbreak;\n\t\tcase \"text-align\":\n\t\t\tstl.textAlign = str[s];\n\t\t\tbreak;\n\t\tcase \"font-family\":\n\t\t\tbreak;\n\t\tcase \"font-size\":\n\t\t\tstl.fontSize = str[s].replace(\"px\", \"\")*0.75;\n\t\t\tbreak;\n\t\tcase \"font-style\":\n\t\t\tstl.italic = str[s] == \"italic\";\n\t\t\tbreak;\n\t\tcase \"underline\":\n\t\t\tstl.underline = str[s] == \"underline\";\n\t\t\tbreak;\n\t\tcase \"strike\":\n\t\t\tstl.strikethrough = str[s] == \"strike\";\n\t\t\tbreak;\n\t\tcase \"font-weight\":\n\t\t\tstl.bold = str[s] == \"bold\";\n\t\t\tbreak;\n\t\tcase \"vertical-align\":\n\t\t\tstl.vertAlign = str[s]; // not supported in PDFJS, so simulate with lineHeight and paddingTop\n\t\t\tbreak;\n\t\tcase \"wrap\":\n\t\t\tstl.whiteSpace = (str[s] != \"nowrap\");\n\t\t\tbreak;\n\t\tcase \"borders\":\n\t\t\tbreak;\n\t\tcase \"format\":\n\t\t\tbreak;\n\t\tcase \"border-right\":\n\t\tcase \"border-bottom\":\n\t\tcase \"border-left\":\n\t\tcase \"border-top\":{\n\t\t\tconst pos = style_names[s].split(\"-\")[1];\n\t\t\tstl[`border${pos[0].toUpperCase() + pos.substring(1)}Color`] = getBorderStyles(str[s]);\n\t\t\tbreak;\n\t\t}\n\t\tcase \"indent\":\n\t\t\tif(str[s]){\n\t\t\t\tconst name = `padding${ str[2] == \"right\" ? \"Right\" : \"Left\" }`;\n\t\t\t\tconst padding = table && table[name] ? table[name] : 10; // 10 - default padding value\n\t\t\t\tstl[name] = padding + str[s] * 6;\n\t\t\t}\n\t\t\tbreak;\n\t}\n}\n\nfunction getBorderStyles(val, excel){\n\tconst [color, type] = val.split(\",\");\n\n\tif(excel)\n\t\treturn { color:{ rgb:_safeColor(color)}, style:type};\n\telse\n\t\treturn _safeColor(color);\n}\n\nfunction _getDocStyle(css){\n\tif(!css) return {};\n\tconst str = [];\n\tfor(let i =0; i<style_names.length; i++)\n\t\tstr.push(css[style_names[i]]||\"\");\n\treturn _getCellStyle(str.join(\";\"), true);\n}","import { style_names } from \"../operations/styles\";\nimport { fontFamily} from \"../toolbar/buttons\";\nimport { defaultStyles} from \"../toolbar/defaults\";\nimport { formatCache, formatsCount } from \"../operations/formats\";\nimport { find } from \"../helpers/array\";\n\nexport function init(view){\n\tview._parseExcel = function(obj, driver){\n\t\tconst options = obj.options || {};\n\t\toptions.math = view.config.math;\n\n\t\tconst full = { sheets:[]};\n\t\tconst fmt = {count: formatsCount, cache:{}};\n\t\tfor(let i  = 0; i< obj.names.length; i++){\n\t\t\toptions.name = obj.names[i];\n\t\t\tfull.sheets.push({\n\t\t\t\tname:options.name,\n\t\t\t\tstate:obj.states[i],\n\t\t\t\tcontent:_excel_to_data(driver.getSheet(obj, options), obj.ranges, i, fmt)\n\t\t\t});\n\t\t}\n\t\treturn full;\n\t};\n\tview._parseCsv = function(obj, driver){\n\t\tobj = driver.getRecords(obj);\n\n\t\tconst dataObj = webix.copy(obj);\n\t\tconst data = [];\n\n\t\tfor(let i = 0; i < dataObj.length; i++){\n\t\t\tlet item = dataObj[i].split(driver.cell);\n\t\t\tfor(let c  = 0; c<item.length; c++){\n\t\t\t\tconst row = i+1, column = c+1;\n\t\t\t\tdata.push([row, column, item[c]]);\n\t\t\t}\n\t\t}\n\t\treturn { data };\n\t};\n}\n\nfunction _excel_to_data(obj, ranges, index, fmt){\n\tconst dataObj = webix.copy(obj.data);\n\tconst data =  [];\n\n\tfor (let i = 0; i < dataObj.length; i++){\n\t\tfor(let c = 0; c<dataObj[0].length; c++){\n\t\t\tconst row = i+1, column = c+1;\n\t\t\tdata.push([row, column, dataObj[i][c]]);\n\t\t}\n\t}\n\tobj.data = data;\n\n\t//merged cells\n\tif(obj.spans){\n\t\tfor(let i = 0; i<obj.spans.length; i++){\n\t\t\tobj.spans[i][0]++;\n\t\t\tobj.spans[i][1]++;\n\t\t}\n\t}\n\n\t//named ranges\n\tif(ranges){\n\t\tfor(let r = 0; r < ranges.length; r++){\n\t\t\tconst sheetIndex = ranges[r].Sheet;\n\t\t\tconst book = webix.isUndefined(sheetIndex);\n\t\t\tif(book || sheetIndex === index){\n\t\t\t\tobj.ranges = obj.ranges || [];\n\t\t\t\tobj.ranges.push([ranges[r].Name.toUpperCase(), ranges[r].Ref.substring(ranges[r].Ref.indexOf(\"!\")+1).replace(/\\$/g, \"\"), book]);\n\t\t\t}\n\t\t}\n\t}\n\n\t//cell styles\n\tif(obj.styles)\n\t\t_getStyles(obj, fmt);\n\n\tif(obj.types)\n\t\t_getTypes(obj);\n\n\tif(obj.hidden){\n\t\t_getHidden(obj);\n\t}\n\n\t//column width and row height\n\tif(obj.sizes){\n\t\tfor(let i = 0; i<obj.sizes.length; i++){\n\t\t\tif(obj.sizes[i][0] == \"column\")\n\t\t\t\tobj.sizes[i] = [0, obj.sizes[i][1]+1, obj.sizes[i][2]];\n\t\t\telse\n\t\t\t\tobj.sizes[i] = [obj.sizes[i][1]+1, 0, obj.sizes[i][2]];\n\t\t}\n\t}\n\n\treturn obj; \n}\n\n//ARGB conversion\nfunction _safeColor(str){\n\tstr = str || \"000000\";\n\tif(str.length === 8) str = str.substring(2);\n\treturn \"#\"+str;\n}\n\n//only fonts that we support can be imported\nfunction _safeFont(str){\n\tlet safe = defaultStyles[\"font-family\"];\n\tfor(let i = 0; i<fontFamily.length; i++){\n\t\tif(fontFamily[i].value == str) { safe = fontFamily[i].id; break; }\n\t}\n\treturn safe;\n}\n\nfunction _getTypes(obj){\n\tobj.types.forEach(type => {\n\t\tfor(let i = 0; i < obj.data.length; i++){\n\t\t\tif(obj.data[i][0] === type[0]+1 && obj.data[i][1] === type[1]+1){\n\t\t\t\tobj.data[i][4] = type[2];\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t});\n}\n\nfunction _getHidden(obj){\n\tconst hidden = {\n\t\trow:[],\n\t\tcolumn:[]\n\t};\n\n\tfor(let i = 0; i < obj.hidden.length; i++){\n\t\tconst item = obj.hidden[i];\n\t\tif(item[0] == \"column\")\n\t\t\thidden.column.push(item[1]+1);\n\t\telse\n\t\t\thidden.row.push(item[1]+1);\n\t}\n\n\tobj.table = {hidden};\n}\n\nfunction _getBorderStyles(pos, stl){\n\tpos = pos.replace(\"border-\", \"\");\n\tif(stl.border && stl.border[pos]){\n\t\tconst border = stl.border[pos];\n\t\tif(border.color){\n\t\t\tconst color = _safeColor(border.color.rgb) || \"\";\n\t\t\tconst type = border.style || \"\";\n\t\t\treturn `${color},${type}`;\n\t\t}\n\t}\n\treturn \"\";\n}\n\nfunction _getStyles(obj, fmt){\n\tlet stylescount = 1;\n\tconst styleshash = {}, styles = [], formats = [];\n\n\tfor(let i = 0; i<obj.styles.length; i++){\n\t\tlet str = [], stl = obj.styles[i][2], css;\n\n\t\tfor(let s  = 0; s<style_names.length; s++){\n\t\t\tswitch (style_names[s]){\n\t\t\t\tcase \"color\": \n\t\t\t\t\tstr[s] = stl.font && stl.font.color ? (_safeColor(stl.font.color.rgb) || \"\") : \"\";\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"background\":\n\t\t\t\t\tstr[s] = stl.fill && stl.fill.fgColor ? (_safeColor(stl.fill.fgColor.rgb) || \"\") : \"\";\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"text-align\":\n\t\t\t\t\tstr[s] = (stl.alignment ? stl.alignment.horizontal : \"\") || defaultStyles[\"text-align\"];\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"font-family\":\n\t\t\t\t\tstr[s] = stl.font && stl.font.name ? _safeFont(stl.font.name) : \"\";\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"font-size\":\n\t\t\t\t\tstr[s] = stl.font && stl.font.sz ? ((stl.font.sz/0.75)+\"px\" || \"\") : \"\"; //pt to px conversion\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"font-style\":\n\t\t\t\t\tstr[s] = stl.font && stl.font.italic ? \"italic\" : \"\";\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"underline\":\n\t\t\t\t\tstr[s] = stl.font && stl.font.underline ? \"underline\" : \"\";\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"strike\":\n\t\t\t\t\tstr[s] = stl.font && stl.font.strike ? \"strike\" : \"\";\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"font-weight\":\n\t\t\t\t\tstr[s] = stl.font && stl.font.bold ? \"bold\" : \"\";\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"vertical-align\":{\n\t\t\t\t\tconst va = stl.alignment ? (stl.alignment.vertical || \"\") : \"\";\n\t\t\t\t\tstr[s] = (va == \"center\" ? \"middle\" : va) || defaultStyles[\"vertical-align\"];\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t\tcase \"wrap\":\n\t\t\t\t\tstr[s] = stl.alignment && stl.alignment.wrapText ? \"wrap\" : \"nowrap\";\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"borders\":\n\t\t\t\t\tstr[s] = \"\";\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"format\":{\n\t\t\t\t\tlet format = stl.numFmt;\n\t\t\t\t\tlet name = \"\";\n\t\t\t\t\tif(format && format != \"General\"){\n\t\t\t\t\t\tformat = format.replaceAll(\"\\\\\", \"\");\n\t\t\t\t\t\tif(formatCache[format])\n\t\t\t\t\t\t\tname = formatCache[format];\n\t\t\t\t\t\telse if(fmt.cache[format])\n\t\t\t\t\t\t\tname = fmt.cache[format];\n\t\t\t\t\t\telse\n\t\t\t\t\t\t\tname = fmt.cache[format] = \"fmt\"+(fmt.count++);\n\n\t\t\t\t\t\tif(!find(formats, arr => arr[0] == name))\n\t\t\t\t\t\t\tformats.push([name, format]);\n\t\t\t\t\t}\n\t\t\t\t\tstr[s] = name;\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t\tcase \"border-right\":\n\t\t\t\tcase \"border-bottom\":\n\t\t\t\tcase \"border-left\":\n\t\t\t\tcase \"border-top\":\n\t\t\t\t\tstr[s] = _getBorderStyles(style_names[s], stl);\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"indent\":\n\t\t\t\t\tstr[s] = stl.alignment && stl.alignment.indent ? stl.alignment.indent : \"\";\n\t\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tstr = str.join(\";\");\n\t\tcss = styleshash[str] || \"wss\"+stylescount;\n\n\t\tfor(let d = 0; d<obj.data.length; d++){\n\t\t\tif(obj.data[d][0] === obj.styles[i][0]+1 && obj.data[d][1] === obj.styles[i][1]+1){\n\t\t\t\tobj.data[d][3] = css;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tif(!styleshash[str]){\n\t\t\tstyles.push([css, str]);\n\t\t\tstyleshash[str] = css;\n\t\t\tstylescount++;\n\t\t}\n\t}\n\n\tobj.formats = formats;\n\tobj.styles = styles;\n}","import group from \"../operations/undo_group\";\n\nexport function init(view){\n\tview.attachEvent(\"onCommand\", (action) => {\n\t\tswitch (action.id) {\n\t\t\tcase \"clear-value\":\n\t\t\t\tview.clearRange(null,{values: true});\n\t\t\t\tbreak;\n\t\t\tcase \"clear-style\":\n\t\t\t\tview.clearRange(null,{styles: true});\n\t\t\t\tbreak;\n\t\t\tcase \"clear-conditional-formats\":\n\t\t\t\tview.clearRange(null,{conditions: true});\n\t\t\t\tbreak;\n\t\t\tcase \"clear-dropdown-editors\":\n\t\t\t\tview.clearRange(null,{editors: true});\n\t\t\t\tbreak;\n\t\t\tcase \"clear-all\":\n\t\t\t\tgroup.set(function(){\n\t\t\t\t\tview.clearRange(null,null);\n\t\t\t\t});\n\t\t\t\tbreak;\n\t\t\tcase \"clear-comments\":\n\t\t\t\tview.clearRange(null,{comments: true});\n\t\t\t\tbreak;\n\t\t}\n\t});\n}","import {numbers} from \"../sheets\";\nimport {zoomStyles} from \"./styles\";\nimport {zoomSizes} from \"./resize\";\n\nconst readyZoom = {};\n\nexport function init(view) {\n\tview.attachEvent(\"onUndo\", (action, row, column, value) => {\n\t\tif (action == \"zoom\"){\n\t\t\tzoom(view, value);\n\t\t}\n\t});\n\n\tview.attachEvent(\"onDataSerialize\", (data) => serialize(view, data));\n\tview.attachEvent(\"onDataParse\", (data) => load(view, data));\n}\n\nexport function zoom(view, newValue, load){\n\tconst grid = view.$$(\"cells\");\n\tconst value = view._zoom || 1;\n\n\tif(newValue == \"in\" || newValue == \"out\")\n\t\tnewValue = webix.ui[\"ssheet-zoom\"].prototype.getNext(value, newValue == \"in\" ? 1 : -1, numbers);\n\n\tview._zoom = newValue;\n\tgrid.define({ minColumnWidth: 40*newValue });\n\n\tif(view.$$(\"zoom\"))\n\t\tview.$$(\"zoom\").setValue(newValue);\n\n\tif(newValue != value){\n\t\tconst fontSize = webix.skin.$active.fontSize * newValue;\n\t\tconst rowHeight = webix.skin.$name == \"contrast\" || webix.skin.$name == \"flat\" ? 24 : 20;\n\t\tconst className = \"webix_ssheet_zoom_\"+newValue.toString().replace(\".\", \"_\");\n\n\t\tgrid.$view.className = grid.$view.className.replace(/ webix_ssheet_zoom_\\w+/,\"\");\n\t\tgrid.define({css: className});\n\n\t\tif(!load){\n\t\t\tzoomSizes(view, value);\n\t\t\tzoomStyles(view);\n\n\t\t\tview.callEvent(\"onZoom\", [newValue, value]);\n\t\t}\n\n\t\tif(!readyZoom[className] && newValue != 1){\n\t\t\treadyZoom[className] = 1;\n\n\t\t\t// cells\n\t\t\twebix.html.addStyle(`\n\t\t\t\t.${className} .webix_hcell, .${className} .webix_cell{\n\t\t\t\t\tfont-size: ${fontSize}px;\n\t\t\t\t}\n\n\t\t\t\t.${className} .sheet_column_0 .webix_cell{\n\t\t\t\t\tpadding: 0 ${12*newValue}px;\n\t\t\t\t}\n\n\t\t\t\t.${className}.webix_ssheet_table .webix_hs_left .webix_hcell.webix_first:before{\n\t\t\t\t\tright: ${4*newValue}px;\n\t\t\t\t\tbottom: ${4*newValue}px;\n\t\t\t\t\tborder-top-width: ${(rowHeight - 8)*newValue}px;\n\t\t\t\t\tborder-right-width: ${(rowHeight - 8)*newValue}px;\n\t\t\t\t}\n\n\t\t\t\t.${className} .webix_cell{\n\t\t\t\t\tpadding: ${2*newValue}px 0px;\n\t\t\t\t}\n\n\t\t\t\t.${className} .webix_cell div:first-child{\n\t\t\t\t\tmargin: 0 ${12*newValue}px;\n\t\t\t\t}\n\t\t\t`);\n\n\t\t\t// icons\n\t\t\twebix.html.addStyle(`\n\t\t\t\t.${className} .webix_cell.ss_filter, .${className} .webix_cell.ss_editor{\n\t\t\t\t\tpadding-right: ${16*newValue}px;\n\t\t\t\t}\n\t\t\t\t.${className} .ssheet_filter_sign, .${className} .webix_cell.ss_editor:after{\n\t\t\t\t\tfont-size: ${20*newValue}px;\n\t\t\t\t\tright: ${6*newValue}px;\n\t\t\t\t}\n\t\t\t\t.${className} .webix_cell.ss_filter.ss_editor:after{\n\t\t\t\t\tright: ${28*newValue}px;\n\t\t\t\t}\n\t\t\t\t.${className} .webix_cell.ss_filter.ss_editor{\n\t\t\t\t\tpadding-right: ${36*newValue}px;\n\t\t\t\t}\n\t\t\t\t.${className} .webix_lock:before{\n\t\t\t\t\tfont-size: ${fontSize}px;\n\t\t\t\t}\n\t\t\t\t.${className} .ssheet_commented_sign:before{\n\t\t\t\t\tborder-top-width: ${8*newValue}px;\n\t\t\t\t\tborder-left-width: ${8*newValue}px;\n\t\t\t\t}\n\t\t\t`);\n\t\t}\n\t}\n}\n\nexport function serialize(view, data){\n\tdata.table = {\n\t\tzoom: view._zoom\n\t};\n}\n\nexport function load(view, data){\n\tlet value = 1;\n\tif(data.table && data.table.zoom)\n\t\tvalue = data.table.zoom;\n\n\tzoom(view, value, true);\n}","import group from \"../operations/undo_group\";\nimport {adjustRow, adjustColumn} from \"../operations/column_operations\";\n\n/* row operations */\n\nexport function insertRow(row){\n\tcallCommand(this, \"add\", \"row\", row);\n}\n\nexport function deleteRow(row){\n\tcallCommand(this, \"del\", \"row\", row);\n}\n\nexport function setRowHeight(row, height){\n\tsetSize(this, \"row\", row, height);\n}\n\n/* col operations */\n\nexport function insertColumn(column){\n\tcallCommand(this, \"add\", \"column\", column);\n}\n\nexport function deleteColumn(column){\n\tcallCommand(this, \"del\", \"column\", column);\n}\n\nexport function setColumnWidth(column, width){\n\tsetSize(this, \"column\", column, width);\n}\n\n/* helpers */\n\nfunction getCells(view, id, group){\n\tif(!id){\n\t\tlet area = view.$$(\"cells\").getSelectArea();\n\t\tif(area)\n\t\t\tid = [area.start[group],area.end[group]];\n\t}\n\telse if(!webix.isArray(id)){\n\t\tid =  [id,id];\n\t}\n\treturn id;\n}\n\nfunction callCommand(view, name, group, id){\n\tlet start = {}, end = {};\n\tid = getCells(view, id, group);\n\tif(!id)\n\t\treturn;\n\tstart[group] = id[0];\n\tend[group] = id[1];\n\tview.callEvent(\"onCommand\", [{id:name,  group:group}, start, end]);\n}\n\nfunction setSize(view, type, id, size){\n\tid = getCells(view, id, type);\n\tif(!id)\n\t\treturn;\n\tgroup.set(()=>{\n\t\tfor (let i = id[0]; i <= id[1]; i++){\n\t\t\tif(size != \"auto\"){\n\t\t\t\tsize *= view._zoom;\n\t\t\t\tview.$$(\"cells\")[type == \"row\" ? \"setRowHeight\" : \"setColumnWidth\"](i, size);\n\t\t\t}\n\t\t\telse\n\t\t\t\t(type == \"row\" ? adjustRow : adjustColumn)(i, view);\n\t\t}\n\t});\n}","import * as lock from \"../operations/lock_cell\";\n\nexport function lockCell(row, column, state){\n\tlock.lockCell(this, row, column, state);\n}\n\nexport function isCellLocked(row, column){\n\treturn lock.isCellLocked(this, row, column);\n}","import group from \"../operations/undo_group\";\n\nexport function freezeColumns(column){\n\tconst grid = this.$$(\"cells\");\n\n\tif( webix.isUndefined(column) ){\n\t\tconst sel = grid.getSelectArea();\n\t\tcolumn = sel ? sel.end.column : 0;\n\t}\n\n\tconst base = grid.config.columns[0].id == \"rowId\" ? 1 : 0;\n\tlet index = base;\n\tlet removeFreeze = false;\n\tif (column && column != this._frozenColumns){\n\t\tfor (let i = column; i > 0; i--) {\n\t\t\tindex = grid.getColumnIndex(i)+1;\n\t\t\tif(index)\n\t\t\t\tbreak;\n\t\t}\n\t\tif (!index) index = base;\n\t}\n\telse removeFreeze = true;\n\n\tgroup.set(function(){\n\t\tcheckSpans(this, \"column\", column);\n\t\tgrid.unselect();\n\t\tgrid.define(\"leftSplit\", index);\n\t\tgrid.refreshColumns();\n\n\t\tthis.callEvent(\"onAction\", [ \"freeze-column\", { value: (this._frozenColumns || 0), newValue: column}]);\n\t\tthis._frozenColumns = (removeFreeze || !column) ? 0 : column;\n\t},this);\n}\n\nexport function freezeRows(row){\n\tconst grid = this.$$(\"cells\");\n\n\tif( webix.isUndefined(row) ){\n\t\tconst sel = grid.getSelectArea();\n\t\trow = sel ? sel.end.row : 0;\n\t}\n\n\tlet index = 0;\n\tlet removeFreeze = false;\n\tif (row && row != this._frozenRows){\n\t\tfor (let i = row; i > 0; i--) {\n\t\t\tindex = grid.getIndexById(i)+1;\n\t\t\tif(index)\n\t\t\t\tbreak;\n\t\t}\n\t}\n\telse removeFreeze = true;\n\n\tgroup.set(function(){\n\t\tcheckSpans(this, \"row\", row);\n\t\tgrid.unselect();\n\t\tgrid.define(\"topSplit\", index);\n\t\tgrid.refreshColumns();\n\n\t\tthis.callEvent(\"onAction\", [ \"freeze-row\", { value: this._frozenRows, newValue: row}]);\n\t\tthis._frozenRows = (removeFreeze || !row) ? 0 : row;\n\t},this);\n}\n\nfunction checkSpans(view, type, num){\n\tconst grid = view.$$(\"cells\");\n\tconst spans = grid.getSpan();\n\tlet changed;\n\n\tfor(let row in spans){\n\t\tif(type == \"row\" && row > num)\n\t\t\tcontinue;\n\n\t\tfor (let col in spans[row]){\n\t\t\tif(type == \"column\" && col > num)\n\t\t\t\tcontinue;\n\n\t\t\tconst span = spans[row][col];\n\t\t\tconst spanSize = type == \"row\" ? (row*1) + span[1] - 1 : (col*1) + span[0] - 1;\n\n\t\t\tif(spanSize > num){\n\t\t\t\tchanged = true;\n\t\t\t\tchangeSpan(\n\t\t\t\t\tview,\n\t\t\t\t\t[row, col],\n\t\t\t\t\ttype == \"row\" ? span[0] : span[0] - (spanSize - num),\n\t\t\t\t\ttype == \"row\" ? span[1] - (spanSize - num) : span[1]\n\t\t\t\t);\n\t\t\t}\n\t\t}\n\t}\n\n\tif(changed)\n\t\tview.refresh();\n}\n\nfunction changeSpan(view, span, x, y){\n\tview.splitCell(span[0], span[1], true);\n\tview.combineCells(\n\t\t{\n\t\t\tcell:{\n\t\t\t\trow:span[0],\n\t\t\t\tcolumn:span[1]\n\t\t\t},\n\t\t\tx,\n\t\t\ty,\n\t\t},\n\t\ttrue\n\t);\n}","import * as gridlines from \"../operations/hide_gridlines\";\n\nexport function hideGridlines(state){\n\tgridlines.hideGridlines(this,state);\n}","import * as headers from \"../operations/hide_headers\";\n\nexport function hideHeaders(state){\n\theaders.hideHeaders(this,state);\n}","import * as hrows from \"../operations/hide_row_col\";\n\nexport function hideColumn(column,state){\n\throws.setState(this, column, state, \"column\");\n}\nexport function isColumnVisible(column){\n\treturn hrows.isColumnVisible(this, column);\n}\nexport function hideRow(row,state){\n\throws.setState(this, row, state, \"row\");\n}\nexport function isRowVisible(row){\n\treturn hrows.isRowVisible(this, row);\n}","import {image, chart} from \"../mathematics/writer\";\nimport {addMath} from \"../mathematics/methods\";\n\nexport function addImage(row, column, url){\n\tthis.setCellValue(row, column, image(url));\n\tthis.refresh();\n}\n\nexport function addSparkline(row, column, config){\n\tlet value = chart(config);\n\tthis.setCellValue(row, column, value);\n\tthis.refresh();\n}\n\n// getSheetData is deprecated, use ss.getCellValue(row, col, math, page), ss.getRangeValue(range, page) instead\nexport function getSheetData(name){\n\tif(this._mData.getPage(name))\n\t\treturn {\n\t\t\tgetValue: (r, c, math)=> this.getCellValue(r, c, math, name),\n\t\t\tgetRangeValue: (range)=> this.getRangeValue(range, name)\n\t\t};\n}\n\nexport function registerMathMethod(name, handler){\n\taddMath(this, name, handler, true);\n}\n\nexport function recalculate(){\n\tthis._mData.getStore().recalculate();\n\tthis.callEvent(\"onMathRefresh\",[]);\n\tthis.refresh();\n}\n\nexport function setPlaceholder(name, value){\n\tif(typeof name == \"object\"){\n\t\tvalue = name;\n\t\tname = \"*\";\n\t}\n\n\tthis._mData.getStore().setPlaceholder(name, value);\n\n\tthis.refresh();\n\tthis.callEvent(\"onMathRefresh\",[]);\n}","import * as sheets from \"../sheets\";\nimport * as spn from \"../operations/spans\";\nimport * as und from \"../operations/undo\";\nimport group from \"../operations/undo_group\";\nimport * as stl from \"../operations/styles\";\nimport * as srt from \"../operations/sorting\";\nimport {removeCommentsRange} from \"../operations/comments\";\nimport {clearConditionalFormats} from \"../operations/conditional_formats\";\nimport {clearEditors} from \"../operations/dropdown\";\nimport {clearFilters} from \"../operations/filter\";\nimport {showCells} from \"../operations/show_cells\";\n\n//spans\nexport function combineCells(range, silent){\n\tif(!range){\n\t\tvar sel = this.getSelectedId(true);\n\t\tif (sel.length>1){\n\t\t\trange = spn.getRange(sel);\n\t\t}\n\t}\n\tgroup.set(()=> {\n\t\tif (range)\n\t\t\tspn.addSpan(this, range.cell, range.x, range.y);\n\t});\n\n\tif(!silent)\n\t\tthis.refresh();\n}\n\nexport function splitCell(row, column, silent){\n\tif (row && column) {\n\t\tspn.removeSpan(this, {row: row, column: column});\n\t}\n\telse{\n\t\tgroup.set(function(){\n\t\t\tthis.eachSelectedCell(function(cell){\n\t\t\t\tspn.removeSpan(this, cell);\n\t\t\t});\n\t\t},this);\n\n\t}\n\n\tif(!silent)\n\t\tthis.refresh();\n}\n\n//styles\nexport function addStyle(prop, origin){\n\treturn stl.addStyle(this, prop, origin);\n}\n\nexport function getStyle(row, column){\n\treturn stl.getStyle(this, {row:row, column:column});\n}\n\nexport function setStyle(row, column, style){\n\treturn stl.setStyle(this, {row: row, column: column}, style);\n}\n\nexport function setRangeStyle(rangeStr, style){\n\tgroup.set(function() {\n\t\tstl.setRangeStyle(this, rangeStr, style);\n\t},this);\n}\n\nexport function clearRange(rangeStr, type) {\n\tif (!rangeStr){\n\t\trangeStr = this._table.getSelectArea();\n\t\tif (!rangeStr) return;\n\t}\n\n\tif (!type) type = {styles: true, values: true, editors:true, conditions:true, comments:true };\n\t\n\tif (type.styles)\n\t\tstl.clearRangeStyle(this,rangeStr);\n\n\tif (type.conditions)\n\t\tclearConditionalFormats(this,rangeStr);\n\t\n\tif (type.values)\n\t\tthis.setRangeValue(rangeStr, null);\n\n\tif (type.editors){\n\t\tclearEditors(this, rangeStr);\n\t\tclearFilters(this, rangeStr);\n\t}\n\n\tif (type.comments)\n\t\tremoveCommentsRange(this, rangeStr);\n\n\tthis.refresh();\n}\n\nexport function compactStyles(){\n\treturn stl.compactStyles(this);\n}\n\n//serialize\nexport function serialize(config){\n\tconst obj = {};\n\tthis.callEvent(\"onDataSerialize\",[obj, config]);\n\n\tif(config){\n\t\tif(config.compactStyles)\n\t\t\tobj.styles = stl.removeUnusedStyles(obj);\n\t\tif(config.sheets)\n\t\t\treturn sheets.serialize(this, obj, config);\n\t}\n\n\treturn obj;\n}\n\n//sheets\nexport function showSheet(name){\n\tsheets.show(this,name);\n}\nexport function setSheetState(name,state){\n\tsheets.setState(this,name,state);\n}\nexport function getSheetState(name){\n\treturn sheets.getSheet(this,name).state || \"visible\";\n}\nexport function getActiveSheet(){\n\treturn this._activeSheet;\n}\nexport function addSheet(content){\n\tsheets.add(this, content);\n}\nexport function clearSheet(){\n\tthis.reset();\n}\nexport function renameSheet(name,newName){\n\tsheets.rename(this,name,newName);\n}\nexport function editSheet(name){\n\tsheets.edit(this,name);\n}\nexport function removeSheet(name){\n\tsheets.remove(this,name);\n}\n\n//undo\nexport function undo(){\n\tund.undo(this);\n}\nexport function redo(){\n\tund.redo(this);\n}\n\n//sort\nexport function sortRange(range, dir){\n\tsrt.sortRange(this, range, dir);\n}\n\n//cells\nexport function showCell(ref, silent){\n\tshowCells(this, ref, silent);\n}","import {toRange,rangeObj,range as getRange} from \"../helpers/column_names\";\nimport * as tbl from \"../table\";\nimport group from \"../operations/undo_group\";\nimport {newSheet, prepareCell} from \"../sheets\";\nimport {getType, loadCell} from \"../operations/types\";\nimport {getExcelDateFromJs} from \"../mathematics/methods\";\nimport {checkFormat, getFormatFromData} from \"../operations/formats\";\nimport * as arr from \"../helpers/array\";\n\nexport function refresh(all){\n\tif (all)\n\t\tthis._table.refreshColumns();\n\telse\n\t\tthis._table.refresh();\n}\nexport function eachSelectedCell(cb){\n\tvar cells = this.getSelectedId(true);\n\tfor (var i=0; i<cells.length; i++)\n\t\tcb.call(this, cells[i]);\n}\nexport function getSelectedRange(sheet){\n\tvar area = this._table.getSelectArea();\n\tif (area){\n\t\tif (sheet)\n\t\t\tsheet = this.getActiveSheet();\n\t\treturn toRange(area.start.row,area.start.column,area.end.row,area.end.column,sheet);\n\t}\n\treturn \"\";\n}\nexport function getSelectedId(all){\n\tvar area = this._table.getSelectArea();\n\tif(!all)\n\t\treturn area && area.start.row ? area.start : null;\n\n\tvar selection = [];\n\tif(area){\n\t\tvar c0 = area.start;\n\t\tvar c1 = area.end;\n\n\t\tfor(var i = c0.row; i<= c1.row; i++){\n\t\t\tfor(var j = c0.column; j <= c1.column; j++){\n\t\t\t\tselection.push({row: i,column:j});\n\t\t\t}\n\t\t}\n\t}\n\n\treturn selection;\n\t//return this._table.getSelectedId(all)\n}\nexport function getCellValue(row, column, math, page){\n\tpage = page ? this._mData.getPage(page) : this._mPage;\n\n\tif(!page)\n\t\treturn;\n\n\tconst value = page.getValue(row-1, column-1, math !== false);\n\n\treturn correctVal(value);\n}\nexport function setCellValue(row, column, value, page){\n\tif(!page)\n\t\tpage = this.getActiveSheet();\n\n\tconst muonPage = this._mData.getPage(page);\n\tif(!muonPage)\n\t\treturn;\n\n\tvalue = correctVal(value);\n\tconst old = this.getCellValue(row, column, page);\n\tconst oldType = getType(this, row, column, page);\n\n\tlet sameValue;\n\tif(oldType == \"date\"){\n\t\tconst parser = webix.Date.strToDate( webix.i18n.spreadsheet.formats.parseDateTime );\n\t\tconst dateValue = isNaN(value) ? getExcelDateFromJs(parser(value)) : value;\n\t\tsameValue = old == dateValue;\n\t}\n\telse if(oldType != \"string\" && value !== \"\" && !isNaN(value) && old == value && value !== 0){\n\t\tsameValue = true;\n\t\tvalue = value*1;\n\t}\n\n\tif (!sameValue && old !== value){\n\t\tgroup.set(()=>{\n\t\t\tif (this.callEvent(\"onBeforeValueChange\",[row, column, value, old, page])){\n\t\t\t\tif(page != this.getActiveSheet()){\n\t\t\t\t\tconst sheet = arr.find(this._sheets, sheet => sheet.name == page).content;\n\t\t\t\t\tlet cell = arr.find(sheet.data, cell => cell[0] == row && cell[1] == column);\n\n\t\t\t\t\tif(!cell){\n\t\t\t\t\t\tcell = [row, column];\n\t\t\t\t\t\tsheet.data.push(cell);\n\t\t\t\t\t}\n\t\t\t\t\tcell[2] = value;\n\n\t\t\t\t\tthis._page_value_set = true;\n\t\t\t\t\tconst item = loadCell(this, sheet, cell);\n\t\t\t\t\tdelete this._page_value_set;\n\n\t\t\t\t\tconst muonItem = muonPage.getCell(row-1, column-1, true);\n\t\t\t\t\tmuonItem.$format = checkFormat({ fmt: getFormatFromData(sheet, cell) }, \"string\") ? 1 : 0;\n\t\t\t\t\tmuonPage.setValue(row-1, column-1, item.value);\n\n\t\t\t\t\tcell[2] = item.value;\n\t\t\t\t\tcell[4] = muonItem.type = item.type;\n\n\t\t\t\t\t//prepareCell can change style (1/1/2001 --loadCell--> 36892 + date type --prepareCell--> date format)\n\t\t\t\t\tprepareCell(cell, sheet, true);\n\t\t\t\t\tmuonItem.style = cell[3];\n\n\t\t\t\t\tthis.callEvent(\"onCellChange\", [row, column, item.value, page]);\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\tthis._mPage.setValue(row-1, column-1, value);\n\n\t\t\t\t\t//onCellChange can change item (via types module)\n\t\t\t\t\tthis.callEvent(\"onCellChange\", [row, column, value, page]);\n\t\t\t\t\tconst updatedType = getType(this, row, column);\n\n\t\t\t\t\t//recalculate if we refer to a cell, where type is string and value is something like 005 or 5e5\n\t\t\t\t\tif(oldType != updatedType && updatedType == \"string\" && value[0] == \"=\" && value.length > 1)\n\t\t\t\t\t\tthis._mPage.setValue(row-1, column-1, value);\n\n\t\t\t\t\tif(/^=hyperlink\\(/i.test(value)){\n\t\t\t\t\t\tconst baseStyle = this.getStyle(row, column);\n\t\t\t\t\t\tconst urlStyle = this.addStyle({ color: \"#0000ff\", underline: \"underline\" }, baseStyle);\n\t\t\t\t\t\tthis.setStyle(row, column, urlStyle);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tthis.saveCell(row, column, page);\n\t\t\t}\n\t\t});\n\t}\n}\n\nfunction correctVal(val){\n\tif(typeof val === \"boolean\")\n\t\tval *= 1;\n\treturn val || val === 0 ? val : \"\";\n}\n\nexport function setRangeValue(range, value, page){\n\tgroup.set(function(){\n\t\tconst pos = rangeObj(range, this);\n\t\tlet i = 0;\n\t\tfor (let row = pos.start.row; row <= pos.end.row; row++) {\n\t\t\tfor (let column = pos.start.column; column <=  pos.end.column; column++, i++) {\n\t\t\t\tthis.setCellValue(row, column, webix.isArray(value) ? value[i] : value, page);\n\t\t\t}\n\t\t}\n\t},this);\n}\n\nexport function getRangeValue(range, page){\n\tif(!page)\n\t\tpage = this.getActiveSheet();\n\n\tconst pos = getRange(range, this, page);\n\tconst muonPage = this._mData.getPage(pos[4]);\n\n\tif (!pos || !muonPage) return [];\n\n\treturn muonPage.getRange(pos[0]-1, pos[1]-1, pos[2]-1, pos[3]-1).map(correctVal);\n}\n\nexport function getRow(id){\n\tconst row = webix.copy(this._table.getItem(id));\n\n\tfor(let i = 1; i <= this.config.columnCount; i++){\n\t\tconst cell = this._mPage.getCell(id-1, i-1);\n\n\t\tif(cell){\n\t\t\trow[i] = cell.value;\n\n\t\t\t[[\"style\", \"$cellCss\"], [\"type\", \"$cellType\"], [\"format\", \"$cellFormat\"]].forEach(param => {\n\t\t\t\tconst val = cell[param[0]];\n\t\t\t\tif(val){\n\t\t\t\t\tif(!row[param[1]])\n\t\t\t\t\t\trow[param[1]] = {};\n\t\t\t\t\trow[param[1]][i] = val;\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tconst math =  this.getCellValue(id, i, true);\n\t\t\tif(math && math[0] == \"=\")\n\t\t\t\trow[\"$\"+i] = math;\n\t\t}\n\t}\n\n\treturn row;\n}\nexport function getColumn(id){\n\treturn this._table.getColumnConfig(id);\n}\nexport function reset(mode){\n\tvar obj = { data:[] };\n\tif (mode && mode.sheets){\n\t\tobj = newSheet(obj);\n\t}\n\t\n\tthis.parse(obj);\n}\n\nexport function _resetTable(){\n\ttbl.reset(this);\n}\n","import {save} from \"../operations/save\";\n\nexport function saveCell(row, column, page){\n\tvar style = this.getStyle(row, column);\n\n\tsave(this, \"data\", {\n\t\trow,\n\t\tcolumn,\n\t\tvalue: this.getCellValue(row, column, null, page),\n\t\tpage: page || this.getActiveSheet(),\n\t\tstyle: (style ? style.id : \"\")\n\t});\n}","export function setCellEditor(row, column, editor) {\n\tconst line = this._table._ssEditors[row] = this._table._ssEditors[row] || {};\n\tconst value = line[column] || null;\n\tline[column] = editor;\n\n\tif (editor && editor.editor){\n\t\tthis._table.addCellCss(row,column, \"ss_editor\");\n\t} else {\n\t\tdelete this._table._ssEditors[row][column];\n\t\tthis._table.removeCellCss(row,column, \"ss_editor\");\n\t}\n\tthis.callEvent(\"onAction\", [\"dropdown\", { row, column, value, newValue:editor }]);\n}\n\nexport function getCellEditor(row, column){\n\tlet line = this._table._ssEditors[row] || {};\n\treturn line[column] || null;\n}","import * as flt from \"../operations/filter\";\n\nexport function setCellFilter(row, column, filter){\n\tconst line = this._table._ssFilters[row] = this._table._ssFilters[row] || {};\n\tconst value = line[column] || null;\n\n\tif (filter && (webix.isArray(filter) || typeof filter == \"string\"))\n\t\tfilter = { options:filter };\n\tline[column] = filter;\n\n\tif (filter && typeof filter == \"object\"){\n\t\tthis._table.addCellCss(row,column, \"ss_filter\");\n\t\tif (filter.value && flt.isValueActive(filter.value))\n\t\t\tthis._table.addCellCss(row,column, \"ss_filter_active\");\n\n\t\twebix.extend(filter, {row, column}, true);\n\t\tfilter.options = flt.calibrateRange(this, row, column, filter.options);\n\n\t\tif (!filter.handler && filter.value && filter.value.condition){\n\t\t\tconst mode = filter.mode || flt.getFilterMode(this, row, column);\n\t\t\tfilter.handler = flt.getFilterFunction(mode, filter.value);\n\t\t}\n\t} else {\n\t\tdelete this._table._ssFilters[row][column];\n\t\tthis._table.removeCellCss(row,column, \"ss_filter\");\n\t\tthis._table.removeCellCss(row,column, \"ss_filter_active\");\n\t}\n\tthis.callEvent(\"onAction\", [\"filter\", { row, column, value, newValue:filter }]);\n}\n\nexport function getCellFilter(row, column){\n\tlet line = this._table._ssFilters[row] || {};\n\treturn line[column] || null;\n}\n\nexport function removeFilters(){\n\tconst filters = flt.getFilters(this._table);\n\n\tfor\t(let i=0; i<filters.length; i++){\n\t\tconst {row, column} = filters[i];\n\t\tthis.setCellFilter(row, column, null);\n\t}\n\n\tthis._table._ssFilters = {};\n\tthis._table.data.filter((obj) => {\n\t\treturn this.isRowVisible(obj.id);\n\t});\n}\n\n\nexport function filterSpreadSheet(){\n\tconst grid = this._table;\n\tgrid.data.silent(()=>{\n\t\t// hidden rows\n\t\tgrid.data.filter(obj => this.isRowVisible(obj.id));\n\n\t\tconst filters = flt.getFilters(grid);\n\t\tfor (let i = 0; i < filters.length; i++){\n\t\t\tconst {row, column, handler, lastRow} = filters[i];\n\n\t\t\tlet finished = false;\n\t\t\tgrid.data.filter(obj => {\n\t\t\t\tlet r = obj.id;\n\t\t\t\tif(r <= row || typeof handler != \"function\")\n\t\t\t\t\treturn true;\n\n\t\t\t\tconst span = grid.getSpan(r, column);\n\t\t\t\tif(span){\n\t\t\t\t\tif(span[0] == row && span[1] == column)\n\t\t\t\t\t\treturn true;\n\t\t\t\t\telse\n\t\t\t\t\t\tr = span[0];\n\t\t\t\t}\n\n\t\t\t\tconst value = String(this.getCellValue(r, column, false));\n\n\t\t\t\tif(lastRow){\n\t\t\t\t\tif(r > lastRow)\n\t\t\t\t\t\treturn true;\n\t\t\t\t}\n\t\t\t\telse if(finished || !value)\n\t\t\t\t\treturn finished = true;\n\n\t\t\t\treturn handler(value);\n\t\t\t}, 1, true);\n\t\t}\n\t});\n\n\tgrid.callEvent(\"onAfterFilter\", []);\n\tgrid.refresh();\n}\n","export function confirm(config){\n\treturn webix.confirm({\n\t\tcontainer: this.$view,\n\t\tcss:\"webix_ssheet_confirm\",\n\t\ttext:config.text,\n\t\tok: webix.i18n.spreadsheet.labels.ok,\n\t\tcancel: webix.i18n.spreadsheet.labels.cancel\n\t});\n}\n\nexport function alert(config){\n\treturn webix.alert({\n\t\tcontainer: this.$view,\n\t\tcss: \"webix_ssheet_alert\",\n\t\ttext:config.text,\n\t\ttype:config.type,\n\t\tok: webix.i18n.spreadsheet.labels.ok\n\t});\n}","import * as undo from \"../operations/undo\";\nimport group from \"../operations/undo_group\";\n\nexport function resetUndo(){\n\tundo.reset(this);\n}\n\nexport function groupUndo(func){\n\tgroup.set(func, this);\n}\n\nexport function ignoreUndo(func){\n\tundo.ignoreUndo(func, this);\n}","import * as fmt from \"../operations/formats\";\n\nexport function setFormat(row, column, format){\n\tfmt.addFormat(this, row, column, format);\n}\n\nexport function changeDecimals(row, column, inc){\n\t//row and column may be obj\n\tfmt.changeAreaDecimals(this, inc, row, column);\n}","import * as formulas from \"../operations/show_formulas\";\n\nexport function showFormulas(state){\n\tformulas.showFormulas(this, state);\n}","import {showBorders} from \"../operations/print\";\n\nexport function showPrintBorders(value){\n\tconst old = !!this._printBorders.$render;\n\n\tif(value == \"toggle\")\n\t\tvalue = !old;\n\n\tif(value != old){\n\t\tif(value)\n\t\t\tshowBorders(this);\n\t\telse{\n\t\t\tdelete this._printBorders.$render;\n\t\t\tthis.refresh();\n\t\t}\n\n\t\tthis.callEvent(\"onCommand\", [{id:\"toolbar-update\", name:\"print-borders\", value}]);\n\t\tthis.callEvent(\"onAction\", [\"print-borders\", {newValue: value, value: old}]);\n\t}\n}","import {zoom as zoomView} from \"../operations/zoom\";\n\nexport function zoom(value){\n\tzoomView(this, value);\n}","const defaultMenu = [\n\t{ id:\"file\", submenu:[\n\t\t{id: \"sheet\", submenu: [\n\t\t\t{id: \"new-sheet\"},\n\t\t\t{id: \"copy-sheet\"},\n\t\t\t{id: \"remove-sheet\"},\n\t\t\t{id: \"hide-sheet\"}\n\t\t]},\n\t\t{id: \"excel-import\"},\n\t\t{id: \"excel-export\"},\n\t\t{id: \"print\"},\n\t\t{id: \"print-borders\"}\n\t]},\n\t{ id:\"edit\", submenu:[\n\t\t{id: \"add-range\"},\n\t\t{id: \"add-dropdown\"},\n\t\t{id: \"add-link\"},\n\t\t{id: \"lock-cell\"},\n\t\t{id: \"conditional-format\"},\n\t\t{id: \"clear\", submenu:[\n\t\t\t{id: \"clear-value\"},\n\t\t\t{id: \"clear-style\"},\n\t\t\t{id: \"clear-conditional-formats\"},\n\t\t\t{id: \"clear-dropdown-editors\"},\n\t\t\t{id: \"clear-comments\"},\n\t\t\t{ $template:\"Separator\" },\n\t\t\t{id: \"clear-all\"}\n\t\t]}\n\t]},\n\t{ id:\"insert\", submenu:[\n\t\t{id: \"image\", submenu:[\n\t\t\t{ id: \"add-image-cell\"},\n\t\t\t{ id: \"add-image-top\"}\n\t\t]},\n\t\t{id: \"graph\", submenu:[\n\t\t\t{ id: \"add-sparkline\"},\n\t\t\t{ id: \"add-chart\"}\n\t\t]},\n\t\t{id: \"add-comment\"}\n\t]},\n\t{ id:\"data\", submenu:[\n\t\t{id: \"sort\", submenu: [\n\t\t\t{id: \"sort-asc\"},\n\t\t\t{id: \"sort-desc\"}\n\t\t]},\n\t\t{id: \"create-filter\"}\n\t]},\n\t{ id: \"view\", submenu:[\n\t\t{id: \"columns\", submenu: [\n\t\t\t{id: \"insert-column\"},\n\t\t\t{id: \"delete-column\"},\n\t\t\t{id: \"show-column\"},\n\t\t\t{id: \"hide-column\"},\n\t\t\t{id: \"resize-column\"}\n\t\t]},\n\t\t{id: \"rows\", submenu: [\n\t\t\t{id: \"insert-row\"},\n\t\t\t{id: \"delete-row\"},\n\t\t\t{id: \"show-row\"},\n\t\t\t{id: \"hide-row\"},\n\t\t\t{id: \"resize-row\"}\n\t\t]},\n\t\t{ $template:\"Separator\" },\n\t\t{id: \"freeze-columns\"},\n\t\t{id: \"freeze-rows\"},\n\t\t{id: \"hide-gridlines\"},\n\t\t{id: \"hide-headers\"},\n\t\t{id: \"show-formulas\"}\n\t]}\n];\n\nconst readonlyMenu = [\n\t{ id:\"file\", submenu:[\n\t\t{id: \"excel-export\"},\n\t\t{id: \"print\"},\n\t\t{id: \"print-borders\"}\n\t]}\n];\n\nconst ui = {\n\tgetMenuData: function(menu, config){\n\t\tvar i;\n\t\tfor(i=0; i < menu.length; i++){\n\t\t\tif(typeof menu[i] == \"string\")\n\t\t\t\tmenu[i] = {id: menu[i]};\n\t\t\tif((menu[i].id == \"resize-column\" || menu[i].id == \"resize-row\") && !config.resizeCell){\n\t\t\t\tmenu.splice(i,1);\n\t\t\t\ti--;\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\tif(!menu[i].value)\n\t\t\t\tmenu[i].value = webix.i18n.spreadsheet.menus[menu[i].id];\n\t\t\tif(menu[i].submenu)\n\t\t\t\tmenu[i].submenu = this.getMenuData(menu[i].submenu, config);\n\t\t}\n\n\t\treturn menu;\n\t}\n};\n\nexport function init(view){\n\tview.attachEvent(\"onComponentInit\", () => ready(view));\n\n\tconst config = view.config;\n\tconst menu = {\n\t\tview: \"menu\",\n\t\tborderless: true,\n\t\tcss: \"webix_ssheet_menu\",\n\t\tid: \"menu\",\n\t\tautowidth: true,\n\t\ttype:{\n\t\t\theight: 40\n\t\t},\n\t\tdata: ui.getMenuData(\n\t\t\twebix.isArray(config.menu) ? config.menu : webix.copy(config.readonly ? readonlyMenu : defaultMenu),\n\t\t\tconfig\n\t\t)\n\t};\n\n\tview.callEvent(\"onViewInit\", [\"menu\", menu]);\n\treturn menu;\n}\n\n\nfunction ready(view){\n\tif(view.$$(\"menu\"))\n\t\tview.$$(\"menu\").attachEvent(\"onMenuItemClick\",(id) => callAction(view,id));\n}\n\nconst actionMap = {\n\t\"undo\": view => view.undo(),\n\t\"redo\": view => view.redo(),\n\t\"insert-column\": view => view.insertColumn(),\n\t\"delete-column\": view => view.deleteColumn(),\n\t\"show-column\": view => view.callEvent(\"onCommand\",[{id: \"show\", group: \"column\", neighbors:true}]),\n\t\"hide-column\": view => view.hideColumn(null,true),\n\t\"resize-column\": view => view.callEvent(\"onCommand\",[{\n\t\tid: \"resize\", group: \"column\", value: webix.i18n.spreadsheet.menus[\"resize-column\"]\n\t}]),\n\t\"insert-row\": view => view.insertRow(),\n\t\"delete-row\": view => view.deleteRow(),\n\t\"show-row\": view => view.callEvent(\"onCommand\",[{id: \"show\", group: \"row\", neighbors:true}]),\n\t\"hide-row\": view => view.hideRow(null,true),\n\t\"resize-row\": view => view.callEvent(\"onCommand\",[{id: \"resize\", group: \"row\", value: webix.i18n.spreadsheet.menus[\"resize-row\"]}]),\n\t\"freeze-columns\": view => view.freezeColumns(),\n\t\"freeze-rows\": view => view.freezeRows(),\n\t\"hide-gridlines\": view => view.hideGridlines(\"toggle\"),\n\t\"hide-headers\": view => view.hideHeaders(\"toggle\"),\n\t\"show-formulas\": view => view.showFormulas(\"toggle\"),\n\t\"print-borders\": view => view.showPrintBorders(\"toggle\")\n};\n\nfunction callAction(view,id){\n\tif(view.callEvent(\"onMenuItemClick\",[id])){\n\t\tif(actionMap[id])\n\t\t\tactionMap[id](view);\n\t\telse\n\t\t\tview.callEvent(\"onCommand\",[{id: id}]);\n\t}\n}","//global definitions\nimport \"./locale\";\nimport \"./views/index\";\n\n//special content for non-production builds\nimport \"./init\";\n\nimport \"./editors/index\";\n\n//modules\nimport * as bar from \"./toolbar\";\nimport * as tbl from \"./table\";\nimport * as key from \"./hotkeys\";\nimport * as editor from \"./editor\";\nimport * as sheets from \"./sheets\";\nimport * as dialogs from \"./dialogs/index\";\nimport * as context from \"./context\";\nimport * as chart from \"./chart\";\n\nimport {setDefaultFormats} from \"./operations/formats\";\nimport {operations} from \"./operations/index\";\nimport {api} from \"./api/index\";\n\n//styling\nimport * as menu from \"./menu\";\nimport {getDefaultStyles} from \"./helpers/conditional\";\nimport {setSkinDefaults} from \"./toolbar/defaults\";\n\nvar component = {\n\tname:\"spreadsheet\",\n\t_base_index:{ count:1 },\n\tdefaults:{\n\t\tspans: true,\n\t\tliveEditor: true,\n\t\trowCount:50,\n\t\tmath:true,\n\t\tcolumnCount:20,\n\t\tresizeCell: true,\n\t\tsheetTabWidth: 90,\n\t\tconditionStyle: getDefaultStyles()\n\t},\n\t$init:function(){\n\t\tthis.$index = (this._base_index.count++);\n\t\tthis.$view.className += \" webix_ssheet\";\n\n\t\tthis.$ready.unshift(this._sub_init);\n\t\tthis.$ready.unshift(setDefaultFormats);\n\t\tthis.$ready.push(this._set_handlers);\n\n\t\tthis._destroy_with_me = [];\n\t\tthis.attachEvent(\"onDestruct\", () => {\n\t\t\tthis._destroy_with_me.forEach(view => view.destructor());\n\t\t});\n\t},\n\t$skin:function(){\n\t\tsetSkinDefaults();\n\t},\n\t_sub_init:function(){\n\t\tconst obj = this.config;\n\t\tconst readonly = obj.readonly;\n\t\tconst rows = [];\n\n\t\t//toolbars\n\t\tif(obj.menu)\n\t\t\trows.push(menu.init(this));\n\t\tif((readonly && (obj.toolbar || obj.buttons)) || (!readonly && obj.toolbar !== false))\n\t\t\trows.push(bar.init(this));\n\t\tif (obj.subbar)\n\t\t\trows.push(obj.subbar);\n\t\tif(!readonly && obj.liveEditor)\n\t\t\trows.push(editor.init(this));\n\n\t\t//data part\n\t\tconst tblObj = {\n\t\t\teditable : !readonly,\n\t\t\tliveEditor: obj.liveEditor\n\t\t};\n\t\tif(obj.rowHeight)\n\t\t\ttblObj.rowHeight = obj.rowHeight;\n\t\tif(obj.columnWidth)\n\t\t\ttblObj.columnWidth = obj.columnWidth;\n\n\t\tif(readonly)\n\t\t\trows.push(tbl.init(this, tblObj));\n\t\telse\n\t\t\trows.push({cols:[tbl.init(this, tblObj), chart.init(this)]});\n\n\t\tconst bottom = obj.bottombar === true ? sheets.defaultBottom(this) : obj.bottombar;\n\t\tif (bottom)\n\t\t\trows.push(bottom);\n\n\t\tsheets.init(this);\n\n\t\tif(!readonly)\n\t\t\tcontext.init(this);\n\n\t\tdialogs.init(this);\n\n\t\tthis.rows_setter(rows);\n\t},\n\t_set_handlers:function(){\n\t\t//prevent double init\n\t\tif (this._table) return;\n\t\tthis._table = this.$$(\"cells\");\n\n\t\t//init all sub modules\n\t\toperations(this);\n\n\t\t//set sizes for the table\n\t\ttbl.reset(this, this.config.columnCount, this.config.rowCount);\n\t\tkey.init(this); //keyboard shortcuts\n\t\t\n\t\tthis._table.attachEvent(\"onAfterAreaAdd\", () =>\n\t\t\tthis.callEvent(\"onAfterSelect\", [ this.getSelectedId(true) ]));\n\n\t\tthis.callEvent(\"onComponentInit\", []);\n\t},\n\t$onLoad:function(obj, driver){\n\t\t//when loading data by data:, we can get $onLoad before _set_handlers call\n\t\tthis._set_handlers();\n\n\t\tconst excel = obj.excel;\n\n\t\tif (excel)\n\t\t\tobj = this._parseExcel(obj, driver);\n\t\telse if(!obj.data && typeof obj == \"string\" && (driver.cell || driver.row))\n\t\t\tobj = this._parseCsv(obj, driver);\n\n\t\tsheets.load(this, obj, excel);\n\t}\n};\napi(component);\nwebix.protoUI(component, webix.AtomDataLoader, webix.IdSpace, webix.ui.layout);\n","import {isCellSelected, isColSelected,isRowSelected,selectRow,selectColumn} from \"./operations/column_operations\";\nimport {getColumnOperation, getRowOperation, getClearOperation} from \"./toolbar/buttons\";\n\nexport function init(view){\n\tview.attachEvent(\"onComponentInit\", () => view.$$(\"context\").attachTo(view._table.$view));\n\n\tconst locale = webix.i18n.spreadsheet.menus;\n\n\tlet clipboard = [];\n\tif(view.config.clipboard !== false)\n\t\tclipboard = [\n\t\t\t{ id:\"cut\", value: locale.cut},\n\t\t\t{ id:\"copy\", value: locale.copy},\n\t\t\t{ id:\"paste\", value: locale.paste},\n\t\t\t{ id:\"special-paste\", value: locale[\"special-paste\"], submenu:[\n\t\t\t\t{id: \"paste-values\", value: locale[\"paste-values\"]},\n\t\t\t\t{id: \"paste-formulas\", value: locale[\"paste-formulas\"]},\n\t\t\t\t{id: \"paste-styles\", value: locale[\"paste-styles\"]},\n\t\t\t\t{id: \"paste-conditions\", value: locale[\"paste-conditions\"]},\n\t\t\t]}\n\t\t];\n\n\tconst lists = {\n\t\tdata: clipboard.concat([\n\t\t\t{ id:\"clear\",\t\tvalue: locale[\"clear\"], submenu: getClearOperation()},\n\t\t\t{ id:\"lock-cell\",\t\tvalue: locale[\"lock-cell\"]},\n\t\t\t{ $template: \"Separator\"},\n\t\t\t{ id:\"sort\",\tvalue: locale.sort, submenu:[\n\t\t\t\t{id: \"sort-asc\", value: locale[\"sort-asc\"]},\n\t\t\t\t{id: \"sort-desc\", value: locale[\"sort-desc\"]}\n\t\t\t]},\n\t\t\t{id:\"create-filter\",\t\tvalue: locale[\"create-filter\"]},\n\t\t\t{ $template: \"Separator\"},\n\t\t\t{ id:\"add-range\",\t\tvalue: locale[\"add-range\"]},\n\t\t\t{ id:\"add-link\",\t\tvalue: locale[\"add-link\"]},\n\t\t\t{ id:\"add-comment\",\t\tvalue: locale[\"add-comment\"]}\n\t\t]),\n\t\tcolumn: getColumnOperation(view),\n\t\trow: getRowOperation(view)\n\t};\n\n\n\tvar context = {\n\t\tview: \"contextmenu\",\n\t\tid: \"context\",\n\t\tpadding:0,\n\t\tsubmenuConfig:{\n\t\t\tpadding:0,\n\t\t\ton:{\n\t\t\t\tonBeforeShow:function(){\n\t\t\t\t\tthis.sizeToContent();\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\t\tdata:[],\n\t\ton:{\n\t\t\tonMenuItemClick(id) {\n\t\t\t\tview.callEvent(\"onCommand\", [this.getMenuItem(id)]);\n\t\t\t},\n\t\t\tonBeforeShow(pos) {\n\t\t\t\twebix.callEvent(\"onClick\", []);\n\t\t\t\tvar mode, trg;\n\n\t\t\t\ttrg = view._table.locate(pos);\n\t\t\t\tif (!trg) return false;\n\n\t\t\t\tmode = \"\";\n\t\t\t\tif (trg.header && trg.column !== \"rowId\"){\n\t\t\t\t\tif (!isColSelected(trg.column, view))\n\t\t\t\t\t\tselectColumn(trg.column, view);\n\t\t\t\t\tmode = \"column\";\n\t\t\t\t} else if (trg.row){\n\t\t\t\t\tif (trg.column === \"rowId\"){\n\t\t\t\t\t\tif (!isRowSelected(trg.row, view))\n\t\t\t\t\t\t\tselectRow(trg.row, view);\n\t\t\t\t\t\tmode = \"row\";\n\t\t\t\t\t} else {\n\t\t\t\t\t\tif (!isCellSelected(trg.row, trg.column, view))\n\t\t\t\t\t\t\tview._table.addSelectArea(trg, trg);\n\t\t\t\t\t\tmode = \"data\";\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tif (mode){\n\t\t\t\t\tvar data = getMenuData(view, mode, lists[mode]);\n\t\t\t\t\tif (data){\n\t\t\t\t\t\tthis.clearAll();\n\t\t\t\t\t\tthis.parse(data);\n\t\t\t\t\t\tthis.sizeToContent();\n\t\t\t\t\t\twebix.html.preventEvent(pos);\n\t\t\t\t\t\treturn true;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\treturn false;\n\t\t\t}\n\t\t}\n\t};\n\n\tview.callEvent(\"onViewInit\", [\"context\", context]);\n\tconst contextMenu = view.ui(context);\n\n\tview._destroy_with_me.push(contextMenu);\n}\n\nexport function getMenuData(view, name, data){\n\tvar ev = { area:name, data:data };\n\tif (view.callEvent(\"onContextMenuConfig\", [ev]))\n\t\treturn ev && ev.data;\n\treturn null;\n}","import * as m1  from \"./add_row_col\";\nimport * as m6  from \"./clipboard\";\nimport * as m12 from \"./column_operations\";\nimport * as m2  from \"./conditional_formats\";\nimport * as m4 from \"./types\";\nimport * as m8 from \"./formats\";\nimport * as m17 from \"./data\";\nimport * as m18 from \"./dropdown\";\nimport * as m7  from \"./formats\";\nimport * as m13 from \"./hide_row_col\";\nimport * as m14 from \"./lock_cell\";\nimport * as m3  from \"./resize\";\nimport * as m9  from \"./selection\";\nimport * as m10 from \"./sorting\";\nimport * as m16 from \"./spans\";\nimport * as m16a from \"../mathematics/methods\";\nimport * as m16b from \"../mathematics/ranges\";\nimport * as m16c from \"../mathematics/sheets\";\nimport * as m19 from \"./states\";\nimport * as m5  from \"./styles\";\nimport * as m11 from \"./undo\";\nimport * as m20 from \"./import\";\nimport * as m21 from \"./filter\";\nimport * as m22 from \"./print\";\nimport * as m23 from \"./export\";\nimport * as m24 from \"./load\";\nimport * as m25 from \"./clear_styles\";\nimport * as m26 from \"./comments\";\nimport * as m27 from \"./save\";\nimport * as m28 from \"./hide_headers\";\nimport * as m29 from \"./hide_gridlines\";\nimport * as m30 from \"./views\";\nimport * as m31 from \"./show_formulas\";\nimport * as m32 from \"./zoom\";\n\nexport function operations(view){\n\t//order in some cases does matter\n\t//resize must be applied after math, to size data by the result of math calculation\n\t//types must be applied after state and data \n\tvar all = [m32,m1,m2,m5,m6,m7,m9,m10,m11,m12,m13,m14,m16,m3,m8,m17,m16a,m16b,m16c,m18,m19,m4,m20,m21,m22,m23,m24,m25,m26,m27,m28,m29,m30,m31];\n\tfor (var i = 0; i < all.length; i++){\n\t\tif (all[i].init)\n\t\t\tall[i].init(view);\n\t}\n}","import * as rco from \"./row_col_operations\";\nimport * as lcl from \"./lock_cell\";\nimport * as fcl from \"./freeze\";\nimport * as hbr from \"./hide_gridlines\";\nimport * as hhd from \"./hide_headers\";\nimport * as hrc from \"./hide_rows\";\nimport * as mat from \"./math\";\nimport * as ops from \"./operations\";\nimport * as cor from \"./core\";\nimport * as sav from \"./save\";\nimport * as dpd from \"./dropdown\";\nimport * as flt from \"./filter\";\nimport * as cfm from \"./confirm\";\nimport * as und from \"./undo\";\nimport * as fmt from \"./number_formats\";\nimport * as fml from \"./show_formulas\";\nimport * as prt from \"./print\";\nimport * as zoom from \"./zoom\";\n\nexport function api(view){\n\tvar all = [rco, lcl, fcl, hbr, hhd, hrc, mat, ops, cor, sav, dpd, flt, cfm, und, fmt, fml, prt, zoom];\n\tfor (var i = 0; i < all.length; i++)\n\t\twebix.extend(view, all[i]);\n}"],"names":["webix","i18n","spreadsheet","labels","tooltips","menus","table","liveEditor","formats","protoUI","name","$cssName","$init","config","options","view","body","tooltip","template","xCount","yCount","data","ui","richselect","defaults","width","skin","$name","margin","cols","scroll","select","obj","id","on","onAfterSelect","this","getParentView","updateMasterValue","value","rows","css","title","onChange","suggest","fitMaster","hide","getValue","$$","master","setValue","getList","getColorView","getTypeView","getSelectedId","getBody","getChildViews","getItemText","$ready","push","bind","getPopup","isArray","old","callEvent","join","height","palette","attachEvent","setMasterValue","colorboard","icon","borderless","$view","className","$renderInput","divStart","color","renderColor","call","replace","match","p1","p2","p3","colorpicker","prototype","$setValue","getColorNode","style","backgroundColor","firstChild","childNodes","$renderIcon","text","apply","arguments","Object","defineProperty","exports","t","r","1","2","3","e","assign","n","length","o","hasOwnProperty","i","a","u","f","s","h","c","p","v","code","g","source","l","d","b","M","pageName","substr","indexOf","toUpperCase","String","fromCharCode","charCodeAt","y","m","_","L","P","w","E","z","I","C","T","page","D","N","A","S","O","x","R","F","U","exec","broken","triggers","pop","Function","Date","getFullYear","valueOf","getTimezoneOffset","Math","floor","round","getTime","isNaN","concat","k","toString","padStart","H","ceil","Y","B","j","G","q","$","W","K","Q","pow","J","Z","tt","rt","et","sqrt","nt","ot","it","CM","CD","XC","XL","X","IX","V","IV","at","ut","ft","st","ht","ct","pt","vt","gt","lt","abs","exp","dt","bt","Mt","yt","substring","Number","mt","_t","cos","cosh","sin","sinh","wt","Et","It","Ct","Tt","Dt","sort","Array","Nt","At","St","Ot","filter","reduce","xt","Rt","ABS","ACOS","acos","ACOSH","acosh","ACOT","atan","ACOTH","log","ADD","ARABIC","test","ASIN","asin","ASINH","asinh","ATAN","ATAN2","atan2","ATANH","AVEDEV","AVERAGE","AVERAGEA","BASE","max","BINOMDIST","BINOM.INV","BINOM.DIST.RANGE","BINOM.DIST","BITAND","BITLSHIFT","BITOR","BITRSHIFT","BITXOR","CEILING","COMBIN","COMBINA","COMPLEX","CORREL","COS","COSH","COT","tan","COTH","COUNT","COUNTA","COUNTBLANK","COVAR","COVARIANCE.P","COVARIANCE.S","CSC","CSCH","DEC2BIN","DEC2HEX","DEC2OCT","DECIMAL","parseInt","DEGREES","PI","DELTA","DEVSQ","forEach","DIVIDE","EQ","ERF","ERFC","EVEN","sign","EXP","FACT","FACTDOUBLE","FISHER","FISHERINV","FLOOR","GAMMA","isInteger","GCD","GEOMEAN","some","isFinite","GESTEP","GT","GTE","HARMEAN","HEX2BIN","HEX2DEC","HEX2OCT","IMABS","IMAGINARY","IMCONJUGATE","IMCOS","IMCOSH","IMCOT","IMCSC","IMCSCH","IMDIV","IMEXP","IMLN","IMPOWER","IMPRODUCT","slice","IMREAL","IMSEC","IMSECH","IMSIN","IMSINH","IMSQRT","IMSUB","IMSUM","IMTAN","INT","LARGE","LN","LOG","LOG10","LT","LTE","MAX","MEDIAN","MIN","MINUS","MOD","MROUND","MULTINOMIAL","MULTIPLY","NE","OCT2BIN","OCT2DEC","OCT2HEX","ODD","PERCENTILE","PERCENTILE.INC","PERCENTILE.EXC","PERMUT","POW","POWER","PRODUCT","QUARTILE","QUARTILE.INC","QUARTILE.EXC","QUOTIENT","RADIANS","RAND","random","RANDBETWEEN","ROMAN","split","ROUND","parseFloat","toFixed","ROUNDDOWN","ROUNDUP","SEC","SECH","SIGN","SIN","SINH","SMALL","SQRT","SQRTPI","STDEV","STDEV.S","STDEV.P","STDEVA","STDEVP","STDEVPA","STEYX","SUBTOTAL","SUM","SUMPRODUCT","SUMSQ","SUMX2MY2","find","SUMX2PY2","SUMXMY2","TAN","TANH","tanh","TRUNC","VAR","VAR.S","VAR.P","VARA","VARP","VARPA","WEIBULL","WEIBULL.DIST","Lt","Pt","freeze","__proto__","CONCATENATE","LEFT","MID","RIGHT","LOWER","addMath","handler","addMethod","sid","list","exists","add","getJsDateFromExcel","excelDate","date","getExcelDateFromJs","jsDate","init","math","IMAGE","url","escape","HYPERLINK","attrs","SPARKLINE","arr","type","color1","color2","negativeColor","paddingX","paddingY","extend","donut","horizontal","tableConfig","isCircle","columnWidth","rowHeight","Sparklines","getTemplate","keys","key","getJsDate","getExcelDate","datepicker","$prepareValue","copy","start","end","daterangepicker","buttons","close","getBodyConfig","content","elements","getFormElements","padding","$active","layoutPadding","form","label","cancel","autowidth","click","getTopParentView","save","hotkey","body_setter","_typeof","isUndefined","window","move","head","autofocus","IdSpace","headerRowHeight","datatable","getItem","setHTML","dataview","contextmenu","group","set","method","uid","all","serialize","sheets","proxy","$parse","$proxy","ajax","headers","post","thread","events","newName","_loading_data","params","activeSheet","getActiveSheet","clearTimeout","delay","decode","encode","alpha","indexToHeader","index","chars","quotient","updateMaxColumn","maxColumn","str","adress","size","col","range","nind","sheet","parts","ranges","getCode","rangeParts","d1","d2","escapeSheet","toRange","x2","y2","rangeObj","row","column","eachRange","callback","isRange","cells","isCell","cellTest","changeRange","inc","updated","r1","c1","r2","c2","toolbarSizes","sectorPadding","sectorMargin","defaultStyles","fonts","material","mini","flat","compact","contrast","willow","dark","style_names","_style_map","format","left","center","right","top","middle","bottom","wrap","zoom","getBorderCss","underline","strike","indent","count","pos","innerCss","fontSize","border","sizeEl","border_checks","cell","area","mode","_style_handlers","getSelectArea","lineStyle","modes","_updateStyle","reset","_styles","_styles_cache","_styles_max","prefix","$index","html","removeStyle","zoomStyles","_serialize","_parse","getStyle","_mPage","getCell","span","getSpan","spanStyles","spanStyle","getFormat","styles","addStyle","props","origin","styleFromText","map","styleToText","cache","_addStyle","styleObj","update_style_data","nstyle","setStyle","_setStyle","setRangeStyle","getTextSize","baseWidth","innerHTML","_table","appendChild","offsetWidth","offsetHeight","removeChild","toolbar","oldFormat","formatChanged","saveCell","sel","silent","_buildCssString","outCss","_zoom","clearRangeStyle","compactStyles","serialized","removeUnusedStyles","used","newStyles","_applyStyles","eachSelectedCell","_applyCellStyles","ostyle","oldVal","refresh","_undoStyle","create","func","findIndex","result","getDimension","spans","line","spanEndRow","spanEndCol","formatsCount","formatCache","formatSources","formatHelpers","currencies","defaultFormats","common","setDefaultFormats","formatsLocale","price","getCurrencySymbol","trim","extra","minusSign","priceFormat","values","zeros","priceSettings","decimalSize","symbol","separator","negative","getDelimiters","numberFormat","percent","format2code","dateFormat","string","serializeFormat","formToValues","groupSign","groupDelimiter","decimalSign","decimalDelimiter","getFormatSource","toexcel","parseFormat","createFormatName","formatToForm","dates","timeFormat","fullDateFormat","longDateFormat","red","first","second","priceBrackets","currency","isPrice","delimiters","integer","decimal","addFormat","nev","removeFormat","splitFormat","conditional","errorMessage","separated","separateFmt","genCode","condition","toLowerCase","fmt","err","check","ind","isAbs","genFormatCode","isQuote","comma","numberPlaceholder","textPlaceholder","symbolPos","multiply","lastDateType","val","betweenPlaceholders","placeholder","datePart","excelDateToWebix","undefined","getParts","reverse","lzeros","lfills","rzeros","rfills","rmax","dateTypes","timeTypes","dateOrder","timeOrder","typesOrder","order","types","changeAreaDecimals","getCells","rules","isNumber","changeCellDecimals","getFormatName","isCustom","updateDecimals","parsed","decimals","placeholders","withoutText","withoutPlaceholders","formValues","symbolId","toExcel","leftPlaceholders","fmtParts","sepFmtParts","getFmtPartValues","leftText","rightText","fmtPart","firstPlaceholder","Infinity","checkFormat","checkTime","quot","item","isDateInvalid","getDateEditFormat","formatName","locale","isTime","dateToStr","getFormatFromData","array","styleName","fmtName","load","isChar","char","getLastCharIndex","includeNumbers","lastChar","getWord","formula","quotes","operand","position","word","sum","flags","crosssheet","fromSheet","lines","ph","escaped","next","pushLine","loadCell","setType","dateToExcel","_page_value_set","setCellValue","getFormatType","formatType","getType","_mData","getPage","parseToStore","_setType","mathFormat","isFormula","parseDate","getMathFormat","blockLevel","level","methods","part","expectType","getExpectType","strToDate","parseDateTime","parser","ignoreUndo","checkType","$format","updateCell","isString","cellEditor","getCellEditor","setFormat","setCellEditor","editor","cursor","getInputNode","selectionStart","charAt","search","nextSymbol","node","tagName","_this","sizes","offset","textWidth","popup","show","setValueHere","$enterKey","isVisible","getCellValue","action","newValue","getPopupConfig","onItemClick","button","suggestData","highlight","_highlightedCells","_update_range","_last_value_set","activeCell","showActiveSheet","updateCellValue","blur","preventEvent","$handleSelection","UIManager","setFocus","eventRemove","keydownEv","event","_this2","endEdit","escapeText","changeCellCss","_activeMath","colorIndex","crossheet","cellSheet","prepareSheet","activeMath","cellText","rangeName","repeatedColor","nextCell","nextCellText","setColor","document","activeElement","paintValue","enter","grid","define","showSheet","moveSelection","remove","which","keyCode","shiftKey","getItemNode","newv","$setValueHere","str1","str2","setSelectionRange","expectOperator","setRange","len","lastPos","prepareArea","min","row1","col1","row2","col2","coloredArea","texthighlight","layout","drag","dragscroll","EditAbility","toggle","offValue","onValue","inp","awidth","aheight","$allowsClear","blockEvent","unblockEvent","arrowCss","arrow","iconCss","inputSpacing","elementsConfig","labelWidth","_initOnChange","$eventSource","_getCheckboxes","$hiddenSheet","$all","_count","base","hidden","labelRight","active","baseHeight","inputHeight","checkboxes","output","cfg","scrollview","queryView","onSelectChange","focus","resize","toFront","minWidth","minHeight","escHide","autofit","setAttribute","addHotKey","_removeView","getMenu","_clickEv","_menu","destructor","move_setter","DragControl","addDrag","$dragPos","$dragCreate","object","trg","target","getAttribute","elOffset","elPos","pOffset","parentNode","state","getScrollState","toNode","$dragDestroy","submenu","readonly","submenuConfig","externalUI","onMenuItemClick","_menuActions","onBeforeShow","_toggleExcel","dots","toPDF","display","toPNG","header","pull","showMenuItem","hideMenuItem","layoutMargin","multi","getSectionConfig","onAfterScroll","addSection","trashIcon","dataPadding","upper","marker","onClick","removeView","childs","getLayout","lastIndex","layoutId","addView","setValues","setSubValue","sub","hideSubviews","child","getValues","$getSize","bodySize","env","scrollSize","$setSize","oldScroll","readOnly","getNext","step","numbers","nextValue","shift","counter","editors","excel_date","createPopup","icons","timepicker","_last_input_target","onEnter","render","showPopup","input","updateCalendar","calendar","afterRender","ss_richselect","popupInit","$value","actions","isMerged","c0","splitCell","confirm","then","combineCells","undo","redo","hideGridlines","hideHeaders","freezeColumns","freezeRows","showFormulas","showPrintBorders","fontFamily","getColumnOperation","colOperations","neighbors","resizeCell","getRowOperation","rowOperations","getClearOperation","getLocaleClear","$template","borders","styleFormats","colorButton","toggleButton","iconButton","btn","segmented","popupWidth","popupTemplate","popupEvents","titleHeight","align","condFormat","buttonsMap","getCellFormats","example","number","getText","getAllElements","calcButtons","groups","$button","insert","ready","selected","updateValue","element","allElements","elm","bottombar","toolbarButtons","structure","checkButtons","getButtons","columns","block","blockColumns","bar","$customScroll","maxSize","limited","viewId","innerId","barStyles","getBarStyles","dropdowns","getCellStyles","cellStyle","property","splice","selectRow","endRow","last","_selectRange","selectAll","firstColumn","selectColumn","endColumn","isColSelected","selectedArea","isCellSelected","isRowSelected","selectColumns","addSelectArea","adjustColumn","getColumnConfig","eachRow","getCellFilter","setColumnWidth","adjustRow","eachColumn","getSpanNode","setRowHeight","highlightColRow","sr","er","sc","ec","removeCellCss","addCellCss","getHeaderNode","removeCss","addCss","lockCss","lockCell","_mapCellsCalls","_locks","isCellLocked","cm","lock","updatePosition","locked","rid","cid","addSpan","extraCss","getExtraCss","setSpanValue","isEmpty","removeSpan","getRange","lx","ly","rx","ry","cx","cy","setSpanCss","borderChecks","adjustSpan","spanData","checkSpan","selection","isFirstCell","pasteSpan","cutted","translate","mapCells","parse","isUndo","undoSpan","checkSpanBorders","isDate","conditions","batch","lastIndexOf","getStore","getContext","getConditionCss","rendered","_empty","collection","get","currentValue","rule","handlers","checkOrder","compare","addEmptyCollection","oldConditions","_pull","clear","rowId","columnId","clearConditionalFormats","_changeCondition","pasteCondition","oldCondition","newCondition","_normalizeValue","createRules","rId","cId","cond","update","newData","_setCondition","type_action","_undoCondition","getSheetData","tconfig","frozenColumns","frozenRows","_frozenColumns","_frozenRows","getState","ids","_undoValue","actionMap","_remove","_activeSheet","edit","setState","prepare","selectSheet","showItem","command","changePagerVisability","changePagerStatus","once","context","dataOrder","num","_sheets","rename","defaultBottom","tabWidth","sheetTabWidth","minTabWidth","getSheetsPopup","maxHeight","autoheight","onShow","clearAll","maxWidth","editable","editaction","editValue","webix_ssheet_sheet_arrow","initSheetMenu","$sheetMenu","menuInit","menu","_destroy_with_me","callAction","getMark","oneSheet","disabled","scrollSheets","gravity","oldV","direction","scrollTo","scrollPos","disable","enable","scrollWidth","$width","showBatch","tab","getSheet","visibleSheets","getVisible","showPrevious","_filterTabs","tabs","newIndex","getNewTitle","addPage","prepareData","prevIndex","removePage","changeId","renamePage","invalidValue","linkRegex","prepareCell","link","styleProperties","newSheet","DataStore","strict","sheetName","rowCount","columnCount","_resetTable","error","alert","showCells","ref","cellRef","rangePos","replaceAll","showCell","dragStartColumn","dragEndColumn","showCommentHandler","pointerType","comments","_activeComment","editStatus","locate","visible","commentsView","viewonly","contains","editMath","highlightHeaders","cop","ed","$anyKey","ev","getEditor","finalStep","resizeColumn","cind","dx","posRelative","selectColumnHandler","lastHeaderClick","headerClick","dblClick","lastClickedRow","editStop","getFocus","need_focus","details","ctrl","setDefaultCss","leftSplit","areaselect","minColumnWidth","minRowHeight","navigation","cell_template","_v","valueOnly","formulasMode","invalidDate","helper","_print","el","nms","cssFormat","getRenderedValue","_printBorders","$render","refreshColumns","isMac","dialog","f2","del","styleHotKey","ctrlU","attr","elementOn","methodsName","nav","updateEditor","fillEditor","startEdit","symbols","disableEditor","_rangeDialog","en","pasteRange","updateRange","colon","isEnabled","clearEditor","isActiveCell","Dialog","$dialog","$hide","$show","unescape","DialogBox","box","preview","parseImage","server","images","image","showPreview","upload","onBeforeFileAdd","file","reader","FileReader","onload","getFormView","readAsDataURL","onFileUpload","response","imageURL","onSaveClick","okClick","onCancelClick","fillUrl","addImage","viewid","open","views","ignoreUndoReset","restoreHistory","_ssUndoHistory","_ssUndoCursor","addToHistory","$skipHistory","ignoreReset","prevData","undoHandlers","nvalue","ovalue","_trackAll","conf","viewMethods","_types","track","_trackOne","_fromRange","_isPie","_removeLegend","legend","fromData","names","_getNames","switchDirection","dataSeries","legendRange","_getParts","_showAll","win","_correctPos","_showOne","winSize","_getWidth","_getHeight","each","$height","_isRange","_getDataParts","subdata","getRangeRows","getRangeCols","_getSeries","oldLeftColumn","dir","vals","xAxis","activeVals","series","firstRange","inActiveSeries","seria","activeVal","_getColor","colors","dataRange","subRange","_normalizeConfig","valign","scale","rangeToData","rind","editUIType","querySelector","register","container","_commands","getConfig","inner","renderConfig","_processTables","query","tables","oldWin","_activeWin","$destructed","_reset","_undoUI","_updateData","one","viewIds","_genChartConfig","htmlFilter","scaleColor","_prepareType","stacked","pie","pieLegend","legendConfig","yAxis","lineColor","lineShape","circle","borderColor","xValue","chartEditor","handlePieLegend","getLeftColumn","getTopRow","setSilentValue","updateLegendRange","updateXaxisRange","xAxisRange","leftColumn","topRow","exist","updateAlign","updateValign","updateType","isPie","isBar","markersVisible","hideField","hideBatch","switchRowsCols","updateSeries","oldXaxis","field","getSelectedRange","inValues","expand","closeEditor","activeSkin","barHeight","complexData","addRichselect","getTypes","vertical","getLegendAlign","getLegendValign","attributes","els","parseChart","color_def","color_pos","color_neg","renderPreview","visibleBatch","labelPosition","checkRange","sparkConfig","addSparkline","clearValidation","selectedCell","scope","toSheetRange","unshift","validate","oldData","_getScope","updateItem","unselect","_this3","theform","onBeforeSelect","removeRange","editRange","isNotEmpty","onFocus","saveClick","getRanges","selectedId","allRanges","nameParts","selectList","rangeVal","empty","Ranges","_master","_normalizeName","_normalizeRange","globalRange","out","global","rangeOptions","getRangePos","getSpans","inSpan","boolean","unique","objA","objB","sorters","sorting","as","int","nullFilter","$empty","_ssFilters","markBarFilter","getFilters","filters","clearFilters","refilter","filterSpreadSheet","calibrateRange","lastRow","getFilterRange","isValueActive","includes","isFilterExists","getFilterMode","pasteFilter","setCellFilter","getSingleOption","getConditions","getFilterFunction","opt","on_click","ssheet_filter_sign","on_dblclick","toggleFilters","removeFilters","isFilter","$mode","$filter","syncScroll","_getTargetNode","getFilter","flt","importData","relative","inputs","applyFilter","oldValue","setCellStyle","isHidden","nodeOffset","tableOffset","getElementsByClassName","ydiff","xdiff","fillForm","labelsLocale","commonConfig","customConfig","dateConfig","getFormats","updateForm","closeWin","isText","$css","_getDatalayout","value2","_formatValue","_isNotDateRule","editFormat","_safeInt","_getCondition","activeValue","_rulesToArr","current_view","_this4","onBlur","vid","dlayout","getIdByIndex","_this5","getRows","getConditionStyle","conditionStyle","getSheets","filename","restoreValue","print","htmlOnly","_buildHtml","doc","xCorrection","sheetnames","baseIndex","pageSize","getPageSize","oldZoom","$customPrint","children","topSplit","childElementCount","splitHeight","insertBefore","sheetNode","class","external","innerView","img","src","promise","defer","resolve","customPrint","printInnerView","br","res","docFooter","_cleanHtml","cloneNode","canvases","getElementsByTagName","drawImage","printSizes","paper","landscape","printMargin","printPPI","showBorders","redraw","rowsHeight","fit","colsWidth","paperSize","modal","onHide","stringResult","printPreview","_setComment","textarea","onViewResize","animate","showInput","addComment","comment","showTemplate","changeTextarea","getHead","getOption","optionHeight","bases","imt","imc","asw","rgs","dpd","cnd","lnk","pnt","cmt","loadChangedData","process","getUpdateValues","_delColumn","removeColumn","_addColumn","addColumn","_delRow","removeRow","_addRow","addRow","updatedData","fixSelectArea","isRowVisible","isColumnVisible","_ssEditors","clearEditors","pasteDropdown","dropdown","styledata","clipdata","updateFilters","specialPaste","getRow","ignore","$popup","tblEditors","isEditor","setClipboard","buffer","browserClipboard","_get_sel_style","mapSelection","writeText","allFiltersInZone","startRow","startCol","endCol","_clip_to_sel","leftTop","csv","delimiter","_changeDelimiter","getClipboardNumberFormat","record","cut","_add_row_col","maxRow","maxCol","colCount","dataRowCount","dataColCount","ri","ci","subtrans","_clipboardToTable","row_ind","col_ind","cdata","transposeMath","clipboardNumberFormat","clipboardDecimalDelimiter","decimalOptional","clipboard","navigator","clipbuffer","_sel_to_clip","_updateDelimiter","numToStr","stringify","ctrlKey","metaKey","readText","catch","finally","_hidden_cols_hash","_hidden_rows_hash","indexes","getIds","_showRow","_showColumn","_hideRow","_hideColumn","hash","showColumn","getColumnIndex","hideColumn","_updatePosition","hiddenIndex","hrows","hcols","defWidth","defHeight","getColumn","zoomSizes","_adjustRowHeight","spanHeight","textHeight","headerOnly","refreshSelectArea","_undoResize","nsizes","bs","blockStart","blockEnd","removeSelectArea","$handleStart","oldSel","oldStart","oldEnd","clearRange","isRow","nums","firstValue","afterSel","iteration","linkPos","linkRow","linkCol","sortRange","fullrange","expandSelection","maxY","maxX","nr1","nr2","nc1","nc2","newrange","by","newMath","updateSheetNames","oldName","stack","option","gridlines","firstVisible","removeComment","getComment","removeCommentsRange","commentCell","_undoComment","modules","m1","m2","m3","m4","m5","m6","m7","m8","uploader","XMLHttpRequest","apiOnly","accept","cellDates","sheetStubs","startImport","fileDialog","_safeColor","_getCellStyle","excel","stl","font","alignment","_getExcelCellStyle","_getPdfCellStyle","rgb","fill","fgColor","sz","italic","bold","wrapText","getBorderStyles","textAlign","strikethrough","vertAlign","whiteSpace","_getDocStyle","$exportView","pdf","export_mode","defaultOptions","stubCells","footer","heights","rawValues","filterHTML","_exportView","dataOnly","sheetOptions","_hidden","pdfTable","textBefore","sheetData","scheme","_getStyles","cached","cachedConditions","_getDefaults","docHeader","delta","rIndex","cIndex","_getCellConditions","computed","getComputedStyle","bg","_updateStyleCondition","rgbToHex","_updatePdfData","colspan","rowData","exportData","rowSize","pad","paddingTop","paddingBottom","Sheet","Name","Ref","getAutowidth","prop","orientation","$getExportValue","_excel_to_data","dataObj","sheetIndex","book","stylescount","styleshash","_safeFont","va","numFmt","_getBorderStyles","_getTypes","_getHidden","safe","_parseExcel","driver","full","states","_parseCsv","getRecords","readyZoom","callCommand","setSize","insertRow","deleteRow","insertColumn","deleteColumn","checkSpans","changed","spanSize","changeSpan","removeFreeze","getIndexById","hideRow","chart","getRangeValue","registerMathMethod","recalculate","setPlaceholder","spn","rangeStr","setRangeValue","setSheetState","getSheetState","addSheet","clearSheet","renameSheet","editSheet","removeSheet","und","srt","correctVal","cb","muonPage","sameValue","oldType","dateValue","muonItem","updatedType","baseStyle","urlStyle","param","tbl","finished","ok","resetUndo","groupUndo","changeDecimals","formulas","zoomView","defaultMenu","readonlyMenu","getMenuData","component","_base_index","getDefaultStyles","_sub_init","_set_handlers","$skin","setSkinDefaults","background","subbar","tblObj","attachTo","paste","lists","sizeToContent","getMenuItem","contextMenu","dialogs","viewBases","rows_setter","operations","m32","m9","m10","m11","m12","m13","m14","m16","m17","m16a","m16b","m16c","m18","m19","m20","m21","m22","m23","m24","m25","m26","m27","m28","m29","m30","m31","$onLoad","api","rco","lcl","fcl","hbr","hhd","hrc","mat","ops","cor","sav","cfm","fml","prt","AtomDataLoader"],"mappings":";;;;;;;;uJACAA,MAAMC,KAAKC,YCDI,CACdC,OAAO,QAEI,kBACE,kBACF,iBACC,eACH,cACE,uBACO,0BACA,2BACL,2BACD,oCACO,yBACJ,4BACA,qCAED,iBACL,YACA,YACA,aACC,eACC,gBACA,iBACC,aACL,WACG,eAEC,cACF,aAEC,6BAEa,0CACA,4BACF,iBACP,gCACQ,+BACG,iCACF,kCACE,kBAEf,sBACM,4BACD,qBACC,sBACA,uBACC,kBAEJ,mBACG,2BACC,qCACH,wCAEM,iCACD,yBACC,0BACA,6BACG,gCACA,0BAEN,8BACE,kCAEA,sCACO,gCACP,gCACA,WAEZ,oBAEU,8BACM,6DACN,uBACD,wCACK,iCAEN,uBACD,kBACD,YAEH,yBACQ,8BACD,wBAEP,wBACO,0BACJ,0BAEA,gBACF,+BAEc,gFACA,8EACH,6EACN,uCACD,+BAEN,sBACM,sCACG,iCACH,4BACC,gBACN,oBACG,4BACC,+BACC,+BACF,yBACH,6BACK,mBACJ,2BACA,8BACG,2BACC,8BACE,4BACC,0BACH,8BACG,6BAEP,gBAEF,eACC,uBACM,gCACA,+BAEH,qBACE,sBACD,4BAEE,wBACA,wBACA,uBAED,6BACI,iCACA,gCACE,0BAEP,oBACA,mBACD,oBACE,oBACF,oBACE,uBACC,4BACI,8BACH,wBAEF,uBACC,wBACA,uBACD,4BACM,kCACA,4BACA,0BACF,6CACA,6CACA,yCACA,2CACE,6BACC,6BACD,0BACF,yBACC,0BACA,sEAEJ,4BACI;mBACA,iDACE,oCACA,4BACD,4BACC,8BACC,+BACA,oCACH,4BACG,+BACA,sBAET,uBACG,6BACG,2BACL,6BACO,mBACV,wBACE,uBACG,yBACF,2BAEI,mCACF,uBACH,uBAEG,iCACO,kCACE,mCACD,gCACF,uBAEP,0BAEM,iBAEtBC,SAAU,OACA,wBACK,iCACC,0BACF,yBACC,oCACI,yBACP,uBACG,+BACE,4BACD,6BACE,gCACC,8BACH,8BACE,qCACK,yCACL,4BACH,4BACE,6BACD,0BACF,2BACG,8BACA,oBACR,aACA,iBACA,YACA,cACE,oCACU,8CACA,wCACL,oBACD,mBACD,mBACH,0BACQ,qCACF,oCACC,qCACA,0CACA,yCACE,sCACN,8CACE,qCACF,wBACA,yBACJ,mBACG,eACL,cACG,gBACD,oBACI,wBACI,sBACF,4BACK,oCACD,wBACV,qBACK,cAEfC,MAAM,gBACW,8BACA,4BACF,kBACN,aACD,kBACM,2BACG,mCACA,wBACP,sBACK,yBACN,YACA,YACA,eACG,0BACM,gCACA,8BACF,4BACA,8BACE,qBACT,oBACM,0BACA,wBACF,sBACA,wBACE,oBACJ,8BACY,4BACZ,cACF,aACC,sBACK,uBACA,qCACc,+CACH,yCACR,uBACL,YACH,yBACQ,8BACD,wBACP,wBACO,0BACJ,uBACJ,kBACI,uBACC,oBACL,kBACI,0BACC,mBACL,wBACU,wCACH,wCACG,qCACF,oCACC,qCACA,uCACD,2BACH,yBACJ,wBACQ,wCACH,cACP,WACC,aACC,wBACQ,+BACD,0BACE,0BACF;mBACI,uBAErBC,MAAM,cACQ,2BACI,uBACF,oBAEhBC,WAAW,MACH,SAERC,QAAQ,YACO,wBACA,6BACI,8BACA,uCACD,8BACJ,sBACC,CACb,UACA,SACA,WACA,gBC9VHR,MAAMS,QAAQ,CACbC,KAAM,eACNC,SAAS,aACTC,MAAO,SAASC,GACfA,EAAOC,QAAW,CACjBC,KAAK,cACLC,KAAK,CACJD,KAAM,eACNE,QAAS,CACRC,SAAS,aAEVC,OAAO,EAAGC,OAAO,GAElBC,KAAMR,EAAOQ,QAGdrB,MAAMsB,GAAGC,YChBXvB,MAAMS,QAAQ,CACbC,KAAM,yBACNc,SAAS,CACRC,MAAO,KAERb,MAAO,SAASC,OACTa,EAAO1B,MAAM0B,KAAKC,MACxBd,EAAOG,KAAO,CACbY,OAAQ,EACRC,KAAK,CACJ,CAAEd,KAAM,eAAgBe,QAAQ,EAAOC,QAAQ,EAC9CZ,OAAQ,EACRC,OAAQ,EACRH,QAAS,CACRC,SAAU,SAASc,UACXhC,MAAMC,KAAKC,YAAYE,SAAS,WAAW4B,EAAIC,MAGxDC,GAAG,CACFC,cAAe,WA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"}